import Yh from"node:http";import{apiReference as Zh}from"@scalar/express-api-reference";import Vh from"cors";import Ua from"express";import ql from"zod";var Q=class extends Error{};var K=class extends Error{};var s=class extends Error{};var l=class extends Error{};var oe=class extends Error{};import{ZodError as Ul}from"zod";var Zt=class extends Ul{};var Vt=class{handle(e,r,t,i){return e instanceof Zt?t.status(400).json({message:"Validation error",error:ql.treeifyError(e)}):e instanceof Q?t.status(400).json({message:e.message}):e instanceof l?t.status(404).json({message:e.message}):e instanceof oe?t.status(401).json({message:e.message}):e instanceof K?t.status(409).json({message:e.message}):e instanceof s?t.status(500).json({message:e.message}):t.status(500).json({message:"Internal server error"})}};function qa(){return{errorHandler:new Vt}}import{OpenAPIRegistry as Nf,OpenApiGeneratorV3 as kf}from"@asteasolutions/zod-to-openapi";import{$Enums as Ba}from"@prisma/client";import f from"zod";import{extendZodWithOpenApi as Bl}from"@asteasolutions/zod-to-openapi";import We from"zod";var Ol=1,Nl=6;Bl(We);var Yi=We.object({page:We.coerce.number().min(1).default(Ol),limit:We.coerce.number().min(1).default(Nl),title:We.string().optional(),description:We.string().optional(),orderBy:We.enum(["asc","desc"]).default("desc")}),Kt=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{title:t,description:i,limit:n,orderBy:a,page:m}=Yi.parse(e.query),c=m*n-n,g=e.user.id,[T,k]=await Promise.all([this.certificationRepository.findByUserId({userId:g,pagination:{offset:c,limit:n},filter:{title:t,description:i,orderBy:a}}),this.certificationRepository.count({filter:{title:t,description:i,userId:g}})]),z=Math.max(Math.ceil(k/n),1);return r.status(200).json({page:m,totalPages:z,offset:c,limit:n,totalCertifications:k,certifications:T})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as kl}from"@asteasolutions/zod-to-openapi";import Ze from"zod";var Ll=1,Gl=7;kl(Ze);var Xi=Ze.object({page:Ze.coerce.number().min(1).default(Ll),limit:Ze.coerce.number().min(1).default(Gl),title:Ze.string().optional(),content:Ze.string().optional(),orderBy:Ze.enum(["asc","desc"]).default("desc")}),Yt=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,content:n,orderBy:a,title:m}=Xi.parse(e.query),c=i*t-i,g=e.user.id,[T,k]=await Promise.all([this.newsRepository.findByAuthorId({authorId:g,pagination:{offset:c,limit:i},filter:{orderBy:a,title:m,content:n}}),this.newsRepository.count({filter:{authorId:g,content:n,title:m}})]),z=Math.ceil(k/i);r.status(200).json({page:t,totalPages:z,offset:c,limit:i,news:T})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as _l}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Hl}from"@prisma/client";import xe from"zod";var zl=1,Wl=6;_l(xe);var $i=xe.object({page:xe.coerce.number().min(1).default(zl),limit:xe.coerce.number().min(1).default(Wl),title:xe.string().optional(),description:xe.string().optional(),status:xe.enum(Hl).default("PENDING"),orderBy:xe.enum(["asc","desc"]).default("desc")}),Xt=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{limit:t,page:i,...n}=$i.parse(e.query),a=i*t-t,m=e.user.id,[c,g]=await Promise.all([this.pendencyRepository.findByUserId({userId:m,pagination:{offset:a,limit:t},filter:n}),this.pendencyRepository.count({filter:{...n,userId:m}})]),T=Math.max(Math.ceil(g/t),1);return r.status(200).json({page:i,totalPages:T,offset:a,limit:t,pendencies:c})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Zl}from"@asteasolutions/zod-to-openapi";import $t from"zod";Zl($t);var Ji=$t.object({password:$t.string(),email:$t.email()}),Jt=class{constructor(e,r,t){this.userRepository=e;this.bcrypt=r;this.jwtService=t}async handle(e,r){try{let{email:t,password:i}=Ji.parse(e.body),n=await this.userRepository.findByEmail(t);if(!n)return r.status(401).json({message:"Usu\xE1rio n\xE3o existe."});if(!await this.bcrypt.compare({password:i,hashedPassword:n.passwordHash}))throw new oe("Senha inv\xE1lida.");let{id:m,role:c}=n,g=this.jwtService.sign({id:m,role:c,email:t});return r.status(200).json({token:g})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Vl}from"@asteasolutions/zod-to-openapi";import mt from"zod";var Qt=8;Vl(mt);var Qi=mt.object({name:mt.string("Nome \xE9 obrigat\xF3rio.").min(1,"Nome \xE9 obrigat\xF3rio."),emailAddress:mt.email("E-mail inv\xE1lido.").min(1,"E-mail \xE9 obrigat\xF3rio."),password:mt.string("A senha \xE9 obrigat\xF3ria.").min(Qt,`A senha deve ter pelo menos ${Qt} caracteres.`),confirmPassword:mt.string("A senha \xE9 obrigat\xF3ria.").min(Qt,`A senha deve ter pelo menos ${Qt} caracteres.`)}).refine(o=>o.password===o.confirmPassword,{message:"As senhas n\xE3o coincidem.",path:["confirmPassword"]}),er=class{constructor(e,r){this.userRepository=e;this.bcrypt=r}async handle(e,r){try{let{emailAddress:t,name:i,password:n}=Qi.parse(e.body);if(await this.userRepository.findByEmail(t))throw new K("Usu\xE1rio j\xE1 existe.");let m=await this.bcrypt.hash(n);return await this.userRepository.create({name:i,emailAddress:t,passwordHash:m}),r.status(201).json()}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Oa={method:"post",path:"/auth/sign-up",tags:["Authentication"],summary:"Create a new user",request:{body:{content:{"application/json":{schema:Qi}}}},responses:{201:{description:"User created successfully",summary:"User Registration Successful",content:{"application/json":{schema:f.object({message:f.string()})}}},400:{description:"Invalid input data provided",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},409:{description:"User already exists with this email",summary:"User Already Exists",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},Na={method:"post",path:"/auth/sign-in",tags:["Authentication"],summary:"Sign in",request:{body:{content:{"application/json":{schema:Ji}}}},responses:{200:{description:"Authentication successful, JWT token returned",summary:"Login Successful",content:{"application/json":{schema:f.object({token:f.string()})}}},400:{description:"Invalid credentials or input data",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},401:{description:"Invalid email or password",summary:"Authentication Failed",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},ka={method:"get",path:"/auth/user",tags:["Authentication"],summary:"Search for authenticated user",security:[{bearerAuth:[]}],responses:{200:{description:"Authenticated user information retrieved successfully",summary:"User Information Retrieved",content:{"application/json":{schema:f.object({name:f.string(),id:f.string(),avatarUrl:f.string().nullable(),createdAt:f.date(),updatedAt:f.date(),emailAddress:f.string(),orcid:f.string().nullable(),phone:f.string().nullable(),lattesUrl:f.string().nullable(),role:f.enum(Ba.UserRole)}).nullable()}}},400:{description:"Invalid request parameters",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},404:{description:"User not found or not authenticated",summary:"User Not Found",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},La={method:"get",path:"/auth/user/news",tags:["Authentication"],summary:"List authenticated user news",security:[{bearerAuth:[]}],request:{query:Xi},responses:{200:{description:"Paginated list of authenticated user news retrieved successfully",summary:"User News Retrieved",content:{"application/json":{schema:f.object({page:f.number(),totalPages:f.number(),offset:f.number(),limit:f.number(),news:f.object({content:f.string(),id:f.string(),title:f.string(),createdAt:f.date(),updatedAt:f.date(),imageUrl:f.string().nullable()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},Ga={method:"get",path:"/auth/admin",tags:["Authentication"],summary:"Verify admin access",security:[{bearerAuth:[]}],responses:{200:{description:"Admin access verified successfully",summary:"Admin Access Granted",content:{"application/json":{schema:f.object({success:f.boolean()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},_a={method:"get",path:"/auth/certifications",tags:["Authentication"],summary:"List all authenticated user's certifications",security:[{bearerAuth:[]}],request:{query:Yi},responses:{200:{description:"Paginated list of authenticated user certifications retrieved successfully",summary:"User Certifications Retrieved",content:{"application/json":{schema:f.object({page:f.number(),totalPages:f.number(),offset:f.number(),limit:f.number(),certifications:f.object({description:f.string(),id:f.string(),title:f.string(),certificationUrl:f.string(),createdAt:f.date(),updatedAt:f.date(),userId:f.string()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},Ha={method:"get",path:"/auth/pendencies",tags:["Authentication"],summary:"List all authenticated user's pendencies",security:[{bearerAuth:[]}],request:{query:$i},responses:{200:{description:"Paginated list of authenticated user pendencies retrieved successfully",summary:"User Pendencies Retrieved",content:{"application/json":{schema:f.object({page:f.number(),totalPages:f.number(),offset:f.number(),limit:f.number(),pendencies:f.object({id:f.string(),title:f.string(),description:f.string(),status:f.enum(Ba.PendencyStatus),createdAt:f.date(),updatedAt:f.date(),userId:f.string()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}};import{$Enums as tu}from"@prisma/client";import C from"zod";import{extendZodWithOpenApi as Kl}from"@asteasolutions/zod-to-openapi";import en from"zod";Kl(en);var tn=en.object({id:en.string()}),tr=class{constructor(e,r){this.certificationRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=tn.parse({id:e.params.certification_id}),i=await this.certificationRepository.findById(t);if(!i)throw new l("A certifica\xE7\xE3o n\xE3o existe.");return await Promise.all([this.certificationRepository.deleteById(i.id),this.firebaseStorageService.deleteFile({fileUrl:i.certificationUrl})]),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Yl}from"@asteasolutions/zod-to-openapi";import rn from"zod";Yl(rn);var on=rn.object({certificationId:rn.uuid()}),rr=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{certificationId:t}=on.parse({certificationId:e.params.certification_id}),i=await this.certificationRepository.findById(t);if(!i)throw new l("Certificado n\xE3o encontrado.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Xl}from"@asteasolutions/zod-to-openapi";import Me from"zod";var $l=1,Jl=6;Xl(Me);var nn=Me.object({page:Me.coerce.number().min(1).default($l),limit:Me.coerce.number().min(1).default(Jl),title:Me.string().optional(),description:Me.string().optional(),userId:Me.uuid().optional(),orderBy:Me.enum(["asc","desc"]).default("desc")}),or=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{limit:t,page:i,...n}=nn.parse(e.query),a=i*t-t,[m,c]=await Promise.all([this.certificationRepository.find({pagination:{offset:a,limit:t},filter:n}),this.certificationRepository.count({filter:n})]),g=Math.max(Math.ceil(c/t),1);return r.status(200).json({page:i,totalPages:g,offset:a,limit:t,certifications:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ql}from"@asteasolutions/zod-to-openapi";import ct from"zod";var D={NEWS:"images/news",USER:"images/user",IN_MEMORIAM:"images/in-memoriam",PARTNER:"images/partners",CERTIFICATION:"documents/certifications",PENDENCY:"documents/pendencies",REGIMENT:"documents/regiments",MEETING_MINUTE:"documents/meeting-minutes",INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY:"images/international-scientific-congress-gallery",GALLERY:"images/regional-congress-gallery",REGIONAL_CONGRESS_GALLERY:"images/regional-congress-gallery"};Ql(ct);var nr=ct.object({userId:ct.uuid(),title:ct.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio."),description:ct.string().min(1,"Descri\xE7\xE3o \xE9 obrigat\xF3ria."),certification:ct.any().refine(o=>o&&typeof o=="object"&&o.size>0,"Arquivo do certificado \xE9 obrigat\xF3rio")}),ir=class{constructor(e,r,t){this.userRepository=e;this.certificationRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{userId:t,title:i,description:n,certification:a}=nr.parse({...e.body,userId:e.params.user_id,certification:e.file});if(!await this.userRepository.findById(t))throw new Q("O usu\xE1rio n\xE3o existe.");let c=await this.firebaseStorageService.uploadFile({file:a,id:t,folder:D.CERTIFICATION});return await this.certificationRepository.register({userId:t,title:i,description:n,certificationUrl:c}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as eu}from"@asteasolutions/zod-to-openapi";import pt from"zod";eu(pt);var ar=pt.object({id:pt.uuid(),title:pt.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio."),description:pt.string().min(1,"Descri\xE7\xE3o \xE9 obrigat\xF3ria."),certification:pt.any().refine(o=>o==null||typeof o=="object"&&typeof o.size=="number"&&(o.size===0||o.size>0),"Arquivo do certificado \xE9 inv\xE1lido").optional()}),sr=class{constructor(e,r){this.certificationRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{certification:t,id:i,...n}=ar.parse({...e.body,id:e.params.certification_id,certification:e.file}),a=await this.certificationRepository.findById(i);if(!a)throw new Q("A certifica\xE7\xE3o n\xE3o existe");let m=a.certificationUrl;return t&&t.size>0&&(m=await this.firebaseStorageService.updateFile({file:t,id:a.userId,folder:D.CERTIFICATION,fileUrl:a.certificationUrl})),await this.certificationRepository.update({...n,id:i,certificationUrl:m}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var za={method:"post",path:"/certifications/{user_id}",tags:["Certifications"],summary:"Register certification for user",security:[{bearerAuth:[]}],request:{params:nr.pick({userId:!0}).transform(()=>({user_id:""})),body:{content:{"multipart/form-data":{schema:nr.omit({userId:!0})}}}},responses:{201:{description:"Certification registered successfully for the user",summary:"Certification Registered",content:{"application/json":{schema:C.object({message:C.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},404:{description:"User not found with the provided ID",summary:"User Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Wa={method:"get",path:"/certifications",tags:["Certifications"],summary:"List certifications",security:[{bearerAuth:[]}],request:{query:nn},responses:{200:{description:"Paginated list of certifications with user information retrieved successfully",summary:"Certifications Retrieved",content:{"application/json":{schema:C.object({page:C.number(),totalPages:C.number(),offset:C.number(),limit:C.number(),certifications:C.array(C.object({description:C.string(),userId:C.string(),title:C.string(),id:C.string(),createdAt:C.date(),updatedAt:C.date(),certificationUrl:C.url(),user:C.object({id:C.uuid(),name:C.string(),createdAt:C.date(),updatedAt:C.date(),avatarUrl:C.string().nullable(),emailAddress:C.email(),orcid:C.string().nullable(),phone:C.string().nullable(),lattesUrl:C.url().nullable(),role:C.enum(tu.UserRole)})}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Za={method:"get",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Find certification by ID",security:[{bearerAuth:[]}],request:{params:on},responses:{200:{description:"Certification details retrieved successfully",summary:"Certification Retrieved",content:{"application/json":{schema:C.object({description:C.string(),userId:C.string(),title:C.string(),id:C.string(),createdAt:C.date(),updatedAt:C.date(),certificationUrl:C.url()}).nullable()}}},400:{description:"Invalid certification ID format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Va={method:"put",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Update certification",security:[{bearerAuth:[]}],request:{params:ar.pick({id:!0}).transform(()=>({certification_id:""})),body:{content:{"multipart/form-data":{schema:ar.omit({id:!0})}}}},responses:{204:{description:"Certification updated successfully",summary:"Certification Updated"},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Ka={method:"delete",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Delete certification",security:[{bearerAuth:[]}],request:{params:tn},responses:{204:{description:"Certification deleted successfully",summary:"Certification Deleted"},400:{description:"Invalid certification ID format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}};import{$Enums as dn}from"@prisma/client";import R from"zod";import{extendZodWithOpenApi as ru}from"@asteasolutions/zod-to-openapi";import me from"zod";ru(me);var sn=me.object({code:me.string(),title:me.string(),description:me.string().optional(),notes:me.string().optional(),leaderId:me.uuid(),deputyLeaderId:me.uuid(),secretaryId:me.uuid(),memberIds:me.array(me.uuid())}),mr=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{code:t,title:i,description:n,notes:a,leaderId:m,deputyLeaderId:c,secretaryId:g,memberIds:T}=sn.parse(e.body);if(await this.etpRepository.findByCode(t))throw new K("J\xE1 existe um ETP cadastrado com este c\xF3digo.");return await this.etpRepository.create({code:t,title:i,description:n,notes:a,leaderId:m,deputyLeaderId:c,secretaryId:g,memberIds:T}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ou}from"@asteasolutions/zod-to-openapi";import an from"zod";ou(an);var mn=an.object({id:an.uuid()}),cr=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t}=mn.parse({id:e.params.id});if(!await this.etpRepository.findById(t))throw new l("O ETP n\xE3o existe.");return await this.etpRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as iu}from"@asteasolutions/zod-to-openapi";import cn from"zod";iu(cn);var dr=cn.object({id:cn.uuid()}),pr=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t}=dr.parse({id:e.params.id}),i=await this.etpRepository.findById(t);if(!i)throw new l("O ETP n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as nu}from"@asteasolutions/zod-to-openapi";import ie from"zod";nu(ie);var pn=ie.object({id:ie.uuid(),code:ie.string().optional(),title:ie.string().optional(),description:ie.string().optional(),notes:ie.string().optional(),leaderId:ie.uuid().optional(),deputyLeaderId:ie.uuid().optional(),secretaryId:ie.uuid().optional(),memberIds:ie.array(ie.uuid()).optional()}),lr=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t,code:i,title:n,description:a,notes:m,leaderId:c,deputyLeaderId:g,secretaryId:T,memberIds:k}=pn.parse({id:e.params.id,...e.body});if(!await this.etpRepository.findById(t))throw new l("O ETP n\xE3o existe.");if(i){let J=await this.etpRepository.findByCode(i);if(J&&J.id!==t)throw new K("J\xE1 existe um ETP com este c\xF3digo.")}return await this.etpRepository.update({id:t,code:i,title:n,description:a,notes:m,leaderId:c,deputyLeaderId:g,secretaryId:T,memberIds:k}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var su=1,au=9,ur=R.object({id:R.uuid(),registrationNumber:R.string(),mainEtps:R.string().nullable(),formations:R.string().nullable(),degrees:R.array(R.enum(dn.Degree)),occupations:R.string(),seniority:R.enum(dn.Seniority),institutions:R.string(),biography:R.string().nullable(),createdAt:R.date(),updatedAt:R.date(),user:R.object({id:R.uuid(),name:R.string(),emailAddress:R.string(),avatarUrl:R.string().nullable(),orcid:R.string().nullable(),phone:R.string().nullable(),lattesUrl:R.string().nullable(),role:R.enum(dn.UserRole)})}),Ya=R.object({id:R.uuid(),code:R.string(),title:R.string(),description:R.string().nullable(),notes:R.string().nullable(),createdAt:R.date(),updatedAt:R.date(),leader:R.object({id:R.uuid(),researcher:ur}).nullable(),deputyLeader:R.object({id:R.uuid(),researcher:ur}).nullable(),secretary:R.object({id:R.uuid(),researcher:ur}).nullable(),members:R.array(ur)}),Xa={method:"post",path:"/etp",tags:["ETPs"],summary:"Create a new ETP with single leader, deputy leader, secretary and multiple members",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:sn}}}},responses:{201:{description:"ETP created successfully",summary:"ETP Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},409:{description:"ETP with this code already exists",summary:"Conflict",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},$a={method:"get",path:"/etp",tags:["ETPs"],summary:"List all ETPs with pagination and filters",request:{query:R.object({page:R.coerce.number().min(1).default(su).optional(),limit:R.coerce.number().min(1).default(au).optional(),code:R.string().optional(),title:R.string().optional(),description:R.string().optional(),notes:R.string().optional(),orderBy:R.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of ETPs retrieved successfully with pagination",summary:"ETPs Retrieved",content:{"application/json":{schema:R.object({page:R.number(),totalPages:R.number(),offset:R.number(),limit:R.number(),etps:R.array(Ya)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},Ja={method:"get",path:"/etp/{id}",tags:["ETPs"],summary:"Find ETP by ID",request:{params:dr},responses:{200:{description:"ETP details retrieved successfully",summary:"ETP Retrieved",content:{"application/json":{schema:Ya}}},400:{description:"Invalid ETP ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},Qa={method:"put",path:"/etp/{id}",tags:["ETPs"],summary:"Update ETP and manage user relationships (single leader, deputy leader, secretary, multiple members)",security:[{bearerAuth:[]}],request:{params:dr,body:{content:{"application/json":{schema:pn.omit({id:!0})}}}},responses:{200:{description:"ETP updated successfully",summary:"ETP Updated"},400:{description:"Invalid input data or ETP ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},409:{description:"ETP with this code already exists",summary:"Conflict",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},em={method:"delete",path:"/etp/{id}",tags:["ETPs"],summary:"Delete ETP",security:[{bearerAuth:[]}],request:{params:mn},responses:{200:{description:"ETP deleted successfully",summary:"ETP Deleted"},400:{description:"Invalid ETP ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}};import{InMemoriamRole as vu}from"@prisma/client";import w from"zod";import{extendZodWithOpenApi as mu}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as cu}from"@prisma/client";import Pe from"zod";var rm=2,tm=1024,pu=tm*tm,du=rm*pu;mu(Pe);var ln=Pe.object({name:Pe.string().min(1,"Nome \xE9 obrigat\xF3rio"),birthDate:Pe.coerce.date(),deathDate:Pe.coerce.date(),biography:Pe.string().optional(),photo:Pe.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=du,`A imagem deve ter no m\xE1ximo ${rm}MB.`).optional(),role:Pe.enum(cu)}).refine(o=>o.deathDate>o.birthDate,{message:"Data de falecimento deve ser posterior \xE0 data de nascimento",path:["deathDate"]}),gr=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{name:t,birthDate:i,deathDate:n,biography:a,role:m,photo:c}=ln.parse({...e.body,photo:e.file}),g=await this.inMemoriamRepository.create({name:t,birthDate:i,deathDate:n,biography:a??void 0,role:m}),T;return c&&(T=await this.firebaseStorageService.uploadFile({file:c,id:g.id,folder:D.IN_MEMORIAM}),await this.inMemoriamRepository.update({id:g.id,photoUrl:T})),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as lu}from"@asteasolutions/zod-to-openapi";import un from"zod";lu(un);var gn=un.object({id:un.uuid()}),yr=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=gn.parse({id:e.params.id}),i=await this.inMemoriamRepository.findById(t);if(!i)throw new l("O in memoriam n\xE3o existe.");return i.photoUrl&&this.firebaseStorageService.deleteFile({fileUrl:i.photoUrl}),await this.inMemoriamRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as uu}from"@asteasolutions/zod-to-openapi";import yn from"zod";uu(yn);var hr=yn.object({id:yn.uuid()}),fr=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{id:t}=hr.parse({id:e.params.id}),i=await this.inMemoriamRepository.findById(t);if(!i)throw new l("O in memoriam n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as gu}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as yu}from"@prisma/client";import fn from"zod";gu(fn);var hn=fn.object({role:fn.enum(yu)}),Rr=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{role:t}=hn.parse({role:e.params.role}),i=await this.inMemoriamRepository.findByRole(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as fu}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as hu}from"@prisma/client";import Te from"zod";var Ru=1,Iu=9;fu(Te);var Rn=Te.object({page:Te.coerce.number().min(1).default(Ru),limit:Te.coerce.number().min(1).default(Iu),name:Te.string().optional(),biography:Te.string().optional(),role:Te.enum(hu).optional(),orderBy:Te.enum(["asc","desc"]).default("desc")}),Ir=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Rn.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.inMemoriamRepository.find({pagination:{offset:a,limit:i},filter:n}),this.inMemoriamRepository.count({filter:n})]),g=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:g,offset:a,limit:i,inMemoriam:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Cu}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as bu}from"@prisma/client";import he from"zod";var im=2,om=1024,wu=om*om,Su=im*wu;Cu(he);var In=he.object({id:he.uuid(),name:he.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),birthDate:he.coerce.date().optional(),deathDate:he.coerce.date().optional(),biography:he.string().optional(),photo:he.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Su,`A imagem deve ter no m\xE1ximo ${im}MB.`).optional(),role:he.enum(bu).optional()}).refine(o=>o.birthDate&&o.deathDate?o.deathDate>o.birthDate:!0,{message:"Data de falecimento deve ser posterior \xE0 data de nascimento",path:["deathDate"]}),Cr=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,birthDate:n,deathDate:a,biography:m,photo:c,role:g}=In.parse({id:e.params.id,...e.body,photo:e.file}),T=await this.inMemoriamRepository.findById(t);if(!T)throw new l("O registro in memoriam n\xE3o existe.");let k=T.photoUrl;return c&&(k=await this.firebaseStorageService.uploadFile({file:c,id:t,folder:D.IN_MEMORIAM})),await this.inMemoriamRepository.update({id:t,name:i,birthDate:n,deathDate:a,biography:m,photoUrl:k??void 0,role:g}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Cn=w.object({id:w.uuid(),name:w.string(),birthDate:w.date(),deathDate:w.date(),biography:w.string().nullable(),photoUrl:w.string().nullable(),role:w.enum(vu),createdAt:w.date(),updatedAt:w.date()}),nm={method:"post",path:"/in-memoriam",tags:["In Memoriam"],summary:"Create a new in memoriam record with optional photo upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:ln}}}},responses:{201:{description:"In memoriam record created successfully",summary:"In Memoriam Created"},400:{description:"Invalid input data, missing required fields, or invalid photo format/size",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:w.object({message:w.string()})}}},409:{description:"In memoriam record with this name already exists",summary:"Conflict",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},sm={method:"get",path:"/in-memoriam",tags:["In Memoriam"],summary:"List all in memoriam records with pagination and filters",request:{query:Rn},responses:{200:{description:"List of in memoriam records retrieved successfully with pagination",summary:"In Memoriam Records Retrieved",content:{"application/json":{schema:w.object({page:w.number(),totalPages:w.number(),offset:w.number(),limit:w.number(),inMemoriam:w.array(Cn)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},am={method:"get",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Find in memoriam record by ID",request:{params:hr},responses:{200:{description:"In memoriam record details retrieved successfully",summary:"In Memoriam Record Retrieved",content:{"application/json":{schema:Cn}}},400:{description:"Invalid in memoriam record ID format",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},mm={method:"put",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Update in memoriam record with optional photo upload",security:[{bearerAuth:[]}],request:{params:hr,body:{content:{"multipart/form-data":{schema:In.omit({id:!0})}}}},responses:{200:{description:"In memoriam record updated successfully",summary:"In Memoriam Record Updated"},400:{description:"Invalid input data, in memoriam record ID format, or invalid photo format/size",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:w.object({message:w.string()})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},409:{description:"In memoriam record with this name already exists",summary:"Conflict",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},cm={method:"delete",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Delete in memoriam record",security:[{bearerAuth:[]}],request:{params:gn},responses:{200:{description:"In memoriam record deleted successfully",summary:"In Memoriam Record Deleted"},400:{description:"Invalid in memoriam record ID format",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:w.object({message:w.string()})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},cb={method:"get",path:"/in-memoriam/role/{role}",tags:["In Memoriam"],summary:"Find in memoriam records by role",request:{params:hn},responses:{200:{description:"In memoriam records retrieved successfully by role",summary:"In Memoriam Records Retrieved by Role",content:{"application/json":{schema:w.array(Cn)}}},400:{description:"Invalid role parameter provided",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}};import F from"zod";import{extendZodWithOpenApi as ju}from"@asteasolutions/zod-to-openapi";import At from"zod";var dm=2,pm=1024,Eu=pm*pm,xu=dm*Eu;ju(At);var bn=At.object({image:At.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=xu,`A imagem deve ter no m\xE1ximo ${dm}MB.`),caption:At.string().optional(),congressId:At.uuid()}),br=class{constructor(e,r,t){this.internationalScientificCongressGalleryRepository=e;this.internationalScientificCongressRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{image:t,caption:i,congressId:n}=bn.parse({...e.body,...e.params,image:e.file});if(!await this.internationalScientificCongressRepository.findById(n))throw new l("O congresso n\xE3o existe.");let m=await this.internationalScientificCongressGalleryRepository.create({imageUrl:"",caption:i||void 0,congressId:n}),c=await this.firebaseStorageService.uploadFile({file:t,id:m.id,folder:D.INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY});return await this.internationalScientificCongressGalleryRepository.update({id:m.id,imageUrl:c}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Mu}from"@asteasolutions/zod-to-openapi";import wn from"zod";Mu(wn);var Sr=wn.object({id:wn.uuid()}),wr=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=Sr.parse({id:e.params.id});if(!await this.internationalScientificCongressGalleryRepository.findById(t))throw new l("A imagem da galeria n\xE3o existe.");return await this.internationalScientificCongressGalleryRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Pu}from"@asteasolutions/zod-to-openapi";import dt from"zod";var Tu=1,Au=9;Pu(dt);var Sn=dt.object({congressId:dt.uuid(),page:dt.coerce.number().min(1).default(Tu),limit:dt.coerce.number().min(1).default(Au),caption:dt.string().optional()}),vr=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{congressId:t,page:i,limit:n,...a}=Sn.parse({congressId:e.params.congressId,...e.query}),m=n*i-n,[c,g]=await Promise.all([this.internationalScientificCongressGalleryRepository.findByCongressId({pagination:{offset:m,limit:n},filter:{congressId:t,...a}}),this.internationalScientificCongressGalleryRepository.count({filter:{congressId:t,caption:a.caption}})]),T=Math.max(Math.ceil(g/n),1);return r.status(200).json({page:i,totalPages:T,offset:m,limit:n,galleryImages:c})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Du}from"@asteasolutions/zod-to-openapi";import Dt from"zod";var um=2,lm=1024,Fu=lm*lm,Uu=um*Fu;Du(Dt);var vn=Dt.object({id:Dt.uuid(),image:Dt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Uu,`A imagem deve ter no m\xE1ximo ${um}MB.`).optional(),caption:Dt.string().optional()}),jr=class{constructor(e,r){this.internationalScientificCongressGalleryRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,image:i,caption:n}=vn.parse({id:e.params.id,...e.body,image:e.file}),a=await this.internationalScientificCongressGalleryRepository.findById(t);if(!a)throw new l("A imagem da galeria n\xE3o existe.");let m=a.imageUrl;return i&&(m=await this.firebaseStorageService.uploadFile({file:i,id:t,folder:D.INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY})),await this.internationalScientificCongressGalleryRepository.update({id:t,imageUrl:m??void 0,caption:n||void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var qu=F.object({id:F.uuid(),imageUrl:F.string(),caption:F.string().nullable(),congressId:F.uuid()}),gm={method:"post",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congresses"],summary:"Create a new congress gallery image",security:[{bearerAuth:[]}],request:{params:F.object({congressId:F.uuid()}),body:{content:{"application/json":{schema:bn.omit({congressId:!0})}}}},responses:{201:{description:"Congress gallery image created successfully",summary:"Congress Gallery Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:F.object({errors:F.record(F.string(),F.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:F.object({message:F.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:F.object({message:F.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:F.object({message:F.string()})}}}}},ym={method:"get",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congresses"],summary:"Find congress gallery images by congress ID",request:{params:Sn},responses:{200:{description:"Congress gallery images retrieved successfully by congress ID",summary:"Congress Galleries Retrieved",content:{"application/json":{schema:F.array(qu)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:F.object({errors:F.record(F.string(),F.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:F.object({message:F.string()})}}}}},fm={method:"put",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congresses"],summary:"Update congress gallery image",security:[{bearerAuth:[]}],request:{params:Sr,body:{content:{"application/json":{schema:vn.omit({id:!0})}}}},responses:{200:{description:"Congress gallery image updated successfully",summary:"Congress Gallery Updated"},400:{description:"Invalid input data or gallery ID format",summary:"Validation Error",content:{"application/json":{schema:F.object({errors:F.record(F.string(),F.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:F.object({message:F.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:F.object({message:F.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:F.object({message:F.string()})}}}}},hm={method:"delete",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congresses"],summary:"Delete congress gallery image",security:[{bearerAuth:[]}],request:{params:Sr},responses:{200:{description:"Congress gallery image deleted successfully",summary:"Congress Gallery Deleted"},400:{description:"Invalid gallery ID format",summary:"Validation Error",content:{"application/json":{schema:F.object({errors:F.record(F.string(),F.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:F.object({message:F.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:F.object({message:F.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:F.object({message:F.string()})}}}}};import U from"zod";import{extendZodWithOpenApi as Bu}from"@asteasolutions/zod-to-openapi";import Ft from"zod";var Im=2,Rm=1024,Ou=Rm*Rm,Nu=Im*Ou;Bu(Ft);var jn=Ft.object({name:Ft.string().min(1,"Nome \xE9 obrigat\xF3rio"),logo:Ft.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Nu,`A imagem deve ter no m\xE1ximo ${Im}MB.`).optional(),congressId:Ft.uuid()}),Er=class{constructor(e,r,t){this.internationalScientificCongressPartnerRepository=e;this.internationalScientificCongressRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{name:t,logo:i,congressId:n}=jn.parse({...e.body,...e.params,logo:e.file});if(!await this.internationalScientificCongressRepository.findById(n))throw new l("O congresso n\xE3o existe.");let m=await this.internationalScientificCongressPartnerRepository.create({name:t,congressId:n}),c;return i&&(c=await this.firebaseStorageService.uploadFile({file:i,id:m.id,folder:D.PARTNER}),await this.internationalScientificCongressPartnerRepository.update({id:m.id,logoUrl:c})),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ku}from"@asteasolutions/zod-to-openapi";import En from"zod";ku(En);var Mr=En.object({id:En.uuid()}),xr=class{constructor(e){this.internationalScientificCongressPartnerRepository=e}async handle(e,r){try{let{id:t}=Mr.parse({id:e.params.id});if(!await this.internationalScientificCongressPartnerRepository.findById(t))throw new l("O parceiro n\xE3o existe.");return await this.internationalScientificCongressPartnerRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Lu}from"@asteasolutions/zod-to-openapi";import lt from"zod";var Gu=1,_u=9;Lu(lt);var xn=lt.object({congressId:lt.uuid(),page:lt.coerce.number().min(1).optional(),limit:lt.coerce.number().min(1).optional(),name:lt.string().optional()}),Pr=class{constructor(e){this.internationalScientificCongressPartnerRepository=e}async handle(e,r){try{let{congressId:t,page:i,limit:n,...a}=xn.parse({congressId:e.params.congressId,...e.query});if(i!==void 0&&n!==void 0){let c=i||Gu,g=n||_u,T=g*c-g,[k,z]=await Promise.all([this.internationalScientificCongressPartnerRepository.findByCongressId({pagination:{offset:T,limit:g},filter:{congressId:t,...a}}),this.internationalScientificCongressPartnerRepository.count({filter:{congressId:t,name:a.name}})]),J=Math.max(Math.ceil(z/g),1);return r.status(200).json({page:c,totalPages:J,offset:T,limit:g,partners:k})}let m=await this.internationalScientificCongressPartnerRepository.findByCongressId({filter:{congressId:t,...a}});return r.status(200).json(m)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Hu}from"@asteasolutions/zod-to-openapi";import Ut from"zod";var bm=2,Cm=1024,zu=Cm*Cm,Wu=bm*zu;Hu(Ut);var Mn=Ut.object({id:Ut.uuid(),name:Ut.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),logo:Ut.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Wu,`A imagem deve ter no m\xE1ximo ${bm}MB.`).optional()}),Tr=class{constructor(e,r){this.internationalScientificCongressPartnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,logo:n}=Mn.parse({id:e.params.id,...e.body,logo:e.file}),a=await this.internationalScientificCongressPartnerRepository.findById(t);if(!a)throw new l("O parceiro n\xE3o existe.");let m=a.logoUrl;return n&&(m=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:D.PARTNER})),await this.internationalScientificCongressPartnerRepository.update({id:t,name:i,logoUrl:m??void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Zu=U.object({id:U.uuid(),name:U.string(),logoUrl:U.string().nullable(),congressId:U.uuid()}),wm={method:"post",path:"/international-scientific-congress/{congressId}/partner",tags:["International Scientific Congresses"],summary:"Create a new congress partner",security:[{bearerAuth:[]}],request:{params:U.object({congressId:U.uuid()}),body:{content:{"application/json":{schema:jn.omit({congressId:!0})}}}},responses:{201:{description:"Congress partner created successfully",summary:"Congress Partner Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:U.object({errors:U.record(U.string(),U.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:U.object({message:U.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:U.object({message:U.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:U.object({message:U.string()})}}}}},Sm={method:"get",path:"/international-scientific-congress/{congressId}/partner",tags:["International Scientific Congresses"],summary:"Find congress partners by congress ID",request:{params:xn},responses:{200:{description:"Congress partners retrieved successfully by congress ID",summary:"Congress Partners Retrieved",content:{"application/json":{schema:U.array(Zu)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:U.object({errors:U.record(U.string(),U.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:U.object({message:U.string()})}}}}},vm={method:"put",path:"/international-scientific-congress/partner/{id}",tags:["International Scientific Congresses"],summary:"Update congress partner",security:[{bearerAuth:[]}],request:{params:Mr,body:{content:{"application/json":{schema:Mn.omit({id:!0})}}}},responses:{200:{description:"Congress partner updated successfully",summary:"Congress Partner Updated"},400:{description:"Invalid input data or partner ID format",summary:"Validation Error",content:{"application/json":{schema:U.object({errors:U.record(U.string(),U.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:U.object({message:U.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:U.object({message:U.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:U.object({message:U.string()})}}}}},jm={method:"delete",path:"/international-scientific-congress/partner/{id}",tags:["International Scientific Congresses"],summary:"Delete congress partner",security:[{bearerAuth:[]}],request:{params:Mr},responses:{200:{description:"Congress partner deleted successfully",summary:"Congress Partner Deleted"},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:U.object({errors:U.record(U.string(),U.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:U.object({message:U.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:U.object({message:U.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:U.object({message:U.string()})}}}}};import p from"zod";import{extendZodWithOpenApi as Vu}from"@asteasolutions/zod-to-openapi";import V from"zod";Vu(V);var Pn=V.object({title:V.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),edition:V.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo"),startDate:V.coerce.date(),endDate:V.coerce.date(),description:V.string().optional(),location:V.string().optional(),congressLink:V.url("Link do congresso deve ser uma URL v\xE1lida").optional().or(V.literal("")),noticeUrl:V.url("URL do edital deve ser uma URL v\xE1lida").optional().or(V.literal("")),scheduleUrl:V.url("URL do cronograma deve ser uma URL v\xE1lida").optional().or(V.literal("")),programUrl:V.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida").optional().or(V.literal("")),adminReportUrl:V.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida").optional().or(V.literal("")),proceedingsUrl:V.url("URL dos anais deve ser uma URL v\xE1lida").optional().or(V.literal(""))}).refine(o=>o.endDate>=o.startDate,{message:"Data de t\xE9rmino deve ser posterior ou igual \xE0 data de in\xEDcio",path:["endDate"]}),Ar=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let t=Pn.parse(e.body);return await this.internationalScientificCongressRepository.create(t),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ku}from"@asteasolutions/zod-to-openapi";import Tn from"zod";Ku(Tn);var An=Tn.object({id:Tn.uuid()}),Dr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t}=An.parse({id:e.params.id});if(!await this.internationalScientificCongressRepository.findById(t))throw new l("O congresso n\xE3o existe.");return await this.internationalScientificCongressRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Yu}from"@asteasolutions/zod-to-openapi";import Dn from"zod";Yu(Dn);var Fn=Dn.object({edition:Dn.coerce.number().int().positive()}),Fr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{edition:t}=Fn.parse({edition:e.params.edition}),i=await this.internationalScientificCongressRepository.findByEdition(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Xu}from"@asteasolutions/zod-to-openapi";import Un from"zod";Xu(Un);var qr=Un.object({id:Un.uuid()}),Ur=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t}=qr.parse({id:e.params.id}),i=await this.internationalScientificCongressRepository.findById(t);if(!i)throw new l("O congresso n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as $u}from"@asteasolutions/zod-to-openapi";import Ae from"zod";var Ju=1,Qu=10;$u(Ae);var qn=Ae.object({page:Ae.coerce.number().min(1).default(Ju),limit:Ae.coerce.number().min(1).default(Qu),title:Ae.string().optional(),edition:Ae.coerce.number().int().positive().optional(),location:Ae.string().optional(),orderBy:Ae.enum(["asc","desc"]).optional()}),Br=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=qn.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.internationalScientificCongressRepository.find({pagination:{offset:a,limit:i},filter:n}),this.internationalScientificCongressRepository.count({filter:n})]),g=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:g,offset:a,limit:i,congresses:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as eg}from"@asteasolutions/zod-to-openapi";import Z from"zod";eg(Z);var Bn=Z.object({id:Z.uuid(),title:Z.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),edition:Z.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo").optional(),startDate:Z.coerce.date().optional(),endDate:Z.coerce.date().optional(),description:Z.string().optional(),location:Z.string().optional(),congressLink:Z.url("Link do congresso deve ser uma URL v\xE1lida").optional().or(Z.literal("")),noticeUrl:Z.url("URL do edital deve ser uma URL v\xE1lida").optional().or(Z.literal("")),scheduleUrl:Z.url("URL do cronograma deve ser uma URL v\xE1lida").optional().or(Z.literal("")),programUrl:Z.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida").optional().or(Z.literal("")),adminReportUrl:Z.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida").optional().or(Z.literal("")),proceedingsUrl:Z.url("URL dos anais deve ser uma URL v\xE1lida").optional().or(Z.literal(""))}),Or=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t,...i}=Bn.parse({id:e.params.id,...e.body});if(!await this.internationalScientificCongressRepository.findById(t))throw new l("O congresso n\xE3o existe.");return await this.internationalScientificCongressRepository.update({...i,id:t}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var tg=9,rg=p.object({image:p.any().openapi({type:"string",format:"binary"}),caption:p.string().optional()}),og=p.object({image:p.any().openapi({type:"string",format:"binary"}).optional(),caption:p.string().optional()}),ig=p.object({id:p.uuid(),name:p.string(),logoUrl:p.string().nullable(),congressId:p.uuid()}),On=p.object({id:p.uuid(),imageUrl:p.string(),caption:p.string().nullable(),congressId:p.uuid()}),Nn=p.object({id:p.uuid(),title:p.string(),edition:p.number(),startDate:p.date(),endDate:p.date(),description:p.string().nullable(),location:p.string().nullable(),congressLink:p.string().nullable(),noticeUrl:p.string().nullable(),scheduleUrl:p.string().nullable(),programUrl:p.string().nullable(),adminReportUrl:p.string().nullable(),proceedingsUrl:p.string().nullable(),partners:p.array(ig),galleries:p.array(On),createdAt:p.date(),updatedAt:p.date()}),Em={method:"post",path:"/international-scientific-congress",tags:["International Scientific Congresses"],summary:"Create a new international scientific congress",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Pn}}}},responses:{201:{description:"International scientific congress created successfully",summary:"International Scientific Congress Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},xm={method:"get",path:"/international-scientific-congress",tags:["International Scientific Congresses"],summary:"List all international scientific congresses with pagination and filters",request:{query:qn},responses:{200:{description:"List of international scientific congresses retrieved successfully with pagination",summary:"International Scientific Congresses Retrieved",content:{"application/json":{schema:p.object({page:p.number(),totalPages:p.number(),offset:p.number(),limit:p.number(),congresses:p.array(Nn)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},Mm={method:"get",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Find international scientific congress by ID",request:{params:qr},responses:{200:{description:"International scientific congress details retrieved successfully",summary:"International Scientific Congress Retrieved",content:{"application/json":{schema:Nn}}},400:{description:"Invalid international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},Pm={method:"get",path:"/international-scientific-congress/edition/{edition}",tags:["International Scientific Congresses"],summary:"Find international scientific congresses by edition",request:{params:Fn},responses:{200:{description:"International scientific congresses retrieved successfully by edition",summary:"International Scientific Congresses Retrieved by Edition",content:{"application/json":{schema:p.array(Nn)}}},400:{description:"Invalid edition parameter provided",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},Tm={method:"put",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Update international scientific congress",security:[{bearerAuth:[]}],request:{params:qr,body:{content:{"application/json":{schema:Bn.omit({id:!0})}}}},responses:{200:{description:"International scientific congress updated successfully",summary:"International Scientific Congress Updated"},400:{description:"Invalid input data or international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},Am={method:"delete",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Delete international scientific congress",security:[{bearerAuth:[]}],request:{params:An},responses:{200:{description:"International scientific congress deleted successfully",summary:"International Scientific Congress Deleted"},400:{description:"Invalid international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},nS={method:"post",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congress Gallery"],summary:"Create a new gallery image for a congress",security:[{bearerAuth:[]}],request:{params:p.object({congressId:p.uuid()}),body:{content:{"multipart/form-data":{schema:rg}}}},responses:{201:{description:"Gallery image created successfully",summary:"Gallery Image Created"},400:{description:"Invalid input data, missing required fields, or invalid image format/size",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},sS={method:"get",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congress Gallery"],summary:"List all gallery images for a congress with pagination",request:{params:p.object({congressId:p.uuid()}),query:p.object({page:p.coerce.number().min(1).default(1),limit:p.coerce.number().min(1).default(tg),caption:p.string().optional()})},responses:{200:{description:"Gallery images retrieved successfully with pagination",summary:"Gallery Images Retrieved",content:{"application/json":{schema:p.object({page:p.number(),totalPages:p.number(),offset:p.number(),limit:p.number(),galleries:p.array(On)})}}},400:{description:"Invalid congress ID format or query parameters",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},aS={method:"get",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congress Gallery"],summary:"Find a gallery image by ID",request:{params:p.object({id:p.uuid()})},responses:{200:{description:"Gallery image retrieved successfully",summary:"Gallery Image Retrieved",content:{"application/json":{schema:On}}},400:{description:"Invalid gallery image ID format",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},mS={method:"put",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congress Gallery"],summary:"Update a gallery image with optional image upload",security:[{bearerAuth:[]}],request:{params:p.object({id:p.uuid()}),body:{content:{"multipart/form-data":{schema:og}}}},responses:{200:{description:"Gallery image updated successfully",summary:"Gallery Image Updated"},400:{description:"Invalid input data, gallery ID format, or invalid image format/size",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},cS={method:"delete",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congress Gallery"],summary:"Delete a gallery image",security:[{bearerAuth:[]}],request:{params:p.object({id:p.uuid()})},responses:{200:{description:"Gallery image deleted successfully",summary:"Gallery Image Deleted"},400:{description:"Invalid gallery ID format",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}};import{$Enums as cg}from"@prisma/client";import x from"zod";import{extendZodWithOpenApi as ng}from"@asteasolutions/zod-to-openapi";import ut from"zod";ng(ut);var kn=ut.object({role:ut.string().min(1),description:ut.string().optional(),userId:ut.uuid(),order:ut.number().optional()}),Nr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{role:t,description:i,userId:n,order:a}=kn.parse(e.body);return await this.legitimatorCommitteeMemberRepository.create({role:t,description:i,userId:n,order:a??0}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as sg}from"@asteasolutions/zod-to-openapi";import Ln from"zod";sg(Ln);var Gn=Ln.object({id:Ln.uuid()}),kr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t}=Gn.parse({id:e.params.id});if(!await this.legitimatorCommitteeMemberRepository.findById(t))throw new l("O membro do comit\xEA legitimador n\xE3o existe.");return await this.legitimatorCommitteeMemberRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ag}from"@asteasolutions/zod-to-openapi";import _n from"zod";ag(_n);var Gr=_n.object({id:_n.uuid()}),Lr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t}=Gr.parse({id:e.params.id}),i=await this.legitimatorCommitteeMemberRepository.findById(t);if(!i)throw new l("O membro do comit\xEA legitimador n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as mg}from"@asteasolutions/zod-to-openapi";import Ve from"zod";mg(Ve);var Hn=Ve.object({id:Ve.uuid(),role:Ve.string().min(1).optional(),description:Ve.string().optional(),userId:Ve.uuid().optional(),order:Ve.number().optional()}),_r=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t,role:i,description:n,userId:a,order:m}=Hn.parse({id:e.params.id,...e.body});if(!await this.legitimatorCommitteeMemberRepository.findById(t))throw new l("O membro do comit\xEA legitimador n\xE3o existe.");return await this.legitimatorCommitteeMemberRepository.update({id:t,role:i,description:n,userId:a,order:m}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var pg=x.object({id:x.uuid(),name:x.string(),emailAddress:x.string(),avatarUrl:x.string().nullable(),orcid:x.string().nullable(),phone:x.string().nullable(),lattesUrl:x.string().nullable(),role:x.enum(cg.UserRole)}),Dm=x.object({id:x.uuid(),role:x.string(),description:x.string().nullable(),order:x.number(),createdAt:x.date(),updatedAt:x.date(),userId:x.uuid(),user:pg}),Fm={method:"post",path:"/legitimator-committee-member",tags:["Legitimator Committee Members"],summary:"Create a new Legitimator Committee Member",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:kn}}}},responses:{201:{description:"Legitimator Committee Member created successfully",summary:"Legitimator Committee Member Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Um={method:"get",path:"/legitimator-committee-member",tags:["Legitimator Committee Members"],summary:"List all Legitimator Committee Members with filters",request:{query:x.object({role:x.string().optional(),orderBy:x.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of Legitimator Committee Members retrieved successfully",summary:"Legitimator Committee Members Retrieved",content:{"application/json":{schema:x.object({members:x.array(Dm)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},qm={method:"get",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Find Legitimator Committee Member by ID",request:{params:Gr},responses:{200:{description:"Legitimator Committee Member details retrieved successfully",summary:"Legitimator Committee Member Retrieved",content:{"application/json":{schema:Dm}}},400:{description:"Invalid Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Bm={method:"put",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Update Legitimator Committee Member",security:[{bearerAuth:[]}],request:{params:Gr,body:{content:{"application/json":{schema:Hn.omit({id:!0})}}}},responses:{200:{description:"Legitimator Committee Member updated successfully",summary:"Legitimator Committee Member Updated"},400:{description:"Invalid input data or Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:x.object({message:x.string()})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Om={method:"delete",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Delete Legitimator Committee Member",security:[{bearerAuth:[]}],request:{params:Gn},responses:{200:{description:"Legitimator Committee Member deleted successfully",summary:"Legitimator Committee Member Deleted"},400:{description:"Invalid Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:x.object({message:x.string()})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}};import{$Enums as yg}from"@prisma/client";import b from"zod";import{extendZodWithOpenApi as dg}from"@asteasolutions/zod-to-openapi";import Re from"zod";dg(Re);var zn=Re.object({name:Re.string().min(1),description:Re.string().optional(),members:Re.array(Re.object({userId:Re.uuid(),role:Re.string().min(1),order:Re.number().optional()}))}),Hr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{name:t,description:i,members:n}=zn.parse(e.body);if(await this.managementTeamRepository.findByName(t))throw new K("J\xE1 existe um time de gest\xE3o cadastrado com este nome.");return await this.managementTeamRepository.create({name:t,description:i,members:n.map(m=>({userId:m.userId,role:m.role,order:m.order??0}))}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as lg}from"@asteasolutions/zod-to-openapi";import Wn from"zod";lg(Wn);var Zn=Wn.object({id:Wn.uuid()}),zr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t}=Zn.parse({id:e.params.id});if(!await this.managementTeamRepository.findById(t))throw new l("O time de gest\xE3o n\xE3o existe.");return await this.managementTeamRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ug}from"@asteasolutions/zod-to-openapi";import Vn from"zod";ug(Vn);var Zr=Vn.object({id:Vn.uuid()}),Wr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t}=Zr.parse({id:e.params.id}),i=await this.managementTeamRepository.findById(t);if(!i)throw new l("O time de gest\xE3o n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as gg}from"@asteasolutions/zod-to-openapi";import ue from"zod";gg(ue);var Kn=ue.object({id:ue.uuid(),name:ue.string().min(1).optional(),description:ue.string().optional(),members:ue.array(ue.object({userId:ue.uuid(),role:ue.string().min(1),order:ue.number().optional()})).optional()}),Vr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t,name:i,description:n,members:a}=Kn.parse({id:e.params.id,...e.body}),m=await this.managementTeamRepository.findById(t);if(!m)throw new l("O time de gest\xE3o n\xE3o existe.");if(i&&i!==m.name){let c=await this.managementTeamRepository.findByName(i);if(c&&c.id!==t)throw new K("J\xE1 existe um time de gest\xE3o com este nome.")}return await this.managementTeamRepository.update({id:t,name:i,description:n,members:a?a.map(c=>({userId:c.userId,role:c.role,order:c.order??0})):void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var fg=b.object({id:b.uuid(),name:b.string(),emailAddress:b.string(),avatarUrl:b.string().nullable(),orcid:b.string().nullable(),phone:b.string().nullable(),lattesUrl:b.string().nullable(),role:b.enum(yg.UserRole)}),hg=b.object({id:b.uuid(),role:b.string(),description:b.string().nullable(),order:b.number(),teamId:b.uuid(),userId:b.uuid(),createdAt:b.date(),updatedAt:b.date(),user:fg}),Nm=b.object({id:b.uuid(),name:b.string(),description:b.string().nullable(),createdAt:b.date(),updatedAt:b.date(),members:b.array(hg)}),km={method:"post",path:"/management-team",tags:["Management Teams"],summary:"Create a new Management Team with multiple members",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:zn}}}},responses:{201:{description:"Management Team created successfully",summary:"Management Team Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},409:{description:"Management Team with this name already exists",summary:"Conflict",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},Lm={method:"get",path:"/management-team",tags:["Management Teams"],summary:"List all Management Teams with filters",request:{query:b.object({name:b.string().optional(),description:b.string().optional(),orderBy:b.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of Management Teams retrieved successfully",summary:"Management Teams Retrieved",content:{"application/json":{schema:b.object({teams:b.array(Nm)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},Gm={method:"get",path:"/management-team/{id}",tags:["Management Teams"],summary:"Find Management Team by ID",request:{params:Zr},responses:{200:{description:"Management Team details retrieved successfully",summary:"Management Team Retrieved",content:{"application/json":{schema:Nm}}},400:{description:"Invalid Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},_m={method:"put",path:"/management-team/{id}",tags:["Management Teams"],summary:"Update Management Team and manage member relationships",security:[{bearerAuth:[]}],request:{params:Zr,body:{content:{"application/json":{schema:Kn.omit({id:!0})}}}},responses:{200:{description:"Management Team updated successfully",summary:"Management Team Updated"},400:{description:"Invalid input data or Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},409:{description:"Management Team with this name already exists",summary:"Conflict",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},Hm={method:"delete",path:"/management-team/{id}",tags:["Management Teams"],summary:"Delete Management Team",security:[{bearerAuth:[]}],request:{params:Zn},responses:{200:{description:"Management Team deleted successfully",summary:"Management Team Deleted"},400:{description:"Invalid Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}};import{MeetingFormat as jg,MeetingStatus as Eg}from"@prisma/client";import P from"zod";import{extendZodWithOpenApi as Rg}from"@asteasolutions/zod-to-openapi";import gt from"zod";var Wm=10,zm=1024,Ig=zm*zm,Cg=Wm*Ig;Rg(gt);var Yn=gt.object({title:gt.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),publishedAt:gt.coerce.date(),meetingId:gt.uuid(),document:gt.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=Cg,`O documento deve ter no m\xE1ximo ${Wm}MB.`)}),Kr=class{constructor(e,r,t){this.meetingMinuteRepository=e;this.meetingRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{title:t,publishedAt:i,meetingId:n,document:a}=Yn.parse({...e.body,...e.params,document:e.file});if(!await this.meetingRepository.findById(n))throw new l("A reuni\xE3o n\xE3o existe.");if(await this.meetingMinuteRepository.findByMeetingId(n))throw new s("Esta reuni\xE3o j\xE1 possui uma ata.");let g=await this.meetingMinuteRepository.create({title:t,publishedAt:i,meetingId:n,documentUrl:""}),T=await this.firebaseStorageService.uploadFile({file:a,id:g.id,folder:D.MEETING_MINUTE});return await this.meetingMinuteRepository.update({id:g.id,documentUrl:T}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as bg}from"@asteasolutions/zod-to-openapi";import Xn from"zod";bg(Xn);var qt=Xn.object({meetingId:Xn.uuid()}),Yr=class{constructor(e){this.meetingMinuteRepository=e}async handle(e,r){try{let{meetingId:t}=qt.parse({meetingId:e.params.meetingId}),i=await this.meetingMinuteRepository.findByMeetingId(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as wg}from"@asteasolutions/zod-to-openapi";import yt from"zod";var Vm=10,Zm=1024,Sg=Zm*Zm,vg=Vm*Sg;wg(yt);var $n=yt.object({meetingId:yt.uuid(),title:yt.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),publishedAt:yt.coerce.date().optional(),document:yt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=vg,`O documento deve ter no m\xE1ximo ${Vm}MB.`).optional()}),Xr=class{constructor(e,r){this.meetingMinuteRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{meetingId:t,title:i,publishedAt:n,document:a}=$n.parse({meetingId:e.params.meetingId,...e.body,document:e.file}),m=await this.meetingMinuteRepository.findByMeetingId(t);if(!m)throw new l("A ata n\xE3o existe para esta reuni\xE3o.");let c=m.documentUrl;return a&&(m.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:m.documentUrl}),c=await this.firebaseStorageService.uploadFile({file:a,id:m.id,folder:D.MEETING_MINUTE})),await this.meetingMinuteRepository.update({id:m.id,title:i,publishedAt:n,documentUrl:c??void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var xg=P.object({id:P.uuid(),title:P.string(),scheduledAt:P.date(),format:P.enum(jg),agenda:P.string(),meetingLink:P.string().nullable(),location:P.string().nullable(),status:P.enum(Eg),createdAt:P.date(),updatedAt:P.date()}),Mg=P.object({id:P.uuid(),title:P.string(),publishedAt:P.date(),documentUrl:P.string(),meetingId:P.uuid(),meeting:xg,createdAt:P.date(),updatedAt:P.date()}),Km={method:"post",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Create a new meeting minute with document upload",security:[{bearerAuth:[]}],request:{params:P.object({meetingId:P.uuid()}),body:{content:{"multipart/form-data":{schema:Yn.omit({meetingId:!0})}}}},responses:{201:{description:"Meeting minute created successfully",summary:"Meeting Minute Created"},400:{description:"Invalid input data, missing required fields, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:P.object({errors:P.record(P.string(),P.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:P.object({message:P.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:P.object({message:P.string()})}}},409:{description:"Meeting already has a minute",summary:"Conflict",content:{"application/json":{schema:P.object({message:P.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:P.object({message:P.string()})}}}}},Ym={method:"get",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Find meeting minute by meeting ID",request:{params:qt},responses:{200:{description:"Meeting minute retrieved successfully by meeting ID",summary:"Meeting Minute Retrieved by Meeting ID",content:{"application/json":{schema:Mg.nullable()}}},400:{description:"Invalid meeting ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:P.object({errors:P.record(P.string(),P.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:P.object({message:P.string()})}}}}},Xm={method:"put",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Update meeting minute with optional document upload",security:[{bearerAuth:[]}],request:{params:qt,body:{content:{"multipart/form-data":{schema:$n.omit({meetingId:!0})}}}},responses:{200:{description:"Meeting minute updated successfully",summary:"Meeting Minute Updated"},400:{description:"Invalid input data, meeting minute ID format, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:P.object({errors:P.record(P.string(),P.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:P.object({message:P.string()})}}},404:{description:"Meeting minute not found with the provided ID",summary:"Meeting Minute Not Found",content:{"application/json":{schema:P.object({message:P.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:P.object({message:P.string()})}}}}},$m={method:"delete",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Delete meeting minute",security:[{bearerAuth:[]}],request:{params:qt},responses:{200:{description:"Meeting minute deleted successfully",summary:"Meeting Minute Deleted"},400:{description:"Invalid meeting minute ID format",summary:"Validation Error",content:{"application/json":{schema:P.object({errors:P.record(P.string(),P.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:P.object({message:P.string()})}}},404:{description:"Meeting minute not found with the provided ID",summary:"Meeting Minute Not Found",content:{"application/json":{schema:P.object({message:P.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:P.object({message:P.string()})}}}}};import{MeetingFormat as _g,MeetingStatus as Hg}from"@prisma/client";import I from"zod";import{extendZodWithOpenApi as Pg}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as $r,MeetingStatus as Jn}from"@prisma/client";import ge from"zod";Pg(ge);var Qn=ge.object({title:ge.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),scheduledAt:ge.coerce.date(),format:ge.enum($r).default($r.ONLINE),agenda:ge.string().min(1,"Pauta \xE9 obrigat\xF3ria"),meetingLink:ge.string().url("Link da reuni\xE3o deve ser uma URL v\xE1lida").optional().or(ge.literal("")),location:ge.string().optional(),status:ge.enum(Jn).default(Jn.PENDING)}).refine(o=>o.format===$r.ONLINE?!!o.meetingLink:o.format===$r.IN_PERSON?!!o.location:!0,{message:"Reuni\xF5es online devem ter link e reuni\xF5es presenciais devem ter localiza\xE7\xE3o",path:["format"]}),Jr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{title:t,scheduledAt:i,format:n,agenda:a,meetingLink:m,location:c,status:g}=Qn.parse(e.body);return await this.meetingRepository.create({title:t,scheduledAt:i,format:n,agenda:a,meetingLink:m||void 0,location:c||void 0,status:g??Jn.PENDING}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Tg}from"@asteasolutions/zod-to-openapi";import es from"zod";Tg(es);var ts=es.object({id:es.uuid()}),Qr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t}=ts.parse({id:e.params.id});if(!await this.meetingRepository.findById(t))throw new l("A reuni\xE3o n\xE3o existe.");return await this.meetingRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ag}from"@asteasolutions/zod-to-openapi";import rs from"zod";Ag(rs);var to=rs.object({id:rs.uuid()}),eo=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t}=to.parse({id:e.params.id}),i=await this.meetingRepository.findById(t);if(!i)throw new l("A reuni\xE3o n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Dg}from"@asteasolutions/zod-to-openapi";import{MeetingStatus as Fg}from"@prisma/client";import os from"zod";Dg(os);var is=os.object({status:os.enum(Fg)}),ro=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{status:t}=is.parse({status:e.params.status}),i=await this.meetingRepository.findByStatus(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ug}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as qg,MeetingStatus as Bg}from"@prisma/client";import De from"zod";var Og=1,Ng=10;Ug(De);var ns=De.object({page:De.coerce.number().min(1).default(Og),limit:De.coerce.number().min(1).default(Ng),title:De.string().optional(),format:De.enum(qg).optional(),status:De.enum(Bg).optional(),orderBy:De.enum(["asc","desc"]).optional()}),oo=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=ns.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.meetingRepository.find({pagination:{offset:a,limit:i},filter:n}),this.meetingRepository.count({filter:n})]),g=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:g,offset:a,limit:i,meetings:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as kg}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as Lg,MeetingStatus as Gg}from"@prisma/client";import ce from"zod";kg(ce);var ss=ce.object({id:ce.uuid(),title:ce.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),scheduledAt:ce.coerce.date().optional(),format:ce.enum(Lg).optional(),agenda:ce.string().min(1,"Pauta \xE9 obrigat\xF3ria").optional(),meetingLink:ce.string().url("Link da reuni\xE3o deve ser uma URL v\xE1lida").optional().or(ce.literal("")),location:ce.string().optional(),status:ce.enum(Gg).optional()}),io=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t,title:i,scheduledAt:n,format:a,agenda:m,meetingLink:c,location:g,status:T}=ss.parse({id:e.params.id,...e.body});if(!await this.meetingRepository.findById(t))throw new l("A reuni\xE3o n\xE3o existe.");return await this.meetingRepository.update({id:t,title:i,scheduledAt:n,format:a,agenda:m,meetingLink:c||void 0,location:g||void 0,status:T}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var zg=I.object({id:I.uuid(),title:I.string(),publishedAt:I.date(),documentUrl:I.string(),meetingId:I.uuid(),createdAt:I.date(),updatedAt:I.date()}),as=I.object({id:I.uuid(),title:I.string(),scheduledAt:I.date(),format:I.enum(_g),agenda:I.string(),meetingLink:I.string().nullable(),location:I.string().nullable(),status:I.enum(Hg),minutes:zg.nullable(),createdAt:I.date(),updatedAt:I.date()}),Jm={method:"post",path:"/meeting",tags:["Meetings"],summary:"Create a new meeting",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Qn}}}},responses:{201:{description:"Meeting created successfully",summary:"Meeting Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},Qm={method:"get",path:"/meeting",tags:["Meetings"],summary:"List all meetings with pagination and filters",request:{query:ns},responses:{200:{description:"List of meetings retrieved successfully with pagination",summary:"Meetings Retrieved",content:{"application/json":{schema:I.object({page:I.number(),totalPages:I.number(),offset:I.number(),limit:I.number(),meetings:I.array(as)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},ec={method:"get",path:"/meeting/{id}",tags:["Meetings"],summary:"Find meeting by ID",request:{params:to},responses:{200:{description:"Meeting details retrieved successfully",summary:"Meeting Retrieved",content:{"application/json":{schema:as}}},400:{description:"Invalid meeting ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},tc={method:"get",path:"/meeting/status/{status}",tags:["Meetings"],summary:"Find meetings by status",request:{params:is},responses:{200:{description:"Meetings retrieved successfully by status",summary:"Meetings Retrieved by Status",content:{"application/json":{schema:I.array(as)}}},400:{description:"Invalid status parameter provided",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},rc={method:"put",path:"/meeting/{id}",tags:["Meetings"],summary:"Update meeting",security:[{bearerAuth:[]}],request:{params:to,body:{content:{"application/json":{schema:ss.omit({id:!0})}}}},responses:{200:{description:"Meeting updated successfully",summary:"Meeting Updated"},400:{description:"Invalid input data or meeting ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:I.object({message:I.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},oc={method:"delete",path:"/meeting/{id}",tags:["Meetings"],summary:"Delete meeting",security:[{bearerAuth:[]}],request:{params:ts},responses:{200:{description:"Meeting deleted successfully",summary:"Meeting Deleted"},400:{description:"Invalid meeting ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:I.object({message:I.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}};import S from"zod";import{extendZodWithOpenApi as Wg}from"@asteasolutions/zod-to-openapi";import Bt from"zod";var Zg=5,ic=1024,Vg=ic*ic,Kg=Zg*Vg;Wg(Bt);var ms=Bt.object({title:Bt.string().min(1),content:Bt.string().min(1),image:Bt.any().refine(o=>!o||typeof o=="object"&&typeof o.mimetype=="string"&&o.mimetype.startsWith("image/")&&typeof o.size=="number"&&o.size<=Kg,{message:"A imagem deve ser uma imagem v\xE1lida de no m\xE1ximo 5MB."})}),no=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{title:t,content:i,image:n}=ms.parse({...e.body,image:e.file}),a=e.user.id,m=await this.firebaseStorageService.uploadFile({file:n,folder:D.NEWS,id:a});await this.newsRepository.create({title:t,content:i,authorId:a,imageUrl:m}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Yg}from"@asteasolutions/zod-to-openapi";import Fe from"zod";var Xg=1,$g=7;Yg(Fe);var ao=Fe.object({page:Fe.coerce.number().min(1).default(Xg),limit:Fe.coerce.number().min(1).default($g),authorId:Fe.string(),title:Fe.string().optional(),content:Fe.string().optional(),orderBy:Fe.enum(["asc","desc"]).default("desc")}),so=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,authorId:n,...a}=ao.parse(e.query),m=i*t-i,[c,g]=await Promise.all([this.newsRepository.findByAuthorId({authorId:n,pagination:{offset:m,limit:i},filter:a}),this.newsRepository.count({filter:{authorId:n,...a}})]),T=Math.max(Math.ceil(g/i),1);r.status(200).json({page:t,totalPages:T,offset:m,limit:i,news:c})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Jg}from"@asteasolutions/zod-to-openapi";import cs from"zod";Jg(cs);var ps=cs.object({id:cs.string()}),mo=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{id:t}=ps.parse(e.params),i=await this.newsRepository.findById(t);if(!i)throw new l("Not\xEDcia n\xE3o encontrada.");r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Qg}from"@asteasolutions/zod-to-openapi";import Ue from"zod";var ey=1,ty=9;Qg(Ue);var ds=Ue.object({page:Ue.coerce.number().min(1).default(ey),limit:Ue.coerce.number().min(1).default(ty),title:Ue.string().optional(),content:Ue.string().optional(),authorId:Ue.string().optional(),orderBy:Ue.enum(["asc","desc"]).default("desc")}),co=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=ds.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.newsRepository.find({pagination:{offset:a,limit:i},filter:n}),this.newsRepository.count({filter:n})]),g=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:g,offset:a,limit:i,news:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var nc={method:"post",path:"/news",tags:["News"],summary:"Create news",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:ms}}}},responses:{201:{description:"News article created successfully",summary:"News Created",content:{"application/json":{schema:S.object({message:S.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},sc={method:"get",path:"/news",tags:["News"],summary:"List news",request:{query:ds},responses:{200:{description:"Paginated list of news articles retrieved successfully",summary:"News Retrieved",content:{"application/json":{schema:S.object({page:S.number(),totalPages:S.number(),offset:S.number(),limit:S.number(),news:S.array(S.object({title:S.string(),content:S.string(),id:S.string(),createdAt:S.date(),updatedAt:S.date(),imageUrl:S.string().nullable()}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},ac={method:"get",path:"/news/{id}",tags:["News"],summary:"Find news by ID",request:{params:ps},responses:{200:{description:"News article details retrieved successfully",summary:"News Retrieved",content:{"application/json":{schema:S.object({page:S.number(),totalPages:S.number(),offset:S.number(),limit:S.number(),news:S.object({title:S.string(),content:S.string(),id:S.string(),createdAt:S.date(),updatedAt:S.date(),imageUrl:S.string().nullable()})})}}},400:{description:"Invalid news ID format",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},404:{description:"News article not found with the provided ID",summary:"News Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},mc={method:"get",path:"/news/author/{author_id}",tags:["News"],summary:"List news by author",request:{params:ao.pick({authorId:!0}).transform(()=>({author_id:""})),query:ao.omit({authorId:!0})},responses:{200:{description:"Paginated list of news articles by author retrieved successfully",summary:"Author News Retrieved",content:{"application/json":{schema:S.object({page:S.number(),totalPages:S.number(),offset:S.number(),limit:S.number(),news:S.array(S.object({title:S.string(),content:S.string(),id:S.string(),createdAt:S.date(),updatedAt:S.date(),imageUrl:S.string().nullable()}))})}}},400:{description:"Invalid author ID or query parameters",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},404:{description:"Author not found with the provided ID",summary:"Author Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}};import j from"zod";import{extendZodWithOpenApi as ry}from"@asteasolutions/zod-to-openapi";import ye from"zod";var pc=2,cc=1024,oy=cc*cc,iy=pc*oy;ry(ye);var ls=ye.object({name:ye.string().min(1,"Nome \xE9 obrigat\xF3rio"),logo:ye.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=iy,`A imagem deve ter no m\xE1ximo ${pc}MB.`),websiteUrl:ye.url("URL do site deve ser v\xE1lida").optional(),description:ye.string().optional(),category:ye.string().optional(),since:ye.coerce.date(),isActive:ye.preprocess(o=>o==="true",ye.boolean().optional())}),po=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{name:t,logo:i,websiteUrl:n,description:a,category:m,since:c,isActive:g}=ls.parse({...e.body,logo:e.file}),T=await this.partnerRepository.create({name:t,websiteUrl:n,description:a,category:m,since:c,isActive:g}),k=await this.firebaseStorageService.uploadFile({file:i,id:T.id,folder:D.PARTNER});return await this.partnerRepository.update({id:T.id,logoUrl:k}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ny}from"@asteasolutions/zod-to-openapi";import us from"zod";ny(us);var gs=us.object({id:us.uuid()}),lo=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=gs.parse({id:e.params.id}),i=await this.partnerRepository.findById(t);if(!i)throw new l("O parceiro n\xE3o existe.");return i.logoUrl&&this.firebaseStorageService.deleteFile({fileUrl:i.logoUrl}),await this.partnerRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as sy}from"@asteasolutions/zod-to-openapi";import ys from"zod";sy(ys);var go=ys.object({id:ys.uuid()}),uo=class{constructor(e){this.partnerRepository=e}async handle(e,r){try{let{id:t}=go.parse({id:e.params.id}),i=await this.partnerRepository.findById(t);if(!i)throw new l("O parceiro n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ay}from"@asteasolutions/zod-to-openapi";import Ie from"zod";var my=1,cy=9;ay(Ie);var fs=Ie.object({page:Ie.coerce.number().min(1).default(my),limit:Ie.coerce.number().min(1).default(cy),name:Ie.string().optional(),description:Ie.string().optional(),category:Ie.string().optional(),isActive:Ie.coerce.boolean().optional(),orderBy:Ie.enum(["asc","desc"]).optional()}),yo=class{constructor(e){this.partnerRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=fs.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.partnerRepository.find({pagination:{offset:a,limit:i},filter:n}),this.partnerRepository.count({filter:n})]),g=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:g,offset:a,limit:i,partners:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as py}from"@asteasolutions/zod-to-openapi";import pe from"zod";var lc=2,dc=1024,dy=dc*dc,ly=lc*dy;py(pe);var hs=pe.object({id:pe.uuid(),name:pe.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),logo:pe.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=ly,`A imagem deve ter no m\xE1ximo ${lc}MB.`).optional(),websiteUrl:pe.url("URL do site deve ser v\xE1lida").optional(),description:pe.string().optional(),category:pe.string().optional(),since:pe.coerce.date().optional(),isActive:pe.preprocess(o=>o==="true",pe.boolean().optional())}),fo=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,logo:n,websiteUrl:a,description:m,category:c,since:g,isActive:T}=hs.parse({id:e.params.id,...e.body,logo:e.file}),k=await this.partnerRepository.findById(t);if(!k)throw new l("O parceiro n\xE3o existe.");let z=k.logoUrl;if(n&&(z=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:"images/partners"})),!z)throw new s("Logo URL \xE9 obrigat\xF3rio");return await this.partnerRepository.update({id:t,name:i,logoUrl:z,websiteUrl:a,description:m,category:c,since:g,isActive:T}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var uc=j.object({id:j.uuid(),name:j.string(),logoUrl:j.string(),description:j.string().nullable(),category:j.string().nullable(),since:j.date(),isActive:j.boolean(),createdAt:j.date(),updatedAt:j.date()}),gc={method:"post",path:"/partner",tags:["Partners"],summary:"Create a new partner with logo upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:ls}}}},responses:{201:{description:"Partner created successfully",summary:"Partner Created"},400:{description:"Invalid input data, missing required fields, or invalid logo format/size",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},409:{description:"Partner with this name already exists",summary:"Conflict",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},yc={method:"get",path:"/partner",tags:["Partners"],summary:"List all partners with pagination and filters",request:{query:fs},responses:{200:{description:"List of partners retrieved successfully with pagination",summary:"Partners Retrieved",content:{"application/json":{schema:j.object({page:j.number(),totalPages:j.number(),offset:j.number(),limit:j.number(),partners:j.array(uc)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},fc={method:"get",path:"/partner/{id}",tags:["Partners"],summary:"Find partner by ID",request:{params:go},responses:{200:{description:"Partner details retrieved successfully",summary:"Partner Retrieved",content:{"application/json":{schema:uc}}},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},hc={method:"put",path:"/partner/{id}",tags:["Partners"],summary:"Update partner with optional logo upload",security:[{bearerAuth:[]}],request:{params:go,body:{content:{"multipart/form-data":{schema:hs.omit({id:!0})}}}},responses:{200:{description:"Partner updated successfully",summary:"Partner Updated"},400:{description:"Invalid input data, partner ID format, or invalid logo format/size",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},409:{description:"Partner with this name already exists",summary:"Conflict",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},Rc={method:"delete",path:"/partner/{id}",tags:["Partners"],summary:"Delete partner",security:[{bearerAuth:[]}],request:{params:gs},responses:{200:{description:"Partner deleted successfully",summary:"Partner Deleted"},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}};import{$Enums as Ic}from"@prisma/client";import E from"zod";import{extendZodWithOpenApi as uy}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as gy}from"@prisma/client";import qe from"zod";uy(qe);var Ro=qe.object({userId:qe.uuid(),title:qe.string().min(1),description:qe.string().optional(),status:qe.enum(gy).default("PENDING"),dueDate:qe.coerce.date().optional(),document:qe.any().refine(o=>o&&typeof o=="object"&&o.size>0,"Arquivo do documento \xE9 obrigat\xF3rio")}),ho=class{constructor(e,r,t){this.userRepository=e;this.pendencyRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{userId:t,title:i,description:n,status:a,dueDate:m,document:c}=Ro.parse({...e.body,userId:e.params.user_id,document:e.file});if(!await this.userRepository.findById(t))throw new Q("O usu\xE1rio n\xE3o existe.");let T=await this.firebaseStorageService.uploadFile({file:c,id:t,folder:D.PENDENCY});return await this.pendencyRepository.create({userId:t,title:i,description:n,status:a,dueDate:m,documentUrl:T}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as yy}from"@asteasolutions/zod-to-openapi";import Rs from"zod";yy(Rs);var Is=Rs.object({id:Rs.uuid()}),Io=class{constructor(e,r){this.pendencyRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=Is.parse({id:e.params.pendency_id}),i=await this.pendencyRepository.findById(t);if(!i)throw new l("A pend\xEAncia n\xE3o existe.");return await Promise.all([this.pendencyRepository.deleteById(i.id),this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl})]),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as fy}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as hy}from"@prisma/client";import Ce from"zod";var Ry=1,Iy=6;fy(Ce);var Cs=Ce.object({page:Ce.coerce.number().min(1).default(Ry),limit:Ce.coerce.number().min(1).default(Iy),title:Ce.string().optional(),description:Ce.string().optional(),status:Ce.enum(hy).default("PENDING"),userId:Ce.uuid().optional(),orderBy:Ce.enum(["asc","desc"]).default("desc")}),Co=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{description:t,limit:i,orderBy:n,page:a,title:m,status:c,userId:g}=Cs.parse(e.query),T=a*i-i,[k,z]=await Promise.all([this.pendencyRepository.find({pagination:{offset:T,limit:i},filter:{title:m,description:t,status:c,orderBy:n,userId:g}}),this.pendencyRepository.count({filter:{title:m,description:t,status:c,userId:g}})]),J=Math.max(Math.ceil(z/i),1);return r.status(200).json({page:a,totalPages:J,offset:T,limit:i,pendencies:k})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Cy}from"@asteasolutions/zod-to-openapi";import bs from"zod";Cy(bs);var ws=bs.object({pendencyId:bs.uuid()}),bo=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{pendencyId:t}=ws.parse({pendencyId:e.params.pendency_id}),i=await this.pendencyRepository.findById(t);if(!i)throw new l("Pend\xEAncia n\xE3o encontrada.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as by}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as wy}from"@prisma/client";import Be from"zod";by(Be);var So=Be.object({id:Be.uuid(),title:Be.string().min(1),description:Be.string().optional(),status:Be.enum(wy),dueDate:Be.coerce.date().optional(),document:Be.any().refine(o=>o==null||typeof o=="object"&&typeof o.size=="number"&&(o.size===0||o.size>0),"Arquivo do documento \xE9 inv\xE1lido").optional()}),wo=class{constructor(e,r){this.pendencyRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{document:t,id:i,...n}=So.parse({...e.body,id:e.params.pendency_id,document:e.file}),a=await this.pendencyRepository.findById(i);if(!a)throw new Q("A pend\xEAncia n\xE3o existe");let m=a.documentUrl;return t&&t.size>0&&(m=await this.firebaseStorageService.updateFile({file:t,id:a.userId,folder:D.PENDENCY,fileUrl:a.documentUrl})),await this.pendencyRepository.update({...n,id:i,documentUrl:m}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Cc={method:"post",path:"/pendency/{user_id}",tags:["Pendencies"],summary:"Create pendency for user",security:[{bearerAuth:[]}],request:{params:Ro.pick({userId:!0}).transform(()=>({user_id:""})),body:{content:{"multipart/form-data":{schema:Ro.omit({userId:!0})}}}},responses:{201:{description:"Pendency created successfully for the user",summary:"Pendency Created",content:{"application/json":{schema:E.object({})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},bc={method:"get",path:"/pendency",tags:["Pendencies"],summary:"List pendencies",security:[{bearerAuth:[]}],request:{query:Cs},responses:{200:{description:"Paginated list of pendencies retrieved successfully",summary:"Pendencies Retrieved",content:{"application/json":{schema:E.object({page:E.number(),totalPages:E.number(),offset:E.number(),limit:E.number(),pendencies:E.array(E.object({id:E.string(),title:E.string(),description:E.string().nullable(),status:E.enum(Ic.PendencyStatus),dueDate:E.date().nullable(),documentUrl:E.string(),userId:E.string(),createdAt:E.date(),updatedAt:E.date()}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},wc={method:"get",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Find pendency by ID",security:[{bearerAuth:[]}],request:{params:ws},responses:{200:{description:"Pendency details retrieved successfully",summary:"Pendency Retrieved",content:{"application/json":{schema:E.object({id:E.string(),title:E.string(),description:E.string().nullable(),status:E.enum(Ic.PendencyStatus),dueDate:E.date().nullable(),documentUrl:E.string(),userId:E.string(),createdAt:E.date(),updatedAt:E.date()}).nullable()}}},400:{description:"Invalid pendency ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},404:{description:"Pendency not found with the provided ID",summary:"Pendency Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},Sc={method:"put",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Update pendency",security:[{bearerAuth:[]}],request:{params:So.pick({id:!0}).transform(()=>({pendency_id:""})),body:{content:{"multipart/form-data":{schema:So.omit({id:!0})}}}},responses:{204:{description:"Pendency updated successfully",summary:"Pendency Updated"},400:{description:"Invalid input data or pendency does not exist",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},vc={method:"delete",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Delete pendency",security:[{bearerAuth:[]}],request:{params:Is},responses:{204:{description:"Pendency deleted successfully",summary:"Pendency Deleted"},400:{description:"Invalid pendency ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},404:{description:"Pendency not found with the provided ID",summary:"Pendency Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}};import{RegimentStatus as Ny}from"@prisma/client";import v from"zod";import{extendZodWithOpenApi as Sy}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as Ec}from"@prisma/client";import Ke from"zod";var xc=10,jc=1024,vy=jc*jc,jy=xc*vy;Sy(Ke);var Ss=Ke.object({title:Ke.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),version:Ke.string().min(1,"Vers\xE3o \xE9 obrigat\xF3ria"),publishedAt:Ke.coerce.date(),document:Ke.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=jy,`O documento deve ter no m\xE1ximo ${xc}MB.`),status:Ke.enum(Ec).optional()}),vo=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{title:t,version:i,publishedAt:n,document:a,status:m}=Ss.parse({...e.body,document:e.file}),c=await this.regimentRepository.create({title:t,version:i,publishedAt:n,documentUrl:"",status:m??Ec.IN_FORCE}),g=await this.firebaseStorageService.uploadFile({file:a,id:c.id,folder:D.REGIMENT});return await this.regimentRepository.update({id:c.id,documentUrl:g}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ey}from"@asteasolutions/zod-to-openapi";import vs from"zod";Ey(vs);var js=vs.object({id:vs.uuid()}),jo=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=js.parse({id:e.params.id}),i=await this.regimentRepository.findById(t);if(!i)throw new l("O regimento n\xE3o existe.");return i.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl}),await this.regimentRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as xy}from"@asteasolutions/zod-to-openapi";import Es from"zod";xy(Es);var xo=Es.object({id:Es.uuid()}),Eo=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{id:t}=xo.parse({id:e.params.id}),i=await this.regimentRepository.findById(t);if(!i)throw new l("O regimento n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as My}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as Py}from"@prisma/client";import xs from"zod";My(xs);var Ms=xs.object({status:xs.enum(Py)}),Mo=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{status:t}=Ms.parse({status:e.params.status}),i=await this.regimentRepository.findByStatus(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ty}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as Ay}from"@prisma/client";import Ye from"zod";var Dy=1,Fy=10;Ty(Ye);var Ps=Ye.object({page:Ye.coerce.number().min(1).default(Dy),limit:Ye.coerce.number().min(1).default(Fy),title:Ye.string().optional(),status:Ye.enum(Ay).optional(),orderBy:Ye.enum(["asc","desc"]).optional()}),Po=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Ps.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.regimentRepository.find({pagination:{offset:a,limit:i},filter:n}),this.regimentRepository.count({filter:n})]),g=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:g,offset:a,limit:i,regiments:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Uy}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as qy}from"@prisma/client";import Oe from"zod";var Pc=10,Mc=1024,By=Mc*Mc,Oy=Pc*By;Uy(Oe);var Ts=Oe.object({id:Oe.uuid(),title:Oe.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),version:Oe.string().min(1,"Vers\xE3o \xE9 obrigat\xF3ria").optional(),publishedAt:Oe.coerce.date().optional(),document:Oe.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Oy,`O documento deve ter no m\xE1ximo ${Pc}MB.`).optional(),status:Oe.enum(qy).optional()}),To=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,title:i,version:n,publishedAt:a,document:m,status:c}=Ts.parse({id:e.params.id,...e.body,document:e.file}),g=await this.regimentRepository.findById(t);if(!g)throw new l("O regimento n\xE3o existe.");let T=g.documentUrl;return m&&(g.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:g.documentUrl}),T=await this.firebaseStorageService.uploadFile({file:m,id:t,folder:D.REGIMENT})),await this.regimentRepository.update({id:t,title:i,version:n,publishedAt:a,documentUrl:T??void 0,status:c}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var As=v.object({id:v.uuid(),title:v.string(),version:v.string(),publishedAt:v.date(),documentUrl:v.string(),status:v.enum(Ny),createdAt:v.date(),updatedAt:v.date()}),Tc={method:"post",path:"/regiment",tags:["Regiments"],summary:"Create a new regiment with document upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:Ss}}}},responses:{201:{description:"Regiment created successfully",summary:"Regiment Created"},400:{description:"Invalid input data, missing required fields, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},Ac={method:"get",path:"/regiment",tags:["Regiments"],summary:"List all regiments with pagination and filters",request:{query:Ps},responses:{200:{description:"List of regiments retrieved successfully with pagination",summary:"Regiments Retrieved",content:{"application/json":{schema:v.object({page:v.number(),totalPages:v.number(),offset:v.number(),limit:v.number(),regiments:v.array(As)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},Dc={method:"get",path:"/regiment/{id}",tags:["Regiments"],summary:"Find regiment by ID",request:{params:xo},responses:{200:{description:"Regiment details retrieved successfully",summary:"Regiment Retrieved",content:{"application/json":{schema:As}}},400:{description:"Invalid regiment ID format",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},Fc={method:"get",path:"/regiment/status/{status}",tags:["Regiments"],summary:"Find regiments by status",request:{params:Ms},responses:{200:{description:"Regiments retrieved successfully by status",summary:"Regiments Retrieved by Status",content:{"application/json":{schema:v.array(As)}}},400:{description:"Invalid status parameter provided",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},Uc={method:"put",path:"/regiment/{id}",tags:["Regiments"],summary:"Update regiment with optional document upload",security:[{bearerAuth:[]}],request:{params:xo,body:{content:{"multipart/form-data":{schema:Ts.omit({id:!0})}}}},responses:{200:{description:"Regiment updated successfully",summary:"Regiment Updated"},400:{description:"Invalid input data, regiment ID format, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},qc={method:"delete",path:"/regiment/{id}",tags:["Regiments"],summary:"Delete regiment",security:[{bearerAuth:[]}],request:{params:js},responses:{200:{description:"Regiment deleted successfully",summary:"Regiment Deleted"},400:{description:"Invalid regiment ID format",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}};import q from"zod";import{extendZodWithOpenApi as ky}from"@asteasolutions/zod-to-openapi";import Ot from"zod";var Oc=5,Bc=1024,Ly=Bc*Bc,Gy=Oc*Ly;ky(Ot);var Ds=Ot.object({caption:Ot.string().optional(),image:Ot.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=Gy,`A imagem deve ter no m\xE1ximo ${Oc}MB.`),congressId:Ot.uuid()}),Ao=class{constructor(e,r,t){this.regionalCongressGalleryRepository=e;this.regionalCongressRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{caption:t,image:i,congressId:n}=Ds.parse({...e.body,...e.params,image:e.file});if(!await this.regionalCongressRepository.findById(n))throw new l("O congresso n\xE3o existe.");let m=await this.regionalCongressGalleryRepository.create({caption:t,congressId:n,imageUrl:""}),c=await this.firebaseStorageService.uploadFile({file:i,id:m.id,folder:D.GALLERY});return await this.regionalCongressGalleryRepository.update({id:m.id,imageUrl:c}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as _y}from"@asteasolutions/zod-to-openapi";import Fs from"zod";_y(Fs);var Fo=Fs.object({id:Fs.uuid("ID inv\xE1lido")}),Do=class{constructor(e){this.regionalCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=Fo.parse(e.params);if(!await this.regionalCongressGalleryRepository.findById(t))throw new l("Item de galeria n\xE3o encontrado");return await this.regionalCongressGalleryRepository.deleteById(t),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Hy}from"@asteasolutions/zod-to-openapi";import ft from"zod";Hy(ft);var Us=ft.object({congressId:ft.uuid("ID do congresso inv\xE1lido"),page:ft.coerce.number().int().positive().default(1),limit:ft.coerce.number().int().positive().default(10),caption:ft.string().optional()}),Uo=class{constructor(e){this.regionalCongressGalleryRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Us.parse({...e.params,...e.query}),a=(t-1)*i,m=await this.regionalCongressGalleryRepository.findByCongressId({pagination:{offset:a,limit:i},filter:n});if(!m)throw new l("Itens de galeria n\xE3o encontrados");let c=await this.regionalCongressGalleryRepository.count({filter:n});return r.status(200).json({data:m,pagination:{page:t,limit:i,total:c,totalPages:Math.ceil(c/i)}})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as zy}from"@asteasolutions/zod-to-openapi";import Nt from"zod";var kc=5,Nc=1024,Wy=Nc*Nc,Zy=kc*Wy;zy(Nt);var qs=Nt.object({id:Nt.string().uuid("ID inv\xE1lido"),caption:Nt.string().optional(),image:Nt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Zy,`A imagem deve ter no m\xE1ximo ${kc}MB.`).optional()}),qo=class{constructor(e,r){this.regionalCongressGalleryRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,caption:i,image:n}=qs.parse({...e.params,...e.body,image:e.file});if(!await this.regionalCongressGalleryRepository.findById(t))throw new l("Item de galeria n\xE3o encontrado");let m;return n&&(m=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:D.GALLERY})),await this.regionalCongressGalleryRepository.update({id:t,caption:i,...m&&{imageUrl:m}}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Vy=q.object({id:q.uuid(),imageUrl:q.string(),caption:q.string().nullable(),congressId:q.uuid()}),Lc={method:"post",path:"/regional-congress/{congressId}/gallery",tags:["Regional Congresses"],summary:"Create a new congress gallery image",security:[{bearerAuth:[]}],request:{params:q.object({congressId:q.uuid()}),body:{content:{"application/json":{schema:Ds.omit({congressId:!0})}}}},responses:{201:{description:"Congress gallery image created successfully",summary:"Congress Gallery Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:q.object({errors:q.record(q.string(),q.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:q.object({message:q.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:q.object({message:q.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:q.object({message:q.string()})}}}}},Gc={method:"get",path:"/regional-congress/{congressId}/gallery",tags:["Regional Congresses"],summary:"Find congress gallery images by congress ID",request:{params:Us},responses:{200:{description:"Congress gallery images retrieved successfully by congress ID",summary:"Congress Galleries Retrieved",content:{"application/json":{schema:q.array(Vy)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:q.object({errors:q.record(q.string(),q.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:q.object({message:q.string()})}}}}},_c={method:"put",path:"/regional-congress/gallery/{id}",tags:["Regional Congresses"],summary:"Update congress gallery image",security:[{bearerAuth:[]}],request:{params:Fo,body:{content:{"application/json":{schema:qs.omit({id:!0})}}}},responses:{200:{description:"Congress gallery image updated successfully",summary:"Congress Gallery Updated"},400:{description:"Invalid input data or gallery ID format",summary:"Validation Error",content:{"application/json":{schema:q.object({errors:q.record(q.string(),q.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:q.object({message:q.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:q.object({message:q.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:q.object({message:q.string()})}}}}},Hc={method:"delete",path:"/regional-congress/gallery/{id}",tags:["Regional Congresses"],summary:"Delete congress gallery image",security:[{bearerAuth:[]}],request:{params:Fo},responses:{200:{description:"Congress gallery image deleted successfully",summary:"Congress Gallery Deleted"},400:{description:"Invalid gallery ID format",summary:"Validation Error",content:{"application/json":{schema:q.object({errors:q.record(q.string(),q.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:q.object({message:q.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:q.object({message:q.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:q.object({message:q.string()})}}}}};import B from"zod";import{extendZodWithOpenApi as Ky}from"@asteasolutions/zod-to-openapi";import kt from"zod";var Wc=2,zc=1024,Yy=zc*zc,Xy=Wc*Yy;Ky(kt);var Bs=kt.object({name:kt.string().min(1,"Nome \xE9 obrigat\xF3rio"),logo:kt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Xy,`A imagem deve ter no m\xE1ximo ${Wc}MB.`).optional(),congressId:kt.uuid()}),Bo=class{constructor(e,r,t){this.regionalCongressPartnerRepository=e;this.regionalCongressRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{name:t,logo:i,congressId:n}=Bs.parse({...e.body,...e.params,logo:e.file});if(!await this.regionalCongressRepository.findById(n))throw new l("O congresso n\xE3o existe.");let m=await this.regionalCongressPartnerRepository.create({name:t,congressId:n}),c;return i&&(c=await this.firebaseStorageService.uploadFile({file:i,id:m.id,folder:D.PARTNER}),await this.regionalCongressPartnerRepository.update({id:m.id,logoUrl:c})),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as $y}from"@asteasolutions/zod-to-openapi";import Os from"zod";$y(Os);var No=Os.object({id:Os.string().uuid("ID inv\xE1lido")}),Oo=class{constructor(e){this.regionalCongressPartnerRepository=e}async handle(e,r){try{let{id:t}=No.parse(e.params);if(!await this.regionalCongressPartnerRepository.findById(t))throw new l("Parceiro n\xE3o encontrado");return await this.regionalCongressPartnerRepository.deleteById(t),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Jy}from"@asteasolutions/zod-to-openapi";import ht from"zod";Jy(ht);var Ns=ht.object({congressId:ht.uuid("ID do congresso inv\xE1lido"),page:ht.coerce.number().int().positive().optional(),limit:ht.coerce.number().int().positive().optional(),name:ht.string().optional()}),ko=class{constructor(e){this.regionalCongressPartnerRepository=e}async handle(e,r){try{let{congressId:t,page:i,limit:n,name:a}=Ns.parse({...e.params,...e.query}),m=i!==void 0&&n!==void 0,c=m?{offset:(i-1)*n,limit:n}:void 0,g=await this.regionalCongressPartnerRepository.findByCongressId({pagination:c,filter:{congressId:t,name:a}});if(!g)throw new l("Parceiros n\xE3o encontrados");if(!m)return r.status(200).json(g);let T=await this.regionalCongressPartnerRepository.count({filter:{congressId:t,name:a}});return r.status(200).json({data:g,pagination:{page:i,limit:n,total:T,totalPages:Math.ceil(T/n)}})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Qy}from"@asteasolutions/zod-to-openapi";import Lt from"zod";var Vc=2,Zc=1024,ef=Zc*Zc,tf=Vc*ef;Qy(Lt);var ks=Lt.object({id:Lt.string().uuid("ID inv\xE1lido"),name:Lt.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),logo:Lt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=tf,`A imagem deve ter no m\xE1ximo ${Vc}MB.`).optional()}),Lo=class{constructor(e,r){this.regionalCongressPartnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,logo:n}=ks.parse({...e.params,...e.body,logo:e.file});if(!await this.regionalCongressPartnerRepository.findById(t))throw new l("Parceiro n\xE3o encontrado");let m;return n&&(m=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:D.PARTNER})),await this.regionalCongressPartnerRepository.update({id:t,name:i,...m&&{logoUrl:m}}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var rf=B.object({id:B.uuid(),name:B.string(),logoUrl:B.string().nullable(),congressId:B.uuid()}),Kc={method:"post",path:"/regional-congress/{congressId}/partner",tags:["Regional Congresses"],summary:"Create a new congress partner",security:[{bearerAuth:[]}],request:{params:B.object({congressId:B.uuid()}),body:{content:{"application/json":{schema:Bs.omit({congressId:!0})}}}},responses:{201:{description:"Congress partner created successfully",summary:"Congress Partner Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:B.object({errors:B.record(B.string(),B.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:B.object({message:B.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:B.object({message:B.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:B.object({message:B.string()})}}}}},Yc={method:"get",path:"/regional-congress/{congressId}/partner",tags:["Regional Congresses"],summary:"Find congress partners by congress ID",request:{params:Ns},responses:{200:{description:"Congress partners retrieved successfully by congress ID",summary:"Congress Partners Retrieved",content:{"application/json":{schema:B.array(rf)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:B.object({errors:B.record(B.string(),B.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:B.object({message:B.string()})}}}}},Xc={method:"put",path:"/regional-congress/partner/{id}",tags:["Regional Congresses"],summary:"Update congress partner",security:[{bearerAuth:[]}],request:{params:No,body:{content:{"application/json":{schema:ks.omit({id:!0})}}}},responses:{200:{description:"Congress partner updated successfully",summary:"Congress Partner Updated"},400:{description:"Invalid input data or partner ID format",summary:"Validation Error",content:{"application/json":{schema:B.object({errors:B.record(B.string(),B.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:B.object({message:B.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:B.object({message:B.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:B.object({message:B.string()})}}}}},$c={method:"delete",path:"/regional-congress/partner/{id}",tags:["Regional Congresses"],summary:"Delete congress partner",security:[{bearerAuth:[]}],request:{params:No},responses:{200:{description:"Congress partner deleted successfully",summary:"Congress Partner Deleted"},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:B.object({errors:B.record(B.string(),B.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:B.object({message:B.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:B.object({message:B.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:B.object({message:B.string()})}}}}};import d from"zod";import{extendZodWithOpenApi as of}from"@asteasolutions/zod-to-openapi";import H from"zod";of(H);var Ls=H.object({title:H.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),edition:H.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo"),startDate:H.coerce.date(),endDate:H.coerce.date(),description:H.string().optional(),location:H.string().optional(),congressLink:H.union([H.url("Link do congresso deve ser uma URL v\xE1lida"),H.literal("")]),noticeUrl:H.union([H.url("URL do edital deve ser uma URL v\xE1lida"),H.literal("")]),scheduleUrl:H.union([H.url("URL do cronograma deve ser uma URL v\xE1lida"),H.literal("")]),programUrl:H.union([H.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida"),H.literal("")]),adminReportUrl:H.union([H.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida"),H.literal("")]),proceedingsUrl:H.union([H.url("URL dos anais deve ser uma URL v\xE1lida"),H.literal("")])}).refine(o=>o.endDate>=o.startDate,{message:"Data de t\xE9rmino deve ser posterior ou igual \xE0 data de in\xEDcio",path:["endDate"]}),Go=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let t=Ls.parse(e.body);return await this.regionalCongressRepository.create(t),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as nf}from"@asteasolutions/zod-to-openapi";import Gs from"zod";nf(Gs);var _s=Gs.object({id:Gs.string().uuid("ID inv\xE1lido")}),_o=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let{id:t}=_s.parse(e.params);if(!await this.regionalCongressRepository.findById(t))throw new l("Congresso regional n\xE3o encontrado");return await this.regionalCongressRepository.deleteById(t),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as sf}from"@asteasolutions/zod-to-openapi";import Hs from"zod";sf(Hs);var zs=Hs.object({edition:Hs.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo")}),Ho=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let{edition:t}=zs.parse(e.params),i=await this.regionalCongressRepository.findByEdition(t);if(!i||i.length===0)throw new l("Congresso regional n\xE3o encontrado");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as af}from"@asteasolutions/zod-to-openapi";import Ws from"zod";af(Ws);var Wo=Ws.object({id:Ws.string().uuid("ID inv\xE1lido")}),zo=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let{id:t}=Wo.parse(e.params),i=await this.regionalCongressRepository.findById(t);if(!i)throw new l("Congresso regional n\xE3o encontrado");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as mf}from"@asteasolutions/zod-to-openapi";import Ne from"zod";mf(Ne);var Zs=Ne.object({page:Ne.coerce.number().int().positive().default(1),limit:Ne.coerce.number().int().positive().default(10),title:Ne.string().optional(),edition:Ne.coerce.number().int().positive().optional(),location:Ne.string().optional(),orderBy:Ne.enum(["asc","desc"]).optional().default("desc")}),Zo=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let{page:t,limit:i,orderBy:n,...a}=Zs.parse(e.query),m=(t-1)*i,c=await this.regionalCongressRepository.find({pagination:{offset:m,limit:i},filter:{...a,orderBy:n}});if(!c)throw new l("Congressos regionais n\xE3o encontrados");let g=await this.regionalCongressRepository.count({filter:a});return r.status(200).json({data:c,pagination:{page:t,limit:i,total:g,totalPages:Math.ceil(g/i)}})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as cf}from"@asteasolutions/zod-to-openapi";import _ from"zod";cf(_);var Vs=_.object({id:_.string().uuid("ID inv\xE1lido"),title:_.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),edition:_.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo").optional(),startDate:_.coerce.date().optional(),endDate:_.coerce.date().optional(),description:_.string().optional(),location:_.string().optional(),congressLink:_.union([_.url("Link do congresso deve ser uma URL v\xE1lida"),_.literal("")]),noticeUrl:_.union([_.url("URL do edital deve ser uma URL v\xE1lida"),_.literal("")]),scheduleUrl:_.union([_.url("URL do cronograma deve ser uma URL v\xE1lida"),_.literal("")]),programUrl:_.union([_.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida"),_.literal("")]),adminReportUrl:_.union([_.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida"),_.literal("")]),proceedingsUrl:_.union([_.url("URL dos anais deve ser uma URL v\xE1lida"),_.literal("")])}).refine(o=>o.startDate&&o.endDate?o.endDate>=o.startDate:!0,{message:"Data de t\xE9rmino deve ser posterior ou igual \xE0 data de in\xEDcio",path:["endDate"]}),Vo=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let{id:t}=_.object({id:_.string().uuid()}).parse(e.params);if(!await this.regionalCongressRepository.findById(t))throw new l("Congresso regional n\xE3o encontrado");let n=Vs.parse({id:t,...e.body});return await this.regionalCongressRepository.update(n),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var pf=9,df=d.object({image:d.any().openapi({type:"string",format:"binary"}),caption:d.string().optional()}),lf=d.object({image:d.any().openapi({type:"string",format:"binary"}).optional(),caption:d.string().optional()}),uf=d.object({id:d.uuid(),name:d.string(),logoUrl:d.string().nullable(),congressId:d.uuid()}),Ks=d.object({id:d.uuid(),imageUrl:d.string(),caption:d.string().nullable(),congressId:d.uuid()}),Ys=d.object({id:d.uuid(),title:d.string(),edition:d.number(),startDate:d.date(),endDate:d.date(),description:d.string().nullable(),location:d.string().nullable(),congressLink:d.string().nullable(),noticeUrl:d.string().nullable(),scheduleUrl:d.string().nullable(),programUrl:d.string().nullable(),adminReportUrl:d.string().nullable(),proceedingsUrl:d.string().nullable(),partners:d.array(uf),galleries:d.array(Ks),createdAt:d.date(),updatedAt:d.date()}),Jc={method:"post",path:"/regional-congress",tags:["Regional Congresses"],summary:"Create a new regional congress",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Ls}}}},responses:{201:{description:"Regional congress created successfully",summary:"Regional Congress Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},Qc={method:"get",path:"/regional-congress",tags:["Regional Congresses"],summary:"List all regional congresses with pagination and filters",request:{query:Zs},responses:{200:{description:"List of regional congresses retrieved successfully with pagination",summary:"Regional Congresses Retrieved",content:{"application/json":{schema:d.object({page:d.number(),totalPages:d.number(),offset:d.number(),limit:d.number(),congresses:d.array(Ys)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},ep={method:"get",path:"/regional-congress/{id}",tags:["Regional Congresses"],summary:"Find regional congress by ID",request:{params:Wo},responses:{200:{description:"Regional congress details retrieved successfully",summary:"Regional Congress Retrieved",content:{"application/json":{schema:Ys}}},400:{description:"Invalid regional congress ID format",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},404:{description:"Regional congress not found with the provided ID",summary:"Regional Congress Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},tp={method:"get",path:"/regional-congress/edition/{edition}",tags:["Regional Congresses"],summary:"Find regional congresses by edition",request:{params:zs},responses:{200:{description:"Regional congresses retrieved successfully by edition",summary:"Regional Congresses Retrieved by Edition",content:{"application/json":{schema:d.array(Ys)}}},400:{description:"Invalid edition parameter provided",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},rp={method:"put",path:"/regional-congress/{id}",tags:["Regional Congresses"],summary:"Update regional congress",security:[{bearerAuth:[]}],request:{params:Wo,body:{content:{"application/json":{schema:Vs.omit({id:!0})}}}},responses:{200:{description:"Regional congress updated successfully",summary:"Regional Congress Updated"},400:{description:"Invalid input data or regional congress ID format",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},404:{description:"Regional congress not found with the provided ID",summary:"Regional Congress Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},op={method:"delete",path:"/regional-congress/{id}",tags:["Regional Congresses"],summary:"Delete regional congress",security:[{bearerAuth:[]}],request:{params:_s},responses:{200:{description:"Regional congress deleted successfully",summary:"Regional Congress Deleted"},400:{description:"Invalid regional congress ID format",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},404:{description:"Regional congress not found with the provided ID",summary:"Regional Congress Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},EP={method:"post",path:"/regional-congress/{congressId}/gallery",tags:["Regional Congress Gallery"],summary:"Create a new gallery image for a congress",security:[{bearerAuth:[]}],request:{params:d.object({congressId:d.uuid()}),body:{content:{"multipart/form-data":{schema:df}}}},responses:{201:{description:"Gallery image created successfully",summary:"Gallery Image Created"},400:{description:"Invalid input data, missing required fields, or invalid image format/size",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},xP={method:"get",path:"/regional-congress/{congressId}/gallery",tags:["Regional Congress Gallery"],summary:"List all gallery images for a congress with pagination",request:{params:d.object({congressId:d.uuid()}),query:d.object({page:d.coerce.number().min(1).default(1),limit:d.coerce.number().min(1).default(pf),caption:d.string().optional()})},responses:{200:{description:"Gallery images retrieved successfully with pagination",summary:"Gallery Images Retrieved",content:{"application/json":{schema:d.object({page:d.number(),totalPages:d.number(),offset:d.number(),limit:d.number(),galleries:d.array(Ks)})}}},400:{description:"Invalid congress ID format or query parameters",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},MP={method:"get",path:"/regional-congress/gallery/{id}",tags:["Regional Congress Gallery"],summary:"Find a gallery image by ID",request:{params:d.object({id:d.uuid()})},responses:{200:{description:"Gallery image retrieved successfully",summary:"Gallery Image Retrieved",content:{"application/json":{schema:Ks}}},400:{description:"Invalid gallery image ID format",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},PP={method:"put",path:"/regional-congress/gallery/{id}",tags:["Regional Congress Gallery"],summary:"Update a gallery image with optional image upload",security:[{bearerAuth:[]}],request:{params:d.object({id:d.uuid()}),body:{content:{"multipart/form-data":{schema:lf}}}},responses:{200:{description:"Gallery image updated successfully",summary:"Gallery Image Updated"},400:{description:"Invalid input data, gallery ID format, or invalid image format/size",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},TP={method:"delete",path:"/regional-congress/gallery/{id}",tags:["Regional Congress Gallery"],summary:"Delete a gallery image",security:[{bearerAuth:[]}],request:{params:d.object({id:d.uuid()})},responses:{200:{description:"Gallery image deleted successfully",summary:"Gallery Image Deleted"},400:{description:"Invalid gallery ID format",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}};import{$Enums as oa}from"@prisma/client";import h from"zod";import{extendZodWithOpenApi as gf}from"@asteasolutions/zod-to-openapi";import{Degree as yf,Seniority as ff}from"@prisma/client";import ne from"zod";gf(ne);var Xs=ne.object({registrationNumber:ne.string(),mainEtps:ne.string().optional(),formations:ne.string().optional(),degrees:ne.array(ne.enum(yf)),occupations:ne.string(),seniority:ne.enum(ff),institutions:ne.string(),biography:ne.string().optional(),userId:ne.string()}),Ko=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{registrationNumber:t,mainEtps:i,formations:n,degrees:a,occupations:m,seniority:c,institutions:g,biography:T,userId:k}=Xs.parse(e.body);if(await this.researcherRepository.findByRegistrationNumber(t))throw new K("J\xE1 existe um pesquisador cadastrado com este n\xFAmero de registro.");if(await this.researcherRepository.findByUserId(k))throw new K("Usu\xE1rio j\xE1 possui um perfil de pesquisador.");return await this.researcherRepository.create({registrationNumber:t,mainEtps:i,formations:n,degrees:a,occupations:m,seniority:c,institutions:g,biography:T,userId:k}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as hf}from"@asteasolutions/zod-to-openapi";import $s from"zod";hf($s);var Js=$s.object({id:$s.uuid()}),Yo=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t}=Js.parse({id:e.params.id});if(!await this.researcherRepository.findById(t))throw new l("O pesquisador n\xE3o existe.");return await this.researcherRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Rf}from"@asteasolutions/zod-to-openapi";import Qs from"zod";Rf(Qs);var $o=Qs.object({id:Qs.uuid()}),Xo=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t}=$o.parse({id:e.params.id}),i=await this.researcherRepository.findById(t);if(!i)throw new l("O pesquisador n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as If}from"@asteasolutions/zod-to-openapi";import ea from"zod";If(ea);var ta=ea.object({userId:ea.uuid()}),Jo=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{userId:t}=ta.parse({userId:e.params.userId}),i=await this.researcherRepository.findByUserId(t);if(!i)throw new l("O pesquisador n\xE3o existe para este usu\xE1rio.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Cf}from"@asteasolutions/zod-to-openapi";import{Degree as bf,Seniority as wf}from"@prisma/client";import se from"zod";Cf(se);var ra=se.object({id:se.uuid(),registrationNumber:se.string().optional(),mainEtps:se.string().optional(),formations:se.string().optional(),degrees:se.array(se.enum(bf)).optional(),occupations:se.string().optional(),seniority:se.enum(wf).optional(),institutions:se.string().optional(),biography:se.string().optional()}),Qo=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t,registrationNumber:i,mainEtps:n,formations:a,degrees:m,occupations:c,seniority:g,institutions:T,biography:k}=ra.parse({id:e.params.id,...e.body}),z=await this.researcherRepository.findById(t);if(!z)throw new l("O pesquisador n\xE3o existe.");if(i&&i!==z.registrationNumber){let J=await this.researcherRepository.findByRegistrationNumber(i);if(J&&J.id!==t)throw new K("J\xE1 existe um pesquisador com este n\xFAmero de registro.")}return await this.researcherRepository.update({id:t,registrationNumber:i,mainEtps:n,formations:a,degrees:m,occupations:c,seniority:g,institutions:T,biography:k}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Sf=1,vf=9,ia=h.object({id:h.uuid(),registrationNumber:h.string(),mainEtps:h.string().nullable(),formations:h.string().nullable(),degrees:h.array(h.enum(oa.Degree)),occupations:h.string(),seniority:h.enum(oa.Seniority),institutions:h.string(),biography:h.string().nullable(),createdAt:h.date(),updatedAt:h.date(),userId:h.uuid(),user:h.object({id:h.uuid(),name:h.string(),emailAddress:h.string(),avatarUrl:h.string().nullable(),orcid:h.string().nullable(),phone:h.string().nullable(),lattesUrl:h.string().nullable(),role:h.enum(oa.UserRole)})}),ip={method:"post",path:"/researcher",tags:["Researchers"],summary:"Create a new researcher profile",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Xs}}}},responses:{201:{description:"Researcher profile created successfully",summary:"Researcher Created",content:{"application/json":{schema:h.object({message:h.string()})}}},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},409:{description:"Researcher with this registration number already exists or user already has a researcher profile",summary:"Conflict",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},np={method:"get",path:"/researcher",tags:["Researchers"],summary:"List all researchers with pagination and filters",request:{query:h.object({page:h.coerce.number().min(1).default(Sf).optional(),limit:h.coerce.number().min(1).default(vf).optional(),userId:h.string().optional(),registrationNumber:h.string().optional(),name:h.string().optional(),emailAddress:h.string().optional(),mainEtps:h.string().optional(),formations:h.string().optional(),occupations:h.string().optional(),institutions:h.string().optional(),biography:h.string().optional(),orderBy:h.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of researchers retrieved successfully with pagination",summary:"Researchers Retrieved",content:{"application/json":{schema:h.object({page:h.number(),totalPages:h.number(),offset:h.number(),limit:h.number(),researchers:h.array(ia)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},sp={method:"get",path:"/researcher/{id}",tags:["Researchers"],summary:"Find researcher by ID",request:{params:$o},responses:{200:{description:"Researcher details retrieved successfully",summary:"Researcher Retrieved",content:{"application/json":{schema:ia}}},400:{description:"Invalid researcher ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},ap={method:"get",path:"/researcher/user/{userId}",tags:["Researchers"],summary:"Find researcher by user ID",request:{params:ta},responses:{200:{description:"Researcher details retrieved successfully",summary:"Researcher Retrieved",content:{"application/json":{schema:ia}}},400:{description:"Invalid user ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},404:{description:"Researcher not found for this user",summary:"Researcher Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},mp={method:"put",path:"/researcher/{id}",tags:["Researchers"],summary:"Update researcher profile",security:[{bearerAuth:[]}],request:{params:$o,body:{content:{"application/json":{schema:ra.omit({id:!0})}}}},responses:{200:{description:"Researcher profile updated successfully",summary:"Researcher Updated",content:{"application/json":{schema:h.object({message:h.string()})}}},400:{description:"Invalid input data or researcher ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},409:{description:"Researcher with this registration number already exists",summary:"Conflict",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},cp={method:"delete",path:"/researcher/{id}",tags:["Researchers"],summary:"Delete researcher profile",security:[{bearerAuth:[]}],request:{params:Js},responses:{200:{description:"Researcher profile deleted successfully",summary:"Researcher Deleted"},400:{description:"Invalid researcher ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}};import{$Enums as Pf}from"@prisma/client";import M from"zod";import{extendZodWithOpenApi as jf}from"@asteasolutions/zod-to-openapi";import Rt from"zod";jf(Rt);var na=Rt.object({role:Rt.string().min(1),description:Rt.string().optional(),userId:Rt.uuid(),order:Rt.number().optional()}),ei=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{role:t,description:i,userId:n,order:a}=na.parse(e.body);return await this.sdhcTeamMemberRepository.create({role:t,description:i,userId:n,order:a??0}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ef}from"@asteasolutions/zod-to-openapi";import sa from"zod";Ef(sa);var aa=sa.object({id:sa.uuid()}),ti=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t}=aa.parse({id:e.params.id});if(!await this.sdhcTeamMemberRepository.findById(t))throw new l("O membro da equipe SDHC n\xE3o existe.");return await this.sdhcTeamMemberRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as xf}from"@asteasolutions/zod-to-openapi";import ma from"zod";xf(ma);var oi=ma.object({id:ma.uuid()}),ri=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t}=oi.parse({id:e.params.id}),i=await this.sdhcTeamMemberRepository.findById(t);if(!i)throw new l("O membro da equipe SDHC n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Mf}from"@asteasolutions/zod-to-openapi";import Xe from"zod";Mf(Xe);var ca=Xe.object({id:Xe.uuid(),role:Xe.string().min(1).optional(),description:Xe.string().optional(),userId:Xe.uuid().optional(),order:Xe.number().optional()}),ii=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t,role:i,description:n,userId:a,order:m}=ca.parse({id:e.params.id,...e.body});if(!await this.sdhcTeamMemberRepository.findById(t))throw new l("O membro da equipe SDHC n\xE3o existe.");return await this.sdhcTeamMemberRepository.update({id:t,role:i,description:n,userId:a,order:m}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Tf=M.object({id:M.uuid(),name:M.string(),emailAddress:M.string(),avatarUrl:M.string().nullable(),orcid:M.string().nullable(),phone:M.string().nullable(),lattesUrl:M.string().nullable(),role:M.enum(Pf.UserRole)}),pp=M.object({id:M.uuid(),role:M.string(),description:M.string().nullable(),order:M.number(),createdAt:M.date(),updatedAt:M.date(),userId:M.uuid(),user:Tf}),dp={method:"post",path:"/sdhc-team-member",tags:["SDHC Team Members"],summary:"Create a new SDHC Team Member",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:na}}}},responses:{201:{description:"SDHC Team Member created successfully",summary:"SDHC Team Member Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},lp={method:"get",path:"/sdhc-team-member",tags:["SDHC Team Members"],summary:"List all SDHC Team Members with filters",request:{query:M.object({role:M.string().optional(),orderBy:M.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of SDHC Team Members retrieved successfully",summary:"SDHC Team Members Retrieved",content:{"application/json":{schema:M.object({members:M.array(pp)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},up={method:"get",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Find SDHC Team Member by ID",request:{params:oi},responses:{200:{description:"SDHC Team Member details retrieved successfully",summary:"SDHC Team Member Retrieved",content:{"application/json":{schema:pp}}},400:{description:"Invalid SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},gp={method:"put",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Update SDHC Team Member",security:[{bearerAuth:[]}],request:{params:oi,body:{content:{"application/json":{schema:ca.omit({id:!0})}}}},responses:{200:{description:"SDHC Team Member updated successfully",summary:"SDHC Team Member Updated"},400:{description:"Invalid input data or SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:M.object({message:M.string()})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},yp={method:"delete",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Delete SDHC Team Member",security:[{bearerAuth:[]}],request:{params:aa},responses:{200:{description:"SDHC Team Member deleted successfully",summary:"SDHC Team Member Deleted"},400:{description:"Invalid SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:M.object({message:M.string()})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}};import{$Enums as Rp}from"@prisma/client";import A from"zod";import{extendZodWithOpenApi as Af}from"@asteasolutions/zod-to-openapi";import pa from"zod";Af(pa);var da=pa.object({id:pa.string()}),ni=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{id:t}=da.parse({id:e.params.id}),i=await this.userRepository.findById(t);if(!i)throw new l("O usu\xE1rio n\xE3o existe.");let n=e.user.id;if(i.id!==n)throw new oe("Voc\xEA n\xE3o tem permiss\xE3o para deletar o usu\xE1rio");return await this.userRepository.deleteById(i.id),r.sendStatus(204)}catch(t){if(console.log(t),t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Df}from"@asteasolutions/zod-to-openapi";import{z as la}from"zod";Df(la);var ua=la.object({id:la.string().min(1,"id do usu\xE1rio n\xE3o fornecido.")}),si=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{id:t}=ua.parse(e.params),i=await this.userRepository.findById(t);if(!i)throw new l("Usu\xE1rio n\xE3o encontrado");r.status(200).json(i)}catch(t){if(console.log(t),t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ff}from"@asteasolutions/zod-to-openapi";import $e from"zod";var hp=2,fp=1024,Uf=fp*fp,qf=hp*Uf,Bf=/^\d{4}-\d{4}-\d{4}-\d{4}$/,Of=/^\(?\d{2}\)?[\s-]?\d{4,5}-?\d{4}$/;Ff($e);var ga=$e.object({name:$e.string().optional(),lattesUrl:$e.string().optional(),orcid:$e.string().optional().transform(o=>o===void 0?void 0:o.trim()).refine(o=>o===void 0||o===""||Bf.test(o),{message:"ORCID inv\xE1lido. Deve estar no formato 0000-0000-0000-0000"}),phone:$e.string().optional().refine(o=>o===void 0||o===""||Of.test(o),{message:"Telefone inv\xE1lido. Deve estar no formato (99) 99999-9999"}),avatarImage:$e.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=qf,`A imagem deve ter no m\xE1ximo ${hp}MB.`).optional()}),ai=class{constructor(e,r){this.userRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{avatarImage:t,...i}=ga.parse({...e.body,avatarImage:e.file}),n=e.user.id,a=await this.userRepository.findById(n);if(!a)throw new Q("O usu\xE1rio n\xE3o existe");let m=a.avatarUrl;return t&&(a.avatarUrl?m=await this.firebaseStorageService.updateFile({file:t,id:n,folder:D.USER,fileUrl:a.avatarUrl}):m=await this.firebaseStorageService.uploadFile({file:t,id:n,folder:D.USER})),await this.userRepository.update({...i,id:n,avatarUrl:m||void 0}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Ip={method:"get",path:"/users/{id}",tags:["Users"],summary:"Find user by ID",request:{params:ua},responses:{200:{description:"User details retrieved successfully",summary:"User Retrieved",content:{"application/json":{schema:A.object({id:A.string(),name:A.string(),createdAt:A.date(),updatedAt:A.date(),role:A.enum(Rp.UserRole),lattesUrl:A.string().nullable(),orcid:A.string().nullable(),phone:A.string().nullable(),avatarUrl:A.url().nullable(),emailAddress:A.email()})}}},400:{description:"Invalid user ID format",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},404:{description:"User not found with the provided ID",summary:"User Not Found",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},Cp={method:"put",path:"/users",tags:["Users"],summary:"Update authenticated user",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:ga}}}},responses:{200:{description:"User profile updated successfully",summary:"User Updated",content:{"application/json":{schema:A.object({message:A.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},401:{description:"User not authenticated or unauthorized",summary:"Authentication Required",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},bp={method:"delete",path:"/users",tags:["Users"],summary:"Delete authenticated user",security:[{bearerAuth:[]}],request:{params:da},responses:{200:{description:"User account deleted successfully",summary:"User Deleted",content:{"application/json":{schema:A.object({message:A.string()})}}},400:{description:"Invalid request parameters",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},401:{description:"User not authenticated or unauthorized",summary:"Authentication Required",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},wp={method:"get",path:"/users",tags:["Users"],summary:"List users",responses:{200:{description:"Complete list of users retrieved successfully",summary:"Users Retrieved",content:{"application/json":{schema:A.array(A.object({id:A.string(),name:A.string(),createdAt:A.date(),updatedAt:A.date(),role:A.enum(Rp.UserRole),lattesUrl:A.url().nullable(),orcid:A.string().nullable(),phone:A.string().nullable(),avatarUrl:A.string().nullable(),emailAddress:A.email()}))}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}};var y=new Nf;y.registerComponent("securitySchemes","bearerAuth",{type:"http",scheme:"bearer",bearerFormat:"JWT"});y.registerPath(Oa);y.registerPath(Na);y.registerPath(ka);y.registerPath(La);y.registerPath(_a);y.registerPath(Ha);y.registerPath(Ga);y.registerPath(Ip);y.registerPath(Cp);y.registerPath(bp);y.registerPath(wp);y.registerPath(nc);y.registerPath(sc);y.registerPath(ac);y.registerPath(mc);y.registerPath(za);y.registerPath(Wa);y.registerPath(Za);y.registerPath(Va);y.registerPath(Ka);y.registerPath(Cc);y.registerPath(bc);y.registerPath(wc);y.registerPath(Sc);y.registerPath(vc);y.registerPath(nm);y.registerPath(sm);y.registerPath(am);y.registerPath(mm);y.registerPath(cm);y.registerPath(ip);y.registerPath(np);y.registerPath(sp);y.registerPath(ap);y.registerPath(mp);y.registerPath(cp);y.registerPath(Xa);y.registerPath($a);y.registerPath(Ja);y.registerPath(Qa);y.registerPath(em);y.registerPath(gc);y.registerPath(yc);y.registerPath(fc);y.registerPath(hc);y.registerPath(Rc);y.registerPath(km);y.registerPath(Lm);y.registerPath(Gm);y.registerPath(_m);y.registerPath(Hm);y.registerPath(dp);y.registerPath(lp);y.registerPath(up);y.registerPath(gp);y.registerPath(yp);y.registerPath(Fm);y.registerPath(Um);y.registerPath(qm);y.registerPath(Bm);y.registerPath(Om);y.registerPath(Tc);y.registerPath(Ac);y.registerPath(Dc);y.registerPath(Fc);y.registerPath(Uc);y.registerPath(qc);y.registerPath(Jm);y.registerPath(Qm);y.registerPath(ec);y.registerPath(tc);y.registerPath(rc);y.registerPath(oc);y.registerPath(Km);y.registerPath(Ym);y.registerPath(Xm);y.registerPath($m);y.registerPath(Em);y.registerPath(xm);y.registerPath(Mm);y.registerPath(Pm);y.registerPath(Tm);y.registerPath(Am);y.registerPath(wm);y.registerPath(Sm);y.registerPath(vm);y.registerPath(jm);y.registerPath(gm);y.registerPath(ym);y.registerPath(fm);y.registerPath(hm);y.registerPath(Jc);y.registerPath(Qc);y.registerPath(ep);y.registerPath(tp);y.registerPath(rp);y.registerPath(op);y.registerPath(Kc);y.registerPath(Yc);y.registerPath(Xc);y.registerPath($c);y.registerPath(Lc);y.registerPath(Gc);y.registerPath(_c);y.registerPath(Hc);var Lf=new kf(y.definitions),Sp=Lf.generateDocument({openapi:"3.0.0",info:{title:"API da Rede CT",version:"1.0.0",description:"API com valida\xE7\xE3o Zod"}});import{Router as Vf}from"express";import{extendZodWithOpenApi as Gf}from"@asteasolutions/zod-to-openapi";import ya from"zod";Gf(ya);var _f=ya.object({authenticatedUserId:ya.uuid()}),mi=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{authenticatedUserId:t}=_f.parse({authenticatedUserId:e.user.id}),i=await this.userRepository.findById(t);if(!i)throw new l("Usu\xE1rio n\xE3o encontrado.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{PrismaClient as Hf}from"@prisma/client";var N=new Hf({log:["warn","error"]});var ci=class{constructor(e){this.prisma=e}async register({userId:e,title:r,description:t,certificationUrl:i}){await this.prisma.certification.create({data:{title:r,description:t,certificationUrl:i,user:{connect:{id:e}}}})}async find({pagination:{offset:e,limit:r},filter:{description:t,orderBy:i,title:n,userId:a}}){let m={},c=[];return a&&(m.userId=a),n&&c.push({title:{contains:n,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.certification.findMany({where:m,include:{user:{omit:{passwordHash:!0}}},orderBy:{updatedAt:i},skip:e,take:r})}async findById(e){return await this.prisma.certification.findFirst({where:{id:e}})}async findByUserId({pagination:{limit:e,offset:r},filter:{description:t,orderBy:i,title:n},userId:a}){let m={userId:a},c=[];return n&&c.push({title:{contains:n,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.certification.findMany({where:m,include:{user:{omit:{passwordHash:!0}}},skip:r,take:e,orderBy:i?{updatedAt:i}:{updatedAt:"desc"}})}async update({id:e,...r}){await this.prisma.certification.update({where:{id:e},data:r})}async deleteById(e){await this.prisma.certification.delete({where:{id:e}})}async count({filter:{description:e,title:r,userId:t}}){let i={},n=[];return t&&(i.userId=t),r&&n.push({title:{contains:r,mode:"insensitive"}}),e&&n.push({description:{contains:e,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.certification.count({where:i})}};function ke(){return new ci(N)}var pi=class{constructor(e){this.prisma=e}async create(e){await this.prisma.news.create({data:e})}async find({pagination:{offset:e,limit:r},filter:{authorId:t,content:i,title:n,orderBy:a}}){let m={};t&&(m.authorId={contains:t,mode:"insensitive"});let c=[];return n&&c.push({title:{contains:n,mode:"insensitive"}}),i&&c.push({content:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.news.findMany({where:m,omit:{authorId:!0},include:{author:!0},orderBy:{updatedAt:a},skip:e,take:r})}async findById(e){return await this.prisma.news.findUnique({where:{id:e},omit:{authorId:!0},include:{author:!0}})}async findByAuthorId({authorId:e,pagination:{offset:r,limit:t},filter:{orderBy:i="desc",content:n,title:a}}){let m={authorId:e},c=[];return a&&c.push({title:{contains:a,mode:"insensitive"}}),n&&c.push({content:{contains:n,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.news.findMany({omit:{authorId:!0},where:m,orderBy:{updatedAt:i},skip:r,take:t})}async update(e){await this.prisma.news.update({where:{id:e.id},data:{title:e.title,content:e.content,imageUrl:e.imageUrl}})}async delete(e){await this.prisma.news.delete({where:{id:e}})}async count({filter:{authorId:e,content:r,title:t}}){let i={};e&&(i.authorId={contains:e,mode:"insensitive"});let n=[];return t&&n.push({title:{contains:t,mode:"insensitive"}}),r&&n.push({content:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.news.count({where:i})}};function be(){return new pi(N)}var di=class{constructor(e){this.prisma=e}async create(e){await this.prisma.pendency.create({data:e})}async find({filter:{description:e,orderBy:r,title:t,status:i,userId:n},pagination:{limit:a,offset:m}}){let c={userId:n,AND:{status:{equals:i}}};e&&(c.description={contains:e,mode:"insensitive"});let g=[];return t&&g.push({title:{contains:t,mode:"insensitive"}}),g.length>0&&(c.OR=g),await this.prisma.pendency.findMany({where:c,orderBy:{updatedAt:r},include:{user:{omit:{passwordHash:!0}}},skip:m,take:a})}async findById(e){return await this.prisma.pendency.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async findByUserId({filter:{description:e,orderBy:r,title:t,status:i},pagination:{limit:n,offset:a},userId:m}){let c={userId:m,AND:{status:{equals:i}}},g=[];return e&&g.push({description:{contains:e,mode:"insensitive"}}),t&&g.push({title:{contains:t,mode:"insensitive"}}),g.length>0&&(c.OR=g),await this.prisma.pendency.findMany({where:c,orderBy:{updatedAt:r},include:{user:{omit:{passwordHash:!0}}},skip:a,take:n})}async update({id:e,...r}){await this.prisma.pendency.update({where:{id:e},data:r})}async deleteById(e){await this.prisma.pendency.delete({where:{id:e}})}async count({filter:{description:e,title:r,status:t,userId:i}}){let n={userId:i},a=[];return e&&a.push({description:{contains:e,mode:"insensitive"}}),r&&a.push({title:{contains:r,mode:"insensitive"}}),t&&a.push({status:{equals:t}}),a.length>0&&(n.OR=a),await this.prisma.pendency.count({where:n})}};function Le(){return new di(N)}var li=class{constructor(e){this.prisma=e}async create(e){await this.prisma.user.create({data:e})}async update(e){await this.prisma.user.update({where:{id:e.id},data:{lattesUrl:e.lattesUrl??null,orcid:e.orcid??null,phone:e.phone??null,avatarUrl:e.avatarUrl??null}})}async deleteById(e){await this.prisma.user.delete({where:{id:e}})}async find(){return await this.prisma.user.findMany({omit:{passwordHash:!0}})}async findByEmail(e){return await this.prisma.user.findFirst({where:{emailAddress:e}})}async findById(e){return await this.prisma.user.findFirst({where:{id:e},omit:{passwordHash:!0}})}};function te(){return new li(N)}import{compare as zf,hash as Wf}from"bcryptjs";var ui=class{constructor(e,r){this.hashFn=e;this.compareFn=r}async hash(e){return await this.hashFn(e,6)}async compare({password:e,hashedPassword:r}){return await this.compareFn(e,r)}};function fa(){return new ui(Wf,zf)}import vp from"jsonwebtoken";import re from"zod";var Zf=re.object({JWT_SECRET:re.string(),FIREBASE_BUCKET:re.string(),FIREBASE_CLIENT_EMAIL:re.string(),FIREBASE_PRIVATE_KEY:re.string(),FIREBASE_PROJECT_ID:re.string(),FIREBASE_TYPE:re.string(),FIREBASE_PRIVATE_KEY_ID:re.string(),FIREBASE_CLIENT_ID:re.string(),FIREBASE_AUTH_URI:re.string(),FIREBASE_TOKEN_URI:re.string(),FIREBASE_AUTH_PROVIDER_X509_CERT_URL:re.string(),FIREBASE_CLIENT_X509_CERT_URL:re.string()}),$=Zf.parse(process.env);var gi=class{constructor(e,r){this.signFn=e;this.verifyFn=r}sign(e){try{return this.signFn(e,$.JWT_SECRET,{expiresIn:"3d",subject:e.id})}catch{return null}}verify(e){try{return this.verifyFn(e,$.JWT_SECRET)}catch{return null}}};function yi(){return new gi(vp.sign,vp.verify)}function jp(){return{signUpController:new er(te(),fa())}}function Ep(){return{signInController:new Jt(te(),fa(),yi())}}function xp(){return{findAuthenticatedUserController:new mi(te())}}function Mp(){return{findAuthenticatedUserController:new Yt(be())}}function Pp(){return{findAuthenticatedUserCertificationsController:new Kt(ke())}}function Tp(){return{findAuthenticatedUserPendenciesController:new Xt(Le())}}var fi=class{constructor(e){this.jwtService=e}authenticated(e,r,t){let i=e.headers.authorization;if(!i?.startsWith("Bearer "))return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});let n=i.split(" ")[1];if(!n)return r.status(401).json({message:"Token n\xE3o fornecido."});try{let a=this.jwtService.verify(n);if(!a)return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});e.user=a,t()}catch(a){if(console.log(a),a instanceof Error)return r.status(401).json({message:a.message})}}isAdmin(e,r,t){let i=e.headers.authorization;if(!i?.startsWith("Bearer "))return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});let n=i.split(" ")[1];if(!n)return r.status(401).json({message:"Token n\xE3o fornecido."});try{let a=this.jwtService.verify(n);if(!a)return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});if(a.role!=="ADMIN")return r.status(401).json({message:"\xC9 necess\xE1rio ter permiss\xF5es de administrador."});t()}catch(a){if(console.log(a),a instanceof Error)return r.status(401).json({message:a.message})}}};function G(){return{authMiddleware:new fi(yi())}}var we=Vf(),{authMiddleware:Gt}=G();we.post("/sign-up",async(o,e)=>{let{signUpController:r}=jp();await r.handle(o,e)});we.post("/sign-in",async(o,e)=>{let{signInController:r}=Ep();await r.handle(o,e)});we.get("/user",(o,e,r)=>{Gt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserController:r}=xp();await r.handle(o,e)});we.get("/user/news",(o,e,r)=>{Gt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserController:r}=Mp();await r.handle(o,e)});we.get("/admin",(o,e,r)=>{Gt.isAdmin(o,e,r)},(o,e)=>{try{e.status(200).json({success:!0})}catch(r){r instanceof Error&&e.status(500).json({message:r.message})}});we.get("/certifications",(o,e,r)=>{Gt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserCertificationsController:r}=Pp();await r.handle(o,e)});we.get("/pendencies",(o,e,r)=>{Gt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserPendenciesController:r}=Tp();await r.handle(o,e)});import{Router as Qf}from"express";import{getStorage as Yf}from"firebase-admin/storage";import{config as Kf}from"dotenv";import Ap from"firebase-admin";Kf();var ha=Ap.initializeApp({credential:Ap.credential.cert({clientEmail:$.FIREBASE_CLIENT_EMAIL,privateKey:$.FIREBASE_PRIVATE_KEY,projectId:$.FIREBASE_PROJECT_ID,type:$.FIREBASE_TYPE,privateKeyId:$.FIREBASE_PRIVATE_KEY_ID,clientId:$.FIREBASE_CLIENT_ID,authUri:$.FIREBASE_AUTH_URI,tokenUri:$.FIREBASE_TOKEN_URI,authProviderX509CertUrl:$.FIREBASE_AUTH_PROVIDER_X509_CERT_URL,clientX509CertUrl:$.FIREBASE_CLIENT_X509_CERT_URL}),storageBucket:$.FIREBASE_BUCKET});ha.name?console.log("\u{1F525} Firebase conectado com sucesso!"):console.error("\u274C Erro ao se conectar ao Firebase.");var Xf=Yf(ha),Dp=Xf.bucket($.FIREBASE_BUCKET);import{randomUUID as $f}from"node:crypto";var Jf=/https:\/\/storage\.googleapis\.com\/[^/]+\/(.+)$/,hi=class{constructor(e){this.bucket=e}async uploadFile({file:e,folder:r,id:t}){let i=`${$f()}-${e?.originalname}`,n=this.bucket.file(`${r}/${t}/${i}`);return await new Promise((a,m)=>{let c=n.createWriteStream({metadata:{contentType:e?.mimetype}});c.on("error",g=>{m(g)}),c.on("finish",async()=>{try{await n.makePublic();let g=`https://storage.googleapis.com/${this.bucket.name}/${n.name}`;a(g)}catch(g){m(g)}}),c.end(e.buffer)})}async updateFile({file:e,id:r,fileUrl:t,folder:i}){try{let n=this.getPath(t);if(!n)throw new Error("Arquivo n\xE3o encontrado.");let[a,m]=await Promise.all([this.bucket.file(n).delete(),this.uploadFile({file:e,id:r,folder:i})]);return m}catch{throw new Error("Erro ao atualizar o arquivo.")}}async deleteFile({fileUrl:e}){let r=this.getPath(e);if(!r)throw new Error("Arquivo n\xE3o encontrado.");try{await this.bucket.file(r).delete()}catch{throw new Error("Erro ao deletar o arquivo.")}}getPath(e){let r=e.match(Jf);return r?r[1]:null}};function O(){return new hi(Dp)}function Fp(){return{registerCertificationController:new ir(te(),ke(),O())}}function Up(){return{findCertificationsController:new or(ke())}}function qp(){return{findCertificationByIdController:new rr(ke())}}function Bp(){return{updateCertificationController:new sr(ke(),O())}}function Op(){return{deleteCertificationController:new tr(ke(),O())}}import Np from"multer";var L=Np({storage:Np.memoryStorage()});var Je=Qf(),{authMiddleware:_t}=G();Je.post("/:user_id",(o,e,r)=>{_t.isAdmin(o,e,r)},L.single("certification"),async(o,e)=>{let{registerCertificationController:r}=Fp();await r.handle(o,e)});Je.get("/",(o,e,r)=>{_t.isAdmin(o,e,r)},async(o,e)=>{let{findCertificationsController:r}=Up();await r.handle(o,e)});Je.get("/:certification_id",(o,e,r)=>{_t.isAdmin(o,e,r)},async(o,e)=>{let{findCertificationByIdController:r}=qp();await r.handle(o,e)});Je.put("/:certification_id",(o,e,r)=>{_t.isAdmin(o,e,r)},L.single("certification"),async(o,e)=>{let{updateCertificationController:r}=Bp();await r.handle(o,e)});Je.delete("/:certification_id",(o,e,r)=>{_t.isAdmin(o,e,r)},async(o,e)=>{let{deleteCertificationController:r}=Op();await r.handle(o,e)});import{Router as ih}from"express";import{extendZodWithOpenApi as eh}from"@asteasolutions/zod-to-openapi";import Se from"zod";var th=1,rh=9;eh(Se);var oh=Se.object({page:Se.coerce.number().min(1).default(th),limit:Se.coerce.number().min(1).default(rh),code:Se.string().optional(),title:Se.string().optional(),description:Se.string().optional(),notes:Se.string().optional(),orderBy:Se.enum(["asc","desc"]).default("desc")}),Ri=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=oh.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.etpRepository.find({pagination:{offset:a,limit:i},filter:n}),this.etpRepository.count({filter:n})]),g=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:g,offset:a,limit:i,etps:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Ii=class{constructor(e){this.prisma=e}async create(e){let{leaderId:r,deputyLeaderId:t,secretaryId:i,memberIds:n,...a}=e;await this.prisma.$transaction(async m=>{let c=await m.eTP.create({data:a});await m.eTPLeader.create({data:{etpId:c.id,researcherId:r}}),await m.eTPDeputy.create({data:{etpId:c.id,researcherId:t}}),await m.eTPSecretary.create({data:{etpId:c.id,researcherId:i}}),await m.eTP.update({where:{id:c.id},data:{members:{connect:n.map(g=>({id:g}))}}})})}async update(e){let{leaderId:r,deputyLeaderId:t,secretaryId:i,memberIds:n,...a}=e;await this.prisma.$transaction(async m=>{await m.eTP.update({where:{id:e.id},data:a}),await this.updateLeader(m,e.id,r),await this.updateDeputyLeader(m,e.id,t),await this.updateSecretary(m,e.id,i),await this.updateMembers(m,e.id,n)})}async updateLeader(e,r,t){t!==void 0&&(await e.eTPLeader.deleteMany({where:{etpId:r}}),t&&await e.eTPLeader.create({data:{etpId:r,researcherId:t}}))}async updateDeputyLeader(e,r,t){t!==void 0&&(await e.eTPDeputy.deleteMany({where:{etpId:r}}),t&&await e.eTPDeputy.create({data:{etpId:r,researcherId:t}}))}async updateSecretary(e,r,t){t!==void 0&&(await e.eTPSecretary.deleteMany({where:{etpId:r}}),t&&await e.eTPSecretary.create({data:{etpId:r,researcherId:t}}))}async updateMembers(e,r,t){t!==void 0&&await e.eTP.update({where:{id:r},data:{members:{set:t.map(i=>({id:i}))}}})}async deleteById(e){await this.prisma.eTP.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{code:t,title:i,description:n,notes:a,orderBy:m}}){let c={},g=[];return t&&g.push({code:{contains:t,mode:"insensitive"}}),i&&g.push({title:{contains:i,mode:"insensitive"}}),n&&g.push({description:{contains:n,mode:"insensitive"}}),a&&g.push({notes:{contains:a,mode:"insensitive"}}),g.length>0&&(c.OR=g),await this.prisma.eTP.findMany({where:c,include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}},orderBy:{updatedAt:m},skip:e,take:r})}async findById(e){return await this.prisma.eTP.findFirst({where:{id:e},include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}}})}async findByCode(e){return await this.prisma.eTP.findFirst({where:{code:e},include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}}})}async count({filter:{code:e,title:r,description:t,notes:i}}){let n={},a=[];return e&&a.push({code:{contains:e,mode:"insensitive"}}),r&&a.push({title:{contains:r,mode:"insensitive"}}),t&&a.push({description:{contains:t,mode:"insensitive"}}),i&&a.push({notes:{contains:i,mode:"insensitive"}}),a.length>0&&(n.OR=a),await this.prisma.eTP.count({where:n})}};function It(){return new Ii(N)}function kp(){return{createETPController:new mr(It())}}function Lp(){return{findETPsController:new Ri(It())}}function Gp(){return{findETPByIdController:new pr(It())}}function _p(){return{updateETPController:new lr(It())}}function Hp(){return{deleteETPController:new cr(It())}}var Qe=ih(),{authMiddleware:Ra}=G();Qe.post("/",(o,e,r)=>{Ra.authenticated(o,e,r)},async(o,e)=>{let{createETPController:r}=kp();await r.handle(o,e)});Qe.get("/",async(o,e)=>{let{findETPsController:r}=Lp();await r.handle(o,e)});Qe.get("/:id",async(o,e)=>{let{findETPByIdController:r}=Gp();await r.handle(o,e)});Qe.put("/:id",(o,e,r)=>{Ra.authenticated(o,e,r)},async(o,e)=>{let{updateETPController:r}=_p();await r.handle(o,e)});Qe.delete("/:id",(o,e,r)=>{Ra.authenticated(o,e,r)},async(o,e)=>{let{deleteETPController:r}=Hp();await r.handle(o,e)});import{Router as nh}from"express";var Ci=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.inMemoriam.create({data:e})}async update(e){await this.prisma.inMemoriam.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.inMemoriam.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{name:t,biography:i,role:n,orderBy:a}}){let m={},c=[];return n&&(m.role=n),t&&c.push({name:{contains:t,mode:"insensitive"}}),i&&c.push({biography:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.inMemoriam.findMany({where:m,orderBy:{updatedAt:a},skip:e,take:r})}async findById(e){return await this.prisma.inMemoriam.findFirst({where:{id:e}})}async findByRole(e){return await this.prisma.inMemoriam.findMany({where:{role:e}})}async count({filter:{name:e,biography:r,role:t}}){let i={},n=[];return t&&(i.role=t),e&&n.push({name:{contains:e,mode:"insensitive"}}),r&&n.push({biography:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.inMemoriam.count({where:i})}};function et(){return new Ci(N)}function zp(){return{createInMemoriamController:new gr(et(),O())}}function Wp(){return{findInMemoriamsController:new Ir(et())}}function Zp(){return{findInMemoriamByIdController:new fr(et())}}function Vp(){return{findInMemoriamByRoleController:new Rr(et())}}function Kp(){return{updateInMemoriamController:new Cr(et(),O())}}function Yp(){return{deleteInMemoriamController:new yr(et(),O())}}var Ge=nh(),{authMiddleware:Ia}=G();Ge.post("/",(o,e,r)=>{Ia.authenticated(o,e,r)},L.single("photo"),async(o,e)=>{let{createInMemoriamController:r}=zp();await r.handle(o,e)});Ge.get("/",async(o,e)=>{let{findInMemoriamsController:r}=Wp();await r.handle(o,e)});Ge.get("/:id",async(o,e)=>{let{findInMemoriamByIdController:r}=Zp();await r.handle(o,e)});Ge.get("/role/:role",async(o,e)=>{let{findInMemoriamByRoleController:r}=Vp();await r.handle(o,e)});Ge.put("/:id",(o,e,r)=>{Ia.authenticated(o,e,r)},L.single("photo"),async(o,e)=>{let{updateInMemoriamController:r}=Kp();await r.handle(o,e)});Ge.delete("/:id",(o,e,r)=>{Ia.authenticated(o,e,r)},async(o,e)=>{let{deleteInMemoriamController:r}=Yp();await r.handle(o,e)});import{Router as sh}from"express";var Ca=sh();Ca.get("/",(o,e)=>{e.status(200).json({message:"Rede CT"})});import{Router as dh}from"express";var bi=class{constructor(e){this.prisma=e}async create(e){await this.prisma.internationalScientificCongress.create({data:e})}async update(e){await this.prisma.internationalScientificCongress.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.internationalScientificCongress.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,edition:i,location:n,orderBy:a}}){let m={},c=[];return i&&c.push({edition:{equals:i}}),t&&c.push({title:{contains:t,mode:"insensitive"}}),n&&c.push({location:{contains:n,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.internationalScientificCongress.findMany({where:m,include:{partners:!0,galleries:!0},orderBy:a?{startDate:a}:{startDate:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.internationalScientificCongress.findFirst({where:{id:e},include:{partners:!0,galleries:!0}})}async findByEdition(e){return await this.prisma.internationalScientificCongress.findMany({where:{edition:e},include:{partners:!0,galleries:!0}})}async count({filter:{title:e,edition:r,location:t}}){let i={},n=[];return r&&n.push({edition:{equals:r}}),e&&n.push({title:{contains:e,mode:"insensitive"}}),t&&n.push({location:{contains:t,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.internationalScientificCongress.count({where:i})}};function de(){return new bi(N)}function Xp(){return{createInternationalScientificCongressController:new Ar(de())}}function $p(){return{findInternationalScientificCongressesController:new Br(de())}}function Jp(){return{findInternationalScientificCongressByIdController:new Ur(de())}}function Qp(){return{findInternationalScientificCongressByEditionController:new Fr(de())}}function ed(){return{updateInternationalScientificCongressController:new Or(de())}}function td(){return{deleteInternationalScientificCongressController:new Dr(de())}}import{extendZodWithOpenApi as ah}from"@asteasolutions/zod-to-openapi";import ba from"zod";ah(ba);var mh=ba.object({id:ba.uuid()}),wi=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=mh.parse({id:e.params.id}),i=await this.internationalScientificCongressGalleryRepository.findById(t);if(!i)throw new l("A imagem da galeria n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Si=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.congressGalleryItem.create({data:e})}async update(e){await this.prisma.congressGalleryItem.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.congressGalleryItem.delete({where:{id:e}})}async findByCongressId(e){let{pagination:r,filter:t}=e;return await this.prisma.congressGalleryItem.findMany({where:{congressId:t.congressId,...t.caption&&{caption:{contains:t.caption,mode:"insensitive"}}},skip:r.offset,take:r.limit})}async findById(e){return await this.prisma.congressGalleryItem.findFirst({where:{id:e}})}async count(e){let{filter:r}=e;return await this.prisma.congressGalleryItem.count({where:{congressId:r.congressId,...r.caption&&{caption:{contains:r.caption,mode:"insensitive"}}}})}};function Ct(){return new Si(N)}function rd(){return{createInternationalScientificCongressGalleryController:new br(Ct(),de(),O())}}function od(){return{findInternationalScientificCongressGalleriesByCongressIdController:new vr(Ct())}}function id(){return{findInternationalScientificCongressGalleryByIdController:new wi(Ct())}}function nd(){return{updateInternationalScientificCongressGalleryController:new jr(Ct(),O())}}function sd(){return{deleteInternationalScientificCongressGalleryController:new wr(Ct())}}import{extendZodWithOpenApi as ch}from"@asteasolutions/zod-to-openapi";import wa from"zod";ch(wa);var ph=wa.object({id:wa.uuid()}),vi=class{constructor(e){this.internationalScientificCongressPartnerRepository=e}async handle(e,r){try{let{id:t}=ph.parse({id:e.params.id}),i=await this.internationalScientificCongressPartnerRepository.findById(t);if(!i)throw new l("O parceiro n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var ji=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.congressPartner.create({data:e})}async update(e){await this.prisma.congressPartner.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.congressPartner.delete({where:{id:e}})}async findByCongressId(e){return await this.prisma.congressPartner.findMany({where:{congressId:e.filter.congressId,name:e.filter.name?{contains:e.filter.name,mode:"insensitive"}:void 0},skip:e.pagination?.offset,take:e.pagination?.limit})}async findById(e){return await this.prisma.congressPartner.findFirst({where:{id:e}})}async count(e){return await this.prisma.congressPartner.count({where:{congressId:e.filter.congressId,name:e.filter.name?{contains:e.filter.name,mode:"insensitive"}:void 0}})}};function bt(){return new ji(N)}function ad(){return{createInternationalScientificCongressPartnerController:new Er(bt(),de(),O())}}function md(){return{findInternationalScientificCongressPartnersByCongressIdController:new Pr(bt())}}function cd(){return{findInternationalScientificCongressPartnerByIdController:new vi(bt())}}function pd(){return{updateInternationalScientificCongressPartnerController:new Tr(bt(),O())}}function dd(){return{deleteInternationalScientificCongressPartnerController:new xr(bt())}}var Y=dh(),{authMiddleware:ve}=G();Y.post("/",(o,e,r)=>{ve.authenticated(o,e,r)},async(o,e)=>{let{createInternationalScientificCongressController:r}=Xp();await r.handle(o,e)});Y.get("/",async(o,e)=>{let{findInternationalScientificCongressesController:r}=$p();await r.handle(o,e)});Y.get("/:id",async(o,e)=>{let{findInternationalScientificCongressByIdController:r}=Jp();await r.handle(o,e)});Y.get("/edition/:edition",async(o,e)=>{let{findInternationalScientificCongressByEditionController:r}=Qp();await r.handle(o,e)});Y.put("/:id",(o,e,r)=>{ve.authenticated(o,e,r)},async(o,e)=>{let{updateInternationalScientificCongressController:r}=ed();await r.handle(o,e)});Y.delete("/:id",(o,e,r)=>{ve.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressController:r}=td();await r.handle(o,e)});Y.post("/:congressId/gallery",(o,e,r)=>{ve.authenticated(o,e,r)},L.single("image"),async(o,e)=>{let{createInternationalScientificCongressGalleryController:r}=rd();await r.handle(o,e)});Y.get("/:congressId/gallery",async(o,e)=>{let{findInternationalScientificCongressGalleriesByCongressIdController:r}=od();await r.handle(o,e)});Y.get("/gallery/:id",async(o,e)=>{let{findInternationalScientificCongressGalleryByIdController:r}=id();await r.handle(o,e)});Y.put("/gallery/:id",(o,e,r)=>{ve.authenticated(o,e,r)},L.single("image"),async(o,e)=>{let{updateInternationalScientificCongressGalleryController:r}=nd();await r.handle(o,e)});Y.delete("/gallery/:id",(o,e,r)=>{ve.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressGalleryController:r}=sd();await r.handle(o,e)});Y.post("/:congressId/partner",(o,e,r)=>{ve.authenticated(o,e,r)},L.single("logo"),async(o,e)=>{let{createInternationalScientificCongressPartnerController:r}=ad();await r.handle(o,e)});Y.get("/:congressId/partner",async(o,e)=>{let{findInternationalScientificCongressPartnersByCongressIdController:r}=md();await r.handle(o,e)});Y.get("/partner/:id",async(o,e)=>{let{findInternationalScientificCongressPartnerByIdController:r}=cd();await r.handle(o,e)});Y.put("/partner/:id",(o,e,r)=>{ve.authenticated(o,e,r)},L.single("logo"),async(o,e)=>{let{updateInternationalScientificCongressPartnerController:r}=pd();await r.handle(o,e)});Y.delete("/partner/:id",(o,e,r)=>{ve.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressPartnerController:r}=dd();await r.handle(o,e)});import{Router as gh}from"express";import{extendZodWithOpenApi as lh}from"@asteasolutions/zod-to-openapi";import Ei from"zod";lh(Ei);var uh=Ei.object({role:Ei.string().optional(),orderBy:Ei.enum(["asc","desc"]).optional()}),xi=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let t=uh.parse(e.query),i=await this.legitimatorCommitteeMemberRepository.find({filter:t});r.status(200).json({members:i})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Mi=class{constructor(e){this.prisma=e}async create(e){await this.prisma.legitimatorCommitteeMember.create({data:{...e,order:e.order??0}})}async update(e){let{id:r,...t}=e;await this.prisma.legitimatorCommitteeMember.update({where:{id:r},data:t})}async deleteById(e){await this.prisma.legitimatorCommitteeMember.delete({where:{id:e}})}async find({filter:{role:e,orderBy:r}}){let t={};return e&&(t.role={contains:e,mode:"insensitive"}),await this.prisma.legitimatorCommitteeMember.findMany({where:t,include:{user:{omit:{passwordHash:!0}}},orderBy:r?[{order:"asc"},{updatedAt:r}]:[{order:"asc"},{updatedAt:"desc"}]})}async findById(e){return await this.prisma.legitimatorCommitteeMember.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{role:e}}){let r={};return e&&(r.role={contains:e,mode:"insensitive"}),await this.prisma.legitimatorCommitteeMember.count({where:r})}};function wt(){return new Mi(N)}function ld(){return{createLegitimatorCommitteeMemberController:new Nr(wt())}}function ud(){return{findLegitimatorCommitteeMembersController:new xi(wt())}}function gd(){return{findLegitimatorCommitteeMemberByIdController:new Lr(wt())}}function yd(){return{updateLegitimatorCommitteeMemberController:new _r(wt())}}function fd(){return{deleteLegitimatorCommitteeMemberController:new kr(wt())}}var tt=gh(),{authMiddleware:Sa}=G();tt.post("/",(o,e,r)=>{Sa.authenticated(o,e,r)},async(o,e)=>{let{createLegitimatorCommitteeMemberController:r}=ld();await r.handle(o,e)});tt.get("/",async(o,e)=>{let{findLegitimatorCommitteeMembersController:r}=ud();await r.handle(o,e)});tt.get("/:id",async(o,e)=>{let{findLegitimatorCommitteeMemberByIdController:r}=gd();await r.handle(o,e)});tt.put("/:id",(o,e,r)=>{Sa.authenticated(o,e,r)},async(o,e)=>{let{updateLegitimatorCommitteeMemberController:r}=yd();await r.handle(o,e)});tt.delete("/:id",(o,e,r)=>{Sa.authenticated(o,e,r)},async(o,e)=>{let{deleteLegitimatorCommitteeMemberController:r}=fd();await r.handle(o,e)});import{Router as hh}from"express";import{extendZodWithOpenApi as yh}from"@asteasolutions/zod-to-openapi";import Ht from"zod";yh(Ht);var fh=Ht.object({name:Ht.string().optional(),description:Ht.string().optional(),orderBy:Ht.enum(["asc","desc"]).default("desc")}),Pi=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let t=fh.parse(e.query),i=await this.managementTeamRepository.find({filter:t});r.status(200).json({teams:i})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Ti=class{constructor(e){this.prisma=e}async create(e){let{members:r,...t}=e;await this.prisma.$transaction(async i=>{let n=await i.managementTeam.create({data:t});return await i.managementTeamMember.createMany({data:r.map(({userId:a,role:m,order:c})=>({teamId:n.id,userId:a,role:m,order:c??0}))}),n})}async update(e){let{members:r,...t}=e;await this.prisma.$transaction(async i=>{let n=await i.managementTeam.update({where:{id:e.id},data:t});return r!==void 0&&(await i.managementTeamMember.deleteMany({where:{teamId:e.id}}),r.length>0&&await i.managementTeamMember.createMany({data:r.map(({userId:a,role:m,order:c})=>({teamId:e.id,userId:a,role:m,order:c??0}))})),n})}async deleteById(e){await this.prisma.managementTeam.delete({where:{id:e}})}async find({filter:{name:e,description:r,orderBy:t}}){let i={},n=[];return e&&n.push({name:{contains:e,mode:"insensitive"}}),r&&n.push({description:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.managementTeam.findMany({where:i,include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}},orderBy:{updatedAt:t}})}async findById(e){return await this.prisma.managementTeam.findFirst({where:{id:e},include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}}})}async findByName(e){return await this.prisma.managementTeam.findFirst({where:{name:e},include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}}})}async count({filter:{name:e,description:r}}){let t={},i=[];return e&&i.push({name:{contains:e,mode:"insensitive"}}),r&&i.push({description:{contains:r,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.managementTeam.count({where:t})}};function St(){return new Ti(N)}function hd(){return{createManagementTeamController:new Hr(St())}}function Rd(){return{findManagementTeamsController:new Pi(St())}}function Id(){return{findManagementTeamByIdController:new Wr(St())}}function Cd(){return{updateManagementTeamController:new Vr(St())}}function bd(){return{deleteManagementTeamController:new zr(St())}}var rt=hh(),{authMiddleware:va}=G();rt.post("/",(o,e,r)=>{va.authenticated(o,e,r)},async(o,e)=>{let{createManagementTeamController:r}=hd();await r.handle(o,e)});rt.get("/",async(o,e)=>{let{findManagementTeamsController:r}=Rd();await r.handle(o,e)});rt.get("/:id",async(o,e)=>{let{findManagementTeamByIdController:r}=Id();await r.handle(o,e)});rt.put("/:id",(o,e,r)=>{va.authenticated(o,e,r)},async(o,e)=>{let{updateManagementTeamController:r}=Cd();await r.handle(o,e)});rt.delete("/:id",(o,e,r)=>{va.authenticated(o,e,r)},async(o,e)=>{let{deleteManagementTeamController:r}=bd();await r.handle(o,e)});import{Router as Ch}from"express";var Ai=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.meeting.create({data:e})}async update(e){await this.prisma.meeting.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.meeting.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,format:i,status:n,orderBy:a}}){let m={},c=[];return i&&(m.format=i),n&&(m.status=n),t&&c.push({title:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.meeting.findMany({where:m,include:{minutes:!0},orderBy:a?{scheduledAt:a}:{scheduledAt:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.meeting.findFirst({where:{id:e},include:{minutes:!0}})}async findByStatus(e){return await this.prisma.meeting.findMany({where:{status:e},include:{minutes:!0}})}async count({filter:{title:e,format:r,status:t}}){let i={},n=[];return r&&(i.format=r),t&&(i.status=t),e&&n.push({title:{contains:e,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.meeting.count({where:i})}};function je(){return new Ai(N)}function wd(){return{createMeetingController:new Jr(je())}}function Sd(){return{findMeetingsController:new oo(je())}}function vd(){return{findMeetingByIdController:new eo(je())}}function jd(){return{findMeetingByStatusController:new ro(je())}}function Ed(){return{updateMeetingController:new io(je())}}function xd(){return{deleteMeetingController:new Qr(je())}}import{extendZodWithOpenApi as Rh}from"@asteasolutions/zod-to-openapi";import ja from"zod";Rh(ja);var Ih=ja.object({meetingId:ja.uuid()}),Di=class{constructor(e,r){this.meetingMinuteRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{meetingId:t}=Ih.parse({meetingId:e.params.meetingId}),i=await this.meetingMinuteRepository.findByMeetingId(t);if(!i)throw new l("A ata n\xE3o existe para esta reuni\xE3o.");return i.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl}),await this.meetingMinuteRepository.deleteByMeetingId(i.id),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Fi=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.meetingMinute.create({data:e,include:{meeting:!0}})}async update(e){await this.prisma.meetingMinute.update({where:{id:e.id},data:e})}async deleteByMeetingId(e){await this.prisma.meetingMinute.delete({where:{id:e}})}async findByMeetingId(e){return await this.prisma.meetingMinute.findFirst({where:{meetingId:e},include:{meeting:!0}})}};function zt(){return new Fi(N)}function Md(){return{createMeetingMinuteController:new Kr(zt(),je(),O())}}function Pd(){return{findMeetingMinuteByMeetingIdController:new Yr(zt())}}function Td(){return{updateMeetingMinuteByMeetingIdController:new Xr(zt(),O())}}function Ad(){return{deleteMeetingMinuteByMeetingIdController:new Di(zt(),O())}}var ae=Ch(),{authMiddleware:vt}=G();ae.post("/",(o,e,r)=>{vt.authenticated(o,e,r)},async(o,e)=>{let{createMeetingController:r}=wd();await r.handle(o,e)});ae.get("/",async(o,e)=>{let{findMeetingsController:r}=Sd();await r.handle(o,e)});ae.get("/:id",async(o,e)=>{let{findMeetingByIdController:r}=vd();await r.handle(o,e)});ae.get("/status/:status",async(o,e)=>{let{findMeetingByStatusController:r}=jd();await r.handle(o,e)});ae.put("/:id",(o,e,r)=>{vt.authenticated(o,e,r)},async(o,e)=>{let{updateMeetingController:r}=Ed();await r.handle(o,e)});ae.delete("/:id",(o,e,r)=>{vt.authenticated(o,e,r)},async(o,e)=>{let{deleteMeetingController:r}=xd();await r.handle(o,e)});ae.post("/:meetingId/minute",(o,e,r)=>{vt.authenticated(o,e,r)},L.single("document"),async(o,e)=>{let{createMeetingMinuteController:r}=Md();await r.handle(o,e)});ae.get("/:meetingId/minute",async(o,e)=>{let{findMeetingMinuteByMeetingIdController:r}=Pd();await r.handle(o,e)});ae.put("/:meetingId/minute",(o,e,r)=>{vt.authenticated(o,e,r)},L.single("document"),async(o,e)=>{let{updateMeetingMinuteByMeetingIdController:r}=Td();await r.handle(o,e)});ae.delete("/:meetingId/minute",(o,e,r)=>{vt.authenticated(o,e,r)},async(o,e)=>{let{deleteMeetingMinuteByMeetingIdController:r}=Ad();await r.handle(o,e)});import{Router as Mh}from"express";import{extendZodWithOpenApi as bh}from"@asteasolutions/zod-to-openapi";import Ea from"zod";bh(Ea);var wh=Ea.object({id:Ea.string()}),Ui=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=wh.parse(e.params),i=e.user.id,n=await this.newsRepository.findById(t);if(!n)throw new l("Not\xEDcia n\xE3o encontrada.");if(n.author.id!==i)throw new oe("Sem permiss\xE3o.");await Promise.all([this.newsRepository.delete(t),this.firebaseStorageService.deleteFile({fileUrl:n.imageUrl})]),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Sh}from"@asteasolutions/zod-to-openapi";import jt from"zod";var vh=5,Dd=1024,jh=Dd*Dd,Eh=vh*jh;Sh(jt);var xh=jt.object({id:jt.string(),title:jt.string().min(1),content:jt.string().min(1),image:jt.any().optional().refine(o=>!o||typeof o=="object"&&typeof o.mimetype=="string"&&o.mimetype.startsWith("image/")&&typeof o.size=="number"&&o.size<=Eh,"A imagem deve ser uma imagem v\xE1lida de no m\xE1ximo 5MB.")}),qi=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,title:i,content:n,image:a}=xh.parse({id:e.params.id,image:e.file,...e.body}),m=await this.newsRepository.findById(t);if(!m)throw new l("Not\xEDcia n\xE3o encontrada.");let c=e.user.id;if(m.author.id!==c)throw new oe("Sem permiss\xE3o.");let g=m.imageUrl||"";a&&m.imageUrl&&(g=await this.firebaseStorageService.updateFile({file:a,folder:D.NEWS,id:t,fileUrl:m.imageUrl}));let T=await this.newsRepository.update({id:t,title:i,content:n,imageUrl:g});r.status(200).json(T)}catch(t){if(t instanceof Error)throw new s(t.message)}}};function Fd(){return{createNewsController:new no(be(),O())}}function Ud(){return{findAllNewsController:new co(be())}}function qd(){return{findNewsByIdController:new mo(be())}}function Bd(){return{findNewsByAuthorIdController:new so(be())}}function Od(){return{updateNewsController:new qi(be(),O())}}function Nd(){return{deleteNewsController:new Ui(be(),O())}}var _e=Mh(),{authMiddleware:xa}=G();_e.post("/",(o,e,r)=>{xa.authenticated(o,e,r)},L.single("image"),async(o,e)=>{let{createNewsController:r}=Fd();await r.handle(o,e)});_e.get("/",async(o,e)=>{let{findAllNewsController:r}=Ud();await r.handle(o,e)});_e.get("/:id",async(o,e)=>{let{findNewsByIdController:r}=qd();await r.handle(o,e)});_e.get("/author/:authorId",async(o,e)=>{let{findNewsByAuthorIdController:r}=Bd();await r.handle(o,e)});_e.put("/:id",(o,e,r)=>{xa.authenticated(o,e,r)},L.single("image"),async(o,e)=>{let{updateNewsController:r}=Od();await r.handle(o,e)});_e.delete("/:id",(o,e,r)=>{xa.authenticated(o,e,r)},async(o,e)=>{let{deleteNewsController:r}=Nd();await r.handle(o,e)});import{Router as Ph}from"express";var Bi=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.partner.create({data:e})}async update(e){await this.prisma.partner.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.partner.delete({where:{id:e}})}async find({pagination:e,filter:{name:r,description:t,category:i,isActive:n,orderBy:a}}){let m={},c=[];return n!==void 0&&(m.isActive=n),r&&c.push({name:{contains:r,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),i&&c.push({category:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.partner.findMany({where:m,orderBy:a?{updatedAt:a}:{updatedAt:"desc"},...e&&{skip:e.offset,take:e.limit}})}async findById(e){return await this.prisma.partner.findFirst({where:{id:e}})}async count({filter:{name:e,description:r,category:t,isActive:i}}){let n={},a=[];return i!==void 0&&(n.isActive=i),e&&a.push({name:{contains:e,mode:"insensitive"}}),r&&a.push({description:{contains:r,mode:"insensitive"}}),t&&a.push({category:{contains:t,mode:"insensitive"}}),a.length>0&&(n.OR=a),await this.prisma.partner.count({where:n})}};function Et(){return new Bi(N)}function kd(){return{createPartnerController:new po(Et(),O())}}function Ld(){return{findPartnersController:new yo(Et())}}function Gd(){return{findPartnerByIdController:new uo(Et())}}function _d(){return{updatePartnerController:new fo(Et(),O())}}function Hd(){return{deletePartnerController:new lo(Et(),O())}}var ot=Ph(),{authMiddleware:Ma}=G();ot.post("/",(o,e,r)=>{Ma.authenticated(o,e,r)},L.single("logo"),async(o,e)=>{let{createPartnerController:r}=kd();await r.handle(o,e)});ot.get("/",async(o,e)=>{let{findPartnersController:r}=Ld();await r.handle(o,e)});ot.get("/:id",async(o,e)=>{let{findPartnerByIdController:r}=Gd();await r.handle(o,e)});ot.put("/:id",(o,e,r)=>{Ma.authenticated(o,e,r)},L.single("logo"),async(o,e)=>{let{updatePartnerController:r}=_d();await r.handle(o,e)});ot.delete("/:id",(o,e,r)=>{Ma.authenticated(o,e,r)},async(o,e)=>{let{deletePartnerController:r}=Hd();await r.handle(o,e)});import{Router as Th}from"express";function zd(){return{createPendencyController:new ho(te(),Le(),O())}}function Wd(){return{findPendenciesController:new Co(Le())}}function Zd(){return{findPendencyByIdController:new bo(Le())}}function Vd(){return{updatePendencyController:new wo(Le(),O())}}function Kd(){return{deletePendencyController:new Io(Le(),O())}}var it=Th(),{authMiddleware:Wt}=G();it.post("/:user_id",(o,e,r)=>{Wt.isAdmin(o,e,r)},L.single("document"),async(o,e)=>{let{createPendencyController:r}=zd();await r.handle(o,e)});it.get("/",(o,e,r)=>{Wt.isAdmin(o,e,r)},async(o,e)=>{let{findPendenciesController:r}=Wd();await r.handle(o,e)});it.get("/:pendency_id",(o,e,r)=>{Wt.isAdmin(o,e,r)},async(o,e)=>{let{findPendencyByIdController:r}=Zd();await r.handle(o,e)});it.put("/:pendency_id",(o,e,r)=>{Wt.isAdmin(o,e,r)},L.single("document"),async(o,e)=>{let{updatePendencyController:r}=Vd();await r.handle(o,e)});it.delete("/:pendency_id",(o,e,r)=>{Wt.isAdmin(o,e,r)},async(o,e)=>{let{deletePendencyController:r}=Kd();await r.handle(o,e)});import{Router as Ah}from"express";var Oi=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.regiment.create({data:e})}async update(e){await this.prisma.regiment.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.regiment.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,status:i,orderBy:n}}){let a={},m=[];return i&&(a.status=i),t&&m.push({title:{contains:t,mode:"insensitive"}}),m.length>0&&(a.OR=m),await this.prisma.regiment.findMany({where:a,orderBy:n?{updatedAt:n}:{updatedAt:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.regiment.findFirst({where:{id:e}})}async findByStatus(e){return await this.prisma.regiment.findMany({where:{status:e}})}async count({filter:{title:e,status:r}}){let t={},i=[];return r&&(t.status=r),e&&i.push({title:{contains:e,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.regiment.count({where:t})}};function nt(){return new Oi(N)}function Yd(){return{createRegimentController:new vo(nt(),O())}}function Xd(){return{findRegimentsController:new Po(nt())}}function $d(){return{findRegimentByIdController:new Eo(nt())}}function Jd(){return{findRegimentByStatusController:new Mo(nt())}}function Qd(){return{updateRegimentController:new To(nt(),O())}}function el(){return{deleteRegimentController:new jo(nt(),O())}}var He=Ah(),{authMiddleware:Pa}=G();He.post("/",(o,e,r)=>{Pa.authenticated(o,e,r)},L.single("document"),async(o,e)=>{let{createRegimentController:r}=Yd();await r.handle(o,e)});He.get("/",async(o,e)=>{let{findRegimentsController:r}=Xd();await r.handle(o,e)});He.get("/:id",async(o,e)=>{let{findRegimentByIdController:r}=$d();await r.handle(o,e)});He.get("/status/:status",async(o,e)=>{let{findRegimentByStatusController:r}=Jd();await r.handle(o,e)});He.put("/:id",(o,e,r)=>{Pa.authenticated(o,e,r)},L.single("document"),async(o,e)=>{let{updateRegimentController:r}=Qd();await r.handle(o,e)});He.delete("/:id",(o,e,r)=>{Pa.authenticated(o,e,r)},async(o,e)=>{let{deleteRegimentController:r}=el();await r.handle(o,e)});import{Router as Bh}from"express";import{extendZodWithOpenApi as Dh}from"@asteasolutions/zod-to-openapi";import Ta from"zod";Dh(Ta);var Fh=Ta.object({id:Ta.string().uuid("ID inv\xE1lido")}),Ni=class{constructor(e){this.regionalCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=Fh.parse(e.params),i=await this.regionalCongressGalleryRepository.findById(t);if(!i)throw new l("Item de galeria n\xE3o encontrado");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var ki=class{constructor(e){this.prisma=e}async create(e){await this.prisma.regionalCongress.create({data:e})}async update(e){await this.prisma.regionalCongress.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.regionalCongress.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,edition:i,location:n,orderBy:a}}){let m={},c=[];return i&&c.push({edition:{equals:i}}),t&&c.push({title:{contains:t,mode:"insensitive"}}),n&&c.push({location:{contains:n,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.regionalCongress.findMany({where:m,include:{regionalCongressPartners:!0,regionalCongressGalleryItems:!0},orderBy:a?{startDate:a}:{startDate:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.regionalCongress.findFirst({where:{id:e},include:{regionalCongressPartners:!0,regionalCongressGalleryItems:!0}})}async findByEdition(e){return await this.prisma.regionalCongress.findMany({where:{edition:e},include:{regionalCongressPartners:!0,regionalCongressGalleryItems:!0}})}async count({filter:{title:e,edition:r,location:t}}){let i={},n=[];return r&&n.push({edition:{equals:r}}),e&&n.push({title:{contains:e,mode:"insensitive"}}),t&&n.push({location:{contains:t,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.regionalCongress.count({where:i})}};function le(){return new ki(N)}var Li=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.regionalCongressGalleryItem.create({data:e})}async update(e){await this.prisma.regionalCongressGalleryItem.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.regionalCongressGalleryItem.delete({where:{id:e}})}async findByCongressId({pagination:e,filter:r}){return await this.prisma.regionalCongressGalleryItem.findMany({where:{congressId:r.congressId,...r.caption&&{caption:{contains:r.caption,mode:"insensitive"}}},skip:e.offset,take:e.limit})}async findById(e){return await this.prisma.regionalCongressGalleryItem.findFirst({where:{id:e}})}async count({filter:e}){return await this.prisma.regionalCongressGalleryItem.count({where:{congressId:e.congressId,...e.caption&&{caption:{contains:e.caption,mode:"insensitive"}}}})}};function xt(){return new Li(N)}function tl(){return{createRegionalCongressGalleryController:new Ao(xt(),le(),O())}}function rl(){return{findRegionalCongressGalleriesByCongressIdController:new Uo(xt())}}function ol(){return{findRegionalCongressGalleryByIdController:new Ni(xt())}}function il(){return{updateRegionalCongressGalleryController:new qo(xt(),O())}}function nl(){return{deleteRegionalCongressGalleryController:new Do(xt())}}import{extendZodWithOpenApi as Uh}from"@asteasolutions/zod-to-openapi";import Aa from"zod";Uh(Aa);var qh=Aa.object({id:Aa.string().uuid("ID inv\xE1lido")}),Gi=class{constructor(e){this.regionalCongressPartnerRepository=e}async handle(e,r){try{let{id:t}=qh.parse(e.params),i=await this.regionalCongressPartnerRepository.findById(t);if(!i)throw new l("Parceiro n\xE3o encontrado");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var _i=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.regionalCongressPartner.create({data:e})}async update(e){await this.prisma.regionalCongressPartner.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.regionalCongressPartner.delete({where:{id:e}})}async findByCongressId(e){return await this.prisma.regionalCongressPartner.findMany({where:{congressId:e.filter.congressId,name:e.filter.name?{contains:e.filter.name,mode:"insensitive"}:void 0},skip:e.pagination?.offset,take:e.pagination?.limit})}async findById(e){return await this.prisma.regionalCongressPartner.findFirst({where:{id:e}})}async count(e){return await this.prisma.regionalCongressPartner.count({where:{congressId:e.filter.congressId,name:e.filter.name?{contains:e.filter.name,mode:"insensitive"}:void 0}})}};function Mt(){return new _i(N)}function sl(){return{createRegionalCongressPartnerController:new Bo(Mt(),le(),O())}}function al(){return{findRegionalCongressPartnersByCongressIdController:new ko(Mt())}}function ml(){return{findRegionalCongressPartnerByIdController:new Gi(Mt())}}function cl(){return{updateRegionalCongressPartnerController:new Lo(Mt(),O())}}function pl(){return{deleteRegionalCongressPartnerController:new Oo(Mt())}}function dl(){return{createRegionalCongressController:new Go(le())}}function ll(){return{findRegionalCongressesController:new Zo(le())}}function ul(){return{findRegionalCongressByIdController:new zo(le())}}function gl(){return{findRegionalCongressByEditionController:new Ho(le())}}function yl(){return{updateRegionalCongressController:new Vo(le())}}function fl(){return{deleteRegionalCongressController:new _o(le())}}var X=Bh(),{authMiddleware:Ee}=G();X.post("/",(o,e,r)=>{Ee.authenticated(o,e,r)},async(o,e)=>{let{createRegionalCongressController:r}=dl();await r.handle(o,e)});X.get("/",async(o,e)=>{let{findRegionalCongressesController:r}=ll();await r.handle(o,e)});X.get("/:id",async(o,e)=>{let{findRegionalCongressByIdController:r}=ul();await r.handle(o,e)});X.get("/edition/:edition",async(o,e)=>{let{findRegionalCongressByEditionController:r}=gl();await r.handle(o,e)});X.put("/:id",(o,e,r)=>{Ee.authenticated(o,e,r)},async(o,e)=>{let{updateRegionalCongressController:r}=yl();await r.handle(o,e)});X.delete("/:id",(o,e,r)=>{Ee.authenticated(o,e,r)},async(o,e)=>{let{deleteRegionalCongressController:r}=fl();await r.handle(o,e)});X.post("/:congressId/gallery",(o,e,r)=>{Ee.authenticated(o,e,r)},L.single("image"),async(o,e)=>{let{createRegionalCongressGalleryController:r}=tl();await r.handle(o,e)});X.get("/:congressId/gallery",async(o,e)=>{let{findRegionalCongressGalleriesByCongressIdController:r}=rl();await r.handle(o,e)});X.get("/gallery/:id",async(o,e)=>{let{findRegionalCongressGalleryByIdController:r}=ol();await r.handle(o,e)});X.put("/gallery/:id",(o,e,r)=>{Ee.authenticated(o,e,r)},L.single("image"),async(o,e)=>{let{updateRegionalCongressGalleryController:r}=il();await r.handle(o,e)});X.delete("/gallery/:id",(o,e,r)=>{Ee.authenticated(o,e,r)},async(o,e)=>{let{deleteRegionalCongressGalleryController:r}=nl();await r.handle(o,e)});X.post("/:congressId/partner",(o,e,r)=>{Ee.authenticated(o,e,r)},L.single("logo"),async(o,e)=>{let{createRegionalCongressPartnerController:r}=sl();await r.handle(o,e)});X.get("/:congressId/partner",async(o,e)=>{let{findRegionalCongressPartnersByCongressIdController:r}=al();await r.handle(o,e)});X.get("/partner/:id",async(o,e)=>{let{findRegionalCongressPartnerByIdController:r}=ml();await r.handle(o,e)});X.put("/partner/:id",(o,e,r)=>{Ee.authenticated(o,e,r)},L.single("logo"),async(o,e)=>{let{updateRegionalCongressPartnerController:r}=cl();await r.handle(o,e)});X.delete("/partner/:id",(o,e,r)=>{Ee.authenticated(o,e,r)},async(o,e)=>{let{deleteRegionalCongressPartnerController:r}=pl();await r.handle(o,e)});import{Router as Gh}from"express";import{extendZodWithOpenApi as Oh}from"@asteasolutions/zod-to-openapi";import ee from"zod";var Nh=1,kh=9;Oh(ee);var Lh=ee.object({page:ee.coerce.number().min(1).default(Nh),limit:ee.coerce.number().min(1).default(kh),userId:ee.string().optional(),registrationNumber:ee.string().optional(),name:ee.string().optional(),emailAddress:ee.string().optional(),mainEtps:ee.string().optional(),formations:ee.string().optional(),occupations:ee.string().optional(),institutions:ee.string().optional(),biography:ee.string().optional(),orderBy:ee.enum(["asc","desc"]).default("desc")}),Hi=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Lh.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.researcherRepository.find({pagination:{offset:a,limit:i},filter:{userName:n.name,...n}}),this.researcherRepository.count({filter:{userName:n.name,...n}})]),g=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:g,offset:a,limit:i,researchers:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var zi=class{constructor(e){this.prisma=e}async create(e){await this.prisma.researcher.create({data:e})}async update(e){await this.prisma.researcher.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.researcher.delete({where:{id:e}})}async find({pagination:e,filter:{biography:r,degrees:t,formations:i,institutions:n,mainEtps:a,occupations:m,orderBy:c,registrationNumber:g,seniority:T,userId:k,userName:z}}){let J={},fe=[];return z&&fe.push({user:{name:{contains:z,mode:"insensitive"}}}),g&&fe.push({registrationNumber:{contains:g,mode:"insensitive"}}),a&&fe.push({mainEtps:{contains:a,mode:"insensitive"}}),i&&fe.push({formations:{contains:i,mode:"insensitive"}}),m&&fe.push({occupations:{contains:m,mode:"insensitive"}}),n&&fe.push({institutions:{contains:n,mode:"insensitive"}}),r&&fe.push({biography:{contains:r,mode:"insensitive"}}),fe.length>0&&(J.OR=fe),t&&t.length>0&&(J.degrees={hasSome:t}),T&&(J.seniority=T),k&&(J.userId={equals:k}),await this.prisma.researcher.findMany({where:J,omit:{userId:!0},include:{user:{omit:{passwordHash:!0}}},orderBy:{updatedAt:c},...e&&{skip:e.offset,take:e.limit}})}async findById(e){return await this.prisma.researcher.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async findByUserId(e){return await this.prisma.researcher.findFirst({where:{userId:e},include:{user:{omit:{passwordHash:!0}}}})}async findByRegistrationNumber(e){return await this.prisma.researcher.findFirst({where:{registrationNumber:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{biography:e,degrees:r,formations:t,institutions:i,mainEtps:n,occupations:a,registrationNumber:m,seniority:c,userId:g,userName:T}}){let k={},z=[];return T&&z.push({user:{name:{contains:T,mode:"insensitive"}}}),m&&z.push({registrationNumber:{contains:m,mode:"insensitive"}}),z.length>0&&(k.OR=z),n&&(k.mainEtps={contains:n,mode:"insensitive"}),t&&(k.formations={contains:t,mode:"insensitive"}),r&&r.length>0&&(k.degrees={hasSome:r}),a&&(k.occupations={contains:a,mode:"insensitive"}),c&&(k.seniority=c),i&&(k.institutions={contains:i,mode:"insensitive"}),e&&(k.biography={contains:e,mode:"insensitive"}),g&&(k.userId={equals:g}),await this.prisma.researcher.count({where:k})}};function st(){return new zi(N)}function hl(){return{createResearcherController:new Ko(st())}}function Rl(){return{findResearchersController:new Hi(st())}}function Il(){return{findResearcherByIdController:new Xo(st())}}function Cl(){return{findResearcherByUserIdController:new Jo(st())}}function bl(){return{updateResearcherController:new Qo(st())}}function wl(){return{deleteResearcherController:new Yo(st())}}var ze=Gh(),{authMiddleware:Da}=G();ze.post("/",(o,e,r)=>{Da.authenticated(o,e,r)},async(o,e)=>{let{createResearcherController:r}=hl();await r.handle(o,e)});ze.get("/",async(o,e)=>{let{findResearchersController:r}=Rl();await r.handle(o,e)});ze.get("/:id",async(o,e)=>{let{findResearcherByIdController:r}=Il();await r.handle(o,e)});ze.get("/user/:userId",async(o,e)=>{let{findResearcherByUserIdController:r}=Cl();await r.handle(o,e)});ze.put("/:id",(o,e,r)=>{Da.authenticated(o,e,r)},async(o,e)=>{let{updateResearcherController:r}=bl();await r.handle(o,e)});ze.delete("/:id",(o,e,r)=>{Da.authenticated(o,e,r)},async(o,e)=>{let{deleteResearcherController:r}=wl();await r.handle(o,e)});import{Router as zh}from"express";import{extendZodWithOpenApi as _h}from"@asteasolutions/zod-to-openapi";import Wi from"zod";_h(Wi);var Hh=Wi.object({role:Wi.string().optional(),orderBy:Wi.enum(["asc","desc"]).optional()}),Zi=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let t=Hh.parse(e.query),i=await this.sdhcTeamMemberRepository.find({filter:t});r.status(200).json({members:i})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Vi=class{constructor(e){this.prisma=e}async create(e){await this.prisma.sDHCTeamMember.create({data:{...e,order:e.order??0}})}async update(e){let{id:r,...t}=e;await this.prisma.sDHCTeamMember.update({where:{id:r},data:t})}async deleteById(e){await this.prisma.sDHCTeamMember.delete({where:{id:e}})}async find({filter:{role:e,orderBy:r}}){let t={};return e&&(t.role={contains:e,mode:"insensitive"}),await this.prisma.sDHCTeamMember.findMany({where:t,include:{user:{omit:{passwordHash:!0}}},orderBy:r?[{order:"asc"},{updatedAt:r}]:[{order:"asc"},{updatedAt:"desc"}]})}async findById(e){return await this.prisma.sDHCTeamMember.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{role:e}}){let r={};return e&&(r.role={contains:e,mode:"insensitive"}),await this.prisma.sDHCTeamMember.count({where:r})}};function Pt(){return new Vi(N)}function Sl(){return{createSDHCTeamMemberController:new ei(Pt())}}function vl(){return{findSDHCTeamMembersController:new Zi(Pt())}}function jl(){return{findSDHCTeamMemberByIdController:new ri(Pt())}}function El(){return{updateSDHCTeamMemberController:new ii(Pt())}}function xl(){return{deleteSDHCTeamMemberController:new ti(Pt())}}var at=zh(),{authMiddleware:Fa}=G();at.post("/",(o,e,r)=>{Fa.authenticated(o,e,r)},async(o,e)=>{let{createSDHCTeamMemberController:r}=Sl();await r.handle(o,e)});at.get("/",async(o,e)=>{let{findSDHCTeamMembersController:r}=vl();await r.handle(o,e)});at.get("/:id",async(o,e)=>{let{findSDHCTeamMemberByIdController:r}=jl();await r.handle(o,e)});at.put("/:id",(o,e,r)=>{Fa.authenticated(o,e,r)},async(o,e)=>{let{updateSDHCTeamMemberController:r}=El();await r.handle(o,e)});at.delete("/:id",(o,e,r)=>{Fa.authenticated(o,e,r)},async(o,e)=>{let{deleteSDHCTeamMemberController:r}=xl();await r.handle(o,e)});import{Router as Wh}from"express";var Ki=class{constructor(e){this.userRepository=e}async handle(e,r){try{let t=await this.userRepository.find();r.status(200).json(t)}catch(t){if(t instanceof Error)throw new s(t.message)}}};function Ml(){return{updateUserController:new ai(te(),O())}}function Pl(){return{deleteUserController:new ni(te())}}function Tl(){return{findUsersController:new Ki(te())}}function Al(){return{findUserController:new si(te())}}var Tt=Wh(),{authMiddleware:Dl}=G();Tt.get("/:id",async(o,e)=>{let{findUserController:r}=Al();await r.handle(o,e)});Tt.put("/",(o,e,r)=>{Dl.authenticated(o,e,r)},L.single("avatarImage"),async(o,e)=>{let{updateUserController:r}=Ml();await r.handle(o,e)});Tt.delete("/:id",(o,e,r)=>{Dl.authenticated(o,e,r)},async(o,e)=>{let{deleteUserController:r}=Pl();await r.handle(o,e)});Tt.get("/",async(o,e)=>{let{findUsersController:r}=Tl();await r.handle(o,e)});var W=Ua(),Kh={methods:["GET","POST","PUT","DELETE"],origin:["http://localhost:3000","https://rede-ct.vercel.app"],credentials:!0};W.use(Vh(Kh));W.use(Ua.json());W.use(Ua.urlencoded({extended:!1}));W.use("/docs",Zh({content:Sp,theme:"kepler"}));W.use("/",Ca);W.use("/auth",we);W.use("/user",Tt);W.use("/news",_e);W.use("/certification",Je);W.use("/pendency",it);W.use("/researcher",ze);W.use("/in-memoriam",Ge);W.use("/etp",Qe);W.use("/partner",ot);W.use("/management-team",rt);W.use("/sdhc-team-member",at);W.use("/legitimator-committee-member",tt);W.use("/regiment",He);W.use("/meeting",ae);W.use("/international-scientific-congress",Y);W.use("/regional-congress",X);W.use((o,e,r,t)=>{let{errorHandler:i}=qa();i.handle(o,e,r,t)});var Xh=Yh.createServer(W),Fl=4e3;Xh.listen(Fl,()=>{console.log(`\u{1F680} Aplica\xE7\xE3o rodando na porta ${Fl}.`)});

import If from"node:http";import{apiReference as yf}from"@scalar/express-api-reference";import hf from"cors";import Jn from"express";import Zc from"zod";var z=class extends Error{};var L=class extends Error{};var a=class extends Error{};var p=class extends Error{};var V=class extends Error{};import{ZodError as Gc}from"zod";var Ct=class extends Gc{};var St=class{handle(e,r,t,i){return e instanceof Ct?t.status(400).json({message:"Validation error",error:Zc.treeifyError(e)}):e instanceof z?t.status(400).json({message:e.message}):e instanceof p?t.status(404).json({message:e.message}):e instanceof V?t.status(401).json({message:e.message}):e instanceof L?t.status(409).json({message:e.message}):e instanceof a?t.status(500).json({message:e.message}):t.status(500).json({message:"Internal server error"})}};function Qn(){return{errorHandler:new St}}import{OpenAPIRegistry as Lu,OpenApiGeneratorV3 as _u}from"@asteasolutions/zod-to-openapi";import{$Enums as es}from"@prisma/client";import u from"zod";import{extendZodWithOpenApi as Kc}from"@asteasolutions/zod-to-openapi";import Ae from"zod";var Vc=1,Yc=6;Kc(Ae);var Vo=Ae.object({page:Ae.coerce.number().min(1).default(Vc),limit:Ae.coerce.number().min(1).default(Yc),title:Ae.string().optional(),description:Ae.string().optional(),orderBy:Ae.enum(["asc","desc"]).default("desc")}),Mt=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{title:t,description:i,limit:n,orderBy:s,page:m}=Vo.parse(e.query),c=m*n-n,d=e.user.id,[T,P]=await Promise.all([this.certificationRepository.findByUserId({userId:d,pagination:{offset:c,limit:n},filter:{title:t,description:i,orderBy:s}}),this.certificationRepository.count({filter:{title:t,description:i,userId:d}})]),O=Math.max(Math.ceil(P/n),1);return r.status(200).json({page:m,totalPages:O,offset:c,limit:n,totalCertifications:P,certifications:T})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as $c}from"@asteasolutions/zod-to-openapi";import Ue from"zod";var Xc=1,Jc=7;$c(Ue);var Yo=Ue.object({page:Ue.coerce.number().min(1).default(Xc),limit:Ue.coerce.number().min(1).default(Jc),title:Ue.string().optional(),content:Ue.string().optional(),orderBy:Ue.enum(["asc","desc"]).default("desc")}),Et=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,content:n,orderBy:s,title:m}=Yo.parse(e.query),c=i*t-i,d=e.user.id,[T,P]=await Promise.all([this.newsRepository.findByAuthorId({authorId:d,pagination:{offset:c,limit:i},filter:{orderBy:s,title:m,content:n}}),this.newsRepository.count({filter:{authorId:d,content:n,title:m}})]),O=Math.ceil(P/i);r.status(200).json({page:t,totalPages:O,offset:c,limit:i,news:T})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Qc}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as ep}from"@prisma/client";import ge from"zod";var tp=1,rp=6;Qc(ge);var $o=ge.object({page:ge.coerce.number().min(1).default(tp),limit:ge.coerce.number().min(1).default(rp),title:ge.string().optional(),description:ge.string().optional(),status:ge.enum(ep).default("PENDING"),orderBy:ge.enum(["asc","desc"]).default("desc")}),vt=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{limit:t,page:i,...n}=$o.parse(e.query),s=i*t-t,m=e.user.id,[c,d]=await Promise.all([this.pendencyRepository.findByUserId({userId:m,pagination:{offset:s,limit:t},filter:n}),this.pendencyRepository.count({filter:{...n,userId:m}})]),T=Math.max(Math.ceil(d/t),1);return r.status(200).json({page:i,totalPages:T,offset:s,limit:t,pendencies:c})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as op}from"@asteasolutions/zod-to-openapi";import jt from"zod";op(jt);var Xo=jt.object({password:jt.string(),email:jt.email()}),xt=class{constructor(e,r,t){this.userRepository=e;this.bcrypt=r;this.jwtService=t}async handle(e,r){try{let{email:t,password:i}=Xo.parse(e.body),n=await this.userRepository.findByEmail(t);if(!n)return r.status(401).json({message:"Usu\xE1rio n\xE3o existe."});if(!await this.bcrypt.compare({password:i,hashedPassword:n.passwordHash}))throw new V("Senha inv\xE1lida.");let{id:m,role:c}=n,d=this.jwtService.sign({id:m,role:c,email:t});return r.status(200).json({token:d})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ip}from"@asteasolutions/zod-to-openapi";import Ye from"zod";var Tt=8;ip(Ye);var Jo=Ye.object({name:Ye.string("Nome \xE9 obrigat\xF3rio.").min(1,"Nome \xE9 obrigat\xF3rio."),emailAddress:Ye.email("E-mail inv\xE1lido.").min(1,"E-mail \xE9 obrigat\xF3rio."),password:Ye.string("A senha \xE9 obrigat\xF3ria.").min(Tt,`A senha deve ter pelo menos ${Tt} caracteres.`),confirmPassword:Ye.string("A senha \xE9 obrigat\xF3ria.").min(Tt,`A senha deve ter pelo menos ${Tt} caracteres.`)}).refine(o=>o.password===o.confirmPassword,{message:"As senhas n\xE3o coincidem.",path:["confirmPassword"]}),Pt=class{constructor(e,r){this.userRepository=e;this.bcrypt=r}async handle(e,r){try{let{emailAddress:t,name:i,password:n}=Jo.parse(e.body);if(await this.userRepository.findByEmail(t))throw new L("Usu\xE1rio j\xE1 existe.");let m=await this.bcrypt.hash(n);return await this.userRepository.create({name:i,emailAddress:t,passwordHash:m}),r.status(201).json()}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ts={method:"post",path:"/auth/sign-up",tags:["Authentication"],summary:"Create a new user",request:{body:{content:{"application/json":{schema:Jo}}}},responses:{201:{description:"User created successfully",summary:"User Registration Successful",content:{"application/json":{schema:u.object({message:u.string()})}}},400:{description:"Invalid input data provided",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},409:{description:"User already exists with this email",summary:"User Already Exists",content:{"application/json":{schema:u.object({message:u.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},rs={method:"post",path:"/auth/sign-in",tags:["Authentication"],summary:"Sign in",request:{body:{content:{"application/json":{schema:Xo}}}},responses:{200:{description:"Authentication successful, JWT token returned",summary:"Login Successful",content:{"application/json":{schema:u.object({token:u.string()})}}},400:{description:"Invalid credentials or input data",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},401:{description:"Invalid email or password",summary:"Authentication Failed",content:{"application/json":{schema:u.object({message:u.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},os={method:"get",path:"/auth/user",tags:["Authentication"],summary:"Search for authenticated user",security:[{bearerAuth:[]}],responses:{200:{description:"Authenticated user information retrieved successfully",summary:"User Information Retrieved",content:{"application/json":{schema:u.object({name:u.string(),id:u.string(),avatarUrl:u.string().nullable(),createdAt:u.date(),updatedAt:u.date(),emailAddress:u.string(),orcid:u.string().nullable(),phone:u.string().nullable(),lattesUrl:u.string().nullable(),role:u.enum(es.UserRole)}).nullable()}}},400:{description:"Invalid request parameters",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},404:{description:"User not found or not authenticated",summary:"User Not Found",content:{"application/json":{schema:u.object({message:u.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},is={method:"get",path:"/auth/user/news",tags:["Authentication"],summary:"List authenticated user news",security:[{bearerAuth:[]}],request:{query:Yo},responses:{200:{description:"Paginated list of authenticated user news retrieved successfully",summary:"User News Retrieved",content:{"application/json":{schema:u.object({page:u.number(),totalPages:u.number(),offset:u.number(),limit:u.number(),news:u.object({content:u.string(),id:u.string(),title:u.string(),createdAt:u.date(),updatedAt:u.date(),imageUrl:u.string().nullable()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},ns={method:"get",path:"/auth/admin",tags:["Authentication"],summary:"Verify admin access",security:[{bearerAuth:[]}],responses:{200:{description:"Admin access verified successfully",summary:"Admin Access Granted",content:{"application/json":{schema:u.object({success:u.boolean()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},ss={method:"get",path:"/auth/certifications",tags:["Authentication"],summary:"List all authenticated user's certifications",security:[{bearerAuth:[]}],request:{query:Vo},responses:{200:{description:"Paginated list of authenticated user certifications retrieved successfully",summary:"User Certifications Retrieved",content:{"application/json":{schema:u.object({page:u.number(),totalPages:u.number(),offset:u.number(),limit:u.number(),certifications:u.object({description:u.string(),id:u.string(),title:u.string(),certificationUrl:u.string(),createdAt:u.date(),updatedAt:u.date(),userId:u.string()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},as={method:"get",path:"/auth/pendencies",tags:["Authentication"],summary:"List all authenticated user's pendencies",security:[{bearerAuth:[]}],request:{query:$o},responses:{200:{description:"Paginated list of authenticated user pendencies retrieved successfully",summary:"User Pendencies Retrieved",content:{"application/json":{schema:u.object({page:u.number(),totalPages:u.number(),offset:u.number(),limit:u.number(),pendencies:u.object({id:u.string(),title:u.string(),description:u.string(),status:u.enum(es.PendencyStatus),createdAt:u.date(),updatedAt:u.date(),userId:u.string()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}};import{$Enums as up}from"@prisma/client";import R from"zod";import{extendZodWithOpenApi as np}from"@asteasolutions/zod-to-openapi";import Qo from"zod";np(Qo);var ei=Qo.object({id:Qo.string()}),At=class{constructor(e,r){this.certificationRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=ei.parse({id:e.params.certification_id}),i=await this.certificationRepository.findById(t);if(!i)throw new p("A certifica\xE7\xE3o n\xE3o existe.");return await Promise.all([this.certificationRepository.deleteById(i.id),this.firebaseStorageService.deleteFile({fileUrl:i.certificationUrl})]),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as sp}from"@asteasolutions/zod-to-openapi";import ti from"zod";sp(ti);var ri=ti.object({certificationId:ti.uuid()}),Ut=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{certificationId:t}=ri.parse({certificationId:e.params.certification_id}),i=await this.certificationRepository.findById(t);if(!i)throw new p("Certificado n\xE3o encontrado.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ap}from"@asteasolutions/zod-to-openapi";import ye from"zod";var mp=1,cp=6;ap(ye);var oi=ye.object({page:ye.coerce.number().min(1).default(mp),limit:ye.coerce.number().min(1).default(cp),title:ye.string().optional(),description:ye.string().optional(),userId:ye.uuid().optional(),orderBy:ye.enum(["asc","desc"]).default("desc")}),Ft=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{limit:t,page:i,...n}=oi.parse(e.query),s=i*t-t,[m,c]=await Promise.all([this.certificationRepository.find({pagination:{offset:s,limit:t},filter:n}),this.certificationRepository.count({filter:n})]),d=Math.max(Math.ceil(c/t),1);return r.status(200).json({page:i,totalPages:d,offset:s,limit:t,certifications:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as pp}from"@asteasolutions/zod-to-openapi";import $e from"zod";var A={NEWS:"images/news",USER:"images/user",IN_MEMORIAM:"images/in-memoriam",PARTNER:"images/partners",CERTIFICATION:"documents/certifications",PENDENCY:"documents/pendencies",REGIMENT:"documents/regiments",MEETING_MINUTE:"documents/meeting-minutes",INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY:"images/international-scientific-congress-gallery"};pp($e);var qt=$e.object({userId:$e.uuid(),title:$e.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio."),description:$e.string().min(1,"Descri\xE7\xE3o \xE9 obrigat\xF3ria."),certification:$e.any().refine(o=>o&&typeof o=="object"&&o.size>0,"Arquivo do certificado \xE9 obrigat\xF3rio")}),Dt=class{constructor(e,r,t){this.userRepository=e;this.certificationRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{userId:t,title:i,description:n,certification:s}=qt.parse({...e.body,userId:e.params.user_id,certification:e.file});if(!await this.userRepository.findById(t))throw new z("O usu\xE1rio n\xE3o existe.");let c=await this.firebaseStorageService.uploadFile({file:s,id:t,folder:A.CERTIFICATION});return await this.certificationRepository.register({userId:t,title:i,description:n,certificationUrl:c}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as dp}from"@asteasolutions/zod-to-openapi";import Xe from"zod";dp(Xe);var Ot=Xe.object({id:Xe.uuid(),title:Xe.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio."),description:Xe.string().min(1,"Descri\xE7\xE3o \xE9 obrigat\xF3ria."),certification:Xe.any().refine(o=>o==null||typeof o=="object"&&typeof o.size=="number"&&(o.size===0||o.size>0),"Arquivo do certificado \xE9 inv\xE1lido").optional()}),Bt=class{constructor(e,r){this.certificationRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{certification:t,id:i,...n}=Ot.parse({...e.body,id:e.params.certification_id,certification:e.file}),s=await this.certificationRepository.findById(i);if(!s)throw new z("A certifica\xE7\xE3o n\xE3o existe");let m=s.certificationUrl;return t&&t.size>0&&(m=await this.firebaseStorageService.updateFile({file:t,id:s.userId,folder:A.CERTIFICATION,fileUrl:s.certificationUrl})),await this.certificationRepository.update({...n,id:i,certificationUrl:m}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ms={method:"post",path:"/certifications/{user_id}",tags:["Certifications"],summary:"Register certification for user",security:[{bearerAuth:[]}],request:{params:qt.pick({userId:!0}).transform(()=>({user_id:""})),body:{content:{"multipart/form-data":{schema:qt.omit({userId:!0})}}}},responses:{201:{description:"Certification registered successfully for the user",summary:"Certification Registered",content:{"application/json":{schema:R.object({message:R.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},404:{description:"User not found with the provided ID",summary:"User Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},cs={method:"get",path:"/certifications",tags:["Certifications"],summary:"List certifications",security:[{bearerAuth:[]}],request:{query:oi},responses:{200:{description:"Paginated list of certifications with user information retrieved successfully",summary:"Certifications Retrieved",content:{"application/json":{schema:R.object({page:R.number(),totalPages:R.number(),offset:R.number(),limit:R.number(),certifications:R.array(R.object({description:R.string(),userId:R.string(),title:R.string(),id:R.string(),createdAt:R.date(),updatedAt:R.date(),certificationUrl:R.url(),user:R.object({id:R.uuid(),name:R.string(),createdAt:R.date(),updatedAt:R.date(),avatarUrl:R.string().nullable(),emailAddress:R.email(),orcid:R.string().nullable(),phone:R.string().nullable(),lattesUrl:R.url().nullable(),role:R.enum(up.UserRole)})}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},ps={method:"get",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Find certification by ID",security:[{bearerAuth:[]}],request:{params:ri},responses:{200:{description:"Certification details retrieved successfully",summary:"Certification Retrieved",content:{"application/json":{schema:R.object({description:R.string(),userId:R.string(),title:R.string(),id:R.string(),createdAt:R.date(),updatedAt:R.date(),certificationUrl:R.url()}).nullable()}}},400:{description:"Invalid certification ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},ds={method:"put",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Update certification",security:[{bearerAuth:[]}],request:{params:Ot.pick({id:!0}).transform(()=>({certification_id:""})),body:{content:{"multipart/form-data":{schema:Ot.omit({id:!0})}}}},responses:{204:{description:"Certification updated successfully",summary:"Certification Updated"},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},us={method:"delete",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Delete certification",security:[{bearerAuth:[]}],request:{params:ei},responses:{204:{description:"Certification deleted successfully",summary:"Certification Deleted"},400:{description:"Invalid certification ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}};import{$Enums as ci}from"@prisma/client";import g from"zod";import{extendZodWithOpenApi as lp}from"@asteasolutions/zod-to-openapi";import Q from"zod";lp(Q);var ii=Q.object({code:Q.string(),title:Q.string(),description:Q.string().optional(),notes:Q.string().optional(),leaderId:Q.uuid(),deputyLeaderId:Q.uuid(),secretaryId:Q.uuid(),memberIds:Q.array(Q.uuid())}),Nt=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{code:t,title:i,description:n,notes:s,leaderId:m,deputyLeaderId:c,secretaryId:d,memberIds:T}=ii.parse(e.body);if(await this.etpRepository.findByCode(t))throw new L("J\xE1 existe um ETP cadastrado com este c\xF3digo.");return await this.etpRepository.create({code:t,title:i,description:n,notes:s,leaderId:m,deputyLeaderId:c,secretaryId:d,memberIds:T}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as fp}from"@asteasolutions/zod-to-openapi";import ni from"zod";fp(ni);var si=ni.object({id:ni.uuid()}),kt=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t}=si.parse({id:e.params.id});if(!await this.etpRepository.findById(t))throw new p("O ETP n\xE3o existe.");return await this.etpRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as gp}from"@asteasolutions/zod-to-openapi";import ai from"zod";gp(ai);var _t=ai.object({id:ai.uuid()}),Lt=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t}=_t.parse({id:e.params.id}),i=await this.etpRepository.findById(t);if(!i)throw new p("O ETP n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as yp}from"@asteasolutions/zod-to-openapi";import Y from"zod";yp(Y);var mi=Y.object({id:Y.uuid(),code:Y.string().optional(),title:Y.string().optional(),description:Y.string().optional(),notes:Y.string().optional(),leaderId:Y.uuid().optional(),deputyLeaderId:Y.uuid().optional(),secretaryId:Y.uuid().optional(),memberIds:Y.array(Y.uuid()).optional()}),Ht=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t,code:i,title:n,description:s,notes:m,leaderId:c,deputyLeaderId:d,secretaryId:T,memberIds:P}=mi.parse({id:e.params.id,...e.body});if(!await this.etpRepository.findById(t))throw new p("O ETP n\xE3o existe.");if(i){let H=await this.etpRepository.findByCode(i);if(H&&H.id!==t)throw new L("J\xE1 existe um ETP com este c\xF3digo.")}return await this.etpRepository.update({id:t,code:i,title:n,description:s,notes:m,leaderId:c,deputyLeaderId:d,secretaryId:T,memberIds:P}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var hp=1,Rp=9,zt=g.object({id:g.uuid(),registrationNumber:g.string(),mainEtps:g.string().nullable(),formations:g.string().nullable(),degrees:g.array(g.enum(ci.Degree)),occupations:g.string(),seniority:g.enum(ci.Seniority),institutions:g.string(),biography:g.string().nullable(),createdAt:g.date(),updatedAt:g.date(),user:g.object({id:g.uuid(),name:g.string(),emailAddress:g.string(),avatarUrl:g.string().nullable(),orcid:g.string().nullable(),phone:g.string().nullable(),lattesUrl:g.string().nullable(),role:g.enum(ci.UserRole)})}),ls=g.object({id:g.uuid(),code:g.string(),title:g.string(),description:g.string().nullable(),notes:g.string().nullable(),createdAt:g.date(),updatedAt:g.date(),leader:g.object({id:g.uuid(),researcher:zt}).nullable(),deputyLeader:g.object({id:g.uuid(),researcher:zt}).nullable(),secretary:g.object({id:g.uuid(),researcher:zt}).nullable(),members:g.array(zt)}),fs={method:"post",path:"/etp",tags:["ETPs"],summary:"Create a new ETP with single leader, deputy leader, secretary and multiple members",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:ii}}}},responses:{201:{description:"ETP created successfully",summary:"ETP Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:g.object({errors:g.record(g.string(),g.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:g.object({message:g.string()})}}},409:{description:"ETP with this code already exists",summary:"Conflict",content:{"application/json":{schema:g.object({message:g.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:g.object({message:g.string()})}}}}},gs={method:"get",path:"/etp",tags:["ETPs"],summary:"List all ETPs with pagination and filters",request:{query:g.object({page:g.coerce.number().min(1).default(hp).optional(),limit:g.coerce.number().min(1).default(Rp).optional(),code:g.string().optional(),title:g.string().optional(),description:g.string().optional(),notes:g.string().optional(),orderBy:g.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of ETPs retrieved successfully with pagination",summary:"ETPs Retrieved",content:{"application/json":{schema:g.object({page:g.number(),totalPages:g.number(),offset:g.number(),limit:g.number(),etps:g.array(ls)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:g.object({message:g.string()})}}}}},ys={method:"get",path:"/etp/{id}",tags:["ETPs"],summary:"Find ETP by ID",request:{params:_t},responses:{200:{description:"ETP details retrieved successfully",summary:"ETP Retrieved",content:{"application/json":{schema:ls}}},400:{description:"Invalid ETP ID format",summary:"Validation Error",content:{"application/json":{schema:g.object({errors:g.record(g.string(),g.string())})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:g.object({message:g.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:g.object({message:g.string()})}}}}},hs={method:"put",path:"/etp/{id}",tags:["ETPs"],summary:"Update ETP and manage user relationships (single leader, deputy leader, secretary, multiple members)",security:[{bearerAuth:[]}],request:{params:_t,body:{content:{"application/json":{schema:mi.omit({id:!0})}}}},responses:{200:{description:"ETP updated successfully",summary:"ETP Updated"},400:{description:"Invalid input data or ETP ID format",summary:"Validation Error",content:{"application/json":{schema:g.object({errors:g.record(g.string(),g.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:g.object({message:g.string()})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:g.object({message:g.string()})}}},409:{description:"ETP with this code already exists",summary:"Conflict",content:{"application/json":{schema:g.object({message:g.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:g.object({message:g.string()})}}}}},Rs={method:"delete",path:"/etp/{id}",tags:["ETPs"],summary:"Delete ETP",security:[{bearerAuth:[]}],request:{params:si},responses:{200:{description:"ETP deleted successfully",summary:"ETP Deleted"},400:{description:"Invalid ETP ID format",summary:"Validation Error",content:{"application/json":{schema:g.object({errors:g.record(g.string(),g.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:g.object({message:g.string()})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:g.object({message:g.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:g.object({message:g.string()})}}}}};import{InMemoriamRole as qp}from"@prisma/client";import b from"zod";import{extendZodWithOpenApi as Ip}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as bp}from"@prisma/client";import he from"zod";var bs=2,Is=1024,wp=Is*Is,Cp=bs*wp;Ip(he);var pi=he.object({name:he.string().min(1,"Nome \xE9 obrigat\xF3rio"),birthDate:he.coerce.date(),deathDate:he.coerce.date(),biography:he.string().optional(),photo:he.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Cp,`A imagem deve ter no m\xE1ximo ${bs}MB.`).optional(),role:he.enum(bp)}).refine(o=>o.deathDate>o.birthDate,{message:"Data de falecimento deve ser posterior \xE0 data de nascimento",path:["deathDate"]}),Wt=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{name:t,birthDate:i,deathDate:n,biography:s,role:m,photo:c}=pi.parse({...e.body,photo:e.file}),d=await this.inMemoriamRepository.create({name:t,birthDate:i,deathDate:n,biography:s??void 0,role:m}),T;return c&&(T=await this.firebaseStorageService.uploadFile({file:c,id:d.id,folder:A.IN_MEMORIAM}),await this.inMemoriamRepository.update({id:d.id,photoUrl:T})),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Sp}from"@asteasolutions/zod-to-openapi";import di from"zod";Sp(di);var ui=di.object({id:di.uuid()}),Gt=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=ui.parse({id:e.params.id}),i=await this.inMemoriamRepository.findById(t);if(!i)throw new p("O in memoriam n\xE3o existe.");return i.photoUrl&&this.firebaseStorageService.deleteFile({fileUrl:i.photoUrl}),await this.inMemoriamRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Mp}from"@asteasolutions/zod-to-openapi";import li from"zod";Mp(li);var Kt=li.object({id:li.uuid()}),Zt=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{id:t}=Kt.parse({id:e.params.id}),i=await this.inMemoriamRepository.findById(t);if(!i)throw new p("O in memoriam n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Ep}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as vp}from"@prisma/client";import fi from"zod";Ep(fi);var gi=fi.object({role:fi.enum(vp)}),Vt=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{role:t}=gi.parse({role:e.params.role}),i=await this.inMemoriamRepository.findByRole(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as jp}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as xp}from"@prisma/client";import Re from"zod";var Tp=1,Pp=9;jp(Re);var yi=Re.object({page:Re.coerce.number().min(1).default(Tp),limit:Re.coerce.number().min(1).default(Pp),name:Re.string().optional(),biography:Re.string().optional(),role:Re.enum(xp).optional(),orderBy:Re.enum(["asc","desc"]).default("desc")}),Yt=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=yi.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.inMemoriamRepository.find({pagination:{offset:s,limit:i},filter:n}),this.inMemoriamRepository.count({filter:n})]),d=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:d,offset:s,limit:i,inMemoriam:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Ap}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as Up}from"@prisma/client";import se from"zod";var Cs=2,ws=1024,Fp=ws*ws,Dp=Cs*Fp;Ap(se);var hi=se.object({id:se.uuid(),name:se.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),birthDate:se.coerce.date().optional(),deathDate:se.coerce.date().optional(),biography:se.string().optional(),photo:se.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Dp,`A imagem deve ter no m\xE1ximo ${Cs}MB.`).optional(),role:se.enum(Up).optional()}).refine(o=>o.birthDate&&o.deathDate?o.deathDate>o.birthDate:!0,{message:"Data de falecimento deve ser posterior \xE0 data de nascimento",path:["deathDate"]}),$t=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,birthDate:n,deathDate:s,biography:m,photo:c,role:d}=hi.parse({id:e.params.id,...e.body,photo:e.file}),T=await this.inMemoriamRepository.findById(t);if(!T)throw new p("O registro in memoriam n\xE3o existe.");let P=T.photoUrl;return c&&(P=await this.firebaseStorageService.uploadFile({file:c,id:t,folder:A.IN_MEMORIAM})),await this.inMemoriamRepository.update({id:t,name:i,birthDate:n,deathDate:s,biography:m,photoUrl:P??void 0,role:d}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Ri=b.object({id:b.uuid(),name:b.string(),birthDate:b.date(),deathDate:b.date(),biography:b.string().nullable(),photoUrl:b.string().nullable(),role:b.enum(qp),createdAt:b.date(),updatedAt:b.date()}),Ss={method:"post",path:"/in-memoriam",tags:["In Memoriam"],summary:"Create a new in memoriam record with optional photo upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:pi}}}},responses:{201:{description:"In memoriam record created successfully",summary:"In Memoriam Created"},400:{description:"Invalid input data, missing required fields, or invalid photo format/size",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},409:{description:"In memoriam record with this name already exists",summary:"Conflict",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},Ms={method:"get",path:"/in-memoriam",tags:["In Memoriam"],summary:"List all in memoriam records with pagination and filters",request:{query:yi},responses:{200:{description:"List of in memoriam records retrieved successfully with pagination",summary:"In Memoriam Records Retrieved",content:{"application/json":{schema:b.object({page:b.number(),totalPages:b.number(),offset:b.number(),limit:b.number(),inMemoriam:b.array(Ri)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},Es={method:"get",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Find in memoriam record by ID",request:{params:Kt},responses:{200:{description:"In memoriam record details retrieved successfully",summary:"In Memoriam Record Retrieved",content:{"application/json":{schema:Ri}}},400:{description:"Invalid in memoriam record ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},vs={method:"put",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Update in memoriam record with optional photo upload",security:[{bearerAuth:[]}],request:{params:Kt,body:{content:{"multipart/form-data":{schema:hi.omit({id:!0})}}}},responses:{200:{description:"In memoriam record updated successfully",summary:"In Memoriam Record Updated"},400:{description:"Invalid input data, in memoriam record ID format, or invalid photo format/size",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},409:{description:"In memoriam record with this name already exists",summary:"Conflict",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},js={method:"delete",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Delete in memoriam record",security:[{bearerAuth:[]}],request:{params:ui},responses:{200:{description:"In memoriam record deleted successfully",summary:"In Memoriam Record Deleted"},400:{description:"Invalid in memoriam record ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},Fh={method:"get",path:"/in-memoriam/role/{role}",tags:["In Memoriam"],summary:"Find in memoriam records by role",request:{params:gi},responses:{200:{description:"In memoriam records retrieved successfully by role",summary:"In Memoriam Records Retrieved by Role",content:{"application/json":{schema:b.array(Ri)}}},400:{description:"Invalid role parameter provided",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}};import{$Enums as Lp}from"@prisma/client";import E from"zod";import{extendZodWithOpenApi as Bp}from"@asteasolutions/zod-to-openapi";import Je from"zod";Bp(Je);var Ii=Je.object({role:Je.string().min(1),description:Je.string().optional(),userId:Je.uuid(),order:Je.number().optional()}),Xt=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{role:t,description:i,userId:n,order:s}=Ii.parse(e.body);return await this.legitimatorCommitteeMemberRepository.create({role:t,description:i,userId:n,order:s??0}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Op}from"@asteasolutions/zod-to-openapi";import bi from"zod";Op(bi);var wi=bi.object({id:bi.uuid()}),Jt=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t}=wi.parse({id:e.params.id});if(!await this.legitimatorCommitteeMemberRepository.findById(t))throw new p("O membro do comit\xEA legitimador n\xE3o existe.");return await this.legitimatorCommitteeMemberRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Np}from"@asteasolutions/zod-to-openapi";import Ci from"zod";Np(Ci);var er=Ci.object({id:Ci.uuid()}),Qt=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t}=er.parse({id:e.params.id}),i=await this.legitimatorCommitteeMemberRepository.findById(t);if(!i)throw new p("O membro do comit\xEA legitimador n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as kp}from"@asteasolutions/zod-to-openapi";import Fe from"zod";kp(Fe);var Si=Fe.object({id:Fe.uuid(),role:Fe.string().min(1).optional(),description:Fe.string().optional(),userId:Fe.uuid().optional(),order:Fe.number().optional()}),tr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t,role:i,description:n,userId:s,order:m}=Si.parse({id:e.params.id,...e.body});if(!await this.legitimatorCommitteeMemberRepository.findById(t))throw new p("O membro do comit\xEA legitimador n\xE3o existe.");return await this.legitimatorCommitteeMemberRepository.update({id:t,role:i,description:n,userId:s,order:m}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var _p=E.object({id:E.uuid(),name:E.string(),emailAddress:E.string(),avatarUrl:E.string().nullable(),orcid:E.string().nullable(),phone:E.string().nullable(),lattesUrl:E.string().nullable(),role:E.enum(Lp.UserRole)}),xs=E.object({id:E.uuid(),role:E.string(),description:E.string().nullable(),order:E.number(),createdAt:E.date(),updatedAt:E.date(),userId:E.uuid(),user:_p}),Ts={method:"post",path:"/legitimator-committee-member",tags:["Legitimator Committee Members"],summary:"Create a new Legitimator Committee Member",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Ii}}}},responses:{201:{description:"Legitimator Committee Member created successfully",summary:"Legitimator Committee Member Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},Ps={method:"get",path:"/legitimator-committee-member",tags:["Legitimator Committee Members"],summary:"List all Legitimator Committee Members with filters",request:{query:E.object({role:E.string().optional(),orderBy:E.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of Legitimator Committee Members retrieved successfully",summary:"Legitimator Committee Members Retrieved",content:{"application/json":{schema:E.object({members:E.array(xs)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},As={method:"get",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Find Legitimator Committee Member by ID",request:{params:er},responses:{200:{description:"Legitimator Committee Member details retrieved successfully",summary:"Legitimator Committee Member Retrieved",content:{"application/json":{schema:xs}}},400:{description:"Invalid Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},Us={method:"put",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Update Legitimator Committee Member",security:[{bearerAuth:[]}],request:{params:er,body:{content:{"application/json":{schema:Si.omit({id:!0})}}}},responses:{200:{description:"Legitimator Committee Member updated successfully",summary:"Legitimator Committee Member Updated"},400:{description:"Invalid input data or Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:E.object({message:E.string()})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},Fs={method:"delete",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Delete Legitimator Committee Member",security:[{bearerAuth:[]}],request:{params:wi},responses:{200:{description:"Legitimator Committee Member deleted successfully",summary:"Legitimator Committee Member Deleted"},400:{description:"Invalid Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:E.object({message:E.string()})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}};import{$Enums as Zp}from"@prisma/client";import I from"zod";import{extendZodWithOpenApi as Hp}from"@asteasolutions/zod-to-openapi";import ae from"zod";Hp(ae);var Mi=ae.object({name:ae.string().min(1),description:ae.string().optional(),members:ae.array(ae.object({userId:ae.uuid(),role:ae.string().min(1),order:ae.number().optional()}))}),rr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{name:t,description:i,members:n}=Mi.parse(e.body);if(await this.managementTeamRepository.findByName(t))throw new L("J\xE1 existe um time de gest\xE3o cadastrado com este nome.");return await this.managementTeamRepository.create({name:t,description:i,members:n.map(m=>({userId:m.userId,role:m.role,order:m.order??0}))}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as zp}from"@asteasolutions/zod-to-openapi";import Ei from"zod";zp(Ei);var vi=Ei.object({id:Ei.uuid()}),or=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t}=vi.parse({id:e.params.id});if(!await this.managementTeamRepository.findById(t))throw new p("O time de gest\xE3o n\xE3o existe.");return await this.managementTeamRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Wp}from"@asteasolutions/zod-to-openapi";import ji from"zod";Wp(ji);var nr=ji.object({id:ji.uuid()}),ir=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t}=nr.parse({id:e.params.id}),i=await this.managementTeamRepository.findById(t);if(!i)throw new p("O time de gest\xE3o n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Gp}from"@asteasolutions/zod-to-openapi";import re from"zod";Gp(re);var xi=re.object({id:re.uuid(),name:re.string().min(1).optional(),description:re.string().optional(),members:re.array(re.object({userId:re.uuid(),role:re.string().min(1),order:re.number().optional()})).optional()}),sr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t,name:i,description:n,members:s}=xi.parse({id:e.params.id,...e.body}),m=await this.managementTeamRepository.findById(t);if(!m)throw new p("O time de gest\xE3o n\xE3o existe.");if(i&&i!==m.name){let c=await this.managementTeamRepository.findByName(i);if(c&&c.id!==t)throw new L("J\xE1 existe um time de gest\xE3o com este nome.")}return await this.managementTeamRepository.update({id:t,name:i,description:n,members:s?s.map(c=>({userId:c.userId,role:c.role,order:c.order??0})):void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Kp=I.object({id:I.uuid(),name:I.string(),emailAddress:I.string(),avatarUrl:I.string().nullable(),orcid:I.string().nullable(),phone:I.string().nullable(),lattesUrl:I.string().nullable(),role:I.enum(Zp.UserRole)}),Vp=I.object({id:I.uuid(),role:I.string(),description:I.string().nullable(),order:I.number(),teamId:I.uuid(),userId:I.uuid(),createdAt:I.date(),updatedAt:I.date(),user:Kp}),Ds=I.object({id:I.uuid(),name:I.string(),description:I.string().nullable(),createdAt:I.date(),updatedAt:I.date(),members:I.array(Vp)}),qs={method:"post",path:"/management-team",tags:["Management Teams"],summary:"Create a new Management Team with multiple members",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Mi}}}},responses:{201:{description:"Management Team created successfully",summary:"Management Team Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:I.object({message:I.string()})}}},409:{description:"Management Team with this name already exists",summary:"Conflict",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},Bs={method:"get",path:"/management-team",tags:["Management Teams"],summary:"List all Management Teams with filters",request:{query:I.object({name:I.string().optional(),description:I.string().optional(),orderBy:I.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of Management Teams retrieved successfully",summary:"Management Teams Retrieved",content:{"application/json":{schema:I.object({teams:I.array(Ds)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},Os={method:"get",path:"/management-team/{id}",tags:["Management Teams"],summary:"Find Management Team by ID",request:{params:nr},responses:{200:{description:"Management Team details retrieved successfully",summary:"Management Team Retrieved",content:{"application/json":{schema:Ds}}},400:{description:"Invalid Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},Ns={method:"put",path:"/management-team/{id}",tags:["Management Teams"],summary:"Update Management Team and manage member relationships",security:[{bearerAuth:[]}],request:{params:nr,body:{content:{"application/json":{schema:xi.omit({id:!0})}}}},responses:{200:{description:"Management Team updated successfully",summary:"Management Team Updated"},400:{description:"Invalid input data or Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:I.object({message:I.string()})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},409:{description:"Management Team with this name already exists",summary:"Conflict",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},ks={method:"delete",path:"/management-team/{id}",tags:["Management Teams"],summary:"Delete Management Team",security:[{bearerAuth:[]}],request:{params:vi},responses:{200:{description:"Management Team deleted successfully",summary:"Management Team Deleted"},400:{description:"Invalid Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:I.object({message:I.string()})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}};import{MeetingFormat as rd,MeetingStatus as od}from"@prisma/client";import j from"zod";import{extendZodWithOpenApi as Yp}from"@asteasolutions/zod-to-openapi";import Qe from"zod";var _s=10,Ls=1024,$p=Ls*Ls,Xp=_s*$p;Yp(Qe);var Ti=Qe.object({title:Qe.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),publishedAt:Qe.coerce.date(),meetingId:Qe.uuid(),document:Qe.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=Xp,`O documento deve ter no m\xE1ximo ${_s}MB.`)}),ar=class{constructor(e,r,t){this.meetingMinuteRepository=e;this.meetingRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{title:t,publishedAt:i,meetingId:n,document:s}=Ti.parse({...e.body,...e.params,document:e.file});if(!await this.meetingRepository.findById(n))throw new p("A reuni\xE3o n\xE3o existe.");if(await this.meetingMinuteRepository.findByMeetingId(n))throw new a("Esta reuni\xE3o j\xE1 possui uma ata.");let d=await this.meetingMinuteRepository.create({title:t,publishedAt:i,meetingId:n,documentUrl:""}),T=await this.firebaseStorageService.uploadFile({file:s,id:d.id,folder:A.MEETING_MINUTE});return await this.meetingMinuteRepository.update({id:d.id,documentUrl:T}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Jp}from"@asteasolutions/zod-to-openapi";import Pi from"zod";Jp(Pi);var lt=Pi.object({meetingId:Pi.uuid()}),mr=class{constructor(e){this.meetingMinuteRepository=e}async handle(e,r){try{let{meetingId:t}=lt.parse({meetingId:e.params.meetingId}),i=await this.meetingMinuteRepository.findByMeetingId(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Qp}from"@asteasolutions/zod-to-openapi";import et from"zod";var zs=10,Hs=1024,ed=Hs*Hs,td=zs*ed;Qp(et);var Ai=et.object({meetingId:et.uuid(),title:et.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),publishedAt:et.coerce.date().optional(),document:et.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=td,`O documento deve ter no m\xE1ximo ${zs}MB.`).optional()}),cr=class{constructor(e,r){this.meetingMinuteRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{meetingId:t,title:i,publishedAt:n,document:s}=Ai.parse({meetingId:e.params.meetingId,...e.body,document:e.file}),m=await this.meetingMinuteRepository.findByMeetingId(t);if(!m)throw new p("A ata n\xE3o existe para esta reuni\xE3o.");let c=m.documentUrl;return s&&(m.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:m.documentUrl}),c=await this.firebaseStorageService.uploadFile({file:s,id:m.id,folder:A.MEETING_MINUTE})),await this.meetingMinuteRepository.update({id:m.id,title:i,publishedAt:n,documentUrl:c??void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var id=j.object({id:j.uuid(),title:j.string(),scheduledAt:j.date(),format:j.enum(rd),agenda:j.string(),meetingLink:j.string().nullable(),location:j.string().nullable(),status:j.enum(od),createdAt:j.date(),updatedAt:j.date()}),nd=j.object({id:j.uuid(),title:j.string(),publishedAt:j.date(),documentUrl:j.string(),meetingId:j.uuid(),meeting:id,createdAt:j.date(),updatedAt:j.date()}),Ws={method:"post",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Create a new meeting minute with document upload",security:[{bearerAuth:[]}],request:{params:j.object({meetingId:j.uuid()}),body:{content:{"multipart/form-data":{schema:Ti.omit({meetingId:!0})}}}},responses:{201:{description:"Meeting minute created successfully",summary:"Meeting Minute Created"},400:{description:"Invalid input data, missing required fields, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},409:{description:"Meeting already has a minute",summary:"Conflict",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},Gs={method:"get",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Find meeting minute by meeting ID",request:{params:lt},responses:{200:{description:"Meeting minute retrieved successfully by meeting ID",summary:"Meeting Minute Retrieved by Meeting ID",content:{"application/json":{schema:nd.nullable()}}},400:{description:"Invalid meeting ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},Zs={method:"put",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Update meeting minute with optional document upload",security:[{bearerAuth:[]}],request:{params:lt,body:{content:{"multipart/form-data":{schema:Ai.omit({meetingId:!0})}}}},responses:{200:{description:"Meeting minute updated successfully",summary:"Meeting Minute Updated"},400:{description:"Invalid input data, meeting minute ID format, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},404:{description:"Meeting minute not found with the provided ID",summary:"Meeting Minute Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},Ks={method:"delete",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Delete meeting minute",security:[{bearerAuth:[]}],request:{params:lt},responses:{200:{description:"Meeting minute deleted successfully",summary:"Meeting Minute Deleted"},400:{description:"Invalid meeting minute ID format",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},404:{description:"Meeting minute not found with the provided ID",summary:"Meeting Minute Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}};import{MeetingFormat as Id,MeetingStatus as bd}from"@prisma/client";import h from"zod";import{extendZodWithOpenApi as sd}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as pr,MeetingStatus as Ui}from"@prisma/client";import oe from"zod";sd(oe);var Fi=oe.object({title:oe.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),scheduledAt:oe.coerce.date(),format:oe.enum(pr).default(pr.ONLINE),agenda:oe.string().min(1,"Pauta \xE9 obrigat\xF3ria"),meetingLink:oe.string().url("Link da reuni\xE3o deve ser uma URL v\xE1lida").optional().or(oe.literal("")),location:oe.string().optional(),status:oe.enum(Ui).default(Ui.PENDING)}).refine(o=>o.format===pr.ONLINE?!!o.meetingLink:o.format===pr.IN_PERSON?!!o.location:!0,{message:"Reuni\xF5es online devem ter link e reuni\xF5es presenciais devem ter localiza\xE7\xE3o",path:["format"]}),dr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{title:t,scheduledAt:i,format:n,agenda:s,meetingLink:m,location:c,status:d}=Fi.parse(e.body);return await this.meetingRepository.create({title:t,scheduledAt:i,format:n,agenda:s,meetingLink:m||void 0,location:c||void 0,status:d??Ui.PENDING}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ad}from"@asteasolutions/zod-to-openapi";import Di from"zod";ad(Di);var qi=Di.object({id:Di.uuid()}),ur=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t}=qi.parse({id:e.params.id});if(!await this.meetingRepository.findById(t))throw new p("A reuni\xE3o n\xE3o existe.");return await this.meetingRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as md}from"@asteasolutions/zod-to-openapi";import Bi from"zod";md(Bi);var fr=Bi.object({id:Bi.uuid()}),lr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t}=fr.parse({id:e.params.id}),i=await this.meetingRepository.findById(t);if(!i)throw new p("A reuni\xE3o n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as cd}from"@asteasolutions/zod-to-openapi";import{MeetingStatus as pd}from"@prisma/client";import Oi from"zod";cd(Oi);var Ni=Oi.object({status:Oi.enum(pd)}),gr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{status:t}=Ni.parse({status:e.params.status}),i=await this.meetingRepository.findByStatus(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as dd}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as ud,MeetingStatus as ld}from"@prisma/client";import Ie from"zod";var fd=1,gd=10;dd(Ie);var ki=Ie.object({page:Ie.coerce.number().min(1).default(fd),limit:Ie.coerce.number().min(1).default(gd),title:Ie.string().optional(),format:Ie.enum(ud).optional(),status:Ie.enum(ld).optional(),orderBy:Ie.enum(["asc","desc"]).optional()}),yr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=ki.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.meetingRepository.find({pagination:{offset:s,limit:i},filter:n}),this.meetingRepository.count({filter:n})]),d=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:d,offset:s,limit:i,meetings:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as yd}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as hd,MeetingStatus as Rd}from"@prisma/client";import ee from"zod";yd(ee);var Li=ee.object({id:ee.uuid(),title:ee.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),scheduledAt:ee.coerce.date().optional(),format:ee.enum(hd).optional(),agenda:ee.string().min(1,"Pauta \xE9 obrigat\xF3ria").optional(),meetingLink:ee.string().url("Link da reuni\xE3o deve ser uma URL v\xE1lida").optional().or(ee.literal("")),location:ee.string().optional(),status:ee.enum(Rd).optional()}),hr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t,title:i,scheduledAt:n,format:s,agenda:m,meetingLink:c,location:d,status:T}=Li.parse({id:e.params.id,...e.body});if(!await this.meetingRepository.findById(t))throw new p("A reuni\xE3o n\xE3o existe.");return await this.meetingRepository.update({id:t,title:i,scheduledAt:n,format:s,agenda:m,meetingLink:c||void 0,location:d||void 0,status:T}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var wd=h.object({id:h.uuid(),title:h.string(),publishedAt:h.date(),documentUrl:h.string(),meetingId:h.uuid(),createdAt:h.date(),updatedAt:h.date()}),_i=h.object({id:h.uuid(),title:h.string(),scheduledAt:h.date(),format:h.enum(Id),agenda:h.string(),meetingLink:h.string().nullable(),location:h.string().nullable(),status:h.enum(bd),minutes:wd.nullable(),createdAt:h.date(),updatedAt:h.date()}),Vs={method:"post",path:"/meeting",tags:["Meetings"],summary:"Create a new meeting",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Fi}}}},responses:{201:{description:"Meeting created successfully",summary:"Meeting Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},Ys={method:"get",path:"/meeting",tags:["Meetings"],summary:"List all meetings with pagination and filters",request:{query:ki},responses:{200:{description:"List of meetings retrieved successfully with pagination",summary:"Meetings Retrieved",content:{"application/json":{schema:h.object({page:h.number(),totalPages:h.number(),offset:h.number(),limit:h.number(),meetings:h.array(_i)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},$s={method:"get",path:"/meeting/{id}",tags:["Meetings"],summary:"Find meeting by ID",request:{params:fr},responses:{200:{description:"Meeting details retrieved successfully",summary:"Meeting Retrieved",content:{"application/json":{schema:_i}}},400:{description:"Invalid meeting ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},Xs={method:"get",path:"/meeting/status/{status}",tags:["Meetings"],summary:"Find meetings by status",request:{params:Ni},responses:{200:{description:"Meetings retrieved successfully by status",summary:"Meetings Retrieved by Status",content:{"application/json":{schema:h.array(_i)}}},400:{description:"Invalid status parameter provided",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},Js={method:"put",path:"/meeting/{id}",tags:["Meetings"],summary:"Update meeting",security:[{bearerAuth:[]}],request:{params:fr,body:{content:{"application/json":{schema:Li.omit({id:!0})}}}},responses:{200:{description:"Meeting updated successfully",summary:"Meeting Updated"},400:{description:"Invalid input data or meeting ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},Qs={method:"delete",path:"/meeting/{id}",tags:["Meetings"],summary:"Delete meeting",security:[{bearerAuth:[]}],request:{params:qi},responses:{200:{description:"Meeting deleted successfully",summary:"Meeting Deleted"},400:{description:"Invalid meeting ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}};import w from"zod";import{extendZodWithOpenApi as Cd}from"@asteasolutions/zod-to-openapi";import ft from"zod";var Sd=5,ea=1024,Md=ea*ea,Ed=Sd*Md;Cd(ft);var Hi=ft.object({title:ft.string().min(1),content:ft.string().min(1),image:ft.any().refine(o=>!o||typeof o=="object"&&typeof o.mimetype=="string"&&o.mimetype.startsWith("image/")&&typeof o.size=="number"&&o.size<=Ed,{message:"A imagem deve ser uma imagem v\xE1lida de no m\xE1ximo 5MB."})}),Rr=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{title:t,content:i,image:n}=Hi.parse({...e.body,image:e.file}),s=e.user.id,m=await this.firebaseStorageService.uploadFile({file:n,folder:A.NEWS,id:s});await this.newsRepository.create({title:t,content:i,authorId:s,imageUrl:m}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as vd}from"@asteasolutions/zod-to-openapi";import be from"zod";var jd=1,xd=7;vd(be);var br=be.object({page:be.coerce.number().min(1).default(jd),limit:be.coerce.number().min(1).default(xd),authorId:be.string(),title:be.string().optional(),content:be.string().optional(),orderBy:be.enum(["asc","desc"]).default("desc")}),Ir=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,authorId:n,...s}=br.parse(e.query),m=i*t-i,[c,d]=await Promise.all([this.newsRepository.findByAuthorId({authorId:n,pagination:{offset:m,limit:i},filter:s}),this.newsRepository.count({filter:{authorId:n,...s}})]),T=Math.max(Math.ceil(d/i),1);r.status(200).json({page:t,totalPages:T,offset:m,limit:i,news:c})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Td}from"@asteasolutions/zod-to-openapi";import zi from"zod";Td(zi);var Wi=zi.object({id:zi.string()}),wr=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{id:t}=Wi.parse(e.params),i=await this.newsRepository.findById(t);if(!i)throw new p("Not\xEDcia n\xE3o encontrada.");r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Pd}from"@asteasolutions/zod-to-openapi";import we from"zod";var Ad=1,Ud=9;Pd(we);var Gi=we.object({page:we.coerce.number().min(1).default(Ad),limit:we.coerce.number().min(1).default(Ud),title:we.string().optional(),content:we.string().optional(),authorId:we.string().optional(),orderBy:we.enum(["asc","desc"]).default("desc")}),Cr=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Gi.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.newsRepository.find({pagination:{offset:s,limit:i},filter:n}),this.newsRepository.count({filter:n})]),d=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:d,offset:s,limit:i,news:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ta={method:"post",path:"/news",tags:["News"],summary:"Create news",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:Hi}}}},responses:{201:{description:"News article created successfully",summary:"News Created",content:{"application/json":{schema:w.object({message:w.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},ra={method:"get",path:"/news",tags:["News"],summary:"List news",request:{query:Gi},responses:{200:{description:"Paginated list of news articles retrieved successfully",summary:"News Retrieved",content:{"application/json":{schema:w.object({page:w.number(),totalPages:w.number(),offset:w.number(),limit:w.number(),news:w.array(w.object({title:w.string(),content:w.string(),id:w.string(),createdAt:w.date(),updatedAt:w.date(),imageUrl:w.string().nullable()}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},oa={method:"get",path:"/news/{id}",tags:["News"],summary:"Find news by ID",request:{params:Wi},responses:{200:{description:"News article details retrieved successfully",summary:"News Retrieved",content:{"application/json":{schema:w.object({page:w.number(),totalPages:w.number(),offset:w.number(),limit:w.number(),news:w.object({title:w.string(),content:w.string(),id:w.string(),createdAt:w.date(),updatedAt:w.date(),imageUrl:w.string().nullable()})})}}},400:{description:"Invalid news ID format",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},404:{description:"News article not found with the provided ID",summary:"News Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},ia={method:"get",path:"/news/author/{author_id}",tags:["News"],summary:"List news by author",request:{params:br.pick({authorId:!0}).transform(()=>({author_id:""})),query:br.omit({authorId:!0})},responses:{200:{description:"Paginated list of news articles by author retrieved successfully",summary:"Author News Retrieved",content:{"application/json":{schema:w.object({page:w.number(),totalPages:w.number(),offset:w.number(),limit:w.number(),news:w.array(w.object({title:w.string(),content:w.string(),id:w.string(),createdAt:w.date(),updatedAt:w.date(),imageUrl:w.string().nullable()}))})}}},400:{description:"Invalid author ID or query parameters",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},404:{description:"Author not found with the provided ID",summary:"Author Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}};import S from"zod";import{extendZodWithOpenApi as Fd}from"@asteasolutions/zod-to-openapi";import ie from"zod";var sa=2,na=1024,Dd=na*na,qd=sa*Dd;Fd(ie);var Zi=ie.object({name:ie.string().min(1,"Nome \xE9 obrigat\xF3rio"),logo:ie.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=qd,`A imagem deve ter no m\xE1ximo ${sa}MB.`),websiteUrl:ie.url("URL do site deve ser v\xE1lida").optional(),description:ie.string().optional(),category:ie.string().optional(),since:ie.coerce.date(),isActive:ie.preprocess(o=>o==="true",ie.boolean().optional())}),Sr=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{name:t,logo:i,websiteUrl:n,description:s,category:m,since:c,isActive:d}=Zi.parse({...e.body,logo:e.file}),T=await this.partnerRepository.create({name:t,websiteUrl:n,description:s,category:m,since:c,isActive:d}),P=await this.firebaseStorageService.uploadFile({file:i,id:T.id,folder:A.PARTNER});return await this.partnerRepository.update({id:T.id,logoUrl:P}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Bd}from"@asteasolutions/zod-to-openapi";import Ki from"zod";Bd(Ki);var Vi=Ki.object({id:Ki.uuid()}),Mr=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=Vi.parse({id:e.params.id}),i=await this.partnerRepository.findById(t);if(!i)throw new p("O parceiro n\xE3o existe.");return i.logoUrl&&this.firebaseStorageService.deleteFile({fileUrl:i.logoUrl}),await this.partnerRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Od}from"@asteasolutions/zod-to-openapi";import Yi from"zod";Od(Yi);var vr=Yi.object({id:Yi.uuid()}),Er=class{constructor(e){this.partnerRepository=e}async handle(e,r){try{let{id:t}=vr.parse({id:e.params.id}),i=await this.partnerRepository.findById(t);if(!i)throw new p("O parceiro n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Nd}from"@asteasolutions/zod-to-openapi";import me from"zod";var kd=1,Ld=9;Nd(me);var $i=me.object({page:me.coerce.number().min(1).default(kd),limit:me.coerce.number().min(1).default(Ld),name:me.string().optional(),description:me.string().optional(),category:me.string().optional(),isActive:me.coerce.boolean().optional(),orderBy:me.enum(["asc","desc"]).optional()}),jr=class{constructor(e){this.partnerRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=$i.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.partnerRepository.find({pagination:{offset:s,limit:i},filter:n}),this.partnerRepository.count({filter:n})]),d=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:d,offset:s,limit:i,partners:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as _d}from"@asteasolutions/zod-to-openapi";import te from"zod";var ma=2,aa=1024,Hd=aa*aa,zd=ma*Hd;_d(te);var Xi=te.object({id:te.uuid(),name:te.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),logo:te.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=zd,`A imagem deve ter no m\xE1ximo ${ma}MB.`).optional(),websiteUrl:te.url("URL do site deve ser v\xE1lida").optional(),description:te.string().optional(),category:te.string().optional(),since:te.coerce.date().optional(),isActive:te.preprocess(o=>o==="true",te.boolean().optional())}),xr=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,logo:n,websiteUrl:s,description:m,category:c,since:d,isActive:T}=Xi.parse({id:e.params.id,...e.body,logo:e.file}),P=await this.partnerRepository.findById(t);if(!P)throw new p("O parceiro n\xE3o existe.");let O=P.logoUrl;if(n&&(O=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:"images/partners"})),!O)throw new a("Logo URL \xE9 obrigat\xF3rio");return await this.partnerRepository.update({id:t,name:i,logoUrl:O,websiteUrl:s,description:m,category:c,since:d,isActive:T}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ca=S.object({id:S.uuid(),name:S.string(),logoUrl:S.string(),description:S.string().nullable(),category:S.string().nullable(),since:S.date(),isActive:S.boolean(),createdAt:S.date(),updatedAt:S.date()}),pa={method:"post",path:"/partner",tags:["Partners"],summary:"Create a new partner with logo upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:Zi}}}},responses:{201:{description:"Partner created successfully",summary:"Partner Created"},400:{description:"Invalid input data, missing required fields, or invalid logo format/size",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},409:{description:"Partner with this name already exists",summary:"Conflict",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},da={method:"get",path:"/partner",tags:["Partners"],summary:"List all partners with pagination and filters",request:{query:$i},responses:{200:{description:"List of partners retrieved successfully with pagination",summary:"Partners Retrieved",content:{"application/json":{schema:S.object({page:S.number(),totalPages:S.number(),offset:S.number(),limit:S.number(),partners:S.array(ca)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},ua={method:"get",path:"/partner/{id}",tags:["Partners"],summary:"Find partner by ID",request:{params:vr},responses:{200:{description:"Partner details retrieved successfully",summary:"Partner Retrieved",content:{"application/json":{schema:ca}}},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},la={method:"put",path:"/partner/{id}",tags:["Partners"],summary:"Update partner with optional logo upload",security:[{bearerAuth:[]}],request:{params:vr,body:{content:{"multipart/form-data":{schema:Xi.omit({id:!0})}}}},responses:{200:{description:"Partner updated successfully",summary:"Partner Updated"},400:{description:"Invalid input data, partner ID format, or invalid logo format/size",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},409:{description:"Partner with this name already exists",summary:"Conflict",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},fa={method:"delete",path:"/partner/{id}",tags:["Partners"],summary:"Delete partner",security:[{bearerAuth:[]}],request:{params:Vi},responses:{200:{description:"Partner deleted successfully",summary:"Partner Deleted"},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}};import{$Enums as ga}from"@prisma/client";import M from"zod";import{extendZodWithOpenApi as Wd}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Gd}from"@prisma/client";import Ce from"zod";Wd(Ce);var Pr=Ce.object({userId:Ce.uuid(),title:Ce.string().min(1),description:Ce.string().optional(),status:Ce.enum(Gd).default("PENDING"),dueDate:Ce.coerce.date().optional(),document:Ce.any().refine(o=>o&&typeof o=="object"&&o.size>0,"Arquivo do documento \xE9 obrigat\xF3rio")}),Tr=class{constructor(e,r,t){this.userRepository=e;this.pendencyRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{userId:t,title:i,description:n,status:s,dueDate:m,document:c}=Pr.parse({...e.body,userId:e.params.user_id,document:e.file});if(!await this.userRepository.findById(t))throw new z("O usu\xE1rio n\xE3o existe.");let T=await this.firebaseStorageService.uploadFile({file:c,id:t,folder:A.PENDENCY});return await this.pendencyRepository.create({userId:t,title:i,description:n,status:s,dueDate:m,documentUrl:T}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Zd}from"@asteasolutions/zod-to-openapi";import Ji from"zod";Zd(Ji);var Qi=Ji.object({id:Ji.uuid()}),Ar=class{constructor(e,r){this.pendencyRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=Qi.parse({id:e.params.pendency_id}),i=await this.pendencyRepository.findById(t);if(!i)throw new p("A pend\xEAncia n\xE3o existe.");return await Promise.all([this.pendencyRepository.deleteById(i.id),this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl})]),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Kd}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Vd}from"@prisma/client";import ce from"zod";var Yd=1,$d=6;Kd(ce);var en=ce.object({page:ce.coerce.number().min(1).default(Yd),limit:ce.coerce.number().min(1).default($d),title:ce.string().optional(),description:ce.string().optional(),status:ce.enum(Vd).default("PENDING"),userId:ce.uuid().optional(),orderBy:ce.enum(["asc","desc"]).default("desc")}),Ur=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{description:t,limit:i,orderBy:n,page:s,title:m,status:c,userId:d}=en.parse(e.query),T=s*i-i,[P,O]=await Promise.all([this.pendencyRepository.find({pagination:{offset:T,limit:i},filter:{title:m,description:t,status:c,orderBy:n,userId:d}}),this.pendencyRepository.count({filter:{title:m,description:t,status:c,userId:d}})]),H=Math.max(Math.ceil(O/i),1);return r.status(200).json({page:s,totalPages:H,offset:T,limit:i,pendencies:P})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Xd}from"@asteasolutions/zod-to-openapi";import tn from"zod";Xd(tn);var rn=tn.object({pendencyId:tn.uuid()}),Fr=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{pendencyId:t}=rn.parse({pendencyId:e.params.pendency_id}),i=await this.pendencyRepository.findById(t);if(!i)throw new p("Pend\xEAncia n\xE3o encontrada.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Jd}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Qd}from"@prisma/client";import Se from"zod";Jd(Se);var qr=Se.object({id:Se.uuid(),title:Se.string().min(1),description:Se.string().optional(),status:Se.enum(Qd),dueDate:Se.coerce.date().optional(),document:Se.any().refine(o=>o==null||typeof o=="object"&&typeof o.size=="number"&&(o.size===0||o.size>0),"Arquivo do documento \xE9 inv\xE1lido").optional()}),Dr=class{constructor(e,r){this.pendencyRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{document:t,id:i,...n}=qr.parse({...e.body,id:e.params.pendency_id,document:e.file}),s=await this.pendencyRepository.findById(i);if(!s)throw new z("A pend\xEAncia n\xE3o existe");let m=s.documentUrl;return t&&t.size>0&&(m=await this.firebaseStorageService.updateFile({file:t,id:s.userId,folder:A.PENDENCY,fileUrl:s.documentUrl})),await this.pendencyRepository.update({...n,id:i,documentUrl:m}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ya={method:"post",path:"/pendency/{user_id}",tags:["Pendencies"],summary:"Create pendency for user",security:[{bearerAuth:[]}],request:{params:Pr.pick({userId:!0}).transform(()=>({user_id:""})),body:{content:{"multipart/form-data":{schema:Pr.omit({userId:!0})}}}},responses:{201:{description:"Pendency created successfully for the user",summary:"Pendency Created",content:{"application/json":{schema:M.object({})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},ha={method:"get",path:"/pendency",tags:["Pendencies"],summary:"List pendencies",security:[{bearerAuth:[]}],request:{query:en},responses:{200:{description:"Paginated list of pendencies retrieved successfully",summary:"Pendencies Retrieved",content:{"application/json":{schema:M.object({page:M.number(),totalPages:M.number(),offset:M.number(),limit:M.number(),pendencies:M.array(M.object({id:M.string(),title:M.string(),description:M.string().nullable(),status:M.enum(ga.PendencyStatus),dueDate:M.date().nullable(),documentUrl:M.string(),userId:M.string(),createdAt:M.date(),updatedAt:M.date()}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},Ra={method:"get",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Find pendency by ID",security:[{bearerAuth:[]}],request:{params:rn},responses:{200:{description:"Pendency details retrieved successfully",summary:"Pendency Retrieved",content:{"application/json":{schema:M.object({id:M.string(),title:M.string(),description:M.string().nullable(),status:M.enum(ga.PendencyStatus),dueDate:M.date().nullable(),documentUrl:M.string(),userId:M.string(),createdAt:M.date(),updatedAt:M.date()}).nullable()}}},400:{description:"Invalid pendency ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},404:{description:"Pendency not found with the provided ID",summary:"Pendency Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},Ia={method:"put",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Update pendency",security:[{bearerAuth:[]}],request:{params:qr.pick({id:!0}).transform(()=>({pendency_id:""})),body:{content:{"multipart/form-data":{schema:qr.omit({id:!0})}}}},responses:{204:{description:"Pendency updated successfully",summary:"Pendency Updated"},400:{description:"Invalid input data or pendency does not exist",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},ba={method:"delete",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Delete pendency",security:[{bearerAuth:[]}],request:{params:Qi},responses:{204:{description:"Pendency deleted successfully",summary:"Pendency Deleted"},400:{description:"Invalid pendency ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},404:{description:"Pendency not found with the provided ID",summary:"Pendency Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}};import{RegimentStatus as gu}from"@prisma/client";import C from"zod";import{extendZodWithOpenApi as eu}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as Ca}from"@prisma/client";import De from"zod";var Sa=10,wa=1024,tu=wa*wa,ru=Sa*tu;eu(De);var on=De.object({title:De.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),version:De.string().min(1,"Vers\xE3o \xE9 obrigat\xF3ria"),publishedAt:De.coerce.date(),document:De.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=ru,`O documento deve ter no m\xE1ximo ${Sa}MB.`),status:De.enum(Ca).optional()}),Br=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{title:t,version:i,publishedAt:n,document:s,status:m}=on.parse({...e.body,document:e.file}),c=await this.regimentRepository.create({title:t,version:i,publishedAt:n,documentUrl:"",status:m??Ca.IN_FORCE}),d=await this.firebaseStorageService.uploadFile({file:s,id:c.id,folder:A.REGIMENT});return await this.regimentRepository.update({id:c.id,documentUrl:d}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ou}from"@asteasolutions/zod-to-openapi";import nn from"zod";ou(nn);var sn=nn.object({id:nn.uuid()}),Or=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=sn.parse({id:e.params.id}),i=await this.regimentRepository.findById(t);if(!i)throw new p("O regimento n\xE3o existe.");return i.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl}),await this.regimentRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as iu}from"@asteasolutions/zod-to-openapi";import an from"zod";iu(an);var kr=an.object({id:an.uuid()}),Nr=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{id:t}=kr.parse({id:e.params.id}),i=await this.regimentRepository.findById(t);if(!i)throw new p("O regimento n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as nu}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as su}from"@prisma/client";import mn from"zod";nu(mn);var cn=mn.object({status:mn.enum(su)}),Lr=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{status:t}=cn.parse({status:e.params.status}),i=await this.regimentRepository.findByStatus(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as au}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as mu}from"@prisma/client";import qe from"zod";var cu=1,pu=10;au(qe);var pn=qe.object({page:qe.coerce.number().min(1).default(cu),limit:qe.coerce.number().min(1).default(pu),title:qe.string().optional(),status:qe.enum(mu).optional(),orderBy:qe.enum(["asc","desc"]).optional()}),_r=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=pn.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.regimentRepository.find({pagination:{offset:s,limit:i},filter:n}),this.regimentRepository.count({filter:n})]),d=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:d,offset:s,limit:i,regiments:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as du}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as uu}from"@prisma/client";import Me from"zod";var Ea=10,Ma=1024,lu=Ma*Ma,fu=Ea*lu;du(Me);var dn=Me.object({id:Me.uuid(),title:Me.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),version:Me.string().min(1,"Vers\xE3o \xE9 obrigat\xF3ria").optional(),publishedAt:Me.coerce.date().optional(),document:Me.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=fu,`O documento deve ter no m\xE1ximo ${Ea}MB.`).optional(),status:Me.enum(uu).optional()}),Hr=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,title:i,version:n,publishedAt:s,document:m,status:c}=dn.parse({id:e.params.id,...e.body,document:e.file}),d=await this.regimentRepository.findById(t);if(!d)throw new p("O regimento n\xE3o existe.");let T=d.documentUrl;return m&&(d.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:d.documentUrl}),T=await this.firebaseStorageService.uploadFile({file:m,id:t,folder:A.REGIMENT})),await this.regimentRepository.update({id:t,title:i,version:n,publishedAt:s,documentUrl:T??void 0,status:c}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var un=C.object({id:C.uuid(),title:C.string(),version:C.string(),publishedAt:C.date(),documentUrl:C.string(),status:C.enum(gu),createdAt:C.date(),updatedAt:C.date()}),va={method:"post",path:"/regiment",tags:["Regiments"],summary:"Create a new regiment with document upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:on}}}},responses:{201:{description:"Regiment created successfully",summary:"Regiment Created"},400:{description:"Invalid input data, missing required fields, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},ja={method:"get",path:"/regiment",tags:["Regiments"],summary:"List all regiments with pagination and filters",request:{query:pn},responses:{200:{description:"List of regiments retrieved successfully with pagination",summary:"Regiments Retrieved",content:{"application/json":{schema:C.object({page:C.number(),totalPages:C.number(),offset:C.number(),limit:C.number(),regiments:C.array(un)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},xa={method:"get",path:"/regiment/{id}",tags:["Regiments"],summary:"Find regiment by ID",request:{params:kr},responses:{200:{description:"Regiment details retrieved successfully",summary:"Regiment Retrieved",content:{"application/json":{schema:un}}},400:{description:"Invalid regiment ID format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Ta={method:"get",path:"/regiment/status/{status}",tags:["Regiments"],summary:"Find regiments by status",request:{params:cn},responses:{200:{description:"Regiments retrieved successfully by status",summary:"Regiments Retrieved by Status",content:{"application/json":{schema:C.array(un)}}},400:{description:"Invalid status parameter provided",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Pa={method:"put",path:"/regiment/{id}",tags:["Regiments"],summary:"Update regiment with optional document upload",security:[{bearerAuth:[]}],request:{params:kr,body:{content:{"multipart/form-data":{schema:dn.omit({id:!0})}}}},responses:{200:{description:"Regiment updated successfully",summary:"Regiment Updated"},400:{description:"Invalid input data, regiment ID format, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:C.object({message:C.string()})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Aa={method:"delete",path:"/regiment/{id}",tags:["Regiments"],summary:"Delete regiment",security:[{bearerAuth:[]}],request:{params:sn},responses:{200:{description:"Regiment deleted successfully",summary:"Regiment Deleted"},400:{description:"Invalid regiment ID format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:C.object({message:C.string()})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}};import{$Enums as bn}from"@prisma/client";import l from"zod";import{extendZodWithOpenApi as yu}from"@asteasolutions/zod-to-openapi";import{Degree as hu,Seniority as Ru}from"@prisma/client";import $ from"zod";yu($);var ln=$.object({registrationNumber:$.string(),mainEtps:$.string().optional(),formations:$.string().optional(),degrees:$.array($.enum(hu)),occupations:$.string(),seniority:$.enum(Ru),institutions:$.string(),biography:$.string().optional(),userId:$.string()}),zr=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{registrationNumber:t,mainEtps:i,formations:n,degrees:s,occupations:m,seniority:c,institutions:d,biography:T,userId:P}=ln.parse(e.body);if(await this.researcherRepository.findByRegistrationNumber(t))throw new L("J\xE1 existe um pesquisador cadastrado com este n\xFAmero de registro.");if(await this.researcherRepository.findByUserId(P))throw new L("Usu\xE1rio j\xE1 possui um perfil de pesquisador.");return await this.researcherRepository.create({registrationNumber:t,mainEtps:i,formations:n,degrees:s,occupations:m,seniority:c,institutions:d,biography:T,userId:P}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Iu}from"@asteasolutions/zod-to-openapi";import fn from"zod";Iu(fn);var gn=fn.object({id:fn.uuid()}),Wr=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t}=gn.parse({id:e.params.id});if(!await this.researcherRepository.findById(t))throw new p("O pesquisador n\xE3o existe.");return await this.researcherRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as bu}from"@asteasolutions/zod-to-openapi";import yn from"zod";bu(yn);var Zr=yn.object({id:yn.uuid()}),Gr=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t}=Zr.parse({id:e.params.id}),i=await this.researcherRepository.findById(t);if(!i)throw new p("O pesquisador n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as wu}from"@asteasolutions/zod-to-openapi";import hn from"zod";wu(hn);var Rn=hn.object({userId:hn.uuid()}),Kr=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{userId:t}=Rn.parse({userId:e.params.userId}),i=await this.researcherRepository.findByUserId(t);if(!i)throw new p("O pesquisador n\xE3o existe para este usu\xE1rio.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Cu}from"@asteasolutions/zod-to-openapi";import{Degree as Su,Seniority as Mu}from"@prisma/client";import X from"zod";Cu(X);var In=X.object({id:X.uuid(),registrationNumber:X.string().optional(),mainEtps:X.string().optional(),formations:X.string().optional(),degrees:X.array(X.enum(Su)).optional(),occupations:X.string().optional(),seniority:X.enum(Mu).optional(),institutions:X.string().optional(),biography:X.string().optional()}),Vr=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t,registrationNumber:i,mainEtps:n,formations:s,degrees:m,occupations:c,seniority:d,institutions:T,biography:P}=In.parse({id:e.params.id,...e.body}),O=await this.researcherRepository.findById(t);if(!O)throw new p("O pesquisador n\xE3o existe.");if(i&&i!==O.registrationNumber){let H=await this.researcherRepository.findByRegistrationNumber(i);if(H&&H.id!==t)throw new L("J\xE1 existe um pesquisador com este n\xFAmero de registro.")}return await this.researcherRepository.update({id:t,registrationNumber:i,mainEtps:n,formations:s,degrees:m,occupations:c,seniority:d,institutions:T,biography:P}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Eu=1,vu=9,wn=l.object({id:l.uuid(),registrationNumber:l.string(),mainEtps:l.string().nullable(),formations:l.string().nullable(),degrees:l.array(l.enum(bn.Degree)),occupations:l.string(),seniority:l.enum(bn.Seniority),institutions:l.string(),biography:l.string().nullable(),createdAt:l.date(),updatedAt:l.date(),userId:l.uuid(),user:l.object({id:l.uuid(),name:l.string(),emailAddress:l.string(),avatarUrl:l.string().nullable(),orcid:l.string().nullable(),phone:l.string().nullable(),lattesUrl:l.string().nullable(),role:l.enum(bn.UserRole)})}),Ua={method:"post",path:"/researcher",tags:["Researchers"],summary:"Create a new researcher profile",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:ln}}}},responses:{201:{description:"Researcher profile created successfully",summary:"Researcher Created",content:{"application/json":{schema:l.object({message:l.string()})}}},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:l.object({errors:l.record(l.string(),l.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:l.object({message:l.string()})}}},409:{description:"Researcher with this registration number already exists or user already has a researcher profile",summary:"Conflict",content:{"application/json":{schema:l.object({message:l.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:l.object({message:l.string()})}}}}},Fa={method:"get",path:"/researcher",tags:["Researchers"],summary:"List all researchers with pagination and filters",request:{query:l.object({page:l.coerce.number().min(1).default(Eu).optional(),limit:l.coerce.number().min(1).default(vu).optional(),userId:l.string().optional(),registrationNumber:l.string().optional(),name:l.string().optional(),emailAddress:l.string().optional(),mainEtps:l.string().optional(),formations:l.string().optional(),occupations:l.string().optional(),institutions:l.string().optional(),biography:l.string().optional(),orderBy:l.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of researchers retrieved successfully with pagination",summary:"Researchers Retrieved",content:{"application/json":{schema:l.object({page:l.number(),totalPages:l.number(),offset:l.number(),limit:l.number(),researchers:l.array(wn)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:l.object({message:l.string()})}}}}},Da={method:"get",path:"/researcher/{id}",tags:["Researchers"],summary:"Find researcher by ID",request:{params:Zr},responses:{200:{description:"Researcher details retrieved successfully",summary:"Researcher Retrieved",content:{"application/json":{schema:wn}}},400:{description:"Invalid researcher ID format",summary:"Validation Error",content:{"application/json":{schema:l.object({errors:l.record(l.string(),l.string())})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:l.object({message:l.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:l.object({message:l.string()})}}}}},qa={method:"get",path:"/researcher/user/{userId}",tags:["Researchers"],summary:"Find researcher by user ID",request:{params:Rn},responses:{200:{description:"Researcher details retrieved successfully",summary:"Researcher Retrieved",content:{"application/json":{schema:wn}}},400:{description:"Invalid user ID format",summary:"Validation Error",content:{"application/json":{schema:l.object({errors:l.record(l.string(),l.string())})}}},404:{description:"Researcher not found for this user",summary:"Researcher Not Found",content:{"application/json":{schema:l.object({message:l.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:l.object({message:l.string()})}}}}},Ba={method:"put",path:"/researcher/{id}",tags:["Researchers"],summary:"Update researcher profile",security:[{bearerAuth:[]}],request:{params:Zr,body:{content:{"application/json":{schema:In.omit({id:!0})}}}},responses:{200:{description:"Researcher profile updated successfully",summary:"Researcher Updated",content:{"application/json":{schema:l.object({message:l.string()})}}},400:{description:"Invalid input data or researcher ID format",summary:"Validation Error",content:{"application/json":{schema:l.object({errors:l.record(l.string(),l.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:l.object({message:l.string()})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:l.object({message:l.string()})}}},409:{description:"Researcher with this registration number already exists",summary:"Conflict",content:{"application/json":{schema:l.object({message:l.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:l.object({message:l.string()})}}}}},Oa={method:"delete",path:"/researcher/{id}",tags:["Researchers"],summary:"Delete researcher profile",security:[{bearerAuth:[]}],request:{params:gn},responses:{200:{description:"Researcher profile deleted successfully",summary:"Researcher Deleted"},400:{description:"Invalid researcher ID format",summary:"Validation Error",content:{"application/json":{schema:l.object({errors:l.record(l.string(),l.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:l.object({message:l.string()})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:l.object({message:l.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:l.object({message:l.string()})}}}}};import{$Enums as Au}from"@prisma/client";import v from"zod";import{extendZodWithOpenApi as ju}from"@asteasolutions/zod-to-openapi";import tt from"zod";ju(tt);var Cn=tt.object({role:tt.string().min(1),description:tt.string().optional(),userId:tt.uuid(),order:tt.number().optional()}),Yr=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{role:t,description:i,userId:n,order:s}=Cn.parse(e.body);return await this.sdhcTeamMemberRepository.create({role:t,description:i,userId:n,order:s??0}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as xu}from"@asteasolutions/zod-to-openapi";import Sn from"zod";xu(Sn);var Mn=Sn.object({id:Sn.uuid()}),$r=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t}=Mn.parse({id:e.params.id});if(!await this.sdhcTeamMemberRepository.findById(t))throw new p("O membro da equipe SDHC n\xE3o existe.");return await this.sdhcTeamMemberRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Tu}from"@asteasolutions/zod-to-openapi";import En from"zod";Tu(En);var Jr=En.object({id:En.uuid()}),Xr=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t}=Jr.parse({id:e.params.id}),i=await this.sdhcTeamMemberRepository.findById(t);if(!i)throw new p("O membro da equipe SDHC n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Pu}from"@asteasolutions/zod-to-openapi";import Be from"zod";Pu(Be);var vn=Be.object({id:Be.uuid(),role:Be.string().min(1).optional(),description:Be.string().optional(),userId:Be.uuid().optional(),order:Be.number().optional()}),Qr=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t,role:i,description:n,userId:s,order:m}=vn.parse({id:e.params.id,...e.body});if(!await this.sdhcTeamMemberRepository.findById(t))throw new p("O membro da equipe SDHC n\xE3o existe.");return await this.sdhcTeamMemberRepository.update({id:t,role:i,description:n,userId:s,order:m}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Uu=v.object({id:v.uuid(),name:v.string(),emailAddress:v.string(),avatarUrl:v.string().nullable(),orcid:v.string().nullable(),phone:v.string().nullable(),lattesUrl:v.string().nullable(),role:v.enum(Au.UserRole)}),Na=v.object({id:v.uuid(),role:v.string(),description:v.string().nullable(),order:v.number(),createdAt:v.date(),updatedAt:v.date(),userId:v.uuid(),user:Uu}),ka={method:"post",path:"/sdhc-team-member",tags:["SDHC Team Members"],summary:"Create a new SDHC Team Member",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Cn}}}},responses:{201:{description:"SDHC Team Member created successfully",summary:"SDHC Team Member Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},La={method:"get",path:"/sdhc-team-member",tags:["SDHC Team Members"],summary:"List all SDHC Team Members with filters",request:{query:v.object({role:v.string().optional(),orderBy:v.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of SDHC Team Members retrieved successfully",summary:"SDHC Team Members Retrieved",content:{"application/json":{schema:v.object({members:v.array(Na)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},_a={method:"get",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Find SDHC Team Member by ID",request:{params:Jr},responses:{200:{description:"SDHC Team Member details retrieved successfully",summary:"SDHC Team Member Retrieved",content:{"application/json":{schema:Na}}},400:{description:"Invalid SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},Ha={method:"put",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Update SDHC Team Member",security:[{bearerAuth:[]}],request:{params:Jr,body:{content:{"application/json":{schema:vn.omit({id:!0})}}}},responses:{200:{description:"SDHC Team Member updated successfully",summary:"SDHC Team Member Updated"},400:{description:"Invalid input data or SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},za={method:"delete",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Delete SDHC Team Member",security:[{bearerAuth:[]}],request:{params:Mn},responses:{200:{description:"SDHC Team Member deleted successfully",summary:"SDHC Team Member Deleted"},400:{description:"Invalid SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}};import{$Enums as Za}from"@prisma/client";import x from"zod";import{extendZodWithOpenApi as Fu}from"@asteasolutions/zod-to-openapi";import jn from"zod";Fu(jn);var xn=jn.object({id:jn.string()}),eo=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{id:t}=xn.parse({id:e.params.id}),i=await this.userRepository.findById(t);if(!i)throw new p("O usu\xE1rio n\xE3o existe.");let n=e.user.id;if(i.id!==n)throw new V("Voc\xEA n\xE3o tem permiss\xE3o para deletar o usu\xE1rio");return await this.userRepository.deleteById(i.id),r.sendStatus(204)}catch(t){if(console.log(t),t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Du}from"@asteasolutions/zod-to-openapi";import{z as Tn}from"zod";Du(Tn);var Pn=Tn.object({id:Tn.string().min(1,"id do usu\xE1rio n\xE3o fornecido.")}),to=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{id:t}=Pn.parse(e.params),i=await this.userRepository.findById(t);if(!i)throw new p("Usu\xE1rio n\xE3o encontrado");r.status(200).json(i)}catch(t){if(console.log(t),t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as qu}from"@asteasolutions/zod-to-openapi";import Oe from"zod";var Ga=2,Wa=1024,Bu=Wa*Wa,Ou=Ga*Bu,Nu=/^\d{4}-\d{4}-\d{4}-\d{4}$/,ku=/^\(?\d{2}\)?[\s-]?\d{4,5}-?\d{4}$/;qu(Oe);var An=Oe.object({name:Oe.string().optional(),lattesUrl:Oe.string().optional(),orcid:Oe.string().optional().transform(o=>o===void 0?void 0:o.trim()).refine(o=>o===void 0||o===""||Nu.test(o),{message:"ORCID inv\xE1lido. Deve estar no formato 0000-0000-0000-0000"}),phone:Oe.string().optional().refine(o=>o===void 0||o===""||ku.test(o),{message:"Telefone inv\xE1lido. Deve estar no formato (99) 99999-9999"}),avatarImage:Oe.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Ou,`A imagem deve ter no m\xE1ximo ${Ga}MB.`).optional()}),ro=class{constructor(e,r){this.userRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{avatarImage:t,...i}=An.parse({...e.body,avatarImage:e.file}),n=e.user.id,s=await this.userRepository.findById(n);if(!s)throw new z("O usu\xE1rio n\xE3o existe");let m=s.avatarUrl;return t&&(s.avatarUrl?m=await this.firebaseStorageService.updateFile({file:t,id:n,folder:A.USER,fileUrl:s.avatarUrl}):m=await this.firebaseStorageService.uploadFile({file:t,id:n,folder:A.USER})),await this.userRepository.update({...i,id:n,avatarUrl:m||void 0}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Ka={method:"get",path:"/users/{id}",tags:["Users"],summary:"Find user by ID",request:{params:Pn},responses:{200:{description:"User details retrieved successfully",summary:"User Retrieved",content:{"application/json":{schema:x.object({id:x.string(),name:x.string(),createdAt:x.date(),updatedAt:x.date(),role:x.enum(Za.UserRole),lattesUrl:x.string().nullable(),orcid:x.string().nullable(),phone:x.string().nullable(),avatarUrl:x.url().nullable(),emailAddress:x.email()})}}},400:{description:"Invalid user ID format",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},404:{description:"User not found with the provided ID",summary:"User Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Va={method:"put",path:"/users",tags:["Users"],summary:"Update authenticated user",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:An}}}},responses:{200:{description:"User profile updated successfully",summary:"User Updated",content:{"application/json":{schema:x.object({message:x.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},401:{description:"User not authenticated or unauthorized",summary:"Authentication Required",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Ya={method:"delete",path:"/users",tags:["Users"],summary:"Delete authenticated user",security:[{bearerAuth:[]}],request:{params:xn},responses:{200:{description:"User account deleted successfully",summary:"User Deleted",content:{"application/json":{schema:x.object({message:x.string()})}}},400:{description:"Invalid request parameters",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},401:{description:"User not authenticated or unauthorized",summary:"Authentication Required",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},$a={method:"get",path:"/users",tags:["Users"],summary:"List users",responses:{200:{description:"Complete list of users retrieved successfully",summary:"Users Retrieved",content:{"application/json":{schema:x.array(x.object({id:x.string(),name:x.string(),createdAt:x.date(),updatedAt:x.date(),role:x.enum(Za.UserRole),lattesUrl:x.url().nullable(),orcid:x.string().nullable(),phone:x.string().nullable(),avatarUrl:x.string().nullable(),emailAddress:x.email()}))}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}};var y=new Lu;y.registerComponent("securitySchemes","bearerAuth",{type:"http",scheme:"bearer",bearerFormat:"JWT"});y.registerPath(ts);y.registerPath(rs);y.registerPath(os);y.registerPath(is);y.registerPath(ss);y.registerPath(as);y.registerPath(ns);y.registerPath(Ka);y.registerPath(Va);y.registerPath(Ya);y.registerPath($a);y.registerPath(ta);y.registerPath(ra);y.registerPath(oa);y.registerPath(ia);y.registerPath(ms);y.registerPath(cs);y.registerPath(ps);y.registerPath(ds);y.registerPath(us);y.registerPath(ya);y.registerPath(ha);y.registerPath(Ra);y.registerPath(Ia);y.registerPath(ba);y.registerPath(Ss);y.registerPath(Ms);y.registerPath(Es);y.registerPath(vs);y.registerPath(js);y.registerPath(Ua);y.registerPath(Fa);y.registerPath(Da);y.registerPath(qa);y.registerPath(Ba);y.registerPath(Oa);y.registerPath(fs);y.registerPath(gs);y.registerPath(ys);y.registerPath(hs);y.registerPath(Rs);y.registerPath(pa);y.registerPath(da);y.registerPath(ua);y.registerPath(la);y.registerPath(fa);y.registerPath(qs);y.registerPath(Bs);y.registerPath(Os);y.registerPath(Ns);y.registerPath(ks);y.registerPath(ka);y.registerPath(La);y.registerPath(_a);y.registerPath(Ha);y.registerPath(za);y.registerPath(Ts);y.registerPath(Ps);y.registerPath(As);y.registerPath(Us);y.registerPath(Fs);y.registerPath(va);y.registerPath(ja);y.registerPath(xa);y.registerPath(Ta);y.registerPath(Pa);y.registerPath(Aa);y.registerPath(Vs);y.registerPath(Ys);y.registerPath($s);y.registerPath(Xs);y.registerPath(Js);y.registerPath(Qs);y.registerPath(Ws);y.registerPath(Gs);y.registerPath(Zs);y.registerPath(Ks);var Hu=new _u(y.definitions),Xa=Hu.generateDocument({openapi:"3.0.0",info:{title:"API da Rede CT",version:"1.0.0",description:"API com valida\xE7\xE3o Zod"}});import{Router as Yu}from"express";import{extendZodWithOpenApi as zu}from"@asteasolutions/zod-to-openapi";import Un from"zod";zu(Un);var Wu=Un.object({authenticatedUserId:Un.uuid()}),oo=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{authenticatedUserId:t}=Wu.parse({authenticatedUserId:e.user.id}),i=await this.userRepository.findById(t);if(!i)throw new p("Usu\xE1rio n\xE3o encontrado.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{PrismaClient as Gu}from"@prisma/client";var F=new Gu({log:["warn","error"]});var io=class{constructor(e){this.prisma=e}async register({userId:e,title:r,description:t,certificationUrl:i}){await this.prisma.certification.create({data:{title:r,description:t,certificationUrl:i,user:{connect:{id:e}}}})}async find({pagination:{offset:e,limit:r},filter:{description:t,orderBy:i,title:n,userId:s}}){let m={},c=[];return s&&(m.userId=s),n&&c.push({title:{contains:n,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.certification.findMany({where:m,include:{user:{omit:{passwordHash:!0}}},orderBy:{updatedAt:i},skip:e,take:r})}async findById(e){return await this.prisma.certification.findFirst({where:{id:e}})}async findByUserId({pagination:{limit:e,offset:r},filter:{description:t,orderBy:i,title:n},userId:s}){let m={userId:s},c=[];return n&&c.push({title:{contains:n,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.certification.findMany({where:m,include:{user:{omit:{passwordHash:!0}}},skip:r,take:e,orderBy:i?{updatedAt:i}:{updatedAt:"desc"}})}async update({id:e,...r}){await this.prisma.certification.update({where:{id:e},data:r})}async deleteById(e){await this.prisma.certification.delete({where:{id:e}})}async count({filter:{description:e,title:r,userId:t}}){let i={},n=[];return t&&(i.userId=t),r&&n.push({title:{contains:r,mode:"insensitive"}}),e&&n.push({description:{contains:e,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.certification.count({where:i})}};function Ee(){return new io(F)}var no=class{constructor(e){this.prisma=e}async create(e){await this.prisma.news.create({data:e})}async find({pagination:{offset:e,limit:r},filter:{authorId:t,content:i,title:n,orderBy:s}}){let m={};t&&(m.authorId={contains:t,mode:"insensitive"});let c=[];return n&&c.push({title:{contains:n,mode:"insensitive"}}),i&&c.push({content:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.news.findMany({where:m,omit:{authorId:!0},include:{author:!0},orderBy:{updatedAt:s},skip:e,take:r})}async findById(e){return await this.prisma.news.findUnique({where:{id:e},omit:{authorId:!0},include:{author:!0}})}async findByAuthorId({authorId:e,pagination:{offset:r,limit:t},filter:{orderBy:i="desc",content:n,title:s}}){let m={authorId:e},c=[];return s&&c.push({title:{contains:s,mode:"insensitive"}}),n&&c.push({content:{contains:n,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.news.findMany({omit:{authorId:!0},where:m,orderBy:{updatedAt:i},skip:r,take:t})}async update(e){await this.prisma.news.update({where:{id:e.id},data:{title:e.title,content:e.content,imageUrl:e.imageUrl}})}async delete(e){await this.prisma.news.delete({where:{id:e}})}async count({filter:{authorId:e,content:r,title:t}}){let i={};e&&(i.authorId={contains:e,mode:"insensitive"});let n=[];return t&&n.push({title:{contains:t,mode:"insensitive"}}),r&&n.push({content:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.news.count({where:i})}};function pe(){return new no(F)}var so=class{constructor(e){this.prisma=e}async create(e){await this.prisma.pendency.create({data:e})}async find({filter:{description:e,orderBy:r,title:t,status:i,userId:n},pagination:{limit:s,offset:m}}){let c={userId:n,AND:{status:{equals:i}}};e&&(c.description={contains:e,mode:"insensitive"});let d=[];return t&&d.push({title:{contains:t,mode:"insensitive"}}),d.length>0&&(c.OR=d),await this.prisma.pendency.findMany({where:c,orderBy:{updatedAt:r},include:{user:{omit:{passwordHash:!0}}},skip:m,take:s})}async findById(e){return await this.prisma.pendency.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async findByUserId({filter:{description:e,orderBy:r,title:t,status:i},pagination:{limit:n,offset:s},userId:m}){let c={userId:m,AND:{status:{equals:i}}},d=[];return e&&d.push({description:{contains:e,mode:"insensitive"}}),t&&d.push({title:{contains:t,mode:"insensitive"}}),d.length>0&&(c.OR=d),await this.prisma.pendency.findMany({where:c,orderBy:{updatedAt:r},include:{user:{omit:{passwordHash:!0}}},skip:s,take:n})}async update({id:e,...r}){await this.prisma.pendency.update({where:{id:e},data:r})}async deleteById(e){await this.prisma.pendency.delete({where:{id:e}})}async count({filter:{description:e,title:r,status:t,userId:i}}){let n={userId:i},s=[];return e&&s.push({description:{contains:e,mode:"insensitive"}}),r&&s.push({title:{contains:r,mode:"insensitive"}}),t&&s.push({status:{equals:t}}),s.length>0&&(n.OR=s),await this.prisma.pendency.count({where:n})}};function ve(){return new so(F)}var ao=class{constructor(e){this.prisma=e}async create(e){await this.prisma.user.create({data:e})}async update(e){await this.prisma.user.update({where:{id:e.id},data:{lattesUrl:e.lattesUrl??null,orcid:e.orcid??null,phone:e.phone??null,avatarUrl:e.avatarUrl??null}})}async deleteById(e){await this.prisma.user.delete({where:{id:e}})}async find(){return await this.prisma.user.findMany({omit:{passwordHash:!0}})}async findByEmail(e){return await this.prisma.user.findFirst({where:{emailAddress:e}})}async findById(e){return await this.prisma.user.findFirst({where:{id:e},omit:{passwordHash:!0}})}};function G(){return new ao(F)}import{compare as Zu,hash as Ku}from"bcryptjs";var mo=class{constructor(e,r){this.hashFn=e;this.compareFn=r}async hash(e){return await this.hashFn(e,6)}async compare({password:e,hashedPassword:r}){return await this.compareFn(e,r)}};function Fn(){return new mo(Ku,Zu)}import Ja from"jsonwebtoken";import Z from"zod";var Vu=Z.object({JWT_SECRET:Z.string(),FIREBASE_BUCKET:Z.string(),FIREBASE_CLIENT_EMAIL:Z.string(),FIREBASE_PRIVATE_KEY:Z.string(),FIREBASE_PROJECT_ID:Z.string(),FIREBASE_TYPE:Z.string(),FIREBASE_PRIVATE_KEY_ID:Z.string(),FIREBASE_CLIENT_ID:Z.string(),FIREBASE_AUTH_URI:Z.string(),FIREBASE_TOKEN_URI:Z.string(),FIREBASE_AUTH_PROVIDER_X509_CERT_URL:Z.string(),FIREBASE_CLIENT_X509_CERT_URL:Z.string()}),_=Vu.parse(process.env);var co=class{constructor(e,r){this.signFn=e;this.verifyFn=r}sign(e){try{return this.signFn(e,_.JWT_SECRET,{expiresIn:"3d",subject:e.id})}catch{return null}}verify(e){try{return this.verifyFn(e,_.JWT_SECRET)}catch{return null}}};function po(){return new co(Ja.sign,Ja.verify)}function Qa(){return{signUpController:new Pt(G(),Fn())}}function em(){return{signInController:new xt(G(),Fn(),po())}}function tm(){return{findAuthenticatedUserController:new oo(G())}}function rm(){return{findAuthenticatedUserController:new Et(pe())}}function om(){return{findAuthenticatedUserCertificationsController:new Mt(Ee())}}function im(){return{findAuthenticatedUserPendenciesController:new vt(ve())}}var uo=class{constructor(e){this.jwtService=e}authenticated(e,r,t){let i=e.headers.authorization;if(!i?.startsWith("Bearer "))return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});let n=i.split(" ")[1];if(!n)return r.status(401).json({message:"Token n\xE3o fornecido."});try{let s=this.jwtService.verify(n);if(!s)return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});e.user=s,t()}catch(s){if(console.log(s),s instanceof Error)return r.status(401).json({message:s.message})}}isAdmin(e,r,t){let i=e.headers.authorization;if(!i?.startsWith("Bearer "))return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});let n=i.split(" ")[1];if(!n)return r.status(401).json({message:"Token n\xE3o fornecido."});try{let s=this.jwtService.verify(n);if(!s)return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});if(s.role!=="ADMIN")return r.status(401).json({message:"\xC9 necess\xE1rio ter permiss\xF5es de administrador."});t()}catch(s){if(console.log(s),s instanceof Error)return r.status(401).json({message:s.message})}}};function D(){return{authMiddleware:new uo(po())}}var de=Yu(),{authMiddleware:gt}=D();de.post("/sign-up",async(o,e)=>{let{signUpController:r}=Qa();await r.handle(o,e)});de.post("/sign-in",async(o,e)=>{let{signInController:r}=em();await r.handle(o,e)});de.get("/user",(o,e,r)=>{gt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserController:r}=tm();await r.handle(o,e)});de.get("/user/news",(o,e,r)=>{gt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserController:r}=rm();await r.handle(o,e)});de.get("/admin",(o,e,r)=>{gt.isAdmin(o,e,r)},(o,e)=>{try{e.status(200).json({success:!0})}catch(r){r instanceof Error&&e.status(500).json({message:r.message})}});de.get("/certifications",(o,e,r)=>{gt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserCertificationsController:r}=om();await r.handle(o,e)});de.get("/pendencies",(o,e,r)=>{gt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserPendenciesController:r}=im();await r.handle(o,e)});import{Router as tl}from"express";import{getStorage as Xu}from"firebase-admin/storage";import{config as $u}from"dotenv";import nm from"firebase-admin";$u();var Dn=nm.initializeApp({credential:nm.credential.cert({clientEmail:_.FIREBASE_CLIENT_EMAIL,privateKey:_.FIREBASE_PRIVATE_KEY,projectId:_.FIREBASE_PROJECT_ID,type:_.FIREBASE_TYPE,privateKeyId:_.FIREBASE_PRIVATE_KEY_ID,clientId:_.FIREBASE_CLIENT_ID,authUri:_.FIREBASE_AUTH_URI,tokenUri:_.FIREBASE_TOKEN_URI,authProviderX509CertUrl:_.FIREBASE_AUTH_PROVIDER_X509_CERT_URL,clientX509CertUrl:_.FIREBASE_CLIENT_X509_CERT_URL}),storageBucket:_.FIREBASE_BUCKET});Dn.name?console.log("\u{1F525} Firebase conectado com sucesso!"):console.error("\u274C Erro ao se conectar ao Firebase.");var Ju=Xu(Dn),sm=Ju.bucket(_.FIREBASE_BUCKET);import{randomUUID as Qu}from"node:crypto";var el=/https:\/\/storage\.googleapis\.com\/[^/]+\/(.+)$/,lo=class{constructor(e){this.bucket=e}async uploadFile({file:e,folder:r,id:t}){let i=`${Qu()}-${e?.originalname}`,n=this.bucket.file(`${r}/${t}/${i}`);return await new Promise((s,m)=>{let c=n.createWriteStream({metadata:{contentType:e?.mimetype}});c.on("error",d=>{m(d)}),c.on("finish",async()=>{try{await n.makePublic();let d=`https://storage.googleapis.com/${this.bucket.name}/${n.name}`;s(d)}catch(d){m(d)}}),c.end(e.buffer)})}async updateFile({file:e,id:r,fileUrl:t,folder:i}){try{let n=this.getPath(t);if(!n)throw new Error("Arquivo n\xE3o encontrado.");let[s,m]=await Promise.all([this.bucket.file(n).delete(),this.uploadFile({file:e,id:r,folder:i})]);return m}catch{throw new Error("Erro ao atualizar o arquivo.")}}async deleteFile({fileUrl:e}){let r=this.getPath(e);if(!r)throw new Error("Arquivo n\xE3o encontrado.");try{await this.bucket.file(r).delete()}catch{throw new Error("Erro ao deletar o arquivo.")}}getPath(e){let r=e.match(el);return r?r[1]:null}};function U(){return new lo(sm)}function am(){return{registerCertificationController:new Dt(G(),Ee(),U())}}function mm(){return{findCertificationsController:new Ft(Ee())}}function cm(){return{findCertificationByIdController:new Ut(Ee())}}function pm(){return{updateCertificationController:new Bt(Ee(),U())}}function dm(){return{deleteCertificationController:new At(Ee(),U())}}import um from"multer";var q=um({storage:um.memoryStorage()});var Ne=tl(),{authMiddleware:yt}=D();Ne.post("/:user_id",(o,e,r)=>{yt.isAdmin(o,e,r)},q.single("certification"),async(o,e)=>{let{registerCertificationController:r}=am();await r.handle(o,e)});Ne.get("/",(o,e,r)=>{yt.isAdmin(o,e,r)},async(o,e)=>{let{findCertificationsController:r}=mm();await r.handle(o,e)});Ne.get("/:certification_id",(o,e,r)=>{yt.isAdmin(o,e,r)},async(o,e)=>{let{findCertificationByIdController:r}=cm();await r.handle(o,e)});Ne.put("/:certification_id",(o,e,r)=>{yt.isAdmin(o,e,r)},q.single("certification"),async(o,e)=>{let{updateCertificationController:r}=pm();await r.handle(o,e)});Ne.delete("/:certification_id",(o,e,r)=>{yt.isAdmin(o,e,r)},async(o,e)=>{let{deleteCertificationController:r}=dm();await r.handle(o,e)});import{Router as sl}from"express";import{extendZodWithOpenApi as rl}from"@asteasolutions/zod-to-openapi";import ue from"zod";var ol=1,il=9;rl(ue);var nl=ue.object({page:ue.coerce.number().min(1).default(ol),limit:ue.coerce.number().min(1).default(il),code:ue.string().optional(),title:ue.string().optional(),description:ue.string().optional(),notes:ue.string().optional(),orderBy:ue.enum(["asc","desc"]).default("desc")}),fo=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=nl.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.etpRepository.find({pagination:{offset:s,limit:i},filter:n}),this.etpRepository.count({filter:n})]),d=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:d,offset:s,limit:i,etps:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var go=class{constructor(e){this.prisma=e}async create(e){let{leaderId:r,deputyLeaderId:t,secretaryId:i,memberIds:n,...s}=e;await this.prisma.$transaction(async m=>{let c=await m.eTP.create({data:s});await m.eTPLeader.create({data:{etpId:c.id,researcherId:r}}),await m.eTPDeputy.create({data:{etpId:c.id,researcherId:t}}),await m.eTPSecretary.create({data:{etpId:c.id,researcherId:i}}),await m.eTP.update({where:{id:c.id},data:{members:{connect:n.map(d=>({id:d}))}}})})}async update(e){let{leaderId:r,deputyLeaderId:t,secretaryId:i,memberIds:n,...s}=e;await this.prisma.$transaction(async m=>{await m.eTP.update({where:{id:e.id},data:s}),await this.updateLeader(m,e.id,r),await this.updateDeputyLeader(m,e.id,t),await this.updateSecretary(m,e.id,i),await this.updateMembers(m,e.id,n)})}async updateLeader(e,r,t){t!==void 0&&(await e.eTPLeader.deleteMany({where:{etpId:r}}),t&&await e.eTPLeader.create({data:{etpId:r,researcherId:t}}))}async updateDeputyLeader(e,r,t){t!==void 0&&(await e.eTPDeputy.deleteMany({where:{etpId:r}}),t&&await e.eTPDeputy.create({data:{etpId:r,researcherId:t}}))}async updateSecretary(e,r,t){t!==void 0&&(await e.eTPSecretary.deleteMany({where:{etpId:r}}),t&&await e.eTPSecretary.create({data:{etpId:r,researcherId:t}}))}async updateMembers(e,r,t){t!==void 0&&await e.eTP.update({where:{id:r},data:{members:{set:t.map(i=>({id:i}))}}})}async deleteById(e){await this.prisma.eTP.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{code:t,title:i,description:n,notes:s,orderBy:m}}){let c={},d=[];return t&&d.push({code:{contains:t,mode:"insensitive"}}),i&&d.push({title:{contains:i,mode:"insensitive"}}),n&&d.push({description:{contains:n,mode:"insensitive"}}),s&&d.push({notes:{contains:s,mode:"insensitive"}}),d.length>0&&(c.OR=d),await this.prisma.eTP.findMany({where:c,include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}},orderBy:{updatedAt:m},skip:e,take:r})}async findById(e){return await this.prisma.eTP.findFirst({where:{id:e},include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}}})}async findByCode(e){return await this.prisma.eTP.findFirst({where:{code:e},include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}}})}async count({filter:{code:e,title:r,description:t,notes:i}}){let n={},s=[];return e&&s.push({code:{contains:e,mode:"insensitive"}}),r&&s.push({title:{contains:r,mode:"insensitive"}}),t&&s.push({description:{contains:t,mode:"insensitive"}}),i&&s.push({notes:{contains:i,mode:"insensitive"}}),s.length>0&&(n.OR=s),await this.prisma.eTP.count({where:n})}};function rt(){return new go(F)}function lm(){return{createETPController:new Nt(rt())}}function fm(){return{findETPsController:new fo(rt())}}function gm(){return{findETPByIdController:new Lt(rt())}}function ym(){return{updateETPController:new Ht(rt())}}function hm(){return{deleteETPController:new kt(rt())}}var ke=sl(),{authMiddleware:qn}=D();ke.post("/",(o,e,r)=>{qn.authenticated(o,e,r)},async(o,e)=>{let{createETPController:r}=lm();await r.handle(o,e)});ke.get("/",async(o,e)=>{let{findETPsController:r}=fm();await r.handle(o,e)});ke.get("/:id",async(o,e)=>{let{findETPByIdController:r}=gm();await r.handle(o,e)});ke.put("/:id",(o,e,r)=>{qn.authenticated(o,e,r)},async(o,e)=>{let{updateETPController:r}=ym();await r.handle(o,e)});ke.delete("/:id",(o,e,r)=>{qn.authenticated(o,e,r)},async(o,e)=>{let{deleteETPController:r}=hm();await r.handle(o,e)});import{Router as al}from"express";var yo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.inMemoriam.create({data:e})}async update(e){await this.prisma.inMemoriam.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.inMemoriam.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{name:t,biography:i,role:n,orderBy:s}}){let m={},c=[];return n&&(m.role=n),t&&c.push({name:{contains:t,mode:"insensitive"}}),i&&c.push({biography:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.inMemoriam.findMany({where:m,orderBy:{updatedAt:s},skip:e,take:r})}async findById(e){return await this.prisma.inMemoriam.findFirst({where:{id:e}})}async findByRole(e){return await this.prisma.inMemoriam.findMany({where:{role:e}})}async count({filter:{name:e,biography:r,role:t}}){let i={},n=[];return t&&(i.role=t),e&&n.push({name:{contains:e,mode:"insensitive"}}),r&&n.push({biography:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.inMemoriam.count({where:i})}};function Le(){return new yo(F)}function Rm(){return{createInMemoriamController:new Wt(Le(),U())}}function Im(){return{findInMemoriamsController:new Yt(Le())}}function bm(){return{findInMemoriamByIdController:new Zt(Le())}}function wm(){return{findInMemoriamByRoleController:new Vt(Le())}}function Cm(){return{updateInMemoriamController:new $t(Le(),U())}}function Sm(){return{deleteInMemoriamController:new Gt(Le(),U())}}var je=al(),{authMiddleware:Bn}=D();je.post("/",(o,e,r)=>{Bn.authenticated(o,e,r)},q.single("photo"),async(o,e)=>{let{createInMemoriamController:r}=Rm();await r.handle(o,e)});je.get("/",async(o,e)=>{let{findInMemoriamsController:r}=Im();await r.handle(o,e)});je.get("/:id",async(o,e)=>{let{findInMemoriamByIdController:r}=bm();await r.handle(o,e)});je.get("/role/:role",async(o,e)=>{let{findInMemoriamByRoleController:r}=wm();await r.handle(o,e)});je.put("/:id",(o,e,r)=>{Bn.authenticated(o,e,r)},q.single("photo"),async(o,e)=>{let{updateInMemoriamController:r}=Cm();await r.handle(o,e)});je.delete("/:id",(o,e,r)=>{Bn.authenticated(o,e,r)},async(o,e)=>{let{deleteInMemoriamController:r}=Sm();await r.handle(o,e)});import{Router as ml}from"express";var On=ml();On.get("/",(o,e)=>{e.status(200).json({message:"Rede CT"})});import{Router as kl}from"express";import{extendZodWithOpenApi as cl}from"@asteasolutions/zod-to-openapi";import k from"zod";cl(k);var pl=k.object({title:k.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),edition:k.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo"),startDate:k.coerce.date(),endDate:k.coerce.date(),description:k.string().optional(),location:k.string().optional(),congressLink:k.url("Link do congresso deve ser uma URL v\xE1lida").optional().or(k.literal("")),noticeUrl:k.url("URL do edital deve ser uma URL v\xE1lida").optional().or(k.literal("")),scheduleUrl:k.url("URL do cronograma deve ser uma URL v\xE1lida").optional().or(k.literal("")),programUrl:k.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida").optional().or(k.literal("")),adminReportUrl:k.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida").optional().or(k.literal("")),proceedingsUrl:k.url("URL dos anais deve ser uma URL v\xE1lida").optional().or(k.literal(""))}).refine(o=>o.endDate>=o.startDate,{message:"Data de t\xE9rmino deve ser posterior ou igual \xE0 data de in\xEDcio",path:["endDate"]}),ho=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let t=pl.parse(e.body);return await this.internationalScientificCongressRepository.create(t),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as dl}from"@asteasolutions/zod-to-openapi";import Nn from"zod";dl(Nn);var ul=Nn.object({id:Nn.uuid()}),Ro=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t}=ul.parse({id:e.params.id});if(!await this.internationalScientificCongressRepository.findById(t))throw new p("O congresso n\xE3o existe.");return await this.internationalScientificCongressRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ll}from"@asteasolutions/zod-to-openapi";import kn from"zod";ll(kn);var fl=kn.object({edition:kn.coerce.number().int().positive()}),Io=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{edition:t}=fl.parse({edition:e.params.edition}),i=await this.internationalScientificCongressRepository.findByEdition(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as gl}from"@asteasolutions/zod-to-openapi";import Ln from"zod";gl(Ln);var yl=Ln.object({id:Ln.uuid()}),bo=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t}=yl.parse({id:e.params.id}),i=await this.internationalScientificCongressRepository.findById(t);if(!i)throw new p("O congresso n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as hl}from"@asteasolutions/zod-to-openapi";import _e from"zod";var Rl=1,Il=10;hl(_e);var bl=_e.object({page:_e.coerce.number().min(1).default(Rl),limit:_e.coerce.number().min(1).default(Il),title:_e.string().optional(),edition:_e.coerce.number().int().positive().optional(),orderBy:_e.enum(["asc","desc"]).optional()}),wo=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=bl.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.internationalScientificCongressRepository.find({pagination:{offset:s,limit:i},filter:n}),this.internationalScientificCongressRepository.count({filter:n})]),d=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:d,offset:s,limit:i,congresses:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as wl}from"@asteasolutions/zod-to-openapi";import N from"zod";wl(N);var Cl=N.object({id:N.uuid(),title:N.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),edition:N.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo").optional(),startDate:N.coerce.date().optional(),endDate:N.coerce.date().optional(),description:N.string().optional(),location:N.string().optional(),congressLink:N.url("Link do congresso deve ser uma URL v\xE1lida").optional().or(N.literal("")),noticeUrl:N.url("URL do edital deve ser uma URL v\xE1lida").optional().or(N.literal("")),scheduleUrl:N.url("URL do cronograma deve ser uma URL v\xE1lida").optional().or(N.literal("")),programUrl:N.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida").optional().or(N.literal("")),adminReportUrl:N.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida").optional().or(N.literal("")),proceedingsUrl:N.url("URL dos anais deve ser uma URL v\xE1lida").optional().or(N.literal(""))}),Co=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t,...i}=Cl.parse({id:e.params.id,...e.body});if(!await this.internationalScientificCongressRepository.findById(t))throw new p("O congresso n\xE3o existe.");return await this.internationalScientificCongressRepository.update({...i,id:t}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var So=class{constructor(e){this.prisma=e}async create(e){await this.prisma.internationalScientificCongress.create({data:e})}async update(e){await this.prisma.internationalScientificCongress.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.internationalScientificCongress.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,edition:i,orderBy:n}}){let s={},m=[];return i&&(s.edition=i),t&&m.push({title:{contains:t,mode:"insensitive"}}),m.length>0&&(s.OR=m),await this.prisma.internationalScientificCongress.findMany({where:s,include:{partners:!0,galleries:!0},orderBy:n?{startDate:n}:{startDate:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.internationalScientificCongress.findFirst({where:{id:e},include:{partners:!0,galleries:!0}})}async findByEdition(e){return await this.prisma.internationalScientificCongress.findMany({where:{edition:e},include:{partners:!0,galleries:!0}})}async count({filter:{title:e,edition:r}}){let t={},i=[];return r&&(t.edition=r),e&&i.push({title:{contains:e,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.internationalScientificCongress.count({where:t})}};function le(){return new So(F)}function Mm(){return{createInternationalScientificCongressController:new ho(le())}}function Em(){return{findInternationalScientificCongressesController:new wo(le())}}function vm(){return{findInternationalScientificCongressByIdController:new bo(le())}}function jm(){return{findInternationalScientificCongressByEditionController:new Io(le())}}function xm(){return{updateInternationalScientificCongressController:new Co(le())}}function Tm(){return{deleteInternationalScientificCongressController:new Ro(le())}}import{extendZodWithOpenApi as Sl}from"@asteasolutions/zod-to-openapi";import ht from"zod";var Am=2,Pm=1024,Ml=Pm*Pm,El=Am*Ml;Sl(ht);var vl=ht.object({image:ht.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=El,`A imagem deve ter no m\xE1ximo ${Am}MB.`),caption:ht.string().optional(),congressId:ht.uuid()}),Mo=class{constructor(e,r,t){this.internationalScientificCongressGalleryRepository=e;this.internationalScientificCongressRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{image:t,caption:i,congressId:n}=vl.parse({...e.body,...e.params,image:e.file});if(!await this.internationalScientificCongressRepository.findById(n))throw new p("O congresso n\xE3o existe.");let m=await this.internationalScientificCongressGalleryRepository.create({imageUrl:"",caption:i||void 0,congressId:n}),c=await this.firebaseStorageService.uploadFile({file:t,id:m.id,folder:A.INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY});return await this.internationalScientificCongressGalleryRepository.update({id:m.id,imageUrl:c}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as jl}from"@asteasolutions/zod-to-openapi";import _n from"zod";jl(_n);var xl=_n.object({id:_n.uuid()}),Eo=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=xl.parse({id:e.params.id});if(!await this.internationalScientificCongressGalleryRepository.findById(t))throw new p("A imagem da galeria n\xE3o existe.");return await this.internationalScientificCongressGalleryRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Tl}from"@asteasolutions/zod-to-openapi";import ot from"zod";var Pl=1,Al=9;Tl(ot);var Ul=ot.object({congressId:ot.uuid(),page:ot.coerce.number().min(1).default(Pl),limit:ot.coerce.number().min(1).default(Al),caption:ot.string().optional()}),vo=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{congressId:t,page:i,limit:n,...s}=Ul.parse({congressId:e.params.congressId,...e.query}),m=n*i-n,[c,d]=await Promise.all([this.internationalScientificCongressGalleryRepository.findByCongressId({pagination:{offset:m,limit:n},filter:{congressId:t,...s}}),this.internationalScientificCongressGalleryRepository.count({filter:{congressId:t,caption:s.caption}})]),T=Math.max(Math.ceil(d/n),1);return r.status(200).json({page:i,totalPages:T,offset:m,limit:n,galleryImages:c})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Fl}from"@asteasolutions/zod-to-openapi";import Hn from"zod";Fl(Hn);var Dl=Hn.object({id:Hn.uuid()}),jo=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=Dl.parse({id:e.params.id}),i=await this.internationalScientificCongressGalleryRepository.findById(t);if(!i)throw new p("A imagem da galeria n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ql}from"@asteasolutions/zod-to-openapi";import Rt from"zod";var Fm=2,Um=1024,Bl=Um*Um,Ol=Fm*Bl;ql(Rt);var Nl=Rt.object({id:Rt.uuid(),image:Rt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Ol,`A imagem deve ter no m\xE1ximo ${Fm}MB.`).optional(),caption:Rt.string().optional()}),xo=class{constructor(e,r){this.internationalScientificCongressGalleryRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,image:i,caption:n}=Nl.parse({id:e.params.id,...e.body,image:e.file}),s=await this.internationalScientificCongressGalleryRepository.findById(t);if(!s)throw new p("A imagem da galeria n\xE3o existe.");let m=s.imageUrl;return i&&(m=await this.firebaseStorageService.uploadFile({file:i,id:t,folder:A.INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY})),await this.internationalScientificCongressGalleryRepository.update({id:t,imageUrl:m??void 0,caption:n||void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var To=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.congressGalleryItem.create({data:e})}async update(e){await this.prisma.congressGalleryItem.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.congressGalleryItem.delete({where:{id:e}})}async findByCongressId(e){let{pagination:r,filter:t}=e;return await this.prisma.congressGalleryItem.findMany({where:{congressId:t.congressId,...t.caption&&{caption:{contains:t.caption,mode:"insensitive"}}},skip:r.offset,take:r.limit})}async findById(e){return await this.prisma.congressGalleryItem.findFirst({where:{id:e}})}async count(e){let{filter:r}=e;return await this.prisma.congressGalleryItem.count({where:{congressId:r.congressId,...r.caption&&{caption:{contains:r.caption,mode:"insensitive"}}}})}};function it(){return new To(F)}function Dm(){return{createInternationalScientificCongressGalleryController:new Mo(it(),le(),U())}}function qm(){return{findInternationalScientificCongressGalleriesByCongressIdController:new vo(it())}}function Bm(){return{findInternationalScientificCongressGalleryByIdController:new jo(it())}}function Om(){return{updateInternationalScientificCongressGalleryController:new xo(it(),U())}}function Nm(){return{deleteInternationalScientificCongressGalleryController:new Eo(it())}}var K=kl(),{authMiddleware:nt}=D();K.post("/",(o,e,r)=>{nt.authenticated(o,e,r)},async(o,e)=>{let{createInternationalScientificCongressController:r}=Mm();await r.handle(o,e)});K.get("/",async(o,e)=>{let{findInternationalScientificCongressesController:r}=Em();await r.handle(o,e)});K.get("/:id",async(o,e)=>{let{findInternationalScientificCongressByIdController:r}=vm();await r.handle(o,e)});K.get("/edition/:edition",async(o,e)=>{let{findInternationalScientificCongressByEditionController:r}=jm();await r.handle(o,e)});K.put("/:id",(o,e,r)=>{nt.authenticated(o,e,r)},async(o,e)=>{let{updateInternationalScientificCongressController:r}=xm();await r.handle(o,e)});K.delete("/:id",(o,e,r)=>{nt.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressController:r}=Tm();await r.handle(o,e)});K.post("/:congressId/gallery",(o,e,r)=>{nt.authenticated(o,e,r)},q.single("image"),async(o,e)=>{let{createInternationalScientificCongressGalleryController:r}=Dm();await r.handle(o,e)});K.get("/:congressId/gallery",async(o,e)=>{let{findInternationalScientificCongressGalleriesByCongressIdController:r}=qm();await r.handle(o,e)});K.get("/gallery/:id",async(o,e)=>{let{findInternationalScientificCongressGalleryByIdController:r}=Bm();await r.handle(o,e)});K.put("/gallery/:id",(o,e,r)=>{nt.authenticated(o,e,r)},q.single("image"),async(o,e)=>{let{updateInternationalScientificCongressGalleryController:r}=Om();await r.handle(o,e)});K.delete("/gallery/:id",(o,e,r)=>{nt.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressGalleryController:r}=Nm();await r.handle(o,e)});import{Router as Hl}from"express";import{extendZodWithOpenApi as Ll}from"@asteasolutions/zod-to-openapi";import Po from"zod";Ll(Po);var _l=Po.object({role:Po.string().optional(),orderBy:Po.enum(["asc","desc"]).optional()}),Ao=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let t=_l.parse(e.query),i=await this.legitimatorCommitteeMemberRepository.find({filter:t});r.status(200).json({members:i})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Uo=class{constructor(e){this.prisma=e}async create(e){await this.prisma.legitimatorCommitteeMember.create({data:{...e,order:e.order??0}})}async update(e){let{id:r,...t}=e;await this.prisma.legitimatorCommitteeMember.update({where:{id:r},data:t})}async deleteById(e){await this.prisma.legitimatorCommitteeMember.delete({where:{id:e}})}async find({filter:{role:e,orderBy:r}}){let t={};return e&&(t.role={contains:e,mode:"insensitive"}),await this.prisma.legitimatorCommitteeMember.findMany({where:t,include:{user:{omit:{passwordHash:!0}}},orderBy:r?[{order:"asc"},{updatedAt:r}]:[{order:"asc"},{updatedAt:"desc"}]})}async findById(e){return await this.prisma.legitimatorCommitteeMember.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{role:e}}){let r={};return e&&(r.role={contains:e,mode:"insensitive"}),await this.prisma.legitimatorCommitteeMember.count({where:r})}};function st(){return new Uo(F)}function km(){return{createLegitimatorCommitteeMemberController:new Xt(st())}}function Lm(){return{findLegitimatorCommitteeMembersController:new Ao(st())}}function _m(){return{findLegitimatorCommitteeMemberByIdController:new Qt(st())}}function Hm(){return{updateLegitimatorCommitteeMemberController:new tr(st())}}function zm(){return{deleteLegitimatorCommitteeMemberController:new Jt(st())}}var He=Hl(),{authMiddleware:zn}=D();He.post("/",(o,e,r)=>{zn.authenticated(o,e,r)},async(o,e)=>{let{createLegitimatorCommitteeMemberController:r}=km();await r.handle(o,e)});He.get("/",async(o,e)=>{let{findLegitimatorCommitteeMembersController:r}=Lm();await r.handle(o,e)});He.get("/:id",async(o,e)=>{let{findLegitimatorCommitteeMemberByIdController:r}=_m();await r.handle(o,e)});He.put("/:id",(o,e,r)=>{zn.authenticated(o,e,r)},async(o,e)=>{let{updateLegitimatorCommitteeMemberController:r}=Hm();await r.handle(o,e)});He.delete("/:id",(o,e,r)=>{zn.authenticated(o,e,r)},async(o,e)=>{let{deleteLegitimatorCommitteeMemberController:r}=zm();await r.handle(o,e)});import{Router as Gl}from"express";import{extendZodWithOpenApi as zl}from"@asteasolutions/zod-to-openapi";import It from"zod";zl(It);var Wl=It.object({name:It.string().optional(),description:It.string().optional(),orderBy:It.enum(["asc","desc"]).default("desc")}),Fo=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let t=Wl.parse(e.query),i=await this.managementTeamRepository.find({filter:t});r.status(200).json({teams:i})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Do=class{constructor(e){this.prisma=e}async create(e){let{members:r,...t}=e;await this.prisma.$transaction(async i=>{let n=await i.managementTeam.create({data:t});return await i.managementTeamMember.createMany({data:r.map(({userId:s,role:m,order:c})=>({teamId:n.id,userId:s,role:m,order:c??0}))}),n})}async update(e){let{members:r,...t}=e;await this.prisma.$transaction(async i=>{let n=await i.managementTeam.update({where:{id:e.id},data:t});return r!==void 0&&(await i.managementTeamMember.deleteMany({where:{teamId:e.id}}),r.length>0&&await i.managementTeamMember.createMany({data:r.map(({userId:s,role:m,order:c})=>({teamId:e.id,userId:s,role:m,order:c??0}))})),n})}async deleteById(e){await this.prisma.managementTeam.delete({where:{id:e}})}async find({filter:{name:e,description:r,orderBy:t}}){let i={},n=[];return e&&n.push({name:{contains:e,mode:"insensitive"}}),r&&n.push({description:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.managementTeam.findMany({where:i,include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}},orderBy:{updatedAt:t}})}async findById(e){return await this.prisma.managementTeam.findFirst({where:{id:e},include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}}})}async findByName(e){return await this.prisma.managementTeam.findFirst({where:{name:e},include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}}})}async count({filter:{name:e,description:r}}){let t={},i=[];return e&&i.push({name:{contains:e,mode:"insensitive"}}),r&&i.push({description:{contains:r,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.managementTeam.count({where:t})}};function at(){return new Do(F)}function Wm(){return{createManagementTeamController:new rr(at())}}function Gm(){return{findManagementTeamsController:new Fo(at())}}function Zm(){return{findManagementTeamByIdController:new ir(at())}}function Km(){return{updateManagementTeamController:new sr(at())}}function Vm(){return{deleteManagementTeamController:new or(at())}}var ze=Gl(),{authMiddleware:Wn}=D();ze.post("/",(o,e,r)=>{Wn.authenticated(o,e,r)},async(o,e)=>{let{createManagementTeamController:r}=Wm();await r.handle(o,e)});ze.get("/",async(o,e)=>{let{findManagementTeamsController:r}=Gm();await r.handle(o,e)});ze.get("/:id",async(o,e)=>{let{findManagementTeamByIdController:r}=Zm();await r.handle(o,e)});ze.put("/:id",(o,e,r)=>{Wn.authenticated(o,e,r)},async(o,e)=>{let{updateManagementTeamController:r}=Km();await r.handle(o,e)});ze.delete("/:id",(o,e,r)=>{Wn.authenticated(o,e,r)},async(o,e)=>{let{deleteManagementTeamController:r}=Vm();await r.handle(o,e)});import{Router as Vl}from"express";var qo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.meeting.create({data:e})}async update(e){await this.prisma.meeting.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.meeting.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,format:i,status:n,orderBy:s}}){let m={},c=[];return i&&(m.format=i),n&&(m.status=n),t&&c.push({title:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.meeting.findMany({where:m,include:{minutes:!0},orderBy:s?{scheduledAt:s}:{scheduledAt:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.meeting.findFirst({where:{id:e},include:{minutes:!0}})}async findByStatus(e){return await this.prisma.meeting.findMany({where:{status:e},include:{minutes:!0}})}async count({filter:{title:e,format:r,status:t}}){let i={},n=[];return r&&(i.format=r),t&&(i.status=t),e&&n.push({title:{contains:e,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.meeting.count({where:i})}};function fe(){return new qo(F)}function Ym(){return{createMeetingController:new dr(fe())}}function $m(){return{findMeetingsController:new yr(fe())}}function Xm(){return{findMeetingByIdController:new lr(fe())}}function Jm(){return{findMeetingByStatusController:new gr(fe())}}function Qm(){return{updateMeetingController:new hr(fe())}}function ec(){return{deleteMeetingController:new ur(fe())}}import{extendZodWithOpenApi as Zl}from"@asteasolutions/zod-to-openapi";import Gn from"zod";Zl(Gn);var Kl=Gn.object({meetingId:Gn.uuid()}),Bo=class{constructor(e,r){this.meetingMinuteRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{meetingId:t}=Kl.parse({meetingId:e.params.meetingId}),i=await this.meetingMinuteRepository.findByMeetingId(t);if(!i)throw new p("A ata n\xE3o existe para esta reuni\xE3o.");return i.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl}),await this.meetingMinuteRepository.deleteByMeetingId(i.id),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Oo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.meetingMinute.create({data:e,include:{meeting:!0}})}async update(e){await this.prisma.meetingMinute.update({where:{id:e.id},data:e})}async deleteByMeetingId(e){await this.prisma.meetingMinute.delete({where:{id:e}})}async findByMeetingId(e){return await this.prisma.meetingMinute.findFirst({where:{meetingId:e},include:{meeting:!0}})}};function bt(){return new Oo(F)}function tc(){return{createMeetingMinuteController:new ar(bt(),fe(),U())}}function rc(){return{findMeetingMinuteByMeetingIdController:new mr(bt())}}function oc(){return{updateMeetingMinuteByMeetingIdController:new cr(bt(),U())}}function ic(){return{deleteMeetingMinuteByMeetingIdController:new Bo(bt(),U())}}var J=Vl(),{authMiddleware:mt}=D();J.post("/",(o,e,r)=>{mt.authenticated(o,e,r)},async(o,e)=>{let{createMeetingController:r}=Ym();await r.handle(o,e)});J.get("/",async(o,e)=>{let{findMeetingsController:r}=$m();await r.handle(o,e)});J.get("/:id",async(o,e)=>{let{findMeetingByIdController:r}=Xm();await r.handle(o,e)});J.get("/status/:status",async(o,e)=>{let{findMeetingByStatusController:r}=Jm();await r.handle(o,e)});J.put("/:id",(o,e,r)=>{mt.authenticated(o,e,r)},async(o,e)=>{let{updateMeetingController:r}=Qm();await r.handle(o,e)});J.delete("/:id",(o,e,r)=>{mt.authenticated(o,e,r)},async(o,e)=>{let{deleteMeetingController:r}=ec();await r.handle(o,e)});J.post("/:meetingId/minute",(o,e,r)=>{mt.authenticated(o,e,r)},q.single("document"),async(o,e)=>{let{createMeetingMinuteController:r}=tc();await r.handle(o,e)});J.get("/:meetingId/minute",async(o,e)=>{let{findMeetingMinuteByMeetingIdController:r}=rc();await r.handle(o,e)});J.put("/:meetingId/minute",(o,e,r)=>{mt.authenticated(o,e,r)},q.single("document"),async(o,e)=>{let{updateMeetingMinuteByMeetingIdController:r}=oc();await r.handle(o,e)});J.delete("/:meetingId/minute",(o,e,r)=>{mt.authenticated(o,e,r)},async(o,e)=>{let{deleteMeetingMinuteByMeetingIdController:r}=ic();await r.handle(o,e)});import{Router as rf}from"express";import{extendZodWithOpenApi as Yl}from"@asteasolutions/zod-to-openapi";import Zn from"zod";Yl(Zn);var $l=Zn.object({id:Zn.string()}),No=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=$l.parse(e.params),i=e.user.id,n=await this.newsRepository.findById(t);if(!n)throw new p("Not\xEDcia n\xE3o encontrada.");if(n.author.id!==i)throw new V("Sem permiss\xE3o.");await Promise.all([this.newsRepository.delete(t),this.firebaseStorageService.deleteFile({fileUrl:n.imageUrl})]),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Xl}from"@asteasolutions/zod-to-openapi";import ct from"zod";var Jl=5,nc=1024,Ql=nc*nc,ef=Jl*Ql;Xl(ct);var tf=ct.object({id:ct.string(),title:ct.string().min(1),content:ct.string().min(1),image:ct.any().optional().refine(o=>!o||typeof o=="object"&&typeof o.mimetype=="string"&&o.mimetype.startsWith("image/")&&typeof o.size=="number"&&o.size<=ef,"A imagem deve ser uma imagem v\xE1lida de no m\xE1ximo 5MB.")}),ko=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,title:i,content:n,image:s}=tf.parse({id:e.params.id,image:e.file,...e.body}),m=await this.newsRepository.findById(t);if(!m)throw new p("Not\xEDcia n\xE3o encontrada.");let c=e.user.id;if(m.author.id!==c)throw new V("Sem permiss\xE3o.");let d=m.imageUrl||"";s&&m.imageUrl&&(d=await this.firebaseStorageService.updateFile({file:s,folder:A.NEWS,id:t,fileUrl:m.imageUrl}));let T=await this.newsRepository.update({id:t,title:i,content:n,imageUrl:d});r.status(200).json(T)}catch(t){if(t instanceof Error)throw new a(t.message)}}};function sc(){return{createNewsController:new Rr(pe(),U())}}function ac(){return{findAllNewsController:new Cr(pe())}}function mc(){return{findNewsByIdController:new wr(pe())}}function cc(){return{findNewsByAuthorIdController:new Ir(pe())}}function pc(){return{updateNewsController:new ko(pe(),U())}}function dc(){return{deleteNewsController:new No(pe(),U())}}var xe=rf(),{authMiddleware:Kn}=D();xe.post("/",(o,e,r)=>{Kn.authenticated(o,e,r)},q.single("image"),async(o,e)=>{let{createNewsController:r}=sc();await r.handle(o,e)});xe.get("/",async(o,e)=>{let{findAllNewsController:r}=ac();await r.handle(o,e)});xe.get("/:id",async(o,e)=>{let{findNewsByIdController:r}=mc();await r.handle(o,e)});xe.get("/author/:authorId",async(o,e)=>{let{findNewsByAuthorIdController:r}=cc();await r.handle(o,e)});xe.put("/:id",(o,e,r)=>{Kn.authenticated(o,e,r)},q.single("image"),async(o,e)=>{let{updateNewsController:r}=pc();await r.handle(o,e)});xe.delete("/:id",(o,e,r)=>{Kn.authenticated(o,e,r)},async(o,e)=>{let{deleteNewsController:r}=dc();await r.handle(o,e)});import{Router as of}from"express";var Lo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.partner.create({data:e})}async update(e){await this.prisma.partner.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.partner.delete({where:{id:e}})}async find({pagination:e,filter:{name:r,description:t,category:i,isActive:n,orderBy:s}}){let m={},c=[];return n!==void 0&&(m.isActive=n),r&&c.push({name:{contains:r,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),i&&c.push({category:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.partner.findMany({where:m,orderBy:s?{updatedAt:s}:{updatedAt:"desc"},...e&&{skip:e.offset,take:e.limit}})}async findById(e){return await this.prisma.partner.findFirst({where:{id:e}})}async count({filter:{name:e,description:r,category:t,isActive:i}}){let n={},s=[];return i!==void 0&&(n.isActive=i),e&&s.push({name:{contains:e,mode:"insensitive"}}),r&&s.push({description:{contains:r,mode:"insensitive"}}),t&&s.push({category:{contains:t,mode:"insensitive"}}),s.length>0&&(n.OR=s),await this.prisma.partner.count({where:n})}};function pt(){return new Lo(F)}function uc(){return{createPartnerController:new Sr(pt(),U())}}function lc(){return{findPartnersController:new jr(pt())}}function fc(){return{findPartnerByIdController:new Er(pt())}}function gc(){return{updatePartnerController:new xr(pt(),U())}}function yc(){return{deletePartnerController:new Mr(pt(),U())}}var We=of(),{authMiddleware:Vn}=D();We.post("/",(o,e,r)=>{Vn.authenticated(o,e,r)},q.single("logo"),async(o,e)=>{let{createPartnerController:r}=uc();await r.handle(o,e)});We.get("/",async(o,e)=>{let{findPartnersController:r}=lc();await r.handle(o,e)});We.get("/:id",async(o,e)=>{let{findPartnerByIdController:r}=fc();await r.handle(o,e)});We.put("/:id",(o,e,r)=>{Vn.authenticated(o,e,r)},q.single("logo"),async(o,e)=>{let{updatePartnerController:r}=gc();await r.handle(o,e)});We.delete("/:id",(o,e,r)=>{Vn.authenticated(o,e,r)},async(o,e)=>{let{deletePartnerController:r}=yc();await r.handle(o,e)});import{Router as nf}from"express";function hc(){return{createPendencyController:new Tr(G(),ve(),U())}}function Rc(){return{findPendenciesController:new Ur(ve())}}function Ic(){return{findPendencyByIdController:new Fr(ve())}}function bc(){return{updatePendencyController:new Dr(ve(),U())}}function wc(){return{deletePendencyController:new Ar(ve(),U())}}var Ge=nf(),{authMiddleware:wt}=D();Ge.post("/:user_id",(o,e,r)=>{wt.isAdmin(o,e,r)},q.single("document"),async(o,e)=>{let{createPendencyController:r}=hc();await r.handle(o,e)});Ge.get("/",(o,e,r)=>{wt.isAdmin(o,e,r)},async(o,e)=>{let{findPendenciesController:r}=Rc();await r.handle(o,e)});Ge.get("/:pendency_id",(o,e,r)=>{wt.isAdmin(o,e,r)},async(o,e)=>{let{findPendencyByIdController:r}=Ic();await r.handle(o,e)});Ge.put("/:pendency_id",(o,e,r)=>{wt.isAdmin(o,e,r)},q.single("document"),async(o,e)=>{let{updatePendencyController:r}=bc();await r.handle(o,e)});Ge.delete("/:pendency_id",(o,e,r)=>{wt.isAdmin(o,e,r)},async(o,e)=>{let{deletePendencyController:r}=wc();await r.handle(o,e)});import{Router as sf}from"express";var _o=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.regiment.create({data:e})}async update(e){await this.prisma.regiment.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.regiment.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,status:i,orderBy:n}}){let s={},m=[];return i&&(s.status=i),t&&m.push({title:{contains:t,mode:"insensitive"}}),m.length>0&&(s.OR=m),await this.prisma.regiment.findMany({where:s,orderBy:n?{updatedAt:n}:{updatedAt:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.regiment.findFirst({where:{id:e}})}async findByStatus(e){return await this.prisma.regiment.findMany({where:{status:e}})}async count({filter:{title:e,status:r}}){let t={},i=[];return r&&(t.status=r),e&&i.push({title:{contains:e,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.regiment.count({where:t})}};function Ze(){return new _o(F)}function Cc(){return{createRegimentController:new Br(Ze(),U())}}function Sc(){return{findRegimentsController:new _r(Ze())}}function Mc(){return{findRegimentByIdController:new Nr(Ze())}}function Ec(){return{findRegimentByStatusController:new Lr(Ze())}}function vc(){return{updateRegimentController:new Hr(Ze(),U())}}function jc(){return{deleteRegimentController:new Or(Ze(),U())}}var Te=sf(),{authMiddleware:Yn}=D();Te.post("/",(o,e,r)=>{Yn.authenticated(o,e,r)},q.single("document"),async(o,e)=>{let{createRegimentController:r}=Cc();await r.handle(o,e)});Te.get("/",async(o,e)=>{let{findRegimentsController:r}=Sc();await r.handle(o,e)});Te.get("/:id",async(o,e)=>{let{findRegimentByIdController:r}=Mc();await r.handle(o,e)});Te.get("/status/:status",async(o,e)=>{let{findRegimentByStatusController:r}=Ec();await r.handle(o,e)});Te.put("/:id",(o,e,r)=>{Yn.authenticated(o,e,r)},q.single("document"),async(o,e)=>{let{updateRegimentController:r}=vc();await r.handle(o,e)});Te.delete("/:id",(o,e,r)=>{Yn.authenticated(o,e,r)},async(o,e)=>{let{deleteRegimentController:r}=jc();await r.handle(o,e)});import{Router as df}from"express";import{extendZodWithOpenApi as af}from"@asteasolutions/zod-to-openapi";import W from"zod";var mf=1,cf=9;af(W);var pf=W.object({page:W.coerce.number().min(1).default(mf),limit:W.coerce.number().min(1).default(cf),userId:W.string().optional(),registrationNumber:W.string().optional(),name:W.string().optional(),emailAddress:W.string().optional(),mainEtps:W.string().optional(),formations:W.string().optional(),occupations:W.string().optional(),institutions:W.string().optional(),biography:W.string().optional(),orderBy:W.enum(["asc","desc"]).default("desc")}),Ho=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=pf.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.researcherRepository.find({pagination:{offset:s,limit:i},filter:{userName:n.name,...n}}),this.researcherRepository.count({filter:{userName:n.name,...n}})]),d=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:d,offset:s,limit:i,researchers:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var zo=class{constructor(e){this.prisma=e}async create(e){await this.prisma.researcher.create({data:e})}async update(e){await this.prisma.researcher.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.researcher.delete({where:{id:e}})}async find({pagination:e,filter:{biography:r,degrees:t,formations:i,institutions:n,mainEtps:s,occupations:m,orderBy:c,registrationNumber:d,seniority:T,userId:P,userName:O}}){let H={},ne=[];return O&&ne.push({user:{name:{contains:O,mode:"insensitive"}}}),d&&ne.push({registrationNumber:{contains:d,mode:"insensitive"}}),s&&ne.push({mainEtps:{contains:s,mode:"insensitive"}}),i&&ne.push({formations:{contains:i,mode:"insensitive"}}),m&&ne.push({occupations:{contains:m,mode:"insensitive"}}),n&&ne.push({institutions:{contains:n,mode:"insensitive"}}),r&&ne.push({biography:{contains:r,mode:"insensitive"}}),ne.length>0&&(H.OR=ne),t&&t.length>0&&(H.degrees={hasSome:t}),T&&(H.seniority=T),P&&(H.userId={equals:P}),await this.prisma.researcher.findMany({where:H,omit:{userId:!0},include:{user:{omit:{passwordHash:!0}}},orderBy:{updatedAt:c},...e&&{skip:e.offset,take:e.limit}})}async findById(e){return await this.prisma.researcher.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async findByUserId(e){return await this.prisma.researcher.findFirst({where:{userId:e},include:{user:{omit:{passwordHash:!0}}}})}async findByRegistrationNumber(e){return await this.prisma.researcher.findFirst({where:{registrationNumber:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{biography:e,degrees:r,formations:t,institutions:i,mainEtps:n,occupations:s,registrationNumber:m,seniority:c,userId:d,userName:T}}){let P={},O=[];return T&&O.push({user:{name:{contains:T,mode:"insensitive"}}}),m&&O.push({registrationNumber:{contains:m,mode:"insensitive"}}),O.length>0&&(P.OR=O),n&&(P.mainEtps={contains:n,mode:"insensitive"}),t&&(P.formations={contains:t,mode:"insensitive"}),r&&r.length>0&&(P.degrees={hasSome:r}),s&&(P.occupations={contains:s,mode:"insensitive"}),c&&(P.seniority=c),i&&(P.institutions={contains:i,mode:"insensitive"}),e&&(P.biography={contains:e,mode:"insensitive"}),d&&(P.userId={equals:d}),await this.prisma.researcher.count({where:P})}};function Ke(){return new zo(F)}function xc(){return{createResearcherController:new zr(Ke())}}function Tc(){return{findResearchersController:new Ho(Ke())}}function Pc(){return{findResearcherByIdController:new Gr(Ke())}}function Ac(){return{findResearcherByUserIdController:new Kr(Ke())}}function Uc(){return{updateResearcherController:new Vr(Ke())}}function Fc(){return{deleteResearcherController:new Wr(Ke())}}var Pe=df(),{authMiddleware:$n}=D();Pe.post("/",(o,e,r)=>{$n.authenticated(o,e,r)},async(o,e)=>{let{createResearcherController:r}=xc();await r.handle(o,e)});Pe.get("/",async(o,e)=>{let{findResearchersController:r}=Tc();await r.handle(o,e)});Pe.get("/:id",async(o,e)=>{let{findResearcherByIdController:r}=Pc();await r.handle(o,e)});Pe.get("/user/:userId",async(o,e)=>{let{findResearcherByUserIdController:r}=Ac();await r.handle(o,e)});Pe.put("/:id",(o,e,r)=>{$n.authenticated(o,e,r)},async(o,e)=>{let{updateResearcherController:r}=Uc();await r.handle(o,e)});Pe.delete("/:id",(o,e,r)=>{$n.authenticated(o,e,r)},async(o,e)=>{let{deleteResearcherController:r}=Fc();await r.handle(o,e)});import{Router as ff}from"express";import{extendZodWithOpenApi as uf}from"@asteasolutions/zod-to-openapi";import Wo from"zod";uf(Wo);var lf=Wo.object({role:Wo.string().optional(),orderBy:Wo.enum(["asc","desc"]).optional()}),Go=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let t=lf.parse(e.query),i=await this.sdhcTeamMemberRepository.find({filter:t});r.status(200).json({members:i})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Zo=class{constructor(e){this.prisma=e}async create(e){await this.prisma.sDHCTeamMember.create({data:{...e,order:e.order??0}})}async update(e){let{id:r,...t}=e;await this.prisma.sDHCTeamMember.update({where:{id:r},data:t})}async deleteById(e){await this.prisma.sDHCTeamMember.delete({where:{id:e}})}async find({filter:{role:e,orderBy:r}}){let t={};return e&&(t.role={contains:e,mode:"insensitive"}),await this.prisma.sDHCTeamMember.findMany({where:t,include:{user:{omit:{passwordHash:!0}}},orderBy:r?[{order:"asc"},{updatedAt:r}]:[{order:"asc"},{updatedAt:"desc"}]})}async findById(e){return await this.prisma.sDHCTeamMember.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{role:e}}){let r={};return e&&(r.role={contains:e,mode:"insensitive"}),await this.prisma.sDHCTeamMember.count({where:r})}};function dt(){return new Zo(F)}function Dc(){return{createSDHCTeamMemberController:new Yr(dt())}}function qc(){return{findSDHCTeamMembersController:new Go(dt())}}function Bc(){return{findSDHCTeamMemberByIdController:new Xr(dt())}}function Oc(){return{updateSDHCTeamMemberController:new Qr(dt())}}function Nc(){return{deleteSDHCTeamMemberController:new $r(dt())}}var Ve=ff(),{authMiddleware:Xn}=D();Ve.post("/",(o,e,r)=>{Xn.authenticated(o,e,r)},async(o,e)=>{let{createSDHCTeamMemberController:r}=Dc();await r.handle(o,e)});Ve.get("/",async(o,e)=>{let{findSDHCTeamMembersController:r}=qc();await r.handle(o,e)});Ve.get("/:id",async(o,e)=>{let{findSDHCTeamMemberByIdController:r}=Bc();await r.handle(o,e)});Ve.put("/:id",(o,e,r)=>{Xn.authenticated(o,e,r)},async(o,e)=>{let{updateSDHCTeamMemberController:r}=Oc();await r.handle(o,e)});Ve.delete("/:id",(o,e,r)=>{Xn.authenticated(o,e,r)},async(o,e)=>{let{deleteSDHCTeamMemberController:r}=Nc();await r.handle(o,e)});import{Router as gf}from"express";var Ko=class{constructor(e){this.userRepository=e}async handle(e,r){try{let t=await this.userRepository.find();r.status(200).json(t)}catch(t){if(t instanceof Error)throw new a(t.message)}}};function kc(){return{updateUserController:new ro(G(),U())}}function Lc(){return{deleteUserController:new eo(G())}}function _c(){return{findUsersController:new Ko(G())}}function Hc(){return{findUserController:new to(G())}}var ut=gf(),{authMiddleware:zc}=D();ut.get("/:id",async(o,e)=>{let{findUserController:r}=Hc();await r.handle(o,e)});ut.put("/",(o,e,r)=>{zc.authenticated(o,e,r)},q.single("avatarImage"),async(o,e)=>{let{updateUserController:r}=kc();await r.handle(o,e)});ut.delete("/:id",(o,e,r)=>{zc.authenticated(o,e,r)},async(o,e)=>{let{deleteUserController:r}=Lc();await r.handle(o,e)});ut.get("/",async(o,e)=>{let{findUsersController:r}=_c();await r.handle(o,e)});var B=Jn(),Rf={methods:["GET","POST","PUT","DELETE"],origin:["http://localhost:3000","https://rede-ct.vercel.app"],credentials:!0};B.use(hf(Rf));B.use(Jn.json());B.use(Jn.urlencoded({extended:!1}));B.use("/docs",yf({content:Xa,theme:"kepler"}));B.use("/",On);B.use("/auth",de);B.use("/user",ut);B.use("/news",xe);B.use("/certification",Ne);B.use("/pendency",Ge);B.use("/researcher",Pe);B.use("/in-memoriam",je);B.use("/etp",ke);B.use("/partner",We);B.use("/management-team",ze);B.use("/sdhc-team-member",Ve);B.use("/legitimator-committee-member",He);B.use("/regiment",Te);B.use("/meeting",J);B.use("/international-scientific-congress",K);B.use((o,e,r,t)=>{let{errorHandler:i}=Qn();i.handle(o,e,r,t)});var bf=If.createServer(B),Wc=4e3;bf.listen(Wc,()=>{console.log(`\u{1F680} Aplica\xE7\xE3o rodando na porta ${Wc}.`)});

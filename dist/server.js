import GR from"node:http";import{apiReference as NR}from"@scalar/express-api-reference";import kR from"cors";import Qa from"express";import uu from"zod";var ee=class extends Error{};var Y=class extends Error{};var s=class extends Error{};var l=class extends Error{};var ie=class extends Error{};import{ZodError as lu}from"zod";var Qt=class extends lu{};var er=class{handle(e,r,t,i){return e instanceof Qt?t.status(400).json({message:"Validation error",error:uu.treeifyError(e)}):e instanceof ee?t.status(400).json({message:e.message}):e instanceof l?t.status(404).json({message:e.message}):e instanceof ie?t.status(401).json({message:e.message}):e instanceof Y?t.status(409).json({message:e.message}):e instanceof s?t.status(500).json({message:e.message}):t.status(500).json({message:"Internal server error"})}};function em(){return{errorHandler:new er}}import{OpenAPIRegistry as vh,OpenApiGeneratorV3 as jh}from"@asteasolutions/zod-to-openapi";import{$Enums as tm}from"@prisma/client";import f from"zod";import{extendZodWithOpenApi as gu}from"@asteasolutions/zod-to-openapi";import Ke from"zod";var yu=1,fu=6;gu(Ke);var cn=Ke.object({page:Ke.coerce.number().min(1).default(yu),limit:Ke.coerce.number().min(1).default(fu),title:Ke.string().optional(),description:Ke.string().optional(),orderBy:Ke.enum(["asc","desc"]).default("desc")}),tr=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{title:t,description:i,limit:n,orderBy:a,page:m}=cn.parse(e.query),c=m*n-n,u=e.user.id,[T,k]=await Promise.all([this.certificationRepository.findByUserId({userId:u,pagination:{offset:c,limit:n},filter:{title:t,description:i,orderBy:a}}),this.certificationRepository.count({filter:{title:t,description:i,userId:u}})]),Z=Math.max(Math.ceil(k/n),1);return r.status(200).json({page:m,totalPages:Z,offset:c,limit:n,totalCertifications:k,certifications:T})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as hu}from"@asteasolutions/zod-to-openapi";import Ye from"zod";var Ru=1,Iu=7;hu(Ye);var pn=Ye.object({page:Ye.coerce.number().min(1).default(Ru),limit:Ye.coerce.number().min(1).default(Iu),title:Ye.string().optional(),content:Ye.string().optional(),orderBy:Ye.enum(["asc","desc"]).default("desc")}),rr=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,content:n,orderBy:a,title:m}=pn.parse(e.query),c=i*t-i,u=e.user.id,[T,k]=await Promise.all([this.newsRepository.findByAuthorId({authorId:u,pagination:{offset:c,limit:i},filter:{orderBy:a,title:m,content:n}}),this.newsRepository.count({filter:{authorId:u,content:n,title:m}})]),Z=Math.ceil(k/i);r.status(200).json({page:t,totalPages:Z,offset:c,limit:i,news:T})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Cu}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as bu}from"@prisma/client";import Te from"zod";var wu=1,Su=6;Cu(Te);var dn=Te.object({page:Te.coerce.number().min(1).default(wu),limit:Te.coerce.number().min(1).default(Su),title:Te.string().optional(),description:Te.string().optional(),status:Te.enum(bu).default("PENDING"),orderBy:Te.enum(["asc","desc"]).default("desc")}),or=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{limit:t,page:i,...n}=dn.parse(e.query),a=i*t-t,m=e.user.id,[c,u]=await Promise.all([this.pendencyRepository.findByUserId({userId:m,pagination:{offset:a,limit:t},filter:n}),this.pendencyRepository.count({filter:{...n,userId:m}})]),T=Math.max(Math.ceil(u/t),1);return r.status(200).json({page:i,totalPages:T,offset:a,limit:t,pendencies:c})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as vu}from"@asteasolutions/zod-to-openapi";import ir from"zod";vu(ir);var ln=ir.object({password:ir.string(),email:ir.email()}),nr=class{constructor(e,r,t){this.userRepository=e;this.bcrypt=r;this.jwtService=t}async handle(e,r){try{let{email:t,password:i}=ln.parse(e.body),n=await this.userRepository.findByEmail(t);if(!n)return r.status(401).json({message:"Usu\xE1rio n\xE3o existe."});if(!await this.bcrypt.compare({password:i,hashedPassword:n.passwordHash}))throw new ie("Senha inv\xE1lida.");let{id:m,role:c}=n,u=this.jwtService.sign({id:m,role:c,email:t});return r.status(200).json({token:u})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ju}from"@asteasolutions/zod-to-openapi";import ut from"zod";var sr=8;ju(ut);var un=ut.object({name:ut.string("Nome \xE9 obrigat\xF3rio.").min(1,"Nome \xE9 obrigat\xF3rio."),emailAddress:ut.email("E-mail inv\xE1lido.").min(1,"E-mail \xE9 obrigat\xF3rio."),password:ut.string("A senha \xE9 obrigat\xF3ria.").min(sr,`A senha deve ter pelo menos ${sr} caracteres.`),confirmPassword:ut.string("A senha \xE9 obrigat\xF3ria.").min(sr,`A senha deve ter pelo menos ${sr} caracteres.`)}).refine(o=>o.password===o.confirmPassword,{message:"As senhas n\xE3o coincidem.",path:["confirmPassword"]}),ar=class{constructor(e,r){this.userRepository=e;this.bcrypt=r}async handle(e,r){try{let{emailAddress:t,name:i,password:n}=un.parse(e.body);if(await this.userRepository.findByEmail(t))throw new Y("Usu\xE1rio j\xE1 existe.");let m=await this.bcrypt.hash(n);return await this.userRepository.create({name:i,emailAddress:t,passwordHash:m}),r.status(201).json()}catch(t){if(t instanceof Error)throw new s(t.message)}}};var rm={method:"post",path:"/auth/sign-up",tags:["Authentication"],summary:"Create a new user",request:{body:{content:{"application/json":{schema:un}}}},responses:{201:{description:"User created successfully",summary:"User Registration Successful",content:{"application/json":{schema:f.object({message:f.string()})}}},400:{description:"Invalid input data provided",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},409:{description:"User already exists with this email",summary:"User Already Exists",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},om={method:"post",path:"/auth/sign-in",tags:["Authentication"],summary:"Sign in",request:{body:{content:{"application/json":{schema:ln}}}},responses:{200:{description:"Authentication successful, JWT token returned",summary:"Login Successful",content:{"application/json":{schema:f.object({token:f.string()})}}},400:{description:"Invalid credentials or input data",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},401:{description:"Invalid email or password",summary:"Authentication Failed",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},im={method:"get",path:"/auth/user",tags:["Authentication"],summary:"Search for authenticated user",security:[{bearerAuth:[]}],responses:{200:{description:"Authenticated user information retrieved successfully",summary:"User Information Retrieved",content:{"application/json":{schema:f.object({name:f.string(),id:f.string(),avatarUrl:f.string().nullable(),createdAt:f.date(),updatedAt:f.date(),emailAddress:f.string(),orcid:f.string().nullable(),phone:f.string().nullable(),lattesUrl:f.string().nullable(),role:f.enum(tm.UserRole)}).nullable()}}},400:{description:"Invalid request parameters",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},404:{description:"User not found or not authenticated",summary:"User Not Found",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},nm={method:"get",path:"/auth/user/news",tags:["Authentication"],summary:"List authenticated user news",security:[{bearerAuth:[]}],request:{query:pn},responses:{200:{description:"Paginated list of authenticated user news retrieved successfully",summary:"User News Retrieved",content:{"application/json":{schema:f.object({page:f.number(),totalPages:f.number(),offset:f.number(),limit:f.number(),news:f.object({content:f.string(),id:f.string(),title:f.string(),createdAt:f.date(),updatedAt:f.date(),imageUrl:f.string().nullable()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},sm={method:"get",path:"/auth/admin",tags:["Authentication"],summary:"Verify admin access",security:[{bearerAuth:[]}],responses:{200:{description:"Admin access verified successfully",summary:"Admin Access Granted",content:{"application/json":{schema:f.object({success:f.boolean()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},am={method:"get",path:"/auth/certifications",tags:["Authentication"],summary:"List all authenticated user's certifications",security:[{bearerAuth:[]}],request:{query:cn},responses:{200:{description:"Paginated list of authenticated user certifications retrieved successfully",summary:"User Certifications Retrieved",content:{"application/json":{schema:f.object({page:f.number(),totalPages:f.number(),offset:f.number(),limit:f.number(),certifications:f.object({description:f.string(),id:f.string(),title:f.string(),certificationUrl:f.string(),createdAt:f.date(),updatedAt:f.date(),userId:f.string()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},mm={method:"get",path:"/auth/pendencies",tags:["Authentication"],summary:"List all authenticated user's pendencies",security:[{bearerAuth:[]}],request:{query:dn},responses:{200:{description:"Paginated list of authenticated user pendencies retrieved successfully",summary:"User Pendencies Retrieved",content:{"application/json":{schema:f.object({page:f.number(),totalPages:f.number(),offset:f.number(),limit:f.number(),pendencies:f.object({id:f.string(),title:f.string(),description:f.string(),status:f.enum(tm.PendencyStatus),createdAt:f.date(),updatedAt:f.date(),userId:f.string()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}};import{$Enums as Fu}from"@prisma/client";import b from"zod";import{extendZodWithOpenApi as Eu}from"@asteasolutions/zod-to-openapi";import gn from"zod";Eu(gn);var yn=gn.object({id:gn.string()}),mr=class{constructor(e,r){this.certificationRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=yn.parse({id:e.params.certification_id}),i=await this.certificationRepository.findById(t);if(!i)throw new l("A certifica\xE7\xE3o n\xE3o existe.");return await Promise.all([this.certificationRepository.deleteById(i.id),this.firebaseStorageService.deleteFile({fileUrl:i.certificationUrl})]),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as xu}from"@asteasolutions/zod-to-openapi";import fn from"zod";xu(fn);var hn=fn.object({certificationId:fn.uuid()}),cr=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{certificationId:t}=hn.parse({certificationId:e.params.certification_id}),i=await this.certificationRepository.findById(t);if(!i)throw new l("Certificado n\xE3o encontrado.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Mu}from"@asteasolutions/zod-to-openapi";import Ae from"zod";var Pu=1,Tu=6;Mu(Ae);var Rn=Ae.object({page:Ae.coerce.number().min(1).default(Pu),limit:Ae.coerce.number().min(1).default(Tu),title:Ae.string().optional(),description:Ae.string().optional(),userId:Ae.uuid().optional(),orderBy:Ae.enum(["asc","desc"]).default("desc")}),pr=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{limit:t,page:i,...n}=Rn.parse(e.query),a=i*t-t,[m,c]=await Promise.all([this.certificationRepository.find({pagination:{offset:a,limit:t},filter:n}),this.certificationRepository.count({filter:n})]),u=Math.max(Math.ceil(c/t),1);return r.status(200).json({page:i,totalPages:u,offset:a,limit:t,certifications:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Au}from"@asteasolutions/zod-to-openapi";import gt from"zod";var F={NEWS:"images/news",USER:"images/user",IN_MEMORIAM:"images/in-memoriam",PARTNER:"images/partners",CERTIFICATION:"documents/certifications",PENDENCY:"documents/pendencies",REGIMENT:"documents/regiments",MEETING_MINUTE:"documents/meeting-minutes",INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY:"images/international-scientific-congress-gallery",GALLERY:"images/regional-congress-gallery",REGIONAL_CONGRESS_GALLERY:"images/regional-congress-gallery",WEBINAR:"images/webinars"};Au(gt);var lr=gt.object({userId:gt.uuid(),title:gt.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio."),description:gt.string().min(1,"Descri\xE7\xE3o \xE9 obrigat\xF3ria."),certification:gt.any().refine(o=>o&&typeof o=="object"&&o.size>0,"Arquivo do certificado \xE9 obrigat\xF3rio")}),dr=class{constructor(e,r,t){this.userRepository=e;this.certificationRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{userId:t,title:i,description:n,certification:a}=lr.parse({...e.body,userId:e.params.user_id,certification:e.file});if(!await this.userRepository.findById(t))throw new ee("O usu\xE1rio n\xE3o existe.");let c=await this.firebaseStorageService.uploadFile({file:a,id:t,folder:F.CERTIFICATION});return await this.certificationRepository.register({userId:t,title:i,description:n,certificationUrl:c}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Du}from"@asteasolutions/zod-to-openapi";import yt from"zod";Du(yt);var gr=yt.object({id:yt.uuid(),title:yt.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio."),description:yt.string().min(1,"Descri\xE7\xE3o \xE9 obrigat\xF3ria."),certification:yt.any().refine(o=>o==null||typeof o=="object"&&typeof o.size=="number"&&(o.size===0||o.size>0),"Arquivo do certificado \xE9 inv\xE1lido").optional()}),ur=class{constructor(e,r){this.certificationRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{certification:t,id:i,...n}=gr.parse({...e.body,id:e.params.certification_id,certification:e.file}),a=await this.certificationRepository.findById(i);if(!a)throw new ee("A certifica\xE7\xE3o n\xE3o existe");let m=a.certificationUrl;return t&&t.size>0&&(m=await this.firebaseStorageService.updateFile({file:t,id:a.userId,folder:F.CERTIFICATION,fileUrl:a.certificationUrl})),await this.certificationRepository.update({...n,id:i,certificationUrl:m}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var cm={method:"post",path:"/certifications/{user_id}",tags:["Certifications"],summary:"Register certification for user",security:[{bearerAuth:[]}],request:{params:lr.pick({userId:!0}).transform(()=>({user_id:""})),body:{content:{"multipart/form-data":{schema:lr.omit({userId:!0})}}}},responses:{201:{description:"Certification registered successfully for the user",summary:"Certification Registered",content:{"application/json":{schema:b.object({message:b.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},404:{description:"User not found with the provided ID",summary:"User Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},pm={method:"get",path:"/certifications",tags:["Certifications"],summary:"List certifications",security:[{bearerAuth:[]}],request:{query:Rn},responses:{200:{description:"Paginated list of certifications with user information retrieved successfully",summary:"Certifications Retrieved",content:{"application/json":{schema:b.object({page:b.number(),totalPages:b.number(),offset:b.number(),limit:b.number(),certifications:b.array(b.object({description:b.string(),userId:b.string(),title:b.string(),id:b.string(),createdAt:b.date(),updatedAt:b.date(),certificationUrl:b.url(),user:b.object({id:b.uuid(),name:b.string(),createdAt:b.date(),updatedAt:b.date(),avatarUrl:b.string().nullable(),emailAddress:b.email(),orcid:b.string().nullable(),phone:b.string().nullable(),lattesUrl:b.url().nullable(),role:b.enum(Fu.UserRole)})}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},dm={method:"get",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Find certification by ID",security:[{bearerAuth:[]}],request:{params:hn},responses:{200:{description:"Certification details retrieved successfully",summary:"Certification Retrieved",content:{"application/json":{schema:b.object({description:b.string(),userId:b.string(),title:b.string(),id:b.string(),createdAt:b.date(),updatedAt:b.date(),certificationUrl:b.url()}).nullable()}}},400:{description:"Invalid certification ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},lm={method:"put",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Update certification",security:[{bearerAuth:[]}],request:{params:gr.pick({id:!0}).transform(()=>({certification_id:""})),body:{content:{"multipart/form-data":{schema:gr.omit({id:!0})}}}},responses:{204:{description:"Certification updated successfully",summary:"Certification Updated"},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},um={method:"delete",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Delete certification",security:[{bearerAuth:[]}],request:{params:yn},responses:{204:{description:"Certification deleted successfully",summary:"Certification Deleted"},400:{description:"Invalid certification ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}};import{$Enums as vn}from"@prisma/client";import R from"zod";import{extendZodWithOpenApi as Uu}from"@asteasolutions/zod-to-openapi";import ce from"zod";Uu(ce);var In=ce.object({code:ce.string(),title:ce.string(),description:ce.string().optional(),notes:ce.string().optional(),leaderId:ce.uuid(),deputyLeaderId:ce.uuid(),secretaryId:ce.uuid(),memberIds:ce.array(ce.uuid())}),yr=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{code:t,title:i,description:n,notes:a,leaderId:m,deputyLeaderId:c,secretaryId:u,memberIds:T}=In.parse(e.body);if(await this.etpRepository.findByCode(t))throw new Y("J\xE1 existe um ETP cadastrado com este c\xF3digo.");return await this.etpRepository.create({code:t,title:i,description:n,notes:a,leaderId:m,deputyLeaderId:c,secretaryId:u,memberIds:T}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as qu}from"@asteasolutions/zod-to-openapi";import Cn from"zod";qu(Cn);var bn=Cn.object({id:Cn.uuid()}),fr=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t}=bn.parse({id:e.params.id});if(!await this.etpRepository.findById(t))throw new l("O ETP n\xE3o existe.");return await this.etpRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Bu}from"@asteasolutions/zod-to-openapi";import wn from"zod";Bu(wn);var Rr=wn.object({id:wn.uuid()}),hr=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t}=Rr.parse({id:e.params.id}),i=await this.etpRepository.findById(t);if(!i)throw new l("O ETP n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ou}from"@asteasolutions/zod-to-openapi";import ne from"zod";Ou(ne);var Sn=ne.object({id:ne.uuid(),code:ne.string().optional(),title:ne.string().optional(),description:ne.string().optional(),notes:ne.string().optional(),leaderId:ne.uuid().optional(),deputyLeaderId:ne.uuid().optional(),secretaryId:ne.uuid().optional(),memberIds:ne.array(ne.uuid()).optional()}),Ir=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t,code:i,title:n,description:a,notes:m,leaderId:c,deputyLeaderId:u,secretaryId:T,memberIds:k}=Sn.parse({id:e.params.id,...e.body});if(!await this.etpRepository.findById(t))throw new l("O ETP n\xE3o existe.");if(i){let Q=await this.etpRepository.findByCode(i);if(Q&&Q.id!==t)throw new Y("J\xE1 existe um ETP com este c\xF3digo.")}return await this.etpRepository.update({id:t,code:i,title:n,description:a,notes:m,leaderId:c,deputyLeaderId:u,secretaryId:T,memberIds:k}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Nu=1,ku=9,Cr=R.object({id:R.uuid(),registrationNumber:R.string(),mainEtps:R.string().nullable(),formations:R.string().nullable(),degrees:R.array(R.enum(vn.Degree)),occupations:R.string(),seniority:R.enum(vn.Seniority),institutions:R.string(),biography:R.string().nullable(),createdAt:R.date(),updatedAt:R.date(),user:R.object({id:R.uuid(),name:R.string(),emailAddress:R.string(),avatarUrl:R.string().nullable(),orcid:R.string().nullable(),phone:R.string().nullable(),lattesUrl:R.string().nullable(),role:R.enum(vn.UserRole)})}),gm=R.object({id:R.uuid(),code:R.string(),title:R.string(),description:R.string().nullable(),notes:R.string().nullable(),createdAt:R.date(),updatedAt:R.date(),leader:R.object({id:R.uuid(),researcher:Cr}).nullable(),deputyLeader:R.object({id:R.uuid(),researcher:Cr}).nullable(),secretary:R.object({id:R.uuid(),researcher:Cr}).nullable(),members:R.array(Cr)}),ym={method:"post",path:"/etp",tags:["ETPs"],summary:"Create a new ETP with single leader, deputy leader, secretary and multiple members",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:In}}}},responses:{201:{description:"ETP created successfully",summary:"ETP Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},409:{description:"ETP with this code already exists",summary:"Conflict",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},fm={method:"get",path:"/etp",tags:["ETPs"],summary:"List all ETPs with pagination and filters",request:{query:R.object({page:R.coerce.number().min(1).default(Nu).optional(),limit:R.coerce.number().min(1).default(ku).optional(),code:R.string().optional(),title:R.string().optional(),description:R.string().optional(),notes:R.string().optional(),orderBy:R.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of ETPs retrieved successfully with pagination",summary:"ETPs Retrieved",content:{"application/json":{schema:R.object({page:R.number(),totalPages:R.number(),offset:R.number(),limit:R.number(),etps:R.array(gm)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},hm={method:"get",path:"/etp/{id}",tags:["ETPs"],summary:"Find ETP by ID",request:{params:Rr},responses:{200:{description:"ETP details retrieved successfully",summary:"ETP Retrieved",content:{"application/json":{schema:gm}}},400:{description:"Invalid ETP ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},Rm={method:"put",path:"/etp/{id}",tags:["ETPs"],summary:"Update ETP and manage user relationships (single leader, deputy leader, secretary, multiple members)",security:[{bearerAuth:[]}],request:{params:Rr,body:{content:{"application/json":{schema:Sn.omit({id:!0})}}}},responses:{200:{description:"ETP updated successfully",summary:"ETP Updated"},400:{description:"Invalid input data or ETP ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},409:{description:"ETP with this code already exists",summary:"Conflict",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},Im={method:"delete",path:"/etp/{id}",tags:["ETPs"],summary:"Delete ETP",security:[{bearerAuth:[]}],request:{params:bn},responses:{200:{description:"ETP deleted successfully",summary:"ETP Deleted"},400:{description:"Invalid ETP ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}};import{InMemoriamRole as rg}from"@prisma/client";import S from"zod";import{extendZodWithOpenApi as Lu}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as Gu}from"@prisma/client";import De from"zod";var bm=2,Cm=1024,_u=Cm*Cm,Wu=bm*_u;Lu(De);var jn=De.object({name:De.string().min(1,"Nome \xE9 obrigat\xF3rio"),birthDate:De.coerce.date(),deathDate:De.coerce.date(),biography:De.string().optional(),photo:De.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Wu,`A imagem deve ter no m\xE1ximo ${bm}MB.`).optional(),role:De.enum(Gu)}).refine(o=>o.deathDate>o.birthDate,{message:"Data de falecimento deve ser posterior \xE0 data de nascimento",path:["deathDate"]}),br=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{name:t,birthDate:i,deathDate:n,biography:a,role:m,photo:c}=jn.parse({...e.body,photo:e.file}),u=await this.inMemoriamRepository.create({name:t,birthDate:i,deathDate:n,biography:a??void 0,role:m}),T;return c&&(T=await this.firebaseStorageService.uploadFile({file:c,id:u.id,folder:F.IN_MEMORIAM}),await this.inMemoriamRepository.update({id:u.id,photoUrl:T})),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Hu}from"@asteasolutions/zod-to-openapi";import En from"zod";Hu(En);var xn=En.object({id:En.uuid()}),wr=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=xn.parse({id:e.params.id}),i=await this.inMemoriamRepository.findById(t);if(!i)throw new l("O in memoriam n\xE3o existe.");return i.photoUrl&&this.firebaseStorageService.deleteFile({fileUrl:i.photoUrl}),await this.inMemoriamRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as zu}from"@asteasolutions/zod-to-openapi";import Mn from"zod";zu(Mn);var vr=Mn.object({id:Mn.uuid()}),Sr=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{id:t}=vr.parse({id:e.params.id}),i=await this.inMemoriamRepository.findById(t);if(!i)throw new l("O in memoriam n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Zu}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as Vu}from"@prisma/client";import Pn from"zod";Zu(Pn);var Tn=Pn.object({role:Pn.enum(Vu)}),jr=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{role:t}=Tn.parse({role:e.params.role}),i=await this.inMemoriamRepository.findByRole(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ku}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as Yu}from"@prisma/client";import Fe from"zod";var Xu=1,$u=9;Ku(Fe);var An=Fe.object({page:Fe.coerce.number().min(1).default(Xu),limit:Fe.coerce.number().min(1).default($u),name:Fe.string().optional(),biography:Fe.string().optional(),role:Fe.enum(Yu).optional(),orderBy:Fe.enum(["asc","desc"]).default("desc")}),Er=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=An.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.inMemoriamRepository.find({pagination:{offset:a,limit:i},filter:n}),this.inMemoriamRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:a,limit:i,inMemoriam:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ju}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as Qu}from"@prisma/client";import Ce from"zod";var Sm=2,wm=1024,eg=wm*wm,tg=Sm*eg;Ju(Ce);var Dn=Ce.object({id:Ce.uuid(),name:Ce.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),birthDate:Ce.coerce.date().optional(),deathDate:Ce.coerce.date().optional(),biography:Ce.string().optional(),photo:Ce.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=tg,`A imagem deve ter no m\xE1ximo ${Sm}MB.`).optional(),role:Ce.enum(Qu).optional()}).refine(o=>o.birthDate&&o.deathDate?o.deathDate>o.birthDate:!0,{message:"Data de falecimento deve ser posterior \xE0 data de nascimento",path:["deathDate"]}),xr=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,birthDate:n,deathDate:a,biography:m,photo:c,role:u}=Dn.parse({id:e.params.id,...e.body,photo:e.file}),T=await this.inMemoriamRepository.findById(t);if(!T)throw new l("O registro in memoriam n\xE3o existe.");let k=T.photoUrl;return c&&(k=await this.firebaseStorageService.uploadFile({file:c,id:t,folder:F.IN_MEMORIAM})),await this.inMemoriamRepository.update({id:t,name:i,birthDate:n,deathDate:a,biography:m,photoUrl:k??void 0,role:u}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Fn=S.object({id:S.uuid(),name:S.string(),birthDate:S.date(),deathDate:S.date(),biography:S.string().nullable(),photoUrl:S.string().nullable(),role:S.enum(rg),createdAt:S.date(),updatedAt:S.date()}),vm={method:"post",path:"/in-memoriam",tags:["In Memoriam"],summary:"Create a new in memoriam record with optional photo upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:jn}}}},responses:{201:{description:"In memoriam record created successfully",summary:"In Memoriam Created"},400:{description:"Invalid input data, missing required fields, or invalid photo format/size",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},409:{description:"In memoriam record with this name already exists",summary:"Conflict",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},jm={method:"get",path:"/in-memoriam",tags:["In Memoriam"],summary:"List all in memoriam records with pagination and filters",request:{query:An},responses:{200:{description:"List of in memoriam records retrieved successfully with pagination",summary:"In Memoriam Records Retrieved",content:{"application/json":{schema:S.object({page:S.number(),totalPages:S.number(),offset:S.number(),limit:S.number(),inMemoriam:S.array(Fn)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},Em={method:"get",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Find in memoriam record by ID",request:{params:vr},responses:{200:{description:"In memoriam record details retrieved successfully",summary:"In Memoriam Record Retrieved",content:{"application/json":{schema:Fn}}},400:{description:"Invalid in memoriam record ID format",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},xm={method:"put",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Update in memoriam record with optional photo upload",security:[{bearerAuth:[]}],request:{params:vr,body:{content:{"multipart/form-data":{schema:Dn.omit({id:!0})}}}},responses:{200:{description:"In memoriam record updated successfully",summary:"In Memoriam Record Updated"},400:{description:"Invalid input data, in memoriam record ID format, or invalid photo format/size",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},409:{description:"In memoriam record with this name already exists",summary:"Conflict",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},Mm={method:"delete",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Delete in memoriam record",security:[{bearerAuth:[]}],request:{params:xn},responses:{200:{description:"In memoriam record deleted successfully",summary:"In Memoriam Record Deleted"},400:{description:"Invalid in memoriam record ID format",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},tw={method:"get",path:"/in-memoriam/role/{role}",tags:["In Memoriam"],summary:"Find in memoriam records by role",request:{params:Tn},responses:{200:{description:"In memoriam records retrieved successfully by role",summary:"In Memoriam Records Retrieved by Role",content:{"application/json":{schema:S.array(Fn)}}},400:{description:"Invalid role parameter provided",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}};import q from"zod";import{extendZodWithOpenApi as og}from"@asteasolutions/zod-to-openapi";import Ot from"zod";var Tm=2,Pm=1024,ig=Pm*Pm,ng=Tm*ig;og(Ot);var Un=Ot.object({image:Ot.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=ng,`A imagem deve ter no m\xE1ximo ${Tm}MB.`),caption:Ot.string().optional(),congressId:Ot.uuid()}),Mr=class{constructor(e,r,t){this.internationalScientificCongressGalleryRepository=e;this.internationalScientificCongressRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{image:t,caption:i,congressId:n}=Un.parse({...e.body,...e.params,image:e.file});if(!await this.internationalScientificCongressRepository.findById(n))throw new l("O congresso n\xE3o existe.");let m=await this.internationalScientificCongressGalleryRepository.create({imageUrl:"",caption:i||void 0,congressId:n}),c=await this.firebaseStorageService.uploadFile({file:t,id:m.id,folder:F.INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY});return await this.internationalScientificCongressGalleryRepository.update({id:m.id,imageUrl:c}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as sg}from"@asteasolutions/zod-to-openapi";import qn from"zod";sg(qn);var Tr=qn.object({id:qn.uuid()}),Pr=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=Tr.parse({id:e.params.id});if(!await this.internationalScientificCongressGalleryRepository.findById(t))throw new l("A imagem da galeria n\xE3o existe.");return await this.internationalScientificCongressGalleryRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ag}from"@asteasolutions/zod-to-openapi";import ft from"zod";var mg=1,cg=9;ag(ft);var Bn=ft.object({congressId:ft.uuid(),page:ft.coerce.number().min(1).default(mg),limit:ft.coerce.number().min(1).default(cg),caption:ft.string().optional()}),Ar=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{congressId:t,page:i,limit:n,...a}=Bn.parse({congressId:e.params.congressId,...e.query}),m=n*i-n,[c,u]=await Promise.all([this.internationalScientificCongressGalleryRepository.findByCongressId({pagination:{offset:m,limit:n},filter:{congressId:t,...a}}),this.internationalScientificCongressGalleryRepository.count({filter:{congressId:t,caption:a.caption}})]),T=Math.max(Math.ceil(u/n),1);return r.status(200).json({page:i,totalPages:T,offset:m,limit:n,galleryImages:c})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as pg}from"@asteasolutions/zod-to-openapi";import Nt from"zod";var Dm=2,Am=1024,dg=Am*Am,lg=Dm*dg;pg(Nt);var On=Nt.object({id:Nt.uuid(),image:Nt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=lg,`A imagem deve ter no m\xE1ximo ${Dm}MB.`).optional(),caption:Nt.string().optional()}),Dr=class{constructor(e,r){this.internationalScientificCongressGalleryRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,image:i,caption:n}=On.parse({id:e.params.id,...e.body,image:e.file}),a=await this.internationalScientificCongressGalleryRepository.findById(t);if(!a)throw new l("A imagem da galeria n\xE3o existe.");let m=a.imageUrl;return i&&(m=await this.firebaseStorageService.uploadFile({file:i,id:t,folder:F.INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY})),await this.internationalScientificCongressGalleryRepository.update({id:t,imageUrl:m??void 0,caption:n||void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var ug=q.object({id:q.uuid(),imageUrl:q.string(),caption:q.string().nullable(),congressId:q.uuid()}),Fm={method:"post",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congresses"],summary:"Create a new congress gallery image",security:[{bearerAuth:[]}],request:{params:q.object({congressId:q.uuid()}),body:{content:{"application/json":{schema:Un.omit({congressId:!0})}}}},responses:{201:{description:"Congress gallery image created successfully",summary:"Congress Gallery Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:q.object({errors:q.record(q.string(),q.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:q.object({message:q.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:q.object({message:q.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:q.object({message:q.string()})}}}}},Um={method:"get",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congresses"],summary:"Find congress gallery images by congress ID",request:{params:Bn},responses:{200:{description:"Congress gallery images retrieved successfully by congress ID",summary:"Congress Galleries Retrieved",content:{"application/json":{schema:q.array(ug)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:q.object({errors:q.record(q.string(),q.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:q.object({message:q.string()})}}}}},qm={method:"put",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congresses"],summary:"Update congress gallery image",security:[{bearerAuth:[]}],request:{params:Tr,body:{content:{"application/json":{schema:On.omit({id:!0})}}}},responses:{200:{description:"Congress gallery image updated successfully",summary:"Congress Gallery Updated"},400:{description:"Invalid input data or gallery ID format",summary:"Validation Error",content:{"application/json":{schema:q.object({errors:q.record(q.string(),q.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:q.object({message:q.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:q.object({message:q.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:q.object({message:q.string()})}}}}},Bm={method:"delete",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congresses"],summary:"Delete congress gallery image",security:[{bearerAuth:[]}],request:{params:Tr},responses:{200:{description:"Congress gallery image deleted successfully",summary:"Congress Gallery Deleted"},400:{description:"Invalid gallery ID format",summary:"Validation Error",content:{"application/json":{schema:q.object({errors:q.record(q.string(),q.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:q.object({message:q.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:q.object({message:q.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:q.object({message:q.string()})}}}}};import B from"zod";import{extendZodWithOpenApi as gg}from"@asteasolutions/zod-to-openapi";import kt from"zod";var Nm=2,Om=1024,yg=Om*Om,fg=Nm*yg;gg(kt);var Nn=kt.object({name:kt.string().min(1,"Nome \xE9 obrigat\xF3rio"),logo:kt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=fg,`A imagem deve ter no m\xE1ximo ${Nm}MB.`).optional(),congressId:kt.uuid()}),Fr=class{constructor(e,r,t){this.internationalScientificCongressPartnerRepository=e;this.internationalScientificCongressRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{name:t,logo:i,congressId:n}=Nn.parse({...e.body,...e.params,logo:e.file});if(!await this.internationalScientificCongressRepository.findById(n))throw new l("O congresso n\xE3o existe.");let m=await this.internationalScientificCongressPartnerRepository.create({name:t,congressId:n}),c;return i&&(c=await this.firebaseStorageService.uploadFile({file:i,id:m.id,folder:F.PARTNER}),await this.internationalScientificCongressPartnerRepository.update({id:m.id,logoUrl:c})),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as hg}from"@asteasolutions/zod-to-openapi";import kn from"zod";hg(kn);var qr=kn.object({id:kn.uuid()}),Ur=class{constructor(e){this.internationalScientificCongressPartnerRepository=e}async handle(e,r){try{let{id:t}=qr.parse({id:e.params.id});if(!await this.internationalScientificCongressPartnerRepository.findById(t))throw new l("O parceiro n\xE3o existe.");return await this.internationalScientificCongressPartnerRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Rg}from"@asteasolutions/zod-to-openapi";import ht from"zod";var Ig=1,Cg=9;Rg(ht);var Ln=ht.object({congressId:ht.uuid(),page:ht.coerce.number().min(1).optional(),limit:ht.coerce.number().min(1).optional(),name:ht.string().optional()}),Br=class{constructor(e){this.internationalScientificCongressPartnerRepository=e}async handle(e,r){try{let{congressId:t,page:i,limit:n,...a}=Ln.parse({congressId:e.params.congressId,...e.query});if(i!==void 0&&n!==void 0){let c=i||Ig,u=n||Cg,T=u*c-u,[k,Z]=await Promise.all([this.internationalScientificCongressPartnerRepository.findByCongressId({pagination:{offset:T,limit:u},filter:{congressId:t,...a}}),this.internationalScientificCongressPartnerRepository.count({filter:{congressId:t,name:a.name}})]),Q=Math.max(Math.ceil(Z/u),1);return r.status(200).json({page:c,totalPages:Q,offset:T,limit:u,partners:k})}let m=await this.internationalScientificCongressPartnerRepository.findByCongressId({filter:{congressId:t,...a}});return r.status(200).json(m)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as bg}from"@asteasolutions/zod-to-openapi";import Lt from"zod";var Lm=2,km=1024,wg=km*km,Sg=Lm*wg;bg(Lt);var Gn=Lt.object({id:Lt.uuid(),name:Lt.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),logo:Lt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Sg,`A imagem deve ter no m\xE1ximo ${Lm}MB.`).optional()}),Or=class{constructor(e,r){this.internationalScientificCongressPartnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,logo:n}=Gn.parse({id:e.params.id,...e.body,logo:e.file}),a=await this.internationalScientificCongressPartnerRepository.findById(t);if(!a)throw new l("O parceiro n\xE3o existe.");let m=a.logoUrl;return n&&(m=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:F.PARTNER})),await this.internationalScientificCongressPartnerRepository.update({id:t,name:i,logoUrl:m??void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var vg=B.object({id:B.uuid(),name:B.string(),logoUrl:B.string().nullable(),congressId:B.uuid()}),Gm={method:"post",path:"/international-scientific-congress/{congressId}/partner",tags:["International Scientific Congresses"],summary:"Create a new congress partner",security:[{bearerAuth:[]}],request:{params:B.object({congressId:B.uuid()}),body:{content:{"application/json":{schema:Nn.omit({congressId:!0})}}}},responses:{201:{description:"Congress partner created successfully",summary:"Congress Partner Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:B.object({errors:B.record(B.string(),B.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:B.object({message:B.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:B.object({message:B.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:B.object({message:B.string()})}}}}},_m={method:"get",path:"/international-scientific-congress/{congressId}/partner",tags:["International Scientific Congresses"],summary:"Find congress partners by congress ID",request:{params:Ln},responses:{200:{description:"Congress partners retrieved successfully by congress ID",summary:"Congress Partners Retrieved",content:{"application/json":{schema:B.array(vg)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:B.object({errors:B.record(B.string(),B.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:B.object({message:B.string()})}}}}},Wm={method:"put",path:"/international-scientific-congress/partner/{id}",tags:["International Scientific Congresses"],summary:"Update congress partner",security:[{bearerAuth:[]}],request:{params:qr,body:{content:{"application/json":{schema:Gn.omit({id:!0})}}}},responses:{200:{description:"Congress partner updated successfully",summary:"Congress Partner Updated"},400:{description:"Invalid input data or partner ID format",summary:"Validation Error",content:{"application/json":{schema:B.object({errors:B.record(B.string(),B.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:B.object({message:B.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:B.object({message:B.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:B.object({message:B.string()})}}}}},Hm={method:"delete",path:"/international-scientific-congress/partner/{id}",tags:["International Scientific Congresses"],summary:"Delete congress partner",security:[{bearerAuth:[]}],request:{params:qr},responses:{200:{description:"Congress partner deleted successfully",summary:"Congress Partner Deleted"},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:B.object({errors:B.record(B.string(),B.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:B.object({message:B.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:B.object({message:B.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:B.object({message:B.string()})}}}}};import p from"zod";import{extendZodWithOpenApi as jg}from"@asteasolutions/zod-to-openapi";import K from"zod";jg(K);var _n=K.object({title:K.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),edition:K.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo"),startDate:K.coerce.date(),endDate:K.coerce.date(),description:K.string().optional(),location:K.string().optional(),congressLink:K.url("Link do congresso deve ser uma URL v\xE1lida").optional().or(K.literal("")),noticeUrl:K.url("URL do edital deve ser uma URL v\xE1lida").optional().or(K.literal("")),scheduleUrl:K.url("URL do cronograma deve ser uma URL v\xE1lida").optional().or(K.literal("")),programUrl:K.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida").optional().or(K.literal("")),adminReportUrl:K.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida").optional().or(K.literal("")),proceedingsUrl:K.url("URL dos anais deve ser uma URL v\xE1lida").optional().or(K.literal(""))}).refine(o=>o.endDate>=o.startDate,{message:"Data de t\xE9rmino deve ser posterior ou igual \xE0 data de in\xEDcio",path:["endDate"]}),Nr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let t=_n.parse(e.body);return await this.internationalScientificCongressRepository.create(t),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Eg}from"@asteasolutions/zod-to-openapi";import Wn from"zod";Eg(Wn);var Hn=Wn.object({id:Wn.uuid()}),kr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t}=Hn.parse({id:e.params.id});if(!await this.internationalScientificCongressRepository.findById(t))throw new l("O congresso n\xE3o existe.");return await this.internationalScientificCongressRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as xg}from"@asteasolutions/zod-to-openapi";import zn from"zod";xg(zn);var Zn=zn.object({edition:zn.coerce.number().int().positive()}),Lr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{edition:t}=Zn.parse({edition:e.params.edition}),i=await this.internationalScientificCongressRepository.findByEdition(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Mg}from"@asteasolutions/zod-to-openapi";import Vn from"zod";Mg(Vn);var _r=Vn.object({id:Vn.uuid()}),Gr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t}=_r.parse({id:e.params.id}),i=await this.internationalScientificCongressRepository.findById(t);if(!i)throw new l("O congresso n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Pg}from"@asteasolutions/zod-to-openapi";import Ue from"zod";var Tg=1,Ag=10;Pg(Ue);var Kn=Ue.object({page:Ue.coerce.number().min(1).default(Tg),limit:Ue.coerce.number().min(1).default(Ag),title:Ue.string().optional(),edition:Ue.coerce.number().int().positive().optional(),location:Ue.string().optional(),orderBy:Ue.enum(["asc","desc"]).optional()}),Wr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Kn.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.internationalScientificCongressRepository.find({pagination:{offset:a,limit:i},filter:n}),this.internationalScientificCongressRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:a,limit:i,congresses:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Dg}from"@asteasolutions/zod-to-openapi";import V from"zod";Dg(V);var Yn=V.object({id:V.uuid(),title:V.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),edition:V.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo").optional(),startDate:V.coerce.date().optional(),endDate:V.coerce.date().optional(),description:V.string().optional(),location:V.string().optional(),congressLink:V.url("Link do congresso deve ser uma URL v\xE1lida").optional().or(V.literal("")),noticeUrl:V.url("URL do edital deve ser uma URL v\xE1lida").optional().or(V.literal("")),scheduleUrl:V.url("URL do cronograma deve ser uma URL v\xE1lida").optional().or(V.literal("")),programUrl:V.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida").optional().or(V.literal("")),adminReportUrl:V.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida").optional().or(V.literal("")),proceedingsUrl:V.url("URL dos anais deve ser uma URL v\xE1lida").optional().or(V.literal(""))}),Hr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t,...i}=Yn.parse({id:e.params.id,...e.body});if(!await this.internationalScientificCongressRepository.findById(t))throw new l("O congresso n\xE3o existe.");return await this.internationalScientificCongressRepository.update({...i,id:t}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Fg=9,Ug=p.object({image:p.any().openapi({type:"string",format:"binary"}),caption:p.string().optional()}),qg=p.object({image:p.any().openapi({type:"string",format:"binary"}).optional(),caption:p.string().optional()}),Bg=p.object({id:p.uuid(),name:p.string(),logoUrl:p.string().nullable(),congressId:p.uuid()}),Xn=p.object({id:p.uuid(),imageUrl:p.string(),caption:p.string().nullable(),congressId:p.uuid()}),$n=p.object({id:p.uuid(),title:p.string(),edition:p.number(),startDate:p.date(),endDate:p.date(),description:p.string().nullable(),location:p.string().nullable(),congressLink:p.string().nullable(),noticeUrl:p.string().nullable(),scheduleUrl:p.string().nullable(),programUrl:p.string().nullable(),adminReportUrl:p.string().nullable(),proceedingsUrl:p.string().nullable(),partners:p.array(Bg),galleries:p.array(Xn),createdAt:p.date(),updatedAt:p.date()}),zm={method:"post",path:"/international-scientific-congress",tags:["International Scientific Congresses"],summary:"Create a new international scientific congress",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:_n}}}},responses:{201:{description:"International scientific congress created successfully",summary:"International Scientific Congress Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},Zm={method:"get",path:"/international-scientific-congress",tags:["International Scientific Congresses"],summary:"List all international scientific congresses with pagination and filters",request:{query:Kn},responses:{200:{description:"List of international scientific congresses retrieved successfully with pagination",summary:"International Scientific Congresses Retrieved",content:{"application/json":{schema:p.object({page:p.number(),totalPages:p.number(),offset:p.number(),limit:p.number(),congresses:p.array($n)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},Vm={method:"get",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Find international scientific congress by ID",request:{params:_r},responses:{200:{description:"International scientific congress details retrieved successfully",summary:"International Scientific Congress Retrieved",content:{"application/json":{schema:$n}}},400:{description:"Invalid international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},Km={method:"get",path:"/international-scientific-congress/edition/{edition}",tags:["International Scientific Congresses"],summary:"Find international scientific congresses by edition",request:{params:Zn},responses:{200:{description:"International scientific congresses retrieved successfully by edition",summary:"International Scientific Congresses Retrieved by Edition",content:{"application/json":{schema:p.array($n)}}},400:{description:"Invalid edition parameter provided",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},Ym={method:"put",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Update international scientific congress",security:[{bearerAuth:[]}],request:{params:_r,body:{content:{"application/json":{schema:Yn.omit({id:!0})}}}},responses:{200:{description:"International scientific congress updated successfully",summary:"International Scientific Congress Updated"},400:{description:"Invalid input data or international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},Xm={method:"delete",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Delete international scientific congress",security:[{bearerAuth:[]}],request:{params:Hn},responses:{200:{description:"International scientific congress deleted successfully",summary:"International Scientific Congress Deleted"},400:{description:"Invalid international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},$S={method:"post",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congress Gallery"],summary:"Create a new gallery image for a congress",security:[{bearerAuth:[]}],request:{params:p.object({congressId:p.uuid()}),body:{content:{"multipart/form-data":{schema:Ug}}}},responses:{201:{description:"Gallery image created successfully",summary:"Gallery Image Created"},400:{description:"Invalid input data, missing required fields, or invalid image format/size",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},JS={method:"get",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congress Gallery"],summary:"List all gallery images for a congress with pagination",request:{params:p.object({congressId:p.uuid()}),query:p.object({page:p.coerce.number().min(1).default(1),limit:p.coerce.number().min(1).default(Fg),caption:p.string().optional()})},responses:{200:{description:"Gallery images retrieved successfully with pagination",summary:"Gallery Images Retrieved",content:{"application/json":{schema:p.object({page:p.number(),totalPages:p.number(),offset:p.number(),limit:p.number(),galleries:p.array(Xn)})}}},400:{description:"Invalid congress ID format or query parameters",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},QS={method:"get",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congress Gallery"],summary:"Find a gallery image by ID",request:{params:p.object({id:p.uuid()})},responses:{200:{description:"Gallery image retrieved successfully",summary:"Gallery Image Retrieved",content:{"application/json":{schema:Xn}}},400:{description:"Invalid gallery image ID format",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},ev={method:"put",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congress Gallery"],summary:"Update a gallery image with optional image upload",security:[{bearerAuth:[]}],request:{params:p.object({id:p.uuid()}),body:{content:{"multipart/form-data":{schema:qg}}}},responses:{200:{description:"Gallery image updated successfully",summary:"Gallery Image Updated"},400:{description:"Invalid input data, gallery ID format, or invalid image format/size",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},tv={method:"delete",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congress Gallery"],summary:"Delete a gallery image",security:[{bearerAuth:[]}],request:{params:p.object({id:p.uuid()})},responses:{200:{description:"Gallery image deleted successfully",summary:"Gallery Image Deleted"},400:{description:"Invalid gallery ID format",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:p.object({message:p.string()})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}};import{$Enums as Gg}from"@prisma/client";import M from"zod";import{extendZodWithOpenApi as Og}from"@asteasolutions/zod-to-openapi";import Rt from"zod";Og(Rt);var Jn=Rt.object({role:Rt.string().min(1),description:Rt.string().optional(),userId:Rt.uuid(),order:Rt.number().optional()}),zr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{role:t,description:i,userId:n,order:a}=Jn.parse(e.body);return await this.legitimatorCommitteeMemberRepository.create({role:t,description:i,userId:n,order:a??0}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ng}from"@asteasolutions/zod-to-openapi";import Qn from"zod";Ng(Qn);var es=Qn.object({id:Qn.uuid()}),Zr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t}=es.parse({id:e.params.id});if(!await this.legitimatorCommitteeMemberRepository.findById(t))throw new l("O membro do comit\xEA legitimador n\xE3o existe.");return await this.legitimatorCommitteeMemberRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as kg}from"@asteasolutions/zod-to-openapi";import ts from"zod";kg(ts);var Kr=ts.object({id:ts.uuid()}),Vr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t}=Kr.parse({id:e.params.id}),i=await this.legitimatorCommitteeMemberRepository.findById(t);if(!i)throw new l("O membro do comit\xEA legitimador n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Lg}from"@asteasolutions/zod-to-openapi";import Xe from"zod";Lg(Xe);var rs=Xe.object({id:Xe.uuid(),role:Xe.string().min(1).optional(),description:Xe.string().optional(),userId:Xe.uuid().optional(),order:Xe.number().optional()}),Yr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t,role:i,description:n,userId:a,order:m}=rs.parse({id:e.params.id,...e.body});if(!await this.legitimatorCommitteeMemberRepository.findById(t))throw new l("O membro do comit\xEA legitimador n\xE3o existe.");return await this.legitimatorCommitteeMemberRepository.update({id:t,role:i,description:n,userId:a,order:m}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var _g=M.object({id:M.uuid(),name:M.string(),emailAddress:M.string(),avatarUrl:M.string().nullable(),orcid:M.string().nullable(),phone:M.string().nullable(),lattesUrl:M.string().nullable(),role:M.enum(Gg.UserRole)}),$m=M.object({id:M.uuid(),role:M.string(),description:M.string().nullable(),order:M.number(),createdAt:M.date(),updatedAt:M.date(),userId:M.uuid(),user:_g}),Jm={method:"post",path:"/legitimator-committee-member",tags:["Legitimator Committee Members"],summary:"Create a new Legitimator Committee Member",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Jn}}}},responses:{201:{description:"Legitimator Committee Member created successfully",summary:"Legitimator Committee Member Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},Qm={method:"get",path:"/legitimator-committee-member",tags:["Legitimator Committee Members"],summary:"List all Legitimator Committee Members with filters",request:{query:M.object({role:M.string().optional(),orderBy:M.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of Legitimator Committee Members retrieved successfully",summary:"Legitimator Committee Members Retrieved",content:{"application/json":{schema:M.object({members:M.array($m)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},ec={method:"get",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Find Legitimator Committee Member by ID",request:{params:Kr},responses:{200:{description:"Legitimator Committee Member details retrieved successfully",summary:"Legitimator Committee Member Retrieved",content:{"application/json":{schema:$m}}},400:{description:"Invalid Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},tc={method:"put",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Update Legitimator Committee Member",security:[{bearerAuth:[]}],request:{params:Kr,body:{content:{"application/json":{schema:rs.omit({id:!0})}}}},responses:{200:{description:"Legitimator Committee Member updated successfully",summary:"Legitimator Committee Member Updated"},400:{description:"Invalid input data or Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:M.object({message:M.string()})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},rc={method:"delete",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Delete Legitimator Committee Member",security:[{bearerAuth:[]}],request:{params:es},responses:{200:{description:"Legitimator Committee Member deleted successfully",summary:"Legitimator Committee Member Deleted"},400:{description:"Invalid Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:M.object({message:M.string()})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}};import{$Enums as Vg}from"@prisma/client";import w from"zod";import{extendZodWithOpenApi as Wg}from"@asteasolutions/zod-to-openapi";import be from"zod";Wg(be);var os=be.object({name:be.string().min(1),description:be.string().optional(),members:be.array(be.object({userId:be.uuid(),role:be.string().min(1),order:be.number().optional()}))}),Xr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{name:t,description:i,members:n}=os.parse(e.body);if(await this.managementTeamRepository.findByName(t))throw new Y("J\xE1 existe um time de gest\xE3o cadastrado com este nome.");return await this.managementTeamRepository.create({name:t,description:i,members:n.map(m=>({userId:m.userId,role:m.role,order:m.order??0}))}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Hg}from"@asteasolutions/zod-to-openapi";import is from"zod";Hg(is);var ns=is.object({id:is.uuid()}),$r=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t}=ns.parse({id:e.params.id});if(!await this.managementTeamRepository.findById(t))throw new l("O time de gest\xE3o n\xE3o existe.");return await this.managementTeamRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as zg}from"@asteasolutions/zod-to-openapi";import ss from"zod";zg(ss);var Qr=ss.object({id:ss.uuid()}),Jr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t}=Qr.parse({id:e.params.id}),i=await this.managementTeamRepository.findById(t);if(!i)throw new l("O time de gest\xE3o n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Zg}from"@asteasolutions/zod-to-openapi";import ye from"zod";Zg(ye);var as=ye.object({id:ye.uuid(),name:ye.string().min(1).optional(),description:ye.string().optional(),members:ye.array(ye.object({userId:ye.uuid(),role:ye.string().min(1),order:ye.number().optional()})).optional()}),eo=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t,name:i,description:n,members:a}=as.parse({id:e.params.id,...e.body}),m=await this.managementTeamRepository.findById(t);if(!m)throw new l("O time de gest\xE3o n\xE3o existe.");if(i&&i!==m.name){let c=await this.managementTeamRepository.findByName(i);if(c&&c.id!==t)throw new Y("J\xE1 existe um time de gest\xE3o com este nome.")}return await this.managementTeamRepository.update({id:t,name:i,description:n,members:a?a.map(c=>({userId:c.userId,role:c.role,order:c.order??0})):void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Kg=w.object({id:w.uuid(),name:w.string(),emailAddress:w.string(),avatarUrl:w.string().nullable(),orcid:w.string().nullable(),phone:w.string().nullable(),lattesUrl:w.string().nullable(),role:w.enum(Vg.UserRole)}),Yg=w.object({id:w.uuid(),role:w.string(),description:w.string().nullable(),order:w.number(),teamId:w.uuid(),userId:w.uuid(),createdAt:w.date(),updatedAt:w.date(),user:Kg}),oc=w.object({id:w.uuid(),name:w.string(),description:w.string().nullable(),createdAt:w.date(),updatedAt:w.date(),members:w.array(Yg)}),ic={method:"post",path:"/management-team",tags:["Management Teams"],summary:"Create a new Management Team with multiple members",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:os}}}},responses:{201:{description:"Management Team created successfully",summary:"Management Team Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:w.object({message:w.string()})}}},409:{description:"Management Team with this name already exists",summary:"Conflict",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},nc={method:"get",path:"/management-team",tags:["Management Teams"],summary:"List all Management Teams with filters",request:{query:w.object({name:w.string().optional(),description:w.string().optional(),orderBy:w.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of Management Teams retrieved successfully",summary:"Management Teams Retrieved",content:{"application/json":{schema:w.object({teams:w.array(oc)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},sc={method:"get",path:"/management-team/{id}",tags:["Management Teams"],summary:"Find Management Team by ID",request:{params:Qr},responses:{200:{description:"Management Team details retrieved successfully",summary:"Management Team Retrieved",content:{"application/json":{schema:oc}}},400:{description:"Invalid Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},ac={method:"put",path:"/management-team/{id}",tags:["Management Teams"],summary:"Update Management Team and manage member relationships",security:[{bearerAuth:[]}],request:{params:Qr,body:{content:{"application/json":{schema:as.omit({id:!0})}}}},responses:{200:{description:"Management Team updated successfully",summary:"Management Team Updated"},400:{description:"Invalid input data or Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:w.object({message:w.string()})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},409:{description:"Management Team with this name already exists",summary:"Conflict",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},mc={method:"delete",path:"/management-team/{id}",tags:["Management Teams"],summary:"Delete Management Team",security:[{bearerAuth:[]}],request:{params:ns},responses:{200:{description:"Management Team deleted successfully",summary:"Management Team Deleted"},400:{description:"Invalid Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:w.object({message:w.string()})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}};import{MeetingFormat as oy,MeetingStatus as iy}from"@prisma/client";import A from"zod";import{extendZodWithOpenApi as Xg}from"@asteasolutions/zod-to-openapi";import It from"zod";var pc=10,cc=1024,$g=cc*cc,Jg=pc*$g;Xg(It);var ms=It.object({title:It.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),publishedAt:It.coerce.date(),meetingId:It.uuid(),document:It.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=Jg,`O documento deve ter no m\xE1ximo ${pc}MB.`)}),to=class{constructor(e,r,t){this.meetingMinuteRepository=e;this.meetingRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{title:t,publishedAt:i,meetingId:n,document:a}=ms.parse({...e.body,...e.params,document:e.file});if(!await this.meetingRepository.findById(n))throw new l("A reuni\xE3o n\xE3o existe.");if(await this.meetingMinuteRepository.findByMeetingId(n))throw new s("Esta reuni\xE3o j\xE1 possui uma ata.");let u=await this.meetingMinuteRepository.create({title:t,publishedAt:i,meetingId:n,documentUrl:""}),T=await this.firebaseStorageService.uploadFile({file:a,id:u.id,folder:F.MEETING_MINUTE});return await this.meetingMinuteRepository.update({id:u.id,documentUrl:T}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Qg}from"@asteasolutions/zod-to-openapi";import cs from"zod";Qg(cs);var Gt=cs.object({meetingId:cs.uuid()}),ro=class{constructor(e){this.meetingMinuteRepository=e}async handle(e,r){try{let{meetingId:t}=Gt.parse({meetingId:e.params.meetingId}),i=await this.meetingMinuteRepository.findByMeetingId(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ey}from"@asteasolutions/zod-to-openapi";import Ct from"zod";var lc=10,dc=1024,ty=dc*dc,ry=lc*ty;ey(Ct);var ps=Ct.object({meetingId:Ct.uuid(),title:Ct.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),publishedAt:Ct.coerce.date().optional(),document:Ct.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=ry,`O documento deve ter no m\xE1ximo ${lc}MB.`).optional()}),oo=class{constructor(e,r){this.meetingMinuteRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{meetingId:t,title:i,publishedAt:n,document:a}=ps.parse({meetingId:e.params.meetingId,...e.body,document:e.file}),m=await this.meetingMinuteRepository.findByMeetingId(t);if(!m)throw new l("A ata n\xE3o existe para esta reuni\xE3o.");let c=m.documentUrl;return a&&(m.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:m.documentUrl}),c=await this.firebaseStorageService.uploadFile({file:a,id:m.id,folder:F.MEETING_MINUTE})),await this.meetingMinuteRepository.update({id:m.id,title:i,publishedAt:n,documentUrl:c??void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var ny=A.object({id:A.uuid(),title:A.string(),scheduledAt:A.date(),format:A.enum(oy),agenda:A.string(),meetingLink:A.string().nullable(),location:A.string().nullable(),status:A.enum(iy),createdAt:A.date(),updatedAt:A.date()}),sy=A.object({id:A.uuid(),title:A.string(),publishedAt:A.date(),documentUrl:A.string(),meetingId:A.uuid(),meeting:ny,createdAt:A.date(),updatedAt:A.date()}),uc={method:"post",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Create a new meeting minute with document upload",security:[{bearerAuth:[]}],request:{params:A.object({meetingId:A.uuid()}),body:{content:{"multipart/form-data":{schema:ms.omit({meetingId:!0})}}}},responses:{201:{description:"Meeting minute created successfully",summary:"Meeting Minute Created"},400:{description:"Invalid input data, missing required fields, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:A.object({message:A.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:A.object({message:A.string()})}}},409:{description:"Meeting already has a minute",summary:"Conflict",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},gc={method:"get",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Find meeting minute by meeting ID",request:{params:Gt},responses:{200:{description:"Meeting minute retrieved successfully by meeting ID",summary:"Meeting Minute Retrieved by Meeting ID",content:{"application/json":{schema:sy.nullable()}}},400:{description:"Invalid meeting ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},yc={method:"put",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Update meeting minute with optional document upload",security:[{bearerAuth:[]}],request:{params:Gt,body:{content:{"multipart/form-data":{schema:ps.omit({meetingId:!0})}}}},responses:{200:{description:"Meeting minute updated successfully",summary:"Meeting Minute Updated"},400:{description:"Invalid input data, meeting minute ID format, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:A.object({message:A.string()})}}},404:{description:"Meeting minute not found with the provided ID",summary:"Meeting Minute Not Found",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},fc={method:"delete",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Delete meeting minute",security:[{bearerAuth:[]}],request:{params:Gt},responses:{200:{description:"Meeting minute deleted successfully",summary:"Meeting Minute Deleted"},400:{description:"Invalid meeting minute ID format",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:A.object({message:A.string()})}}},404:{description:"Meeting minute not found with the provided ID",summary:"Meeting Minute Not Found",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}};import{MeetingFormat as Cy,MeetingStatus as by}from"@prisma/client";import C from"zod";import{extendZodWithOpenApi as ay}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as io,MeetingStatus as ds}from"@prisma/client";import fe from"zod";ay(fe);var ls=fe.object({title:fe.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),scheduledAt:fe.coerce.date(),format:fe.enum(io).default(io.ONLINE),agenda:fe.string().min(1,"Pauta \xE9 obrigat\xF3ria"),meetingLink:fe.string().url("Link da reuni\xE3o deve ser uma URL v\xE1lida").optional().or(fe.literal("")),location:fe.string().optional(),status:fe.enum(ds).default(ds.PENDING)}).refine(o=>o.format===io.ONLINE?!!o.meetingLink:o.format===io.IN_PERSON?!!o.location:!0,{message:"Reuni\xF5es online devem ter link e reuni\xF5es presenciais devem ter localiza\xE7\xE3o",path:["format"]}),no=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{title:t,scheduledAt:i,format:n,agenda:a,meetingLink:m,location:c,status:u}=ls.parse(e.body);return await this.meetingRepository.create({title:t,scheduledAt:i,format:n,agenda:a,meetingLink:m||void 0,location:c||void 0,status:u??ds.PENDING}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as my}from"@asteasolutions/zod-to-openapi";import us from"zod";my(us);var gs=us.object({id:us.uuid()}),so=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t}=gs.parse({id:e.params.id});if(!await this.meetingRepository.findById(t))throw new l("A reuni\xE3o n\xE3o existe.");return await this.meetingRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as cy}from"@asteasolutions/zod-to-openapi";import ys from"zod";cy(ys);var mo=ys.object({id:ys.uuid()}),ao=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t}=mo.parse({id:e.params.id}),i=await this.meetingRepository.findById(t);if(!i)throw new l("A reuni\xE3o n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as py}from"@asteasolutions/zod-to-openapi";import{MeetingStatus as dy}from"@prisma/client";import fs from"zod";py(fs);var hs=fs.object({status:fs.enum(dy)}),co=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{status:t}=hs.parse({status:e.params.status}),i=await this.meetingRepository.findByStatus(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ly}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as uy,MeetingStatus as gy}from"@prisma/client";import qe from"zod";var yy=1,fy=10;ly(qe);var Rs=qe.object({page:qe.coerce.number().min(1).default(yy),limit:qe.coerce.number().min(1).default(fy),title:qe.string().optional(),format:qe.enum(uy).optional(),status:qe.enum(gy).optional(),orderBy:qe.enum(["asc","desc"]).optional()}),po=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Rs.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.meetingRepository.find({pagination:{offset:a,limit:i},filter:n}),this.meetingRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:a,limit:i,meetings:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as hy}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as Ry,MeetingStatus as Iy}from"@prisma/client";import pe from"zod";hy(pe);var Is=pe.object({id:pe.uuid(),title:pe.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),scheduledAt:pe.coerce.date().optional(),format:pe.enum(Ry).optional(),agenda:pe.string().min(1,"Pauta \xE9 obrigat\xF3ria").optional(),meetingLink:pe.string().url("Link da reuni\xE3o deve ser uma URL v\xE1lida").optional().or(pe.literal("")),location:pe.string().optional(),status:pe.enum(Iy).optional()}),lo=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t,title:i,scheduledAt:n,format:a,agenda:m,meetingLink:c,location:u,status:T}=Is.parse({id:e.params.id,...e.body});if(!await this.meetingRepository.findById(t))throw new l("A reuni\xE3o n\xE3o existe.");return await this.meetingRepository.update({id:t,title:i,scheduledAt:n,format:a,agenda:m,meetingLink:c||void 0,location:u||void 0,status:T}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var wy=C.object({id:C.uuid(),title:C.string(),publishedAt:C.date(),documentUrl:C.string(),meetingId:C.uuid(),createdAt:C.date(),updatedAt:C.date()}),Cs=C.object({id:C.uuid(),title:C.string(),scheduledAt:C.date(),format:C.enum(Cy),agenda:C.string(),meetingLink:C.string().nullable(),location:C.string().nullable(),status:C.enum(by),minutes:wy.nullable(),createdAt:C.date(),updatedAt:C.date()}),hc={method:"post",path:"/meeting",tags:["Meetings"],summary:"Create a new meeting",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:ls}}}},responses:{201:{description:"Meeting created successfully",summary:"Meeting Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Rc={method:"get",path:"/meeting",tags:["Meetings"],summary:"List all meetings with pagination and filters",request:{query:Rs},responses:{200:{description:"List of meetings retrieved successfully with pagination",summary:"Meetings Retrieved",content:{"application/json":{schema:C.object({page:C.number(),totalPages:C.number(),offset:C.number(),limit:C.number(),meetings:C.array(Cs)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Ic={method:"get",path:"/meeting/{id}",tags:["Meetings"],summary:"Find meeting by ID",request:{params:mo},responses:{200:{description:"Meeting details retrieved successfully",summary:"Meeting Retrieved",content:{"application/json":{schema:Cs}}},400:{description:"Invalid meeting ID format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Cc={method:"get",path:"/meeting/status/{status}",tags:["Meetings"],summary:"Find meetings by status",request:{params:hs},responses:{200:{description:"Meetings retrieved successfully by status",summary:"Meetings Retrieved by Status",content:{"application/json":{schema:C.array(Cs)}}},400:{description:"Invalid status parameter provided",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},bc={method:"put",path:"/meeting/{id}",tags:["Meetings"],summary:"Update meeting",security:[{bearerAuth:[]}],request:{params:mo,body:{content:{"application/json":{schema:Is.omit({id:!0})}}}},responses:{200:{description:"Meeting updated successfully",summary:"Meeting Updated"},400:{description:"Invalid input data or meeting ID format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:C.object({message:C.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},wc={method:"delete",path:"/meeting/{id}",tags:["Meetings"],summary:"Delete meeting",security:[{bearerAuth:[]}],request:{params:gs},responses:{200:{description:"Meeting deleted successfully",summary:"Meeting Deleted"},400:{description:"Invalid meeting ID format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:C.object({message:C.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}};import v from"zod";import{extendZodWithOpenApi as Sy}from"@asteasolutions/zod-to-openapi";import _t from"zod";var vy=5,Sc=1024,jy=Sc*Sc,Ey=vy*jy;Sy(_t);var bs=_t.object({title:_t.string().min(1),content:_t.string().min(1),image:_t.any().refine(o=>!o||typeof o=="object"&&typeof o.mimetype=="string"&&o.mimetype.startsWith("image/")&&typeof o.size=="number"&&o.size<=Ey,{message:"A imagem deve ser uma imagem v\xE1lida de no m\xE1ximo 5MB."})}),uo=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{title:t,content:i,image:n}=bs.parse({...e.body,image:e.file}),a=e.user.id,m=await this.firebaseStorageService.uploadFile({file:n,folder:F.NEWS,id:a});await this.newsRepository.create({title:t,content:i,authorId:a,imageUrl:m}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as xy}from"@asteasolutions/zod-to-openapi";import Be from"zod";var My=1,Py=7;xy(Be);var yo=Be.object({page:Be.coerce.number().min(1).default(My),limit:Be.coerce.number().min(1).default(Py),authorId:Be.string(),title:Be.string().optional(),content:Be.string().optional(),orderBy:Be.enum(["asc","desc"]).default("desc")}),go=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,authorId:n,...a}=yo.parse(e.query),m=i*t-i,[c,u]=await Promise.all([this.newsRepository.findByAuthorId({authorId:n,pagination:{offset:m,limit:i},filter:a}),this.newsRepository.count({filter:{authorId:n,...a}})]),T=Math.max(Math.ceil(u/i),1);r.status(200).json({page:t,totalPages:T,offset:m,limit:i,news:c})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ty}from"@asteasolutions/zod-to-openapi";import ws from"zod";Ty(ws);var Ss=ws.object({id:ws.string()}),fo=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{id:t}=Ss.parse(e.params),i=await this.newsRepository.findById(t);if(!i)throw new l("Not\xEDcia n\xE3o encontrada.");r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ay}from"@asteasolutions/zod-to-openapi";import Oe from"zod";var Dy=1,Fy=9;Ay(Oe);var vs=Oe.object({page:Oe.coerce.number().min(1).default(Dy),limit:Oe.coerce.number().min(1).default(Fy),title:Oe.string().optional(),content:Oe.string().optional(),authorId:Oe.string().optional(),orderBy:Oe.enum(["asc","desc"]).default("desc")}),ho=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=vs.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.newsRepository.find({pagination:{offset:a,limit:i},filter:n}),this.newsRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:a,limit:i,news:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var vc={method:"post",path:"/news",tags:["News"],summary:"Create news",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:bs}}}},responses:{201:{description:"News article created successfully",summary:"News Created",content:{"application/json":{schema:v.object({message:v.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},jc={method:"get",path:"/news",tags:["News"],summary:"List news",request:{query:vs},responses:{200:{description:"Paginated list of news articles retrieved successfully",summary:"News Retrieved",content:{"application/json":{schema:v.object({page:v.number(),totalPages:v.number(),offset:v.number(),limit:v.number(),news:v.array(v.object({title:v.string(),content:v.string(),id:v.string(),createdAt:v.date(),updatedAt:v.date(),imageUrl:v.string().nullable()}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},Ec={method:"get",path:"/news/{id}",tags:["News"],summary:"Find news by ID",request:{params:Ss},responses:{200:{description:"News article details retrieved successfully",summary:"News Retrieved",content:{"application/json":{schema:v.object({page:v.number(),totalPages:v.number(),offset:v.number(),limit:v.number(),news:v.object({title:v.string(),content:v.string(),id:v.string(),createdAt:v.date(),updatedAt:v.date(),imageUrl:v.string().nullable()})})}}},400:{description:"Invalid news ID format",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},404:{description:"News article not found with the provided ID",summary:"News Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},xc={method:"get",path:"/news/author/{author_id}",tags:["News"],summary:"List news by author",request:{params:yo.pick({authorId:!0}).transform(()=>({author_id:""})),query:yo.omit({authorId:!0})},responses:{200:{description:"Paginated list of news articles by author retrieved successfully",summary:"Author News Retrieved",content:{"application/json":{schema:v.object({page:v.number(),totalPages:v.number(),offset:v.number(),limit:v.number(),news:v.array(v.object({title:v.string(),content:v.string(),id:v.string(),createdAt:v.date(),updatedAt:v.date(),imageUrl:v.string().nullable()}))})}}},400:{description:"Invalid author ID or query parameters",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},404:{description:"Author not found with the provided ID",summary:"Author Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}};import E from"zod";import{extendZodWithOpenApi as Uy}from"@asteasolutions/zod-to-openapi";import he from"zod";var Pc=2,Mc=1024,qy=Mc*Mc,By=Pc*qy;Uy(he);var js=he.object({name:he.string().min(1,"Nome \xE9 obrigat\xF3rio"),logo:he.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=By,`A imagem deve ter no m\xE1ximo ${Pc}MB.`),websiteUrl:he.url("URL do site deve ser v\xE1lida").optional(),description:he.string().optional(),category:he.string().optional(),since:he.coerce.date(),isActive:he.preprocess(o=>o==="true",he.boolean().optional())}),Ro=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{name:t,logo:i,websiteUrl:n,description:a,category:m,since:c,isActive:u}=js.parse({...e.body,logo:e.file}),T=await this.partnerRepository.create({name:t,websiteUrl:n,description:a,category:m,since:c,isActive:u}),k=await this.firebaseStorageService.uploadFile({file:i,id:T.id,folder:F.PARTNER});return await this.partnerRepository.update({id:T.id,logoUrl:k}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Oy}from"@asteasolutions/zod-to-openapi";import Es from"zod";Oy(Es);var xs=Es.object({id:Es.uuid()}),Io=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=xs.parse({id:e.params.id}),i=await this.partnerRepository.findById(t);if(!i)throw new l("O parceiro n\xE3o existe.");return i.logoUrl&&this.firebaseStorageService.deleteFile({fileUrl:i.logoUrl}),await this.partnerRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ny}from"@asteasolutions/zod-to-openapi";import Ms from"zod";Ny(Ms);var bo=Ms.object({id:Ms.uuid()}),Co=class{constructor(e){this.partnerRepository=e}async handle(e,r){try{let{id:t}=bo.parse({id:e.params.id}),i=await this.partnerRepository.findById(t);if(!i)throw new l("O parceiro n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ky}from"@asteasolutions/zod-to-openapi";import we from"zod";var Ly=1,Gy=9;ky(we);var Ps=we.object({page:we.coerce.number().min(1).default(Ly),limit:we.coerce.number().min(1).default(Gy),name:we.string().optional(),description:we.string().optional(),category:we.string().optional(),isActive:we.coerce.boolean().optional(),orderBy:we.enum(["asc","desc"]).optional()}),wo=class{constructor(e){this.partnerRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Ps.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.partnerRepository.find({pagination:{offset:a,limit:i},filter:n}),this.partnerRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:a,limit:i,partners:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as _y}from"@asteasolutions/zod-to-openapi";import de from"zod";var Ac=2,Tc=1024,Wy=Tc*Tc,Hy=Ac*Wy;_y(de);var Ts=de.object({id:de.uuid(),name:de.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),logo:de.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Hy,`A imagem deve ter no m\xE1ximo ${Ac}MB.`).optional(),websiteUrl:de.url("URL do site deve ser v\xE1lida").optional(),description:de.string().optional(),category:de.string().optional(),since:de.coerce.date().optional(),isActive:de.preprocess(o=>o==="true",de.boolean().optional())}),So=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,logo:n,websiteUrl:a,description:m,category:c,since:u,isActive:T}=Ts.parse({id:e.params.id,...e.body,logo:e.file}),k=await this.partnerRepository.findById(t);if(!k)throw new l("O parceiro n\xE3o existe.");let Z=k.logoUrl;if(n&&(Z=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:"images/partners"})),!Z)throw new s("Logo URL \xE9 obrigat\xF3rio");return await this.partnerRepository.update({id:t,name:i,logoUrl:Z,websiteUrl:a,description:m,category:c,since:u,isActive:T}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Dc=E.object({id:E.uuid(),name:E.string(),logoUrl:E.string(),description:E.string().nullable(),category:E.string().nullable(),since:E.date(),isActive:E.boolean(),createdAt:E.date(),updatedAt:E.date()}),Fc={method:"post",path:"/partner",tags:["Partners"],summary:"Create a new partner with logo upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:js}}}},responses:{201:{description:"Partner created successfully",summary:"Partner Created"},400:{description:"Invalid input data, missing required fields, or invalid logo format/size",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:E.object({message:E.string()})}}},409:{description:"Partner with this name already exists",summary:"Conflict",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},Uc={method:"get",path:"/partner",tags:["Partners"],summary:"List all partners with pagination and filters",request:{query:Ps},responses:{200:{description:"List of partners retrieved successfully with pagination",summary:"Partners Retrieved",content:{"application/json":{schema:E.object({page:E.number(),totalPages:E.number(),offset:E.number(),limit:E.number(),partners:E.array(Dc)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},qc={method:"get",path:"/partner/{id}",tags:["Partners"],summary:"Find partner by ID",request:{params:bo},responses:{200:{description:"Partner details retrieved successfully",summary:"Partner Retrieved",content:{"application/json":{schema:Dc}}},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},Bc={method:"put",path:"/partner/{id}",tags:["Partners"],summary:"Update partner with optional logo upload",security:[{bearerAuth:[]}],request:{params:bo,body:{content:{"multipart/form-data":{schema:Ts.omit({id:!0})}}}},responses:{200:{description:"Partner updated successfully",summary:"Partner Updated"},400:{description:"Invalid input data, partner ID format, or invalid logo format/size",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:E.object({message:E.string()})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},409:{description:"Partner with this name already exists",summary:"Conflict",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},Oc={method:"delete",path:"/partner/{id}",tags:["Partners"],summary:"Delete partner",security:[{bearerAuth:[]}],request:{params:xs},responses:{200:{description:"Partner deleted successfully",summary:"Partner Deleted"},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:E.object({message:E.string()})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}};import{$Enums as Nc}from"@prisma/client";import x from"zod";import{extendZodWithOpenApi as zy}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Zy}from"@prisma/client";import Ne from"zod";zy(Ne);var jo=Ne.object({userId:Ne.uuid(),title:Ne.string().min(1),description:Ne.string().optional(),status:Ne.enum(Zy).default("PENDING"),dueDate:Ne.coerce.date().optional(),document:Ne.any().refine(o=>o&&typeof o=="object"&&o.size>0,"Arquivo do documento \xE9 obrigat\xF3rio")}),vo=class{constructor(e,r,t){this.userRepository=e;this.pendencyRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{userId:t,title:i,description:n,status:a,dueDate:m,document:c}=jo.parse({...e.body,userId:e.params.user_id,document:e.file});if(!await this.userRepository.findById(t))throw new ee("O usu\xE1rio n\xE3o existe.");let T=await this.firebaseStorageService.uploadFile({file:c,id:t,folder:F.PENDENCY});return await this.pendencyRepository.create({userId:t,title:i,description:n,status:a,dueDate:m,documentUrl:T}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Vy}from"@asteasolutions/zod-to-openapi";import As from"zod";Vy(As);var Ds=As.object({id:As.uuid()}),Eo=class{constructor(e,r){this.pendencyRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=Ds.parse({id:e.params.pendency_id}),i=await this.pendencyRepository.findById(t);if(!i)throw new l("A pend\xEAncia n\xE3o existe.");return await Promise.all([this.pendencyRepository.deleteById(i.id),this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl})]),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Ky}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Yy}from"@prisma/client";import Se from"zod";var Xy=1,$y=6;Ky(Se);var Fs=Se.object({page:Se.coerce.number().min(1).default(Xy),limit:Se.coerce.number().min(1).default($y),title:Se.string().optional(),description:Se.string().optional(),status:Se.enum(Yy).default("PENDING"),userId:Se.uuid().optional(),orderBy:Se.enum(["asc","desc"]).default("desc")}),xo=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{description:t,limit:i,orderBy:n,page:a,title:m,status:c,userId:u}=Fs.parse(e.query),T=a*i-i,[k,Z]=await Promise.all([this.pendencyRepository.find({pagination:{offset:T,limit:i},filter:{title:m,description:t,status:c,orderBy:n,userId:u}}),this.pendencyRepository.count({filter:{title:m,description:t,status:c,userId:u}})]),Q=Math.max(Math.ceil(Z/i),1);return r.status(200).json({page:a,totalPages:Q,offset:T,limit:i,pendencies:k})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Jy}from"@asteasolutions/zod-to-openapi";import Us from"zod";Jy(Us);var qs=Us.object({pendencyId:Us.uuid()}),Mo=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{pendencyId:t}=qs.parse({pendencyId:e.params.pendency_id}),i=await this.pendencyRepository.findById(t);if(!i)throw new l("Pend\xEAncia n\xE3o encontrada.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Qy}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as ef}from"@prisma/client";import ke from"zod";Qy(ke);var To=ke.object({id:ke.uuid(),title:ke.string().min(1),description:ke.string().optional(),status:ke.enum(ef),dueDate:ke.coerce.date().optional(),document:ke.any().refine(o=>o==null||typeof o=="object"&&typeof o.size=="number"&&(o.size===0||o.size>0),"Arquivo do documento \xE9 inv\xE1lido").optional()}),Po=class{constructor(e,r){this.pendencyRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{document:t,id:i,...n}=To.parse({...e.body,id:e.params.pendency_id,document:e.file}),a=await this.pendencyRepository.findById(i);if(!a)throw new ee("A pend\xEAncia n\xE3o existe");let m=a.documentUrl;return t&&t.size>0&&(m=await this.firebaseStorageService.updateFile({file:t,id:a.userId,folder:F.PENDENCY,fileUrl:a.documentUrl})),await this.pendencyRepository.update({...n,id:i,documentUrl:m}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var kc={method:"post",path:"/pendency/{user_id}",tags:["Pendencies"],summary:"Create pendency for user",security:[{bearerAuth:[]}],request:{params:jo.pick({userId:!0}).transform(()=>({user_id:""})),body:{content:{"multipart/form-data":{schema:jo.omit({userId:!0})}}}},responses:{201:{description:"Pendency created successfully for the user",summary:"Pendency Created",content:{"application/json":{schema:x.object({})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Lc={method:"get",path:"/pendency",tags:["Pendencies"],summary:"List pendencies",security:[{bearerAuth:[]}],request:{query:Fs},responses:{200:{description:"Paginated list of pendencies retrieved successfully",summary:"Pendencies Retrieved",content:{"application/json":{schema:x.object({page:x.number(),totalPages:x.number(),offset:x.number(),limit:x.number(),pendencies:x.array(x.object({id:x.string(),title:x.string(),description:x.string().nullable(),status:x.enum(Nc.PendencyStatus),dueDate:x.date().nullable(),documentUrl:x.string(),userId:x.string(),createdAt:x.date(),updatedAt:x.date()}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Gc={method:"get",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Find pendency by ID",security:[{bearerAuth:[]}],request:{params:qs},responses:{200:{description:"Pendency details retrieved successfully",summary:"Pendency Retrieved",content:{"application/json":{schema:x.object({id:x.string(),title:x.string(),description:x.string().nullable(),status:x.enum(Nc.PendencyStatus),dueDate:x.date().nullable(),documentUrl:x.string(),userId:x.string(),createdAt:x.date(),updatedAt:x.date()}).nullable()}}},400:{description:"Invalid pendency ID format",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},404:{description:"Pendency not found with the provided ID",summary:"Pendency Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},_c={method:"put",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Update pendency",security:[{bearerAuth:[]}],request:{params:To.pick({id:!0}).transform(()=>({pendency_id:""})),body:{content:{"multipart/form-data":{schema:To.omit({id:!0})}}}},responses:{204:{description:"Pendency updated successfully",summary:"Pendency Updated"},400:{description:"Invalid input data or pendency does not exist",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Wc={method:"delete",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Delete pendency",security:[{bearerAuth:[]}],request:{params:Ds},responses:{204:{description:"Pendency deleted successfully",summary:"Pendency Deleted"},400:{description:"Invalid pendency ID format",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},404:{description:"Pendency not found with the provided ID",summary:"Pendency Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}};import{RegimentStatus as hf}from"@prisma/client";import j from"zod";import{extendZodWithOpenApi as tf}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as zc}from"@prisma/client";import $e from"zod";var Zc=10,Hc=1024,rf=Hc*Hc,of=Zc*rf;tf($e);var Bs=$e.object({title:$e.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),version:$e.string().min(1,"Vers\xE3o \xE9 obrigat\xF3ria"),publishedAt:$e.coerce.date(),document:$e.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=of,`O documento deve ter no m\xE1ximo ${Zc}MB.`),status:$e.enum(zc).optional()}),Ao=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{title:t,version:i,publishedAt:n,document:a,status:m}=Bs.parse({...e.body,document:e.file}),c=await this.regimentRepository.create({title:t,version:i,publishedAt:n,documentUrl:"",status:m??zc.IN_FORCE}),u=await this.firebaseStorageService.uploadFile({file:a,id:c.id,folder:F.REGIMENT});return await this.regimentRepository.update({id:c.id,documentUrl:u}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as nf}from"@asteasolutions/zod-to-openapi";import Os from"zod";nf(Os);var Ns=Os.object({id:Os.uuid()}),Do=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=Ns.parse({id:e.params.id}),i=await this.regimentRepository.findById(t);if(!i)throw new l("O regimento n\xE3o existe.");return i.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl}),await this.regimentRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as sf}from"@asteasolutions/zod-to-openapi";import ks from"zod";sf(ks);var Uo=ks.object({id:ks.uuid()}),Fo=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{id:t}=Uo.parse({id:e.params.id}),i=await this.regimentRepository.findById(t);if(!i)throw new l("O regimento n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as af}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as mf}from"@prisma/client";import Ls from"zod";af(Ls);var Gs=Ls.object({status:Ls.enum(mf)}),qo=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{status:t}=Gs.parse({status:e.params.status}),i=await this.regimentRepository.findByStatus(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as cf}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as pf}from"@prisma/client";import Je from"zod";var df=1,lf=10;cf(Je);var _s=Je.object({page:Je.coerce.number().min(1).default(df),limit:Je.coerce.number().min(1).default(lf),title:Je.string().optional(),status:Je.enum(pf).optional(),orderBy:Je.enum(["asc","desc"]).optional()}),Bo=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=_s.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.regimentRepository.find({pagination:{offset:a,limit:i},filter:n}),this.regimentRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:a,limit:i,regiments:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as uf}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as gf}from"@prisma/client";import Le from"zod";var Kc=10,Vc=1024,yf=Vc*Vc,ff=Kc*yf;uf(Le);var Ws=Le.object({id:Le.uuid(),title:Le.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),version:Le.string().min(1,"Vers\xE3o \xE9 obrigat\xF3ria").optional(),publishedAt:Le.coerce.date().optional(),document:Le.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=ff,`O documento deve ter no m\xE1ximo ${Kc}MB.`).optional(),status:Le.enum(gf).optional()}),Oo=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,title:i,version:n,publishedAt:a,document:m,status:c}=Ws.parse({id:e.params.id,...e.body,document:e.file}),u=await this.regimentRepository.findById(t);if(!u)throw new l("O regimento n\xE3o existe.");let T=u.documentUrl;return m&&(u.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:u.documentUrl}),T=await this.firebaseStorageService.uploadFile({file:m,id:t,folder:F.REGIMENT})),await this.regimentRepository.update({id:t,title:i,version:n,publishedAt:a,documentUrl:T??void 0,status:c}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Hs=j.object({id:j.uuid(),title:j.string(),version:j.string(),publishedAt:j.date(),documentUrl:j.string(),status:j.enum(hf),createdAt:j.date(),updatedAt:j.date()}),Yc={method:"post",path:"/regiment",tags:["Regiments"],summary:"Create a new regiment with document upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:Bs}}}},responses:{201:{description:"Regiment created successfully",summary:"Regiment Created"},400:{description:"Invalid input data, missing required fields, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},Xc={method:"get",path:"/regiment",tags:["Regiments"],summary:"List all regiments with pagination and filters",request:{query:_s},responses:{200:{description:"List of regiments retrieved successfully with pagination",summary:"Regiments Retrieved",content:{"application/json":{schema:j.object({page:j.number(),totalPages:j.number(),offset:j.number(),limit:j.number(),regiments:j.array(Hs)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},$c={method:"get",path:"/regiment/{id}",tags:["Regiments"],summary:"Find regiment by ID",request:{params:Uo},responses:{200:{description:"Regiment details retrieved successfully",summary:"Regiment Retrieved",content:{"application/json":{schema:Hs}}},400:{description:"Invalid regiment ID format",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},Jc={method:"get",path:"/regiment/status/{status}",tags:["Regiments"],summary:"Find regiments by status",request:{params:Gs},responses:{200:{description:"Regiments retrieved successfully by status",summary:"Regiments Retrieved by Status",content:{"application/json":{schema:j.array(Hs)}}},400:{description:"Invalid status parameter provided",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},Qc={method:"put",path:"/regiment/{id}",tags:["Regiments"],summary:"Update regiment with optional document upload",security:[{bearerAuth:[]}],request:{params:Uo,body:{content:{"multipart/form-data":{schema:Ws.omit({id:!0})}}}},responses:{200:{description:"Regiment updated successfully",summary:"Regiment Updated"},400:{description:"Invalid input data, regiment ID format, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},ep={method:"delete",path:"/regiment/{id}",tags:["Regiments"],summary:"Delete regiment",security:[{bearerAuth:[]}],request:{params:Ns},responses:{200:{description:"Regiment deleted successfully",summary:"Regiment Deleted"},400:{description:"Invalid regiment ID format",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}};import O from"zod";import{extendZodWithOpenApi as Rf}from"@asteasolutions/zod-to-openapi";import Wt from"zod";var rp=5,tp=1024,If=tp*tp,Cf=rp*If;Rf(Wt);var zs=Wt.object({caption:Wt.string().optional(),image:Wt.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=Cf,`A imagem deve ter no m\xE1ximo ${rp}MB.`),congressId:Wt.uuid()}),No=class{constructor(e,r,t){this.regionalCongressGalleryRepository=e;this.regionalCongressRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{caption:t,image:i,congressId:n}=zs.parse({...e.body,...e.params,image:e.file});if(!await this.regionalCongressRepository.findById(n))throw new l("O congresso n\xE3o existe.");let m=await this.regionalCongressGalleryRepository.create({caption:t,congressId:n,imageUrl:""}),c=await this.firebaseStorageService.uploadFile({file:i,id:m.id,folder:F.GALLERY});return await this.regionalCongressGalleryRepository.update({id:m.id,imageUrl:c}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as bf}from"@asteasolutions/zod-to-openapi";import Zs from"zod";bf(Zs);var Lo=Zs.object({id:Zs.uuid("ID inv\xE1lido")}),ko=class{constructor(e){this.regionalCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=Lo.parse(e.params);if(!await this.regionalCongressGalleryRepository.findById(t))throw new l("Item de galeria n\xE3o encontrado");return await this.regionalCongressGalleryRepository.deleteById(t),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as wf}from"@asteasolutions/zod-to-openapi";import bt from"zod";wf(bt);var Vs=bt.object({congressId:bt.uuid("ID do congresso inv\xE1lido"),page:bt.coerce.number().int().positive().default(1),limit:bt.coerce.number().int().positive().default(10),caption:bt.string().optional()}),Go=class{constructor(e){this.regionalCongressGalleryRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Vs.parse({...e.params,...e.query}),a=(t-1)*i,m=await this.regionalCongressGalleryRepository.findByCongressId({pagination:{offset:a,limit:i},filter:n});if(!m)throw new l("Itens de galeria n\xE3o encontrados");let c=await this.regionalCongressGalleryRepository.count({filter:n});return r.status(200).json({data:m,pagination:{page:t,limit:i,total:c,totalPages:Math.ceil(c/i)}})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Sf}from"@asteasolutions/zod-to-openapi";import Ht from"zod";var ip=5,op=1024,vf=op*op,jf=ip*vf;Sf(Ht);var Ks=Ht.object({id:Ht.string().uuid("ID inv\xE1lido"),caption:Ht.string().optional(),image:Ht.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=jf,`A imagem deve ter no m\xE1ximo ${ip}MB.`).optional()}),_o=class{constructor(e,r){this.regionalCongressGalleryRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,caption:i,image:n}=Ks.parse({...e.params,...e.body,image:e.file});if(!await this.regionalCongressGalleryRepository.findById(t))throw new l("Item de galeria n\xE3o encontrado");let m;return n&&(m=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:F.GALLERY})),await this.regionalCongressGalleryRepository.update({id:t,caption:i,...m&&{imageUrl:m}}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Ef=O.object({id:O.uuid(),imageUrl:O.string(),caption:O.string().nullable(),congressId:O.uuid()}),np={method:"post",path:"/regional-congress/{congressId}/gallery",tags:["Regional Congresses"],summary:"Create a new congress gallery image",security:[{bearerAuth:[]}],request:{params:O.object({congressId:O.uuid()}),body:{content:{"application/json":{schema:zs.omit({congressId:!0})}}}},responses:{201:{description:"Congress gallery image created successfully",summary:"Congress Gallery Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:O.object({errors:O.record(O.string(),O.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:O.object({message:O.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:O.object({message:O.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:O.object({message:O.string()})}}}}},sp={method:"get",path:"/regional-congress/{congressId}/gallery",tags:["Regional Congresses"],summary:"Find congress gallery images by congress ID",request:{params:Vs},responses:{200:{description:"Congress gallery images retrieved successfully by congress ID",summary:"Congress Galleries Retrieved",content:{"application/json":{schema:O.array(Ef)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:O.object({errors:O.record(O.string(),O.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:O.object({message:O.string()})}}}}},ap={method:"put",path:"/regional-congress/gallery/{id}",tags:["Regional Congresses"],summary:"Update congress gallery image",security:[{bearerAuth:[]}],request:{params:Lo,body:{content:{"application/json":{schema:Ks.omit({id:!0})}}}},responses:{200:{description:"Congress gallery image updated successfully",summary:"Congress Gallery Updated"},400:{description:"Invalid input data or gallery ID format",summary:"Validation Error",content:{"application/json":{schema:O.object({errors:O.record(O.string(),O.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:O.object({message:O.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:O.object({message:O.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:O.object({message:O.string()})}}}}},mp={method:"delete",path:"/regional-congress/gallery/{id}",tags:["Regional Congresses"],summary:"Delete congress gallery image",security:[{bearerAuth:[]}],request:{params:Lo},responses:{200:{description:"Congress gallery image deleted successfully",summary:"Congress Gallery Deleted"},400:{description:"Invalid gallery ID format",summary:"Validation Error",content:{"application/json":{schema:O.object({errors:O.record(O.string(),O.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:O.object({message:O.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:O.object({message:O.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:O.object({message:O.string()})}}}}};import N from"zod";import{extendZodWithOpenApi as xf}from"@asteasolutions/zod-to-openapi";import zt from"zod";var pp=2,cp=1024,Mf=cp*cp,Pf=pp*Mf;xf(zt);var Ys=zt.object({name:zt.string().min(1,"Nome \xE9 obrigat\xF3rio"),logo:zt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Pf,`A imagem deve ter no m\xE1ximo ${pp}MB.`).optional(),congressId:zt.uuid()}),Wo=class{constructor(e,r,t){this.regionalCongressPartnerRepository=e;this.regionalCongressRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{name:t,logo:i,congressId:n}=Ys.parse({...e.body,...e.params,logo:e.file});if(!await this.regionalCongressRepository.findById(n))throw new l("O congresso n\xE3o existe.");let m=await this.regionalCongressPartnerRepository.create({name:t,congressId:n}),c;return i&&(c=await this.firebaseStorageService.uploadFile({file:i,id:m.id,folder:F.PARTNER}),await this.regionalCongressPartnerRepository.update({id:m.id,logoUrl:c})),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Tf}from"@asteasolutions/zod-to-openapi";import Xs from"zod";Tf(Xs);var zo=Xs.object({id:Xs.string().uuid("ID inv\xE1lido")}),Ho=class{constructor(e){this.regionalCongressPartnerRepository=e}async handle(e,r){try{let{id:t}=zo.parse(e.params);if(!await this.regionalCongressPartnerRepository.findById(t))throw new l("Parceiro n\xE3o encontrado");return await this.regionalCongressPartnerRepository.deleteById(t),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Af}from"@asteasolutions/zod-to-openapi";import wt from"zod";Af(wt);var $s=wt.object({congressId:wt.uuid("ID do congresso inv\xE1lido"),page:wt.coerce.number().int().positive().optional(),limit:wt.coerce.number().int().positive().optional(),name:wt.string().optional()}),Zo=class{constructor(e){this.regionalCongressPartnerRepository=e}async handle(e,r){try{let{congressId:t,page:i,limit:n,name:a}=$s.parse({...e.params,...e.query}),m=i!==void 0&&n!==void 0,c=m?{offset:(i-1)*n,limit:n}:void 0,u=await this.regionalCongressPartnerRepository.findByCongressId({pagination:c,filter:{congressId:t,name:a}});if(!u)throw new l("Parceiros n\xE3o encontrados");if(!m)return r.status(200).json(u);let T=await this.regionalCongressPartnerRepository.count({filter:{congressId:t,name:a}});return r.status(200).json({data:u,pagination:{page:i,limit:n,total:T,totalPages:Math.ceil(T/n)}})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Df}from"@asteasolutions/zod-to-openapi";import Zt from"zod";var lp=2,dp=1024,Ff=dp*dp,Uf=lp*Ff;Df(Zt);var Js=Zt.object({id:Zt.string().uuid("ID inv\xE1lido"),name:Zt.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),logo:Zt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Uf,`A imagem deve ter no m\xE1ximo ${lp}MB.`).optional()}),Vo=class{constructor(e,r){this.regionalCongressPartnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,logo:n}=Js.parse({...e.params,...e.body,logo:e.file});if(!await this.regionalCongressPartnerRepository.findById(t))throw new l("Parceiro n\xE3o encontrado");let m;return n&&(m=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:F.PARTNER})),await this.regionalCongressPartnerRepository.update({id:t,name:i,...m&&{logoUrl:m}}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var qf=N.object({id:N.uuid(),name:N.string(),logoUrl:N.string().nullable(),congressId:N.uuid()}),up={method:"post",path:"/regional-congress/{congressId}/partner",tags:["Regional Congresses"],summary:"Create a new congress partner",security:[{bearerAuth:[]}],request:{params:N.object({congressId:N.uuid()}),body:{content:{"application/json":{schema:Ys.omit({congressId:!0})}}}},responses:{201:{description:"Congress partner created successfully",summary:"Congress Partner Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:N.object({errors:N.record(N.string(),N.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:N.object({message:N.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:N.object({message:N.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:N.object({message:N.string()})}}}}},gp={method:"get",path:"/regional-congress/{congressId}/partner",tags:["Regional Congresses"],summary:"Find congress partners by congress ID",request:{params:$s},responses:{200:{description:"Congress partners retrieved successfully by congress ID",summary:"Congress Partners Retrieved",content:{"application/json":{schema:N.array(qf)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:N.object({errors:N.record(N.string(),N.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:N.object({message:N.string()})}}}}},yp={method:"put",path:"/regional-congress/partner/{id}",tags:["Regional Congresses"],summary:"Update congress partner",security:[{bearerAuth:[]}],request:{params:zo,body:{content:{"application/json":{schema:Js.omit({id:!0})}}}},responses:{200:{description:"Congress partner updated successfully",summary:"Congress Partner Updated"},400:{description:"Invalid input data or partner ID format",summary:"Validation Error",content:{"application/json":{schema:N.object({errors:N.record(N.string(),N.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:N.object({message:N.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:N.object({message:N.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:N.object({message:N.string()})}}}}},fp={method:"delete",path:"/regional-congress/partner/{id}",tags:["Regional Congresses"],summary:"Delete congress partner",security:[{bearerAuth:[]}],request:{params:zo},responses:{200:{description:"Congress partner deleted successfully",summary:"Congress Partner Deleted"},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:N.object({errors:N.record(N.string(),N.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:N.object({message:N.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:N.object({message:N.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:N.object({message:N.string()})}}}}};import d from"zod";import{extendZodWithOpenApi as Bf}from"@asteasolutions/zod-to-openapi";import H from"zod";Bf(H);var Qs=H.object({title:H.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),edition:H.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo"),startDate:H.coerce.date(),endDate:H.coerce.date(),description:H.string().optional(),location:H.string().optional(),congressLink:H.union([H.url("Link do congresso deve ser uma URL v\xE1lida"),H.literal("")]),noticeUrl:H.union([H.url("URL do edital deve ser uma URL v\xE1lida"),H.literal("")]),scheduleUrl:H.union([H.url("URL do cronograma deve ser uma URL v\xE1lida"),H.literal("")]),programUrl:H.union([H.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida"),H.literal("")]),adminReportUrl:H.union([H.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida"),H.literal("")]),proceedingsUrl:H.union([H.url("URL dos anais deve ser uma URL v\xE1lida"),H.literal("")])}).refine(o=>o.endDate>=o.startDate,{message:"Data de t\xE9rmino deve ser posterior ou igual \xE0 data de in\xEDcio",path:["endDate"]}),Ko=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let t=Qs.parse(e.body);return await this.regionalCongressRepository.create(t),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Of}from"@asteasolutions/zod-to-openapi";import ea from"zod";Of(ea);var ta=ea.object({id:ea.string().uuid("ID inv\xE1lido")}),Yo=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let{id:t}=ta.parse(e.params);if(!await this.regionalCongressRepository.findById(t))throw new l("Congresso regional n\xE3o encontrado");return await this.regionalCongressRepository.deleteById(t),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Nf}from"@asteasolutions/zod-to-openapi";import ra from"zod";Nf(ra);var oa=ra.object({edition:ra.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo")}),Xo=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let{edition:t}=oa.parse(e.params),i=await this.regionalCongressRepository.findByEdition(t);if(!i||i.length===0)throw new l("Congresso regional n\xE3o encontrado");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as kf}from"@asteasolutions/zod-to-openapi";import ia from"zod";kf(ia);var Jo=ia.object({id:ia.string().uuid("ID inv\xE1lido")}),$o=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let{id:t}=Jo.parse(e.params),i=await this.regionalCongressRepository.findById(t);if(!i)throw new l("Congresso regional n\xE3o encontrado");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Lf}from"@asteasolutions/zod-to-openapi";import Ge from"zod";Lf(Ge);var na=Ge.object({page:Ge.coerce.number().int().positive().default(1),limit:Ge.coerce.number().int().positive().default(10),title:Ge.string().optional(),edition:Ge.coerce.number().int().positive().optional(),location:Ge.string().optional(),orderBy:Ge.enum(["asc","desc"]).optional().default("desc")}),Qo=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let{page:t,limit:i,orderBy:n,...a}=na.parse(e.query),m=(t-1)*i,c=await this.regionalCongressRepository.find({pagination:{offset:m,limit:i},filter:{...a,orderBy:n}});if(!c)throw new l("Congressos regionais n\xE3o encontrados");let u=await this.regionalCongressRepository.count({filter:a});return r.status(200).json({data:c,pagination:{page:t,limit:i,total:u,totalPages:Math.ceil(u/i)}})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Gf}from"@asteasolutions/zod-to-openapi";import W from"zod";Gf(W);var sa=W.object({id:W.string().uuid("ID inv\xE1lido"),title:W.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),edition:W.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo").optional(),startDate:W.coerce.date().optional(),endDate:W.coerce.date().optional(),description:W.string().optional(),location:W.string().optional(),congressLink:W.union([W.url("Link do congresso deve ser uma URL v\xE1lida"),W.literal("")]),noticeUrl:W.union([W.url("URL do edital deve ser uma URL v\xE1lida"),W.literal("")]),scheduleUrl:W.union([W.url("URL do cronograma deve ser uma URL v\xE1lida"),W.literal("")]),programUrl:W.union([W.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida"),W.literal("")]),adminReportUrl:W.union([W.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida"),W.literal("")]),proceedingsUrl:W.union([W.url("URL dos anais deve ser uma URL v\xE1lida"),W.literal("")])}).refine(o=>o.startDate&&o.endDate?o.endDate>=o.startDate:!0,{message:"Data de t\xE9rmino deve ser posterior ou igual \xE0 data de in\xEDcio",path:["endDate"]}),ei=class{constructor(e){this.regionalCongressRepository=e}async handle(e,r){try{let{id:t}=W.object({id:W.string().uuid()}).parse(e.params);if(!await this.regionalCongressRepository.findById(t))throw new l("Congresso regional n\xE3o encontrado");let n=sa.parse({id:t,...e.body});return await this.regionalCongressRepository.update(n),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var _f=9,Wf=d.object({image:d.any().openapi({type:"string",format:"binary"}),caption:d.string().optional()}),Hf=d.object({image:d.any().openapi({type:"string",format:"binary"}).optional(),caption:d.string().optional()}),zf=d.object({id:d.uuid(),name:d.string(),logoUrl:d.string().nullable(),congressId:d.uuid()}),aa=d.object({id:d.uuid(),imageUrl:d.string(),caption:d.string().nullable(),congressId:d.uuid()}),ma=d.object({id:d.uuid(),title:d.string(),edition:d.number(),startDate:d.date(),endDate:d.date(),description:d.string().nullable(),location:d.string().nullable(),congressLink:d.string().nullable(),noticeUrl:d.string().nullable(),scheduleUrl:d.string().nullable(),programUrl:d.string().nullable(),adminReportUrl:d.string().nullable(),proceedingsUrl:d.string().nullable(),partners:d.array(zf),galleries:d.array(aa),createdAt:d.date(),updatedAt:d.date()}),hp={method:"post",path:"/regional-congress",tags:["Regional Congresses"],summary:"Create a new regional congress",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Qs}}}},responses:{201:{description:"Regional congress created successfully",summary:"Regional Congress Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},Rp={method:"get",path:"/regional-congress",tags:["Regional Congresses"],summary:"List all regional congresses with pagination and filters",request:{query:na},responses:{200:{description:"List of regional congresses retrieved successfully with pagination",summary:"Regional Congresses Retrieved",content:{"application/json":{schema:d.object({page:d.number(),totalPages:d.number(),offset:d.number(),limit:d.number(),congresses:d.array(ma)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},Ip={method:"get",path:"/regional-congress/{id}",tags:["Regional Congresses"],summary:"Find regional congress by ID",request:{params:Jo},responses:{200:{description:"Regional congress details retrieved successfully",summary:"Regional Congress Retrieved",content:{"application/json":{schema:ma}}},400:{description:"Invalid regional congress ID format",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},404:{description:"Regional congress not found with the provided ID",summary:"Regional Congress Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},Cp={method:"get",path:"/regional-congress/edition/{edition}",tags:["Regional Congresses"],summary:"Find regional congresses by edition",request:{params:oa},responses:{200:{description:"Regional congresses retrieved successfully by edition",summary:"Regional Congresses Retrieved by Edition",content:{"application/json":{schema:d.array(ma)}}},400:{description:"Invalid edition parameter provided",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},bp={method:"put",path:"/regional-congress/{id}",tags:["Regional Congresses"],summary:"Update regional congress",security:[{bearerAuth:[]}],request:{params:Jo,body:{content:{"application/json":{schema:sa.omit({id:!0})}}}},responses:{200:{description:"Regional congress updated successfully",summary:"Regional Congress Updated"},400:{description:"Invalid input data or regional congress ID format",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},404:{description:"Regional congress not found with the provided ID",summary:"Regional Congress Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},wp={method:"delete",path:"/regional-congress/{id}",tags:["Regional Congresses"],summary:"Delete regional congress",security:[{bearerAuth:[]}],request:{params:ta},responses:{200:{description:"Regional congress deleted successfully",summary:"Regional Congress Deleted"},400:{description:"Invalid regional congress ID format",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},404:{description:"Regional congress not found with the provided ID",summary:"Regional Congress Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},RT={method:"post",path:"/regional-congress/{congressId}/gallery",tags:["Regional Congress Gallery"],summary:"Create a new gallery image for a congress",security:[{bearerAuth:[]}],request:{params:d.object({congressId:d.uuid()}),body:{content:{"multipart/form-data":{schema:Wf}}}},responses:{201:{description:"Gallery image created successfully",summary:"Gallery Image Created"},400:{description:"Invalid input data, missing required fields, or invalid image format/size",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},IT={method:"get",path:"/regional-congress/{congressId}/gallery",tags:["Regional Congress Gallery"],summary:"List all gallery images for a congress with pagination",request:{params:d.object({congressId:d.uuid()}),query:d.object({page:d.coerce.number().min(1).default(1),limit:d.coerce.number().min(1).default(_f),caption:d.string().optional()})},responses:{200:{description:"Gallery images retrieved successfully with pagination",summary:"Gallery Images Retrieved",content:{"application/json":{schema:d.object({page:d.number(),totalPages:d.number(),offset:d.number(),limit:d.number(),galleries:d.array(aa)})}}},400:{description:"Invalid congress ID format or query parameters",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},CT={method:"get",path:"/regional-congress/gallery/{id}",tags:["Regional Congress Gallery"],summary:"Find a gallery image by ID",request:{params:d.object({id:d.uuid()})},responses:{200:{description:"Gallery image retrieved successfully",summary:"Gallery Image Retrieved",content:{"application/json":{schema:aa}}},400:{description:"Invalid gallery image ID format",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},bT={method:"put",path:"/regional-congress/gallery/{id}",tags:["Regional Congress Gallery"],summary:"Update a gallery image with optional image upload",security:[{bearerAuth:[]}],request:{params:d.object({id:d.uuid()}),body:{content:{"multipart/form-data":{schema:Hf}}}},responses:{200:{description:"Gallery image updated successfully",summary:"Gallery Image Updated"},400:{description:"Invalid input data, gallery ID format, or invalid image format/size",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}},wT={method:"delete",path:"/regional-congress/gallery/{id}",tags:["Regional Congress Gallery"],summary:"Delete a gallery image",security:[{bearerAuth:[]}],request:{params:d.object({id:d.uuid()})},responses:{200:{description:"Gallery image deleted successfully",summary:"Gallery Image Deleted"},400:{description:"Invalid gallery ID format",summary:"Validation Error",content:{"application/json":{schema:d.object({errors:d.record(d.string(),d.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:d.object({message:d.string()})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:d.object({message:d.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:d.object({message:d.string()})}}}}};import{$Enums as fa}from"@prisma/client";import h from"zod";import{extendZodWithOpenApi as Zf}from"@asteasolutions/zod-to-openapi";import{Degree as Vf,Seniority as Kf}from"@prisma/client";import se from"zod";Zf(se);var ca=se.object({registrationNumber:se.string(),mainEtps:se.string().optional(),formations:se.string().optional(),degrees:se.array(se.enum(Vf)),occupations:se.string(),seniority:se.enum(Kf),institutions:se.string(),biography:se.string().optional(),userId:se.string()}),ti=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{registrationNumber:t,mainEtps:i,formations:n,degrees:a,occupations:m,seniority:c,institutions:u,biography:T,userId:k}=ca.parse(e.body);if(await this.researcherRepository.findByRegistrationNumber(t))throw new Y("J\xE1 existe um pesquisador cadastrado com este n\xFAmero de registro.");if(await this.researcherRepository.findByUserId(k))throw new Y("Usu\xE1rio j\xE1 possui um perfil de pesquisador.");return await this.researcherRepository.create({registrationNumber:t,mainEtps:i,formations:n,degrees:a,occupations:m,seniority:c,institutions:u,biography:T,userId:k}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Yf}from"@asteasolutions/zod-to-openapi";import pa from"zod";Yf(pa);var da=pa.object({id:pa.uuid()}),ri=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t}=da.parse({id:e.params.id});if(!await this.researcherRepository.findById(t))throw new l("O pesquisador n\xE3o existe.");return await this.researcherRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Xf}from"@asteasolutions/zod-to-openapi";import la from"zod";Xf(la);var ii=la.object({id:la.uuid()}),oi=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t}=ii.parse({id:e.params.id}),i=await this.researcherRepository.findById(t);if(!i)throw new l("O pesquisador n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as $f}from"@asteasolutions/zod-to-openapi";import ua from"zod";$f(ua);var ga=ua.object({userId:ua.uuid()}),ni=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{userId:t}=ga.parse({userId:e.params.userId}),i=await this.researcherRepository.findByUserId(t);if(!i)throw new l("O pesquisador n\xE3o existe para este usu\xE1rio.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Jf}from"@asteasolutions/zod-to-openapi";import{Degree as Qf,Seniority as eh}from"@prisma/client";import ae from"zod";Jf(ae);var ya=ae.object({id:ae.uuid(),registrationNumber:ae.string().optional(),mainEtps:ae.string().optional(),formations:ae.string().optional(),degrees:ae.array(ae.enum(Qf)).optional(),occupations:ae.string().optional(),seniority:ae.enum(eh).optional(),institutions:ae.string().optional(),biography:ae.string().optional()}),si=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t,registrationNumber:i,mainEtps:n,formations:a,degrees:m,occupations:c,seniority:u,institutions:T,biography:k}=ya.parse({id:e.params.id,...e.body}),Z=await this.researcherRepository.findById(t);if(!Z)throw new l("O pesquisador n\xE3o existe.");if(i&&i!==Z.registrationNumber){let Q=await this.researcherRepository.findByRegistrationNumber(i);if(Q&&Q.id!==t)throw new Y("J\xE1 existe um pesquisador com este n\xFAmero de registro.")}return await this.researcherRepository.update({id:t,registrationNumber:i,mainEtps:n,formations:a,degrees:m,occupations:c,seniority:u,institutions:T,biography:k}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var th=1,rh=9,ha=h.object({id:h.uuid(),registrationNumber:h.string(),mainEtps:h.string().nullable(),formations:h.string().nullable(),degrees:h.array(h.enum(fa.Degree)),occupations:h.string(),seniority:h.enum(fa.Seniority),institutions:h.string(),biography:h.string().nullable(),createdAt:h.date(),updatedAt:h.date(),userId:h.uuid(),user:h.object({id:h.uuid(),name:h.string(),emailAddress:h.string(),avatarUrl:h.string().nullable(),orcid:h.string().nullable(),phone:h.string().nullable(),lattesUrl:h.string().nullable(),role:h.enum(fa.UserRole)})}),Sp={method:"post",path:"/researcher",tags:["Researchers"],summary:"Create a new researcher profile",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:ca}}}},responses:{201:{description:"Researcher profile created successfully",summary:"Researcher Created",content:{"application/json":{schema:h.object({message:h.string()})}}},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},409:{description:"Researcher with this registration number already exists or user already has a researcher profile",summary:"Conflict",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},vp={method:"get",path:"/researcher",tags:["Researchers"],summary:"List all researchers with pagination and filters",request:{query:h.object({page:h.coerce.number().min(1).default(th).optional(),limit:h.coerce.number().min(1).default(rh).optional(),userId:h.string().optional(),registrationNumber:h.string().optional(),name:h.string().optional(),emailAddress:h.string().optional(),mainEtps:h.string().optional(),formations:h.string().optional(),occupations:h.string().optional(),institutions:h.string().optional(),biography:h.string().optional(),orderBy:h.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of researchers retrieved successfully with pagination",summary:"Researchers Retrieved",content:{"application/json":{schema:h.object({page:h.number(),totalPages:h.number(),offset:h.number(),limit:h.number(),researchers:h.array(ha)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},jp={method:"get",path:"/researcher/{id}",tags:["Researchers"],summary:"Find researcher by ID",request:{params:ii},responses:{200:{description:"Researcher details retrieved successfully",summary:"Researcher Retrieved",content:{"application/json":{schema:ha}}},400:{description:"Invalid researcher ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},Ep={method:"get",path:"/researcher/user/{userId}",tags:["Researchers"],summary:"Find researcher by user ID",request:{params:ga},responses:{200:{description:"Researcher details retrieved successfully",summary:"Researcher Retrieved",content:{"application/json":{schema:ha}}},400:{description:"Invalid user ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},404:{description:"Researcher not found for this user",summary:"Researcher Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},xp={method:"put",path:"/researcher/{id}",tags:["Researchers"],summary:"Update researcher profile",security:[{bearerAuth:[]}],request:{params:ii,body:{content:{"application/json":{schema:ya.omit({id:!0})}}}},responses:{200:{description:"Researcher profile updated successfully",summary:"Researcher Updated",content:{"application/json":{schema:h.object({message:h.string()})}}},400:{description:"Invalid input data or researcher ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},409:{description:"Researcher with this registration number already exists",summary:"Conflict",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},Mp={method:"delete",path:"/researcher/{id}",tags:["Researchers"],summary:"Delete researcher profile",security:[{bearerAuth:[]}],request:{params:da},responses:{200:{description:"Researcher profile deleted successfully",summary:"Researcher Deleted"},400:{description:"Invalid researcher ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}};import{$Enums as ah}from"@prisma/client";import P from"zod";import{extendZodWithOpenApi as oh}from"@asteasolutions/zod-to-openapi";import St from"zod";oh(St);var Ra=St.object({role:St.string().min(1),description:St.string().optional(),userId:St.uuid(),order:St.number().optional()}),ai=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{role:t,description:i,userId:n,order:a}=Ra.parse(e.body);return await this.sdhcTeamMemberRepository.create({role:t,description:i,userId:n,order:a??0}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ih}from"@asteasolutions/zod-to-openapi";import Ia from"zod";ih(Ia);var Ca=Ia.object({id:Ia.uuid()}),mi=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t}=Ca.parse({id:e.params.id});if(!await this.sdhcTeamMemberRepository.findById(t))throw new l("O membro da equipe SDHC n\xE3o existe.");return await this.sdhcTeamMemberRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as nh}from"@asteasolutions/zod-to-openapi";import ba from"zod";nh(ba);var pi=ba.object({id:ba.uuid()}),ci=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t}=pi.parse({id:e.params.id}),i=await this.sdhcTeamMemberRepository.findById(t);if(!i)throw new l("O membro da equipe SDHC n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as sh}from"@asteasolutions/zod-to-openapi";import Qe from"zod";sh(Qe);var wa=Qe.object({id:Qe.uuid(),role:Qe.string().min(1).optional(),description:Qe.string().optional(),userId:Qe.uuid().optional(),order:Qe.number().optional()}),di=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t,role:i,description:n,userId:a,order:m}=wa.parse({id:e.params.id,...e.body});if(!await this.sdhcTeamMemberRepository.findById(t))throw new l("O membro da equipe SDHC n\xE3o existe.");return await this.sdhcTeamMemberRepository.update({id:t,role:i,description:n,userId:a,order:m}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var mh=P.object({id:P.uuid(),name:P.string(),emailAddress:P.string(),avatarUrl:P.string().nullable(),orcid:P.string().nullable(),phone:P.string().nullable(),lattesUrl:P.string().nullable(),role:P.enum(ah.UserRole)}),Pp=P.object({id:P.uuid(),role:P.string(),description:P.string().nullable(),order:P.number(),createdAt:P.date(),updatedAt:P.date(),userId:P.uuid(),user:mh}),Tp={method:"post",path:"/sdhc-team-member",tags:["SDHC Team Members"],summary:"Create a new SDHC Team Member",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Ra}}}},responses:{201:{description:"SDHC Team Member created successfully",summary:"SDHC Team Member Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:P.object({errors:P.record(P.string(),P.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:P.object({message:P.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:P.object({message:P.string()})}}}}},Ap={method:"get",path:"/sdhc-team-member",tags:["SDHC Team Members"],summary:"List all SDHC Team Members with filters",request:{query:P.object({role:P.string().optional(),orderBy:P.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of SDHC Team Members retrieved successfully",summary:"SDHC Team Members Retrieved",content:{"application/json":{schema:P.object({members:P.array(Pp)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:P.object({message:P.string()})}}}}},Dp={method:"get",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Find SDHC Team Member by ID",request:{params:pi},responses:{200:{description:"SDHC Team Member details retrieved successfully",summary:"SDHC Team Member Retrieved",content:{"application/json":{schema:Pp}}},400:{description:"Invalid SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:P.object({errors:P.record(P.string(),P.string())})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:P.object({message:P.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:P.object({message:P.string()})}}}}},Fp={method:"put",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Update SDHC Team Member",security:[{bearerAuth:[]}],request:{params:pi,body:{content:{"application/json":{schema:wa.omit({id:!0})}}}},responses:{200:{description:"SDHC Team Member updated successfully",summary:"SDHC Team Member Updated"},400:{description:"Invalid input data or SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:P.object({errors:P.record(P.string(),P.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:P.object({message:P.string()})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:P.object({message:P.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:P.object({message:P.string()})}}}}},Up={method:"delete",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Delete SDHC Team Member",security:[{bearerAuth:[]}],request:{params:Ca},responses:{200:{description:"SDHC Team Member deleted successfully",summary:"SDHC Team Member Deleted"},400:{description:"Invalid SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:P.object({errors:P.record(P.string(),P.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:P.object({message:P.string()})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:P.object({message:P.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:P.object({message:P.string()})}}}}};import{$Enums as Op}from"@prisma/client";import D from"zod";import{extendZodWithOpenApi as ch}from"@asteasolutions/zod-to-openapi";import Sa from"zod";ch(Sa);var va=Sa.object({id:Sa.string()}),li=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{id:t}=va.parse({id:e.params.id}),i=await this.userRepository.findById(t);if(!i)throw new l("O usu\xE1rio n\xE3o existe.");let n=e.user.id;if(i.id!==n)throw new ie("Voc\xEA n\xE3o tem permiss\xE3o para deletar o usu\xE1rio");return await this.userRepository.deleteById(i.id),r.sendStatus(204)}catch(t){if(console.log(t),t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as ph}from"@asteasolutions/zod-to-openapi";import{z as ja}from"zod";ph(ja);var Ea=ja.object({id:ja.string().min(1,"id do usu\xE1rio n\xE3o fornecido.")}),ui=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{id:t}=Ea.parse(e.params),i=await this.userRepository.findById(t);if(!i)throw new l("Usu\xE1rio n\xE3o encontrado");r.status(200).json(i)}catch(t){if(console.log(t),t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as dh}from"@asteasolutions/zod-to-openapi";import et from"zod";var Bp=2,qp=1024,lh=qp*qp,uh=Bp*lh,gh=/^\d{4}-\d{4}-\d{4}-\d{4}$/,yh=/^\(?\d{2}\)?[\s-]?\d{4,5}-?\d{4}$/;dh(et);var xa=et.object({name:et.string().optional(),lattesUrl:et.string().optional(),orcid:et.string().optional().transform(o=>o===void 0?void 0:o.trim()).refine(o=>o===void 0||o===""||gh.test(o),{message:"ORCID inv\xE1lido. Deve estar no formato 0000-0000-0000-0000"}),phone:et.string().optional().refine(o=>o===void 0||o===""||yh.test(o),{message:"Telefone inv\xE1lido. Deve estar no formato (99) 99999-9999"}),avatarImage:et.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=uh,`A imagem deve ter no m\xE1ximo ${Bp}MB.`).optional()}),gi=class{constructor(e,r){this.userRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{avatarImage:t,...i}=xa.parse({...e.body,avatarImage:e.file}),n=e.user.id,a=await this.userRepository.findById(n);if(!a)throw new ee("O usu\xE1rio n\xE3o existe");let m=a.avatarUrl;return t&&(a.avatarUrl?m=await this.firebaseStorageService.updateFile({file:t,id:n,folder:F.USER,fileUrl:a.avatarUrl}):m=await this.firebaseStorageService.uploadFile({file:t,id:n,folder:F.USER})),await this.userRepository.update({...i,id:n,avatarUrl:m||void 0}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Np={method:"get",path:"/users/{id}",tags:["Users"],summary:"Find user by ID",request:{params:Ea},responses:{200:{description:"User details retrieved successfully",summary:"User Retrieved",content:{"application/json":{schema:D.object({id:D.string(),name:D.string(),createdAt:D.date(),updatedAt:D.date(),role:D.enum(Op.UserRole),lattesUrl:D.string().nullable(),orcid:D.string().nullable(),phone:D.string().nullable(),avatarUrl:D.url().nullable(),emailAddress:D.email()})}}},400:{description:"Invalid user ID format",summary:"Validation Error",content:{"application/json":{schema:D.object({errors:D.record(D.string(),D.string())})}}},404:{description:"User not found with the provided ID",summary:"User Not Found",content:{"application/json":{schema:D.object({message:D.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:D.object({message:D.string()})}}}}},kp={method:"put",path:"/users",tags:["Users"],summary:"Update authenticated user",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:xa}}}},responses:{200:{description:"User profile updated successfully",summary:"User Updated",content:{"application/json":{schema:D.object({message:D.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:D.object({errors:D.record(D.string(),D.string())})}}},401:{description:"User not authenticated or unauthorized",summary:"Authentication Required",content:{"application/json":{schema:D.object({message:D.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:D.object({message:D.string()})}}}}},Lp={method:"delete",path:"/users",tags:["Users"],summary:"Delete authenticated user",security:[{bearerAuth:[]}],request:{params:va},responses:{200:{description:"User account deleted successfully",summary:"User Deleted",content:{"application/json":{schema:D.object({message:D.string()})}}},400:{description:"Invalid request parameters",summary:"Validation Error",content:{"application/json":{schema:D.object({errors:D.record(D.string(),D.string())})}}},401:{description:"User not authenticated or unauthorized",summary:"Authentication Required",content:{"application/json":{schema:D.object({message:D.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:D.object({message:D.string()})}}}}},Gp={method:"get",path:"/users",tags:["Users"],summary:"List users",responses:{200:{description:"Complete list of users retrieved successfully",summary:"Users Retrieved",content:{"application/json":{schema:D.array(D.object({id:D.string(),name:D.string(),createdAt:D.date(),updatedAt:D.date(),role:D.enum(Op.UserRole),lattesUrl:D.url().nullable(),orcid:D.string().nullable(),phone:D.string().nullable(),avatarUrl:D.string().nullable(),emailAddress:D.email()}))}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:D.object({message:D.string()})}}}}};import I from"zod";import{extendZodWithOpenApi as fh}from"@asteasolutions/zod-to-openapi";import Ma from"zod";fh(Ma);var Pa=Ma.object({id:Ma.uuid()}),yi=class{constructor(e,r){this.webinarRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=Pa.parse({id:e.params.id}),i=await this.webinarRepository.findById(t);if(!i)throw new l("O webinar n\xE3o existe.");return i.thumbnailUrl&&this.firebaseStorageService.deleteFile({fileUrl:i.thumbnailUrl}),await this.webinarRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as hh}from"@asteasolutions/zod-to-openapi";import Ta from"zod";hh(Ta);var Aa=Ta.object({id:Ta.uuid()}),fi=class{constructor(e){this.webinarRepository=e}async handle(e,r){try{let{id:t}=Aa.parse({id:e.params.id}),i=await this.webinarRepository.findById(t);if(!i)throw new l("Webinar n\xE3o encontrado.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as Rh}from"@asteasolutions/zod-to-openapi";import tt from"zod";var Ih=1,Ch=6;Rh(tt);var Da=tt.object({page:tt.coerce.number().min(1).default(Ih),limit:tt.coerce.number().min(1).default(Ch),title:tt.string().optional(),description:tt.string().optional(),orderBy:tt.enum(["asc","desc"]).default("desc")}),hi=class{constructor(e){this.webinarRepository=e}async handle(e,r){try{let{limit:t,page:i,...n}=Da.parse(e.query),a=i*t-t,[m,c]=await Promise.all([this.webinarRepository.find({pagination:{offset:a,limit:t},filter:n}),this.webinarRepository.count({filter:n})]),u=Math.max(Math.ceil(c/t),1);return r.status(200).json({page:i,totalPages:u,offset:a,limit:t,webinars:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as bh}from"@asteasolutions/zod-to-openapi";import le from"zod";var Wp=5,_p=1024,wh=_p*_p,Sh=Wp*wh;bh(le);var Fa=le.object({id:le.uuid(),title:le.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio.").optional(),description:le.string().optional(),scheduledAt:le.coerce.date().optional(),webinarLink:le.url("URL do webinar deve ser v\xE1lida").optional(),guestIds:le.transform(o=>typeof o=="string"?o.split(","):o).pipe(le.array(le.uuid())).optional(),thumbnail:le.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Sh,`A thumbnail deve ter no m\xE1ximo ${Wp}MB.`).optional()}),Ri=class{constructor(e,r){this.webinarRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,thumbnail:i,title:n,description:a,scheduledAt:m,webinarLink:c,guestIds:u}=Fa.parse({id:e.params.id,...e.body,thumbnail:e.file}),T=await this.webinarRepository.findById(t);if(!T)throw new l("O webinar n\xE3o existe.");let k=T.thumbnailUrl;if(i&&(k=await this.firebaseStorageService.uploadFile({file:i,id:t,folder:F.WEBINAR})),!k)throw new s("Thumbnail URL \xE9 obrigat\xF3rio");return await this.webinarRepository.update({id:t,title:n,description:a,scheduledAt:m,webinarLink:c,thumbnailUrl:k,guestIds:u}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Hp={method:"post",path:"/webinars",tags:["Webinars"],summary:"Create webinar",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:I.object({title:I.string().min(1).openapi({description:"T\xEDtulo do webinar"}),description:I.string().optional().openapi({description:"Descri\xE7\xE3o do webinar"}),scheduledAt:I.string().openapi({description:"Data e hora agendada (ISO 8601)",example:"2024-01-01T10:00:00Z"}),webinarLink:I.string().url().optional().openapi({description:"Link do webinar"}),guestIds:I.string().openapi({description:"IDs dos convidados separados por v\xEDrgula",example:"uuid1,uuid2,uuid3"}),thumbnail:I.string().optional().openapi({description:"Imagem de thumbnail (m\xE1ximo 5MB)",type:"string",format:"binary"})})}}}},responses:{201:{description:"Webinar created successfully",summary:"Webinar Created"},400:{description:"Invalid input data",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},zp={method:"get",path:"/webinars",tags:["Webinars"],summary:"List webinars",security:[{bearerAuth:[]}],request:{query:Da},responses:{200:{description:"Paginated list of webinars with guest information retrieved successfully",summary:"Webinars Retrieved",content:{"application/json":{schema:I.object({page:I.number(),totalPages:I.number(),offset:I.number(),limit:I.number(),webinars:I.array(I.object({id:I.string(),title:I.string(),description:I.string().nullable(),scheduledAt:I.date(),webinarLink:I.string().nullable(),thumbnailUrl:I.string().nullable(),createdAt:I.date(),updatedAt:I.date(),guests:I.array(I.object({id:I.uuid(),name:I.string(),emailAddress:I.email(),avatarUrl:I.string().nullable(),createdAt:I.date(),updatedAt:I.date()}))}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},Zp={method:"get",path:"/webinars/{id}",tags:["Webinars"],summary:"Find webinar by ID",security:[{bearerAuth:[]}],request:{params:Aa},responses:{200:{description:"Webinar details retrieved successfully",summary:"Webinar Retrieved",content:{"application/json":{schema:I.object({id:I.string(),title:I.string(),description:I.string().nullable(),scheduledAt:I.date(),webinarLink:I.string().nullable(),thumbnailUrl:I.string().nullable(),createdAt:I.date(),updatedAt:I.date(),guests:I.array(I.object({id:I.uuid(),name:I.string(),emailAddress:I.email(),avatarUrl:I.string().nullable(),createdAt:I.date(),updatedAt:I.date()}))}).nullable()}}},400:{description:"Invalid webinar ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"Webinar not found with the provided ID",summary:"Webinar Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},Vp={method:"put",path:"/webinars/{id}",tags:["Webinars"],summary:"Update webinar",security:[{bearerAuth:[]}],request:{params:Fa.pick({id:!0}),body:{content:{"multipart/form-data":{schema:I.object({title:I.string().min(1).optional().openapi({description:"T\xEDtulo do webinar"}),description:I.string().optional().openapi({description:"Descri\xE7\xE3o do webinar"}),scheduledAt:I.string().optional().openapi({description:"Data e hora agendada (ISO 8601)",example:"2024-01-01T10:00:00Z"}),webinarLink:I.string().url().optional().openapi({description:"Link do webinar"}),guestIds:I.string().optional().openapi({description:"IDs dos convidados separados por v\xEDrgula",example:"uuid1,uuid2,uuid3"}),thumbnail:I.string().optional().openapi({description:"Imagem de thumbnail (m\xE1ximo 5MB)",type:"string",format:"binary"})})}}}},responses:{200:{description:"Webinar updated successfully",summary:"Webinar Updated"},400:{description:"Invalid input data",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"Webinar not found with the provided ID",summary:"Webinar Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},Kp={method:"delete",path:"/webinars/{id}",tags:["Webinars"],summary:"Delete webinar",security:[{bearerAuth:[]}],request:{params:Pa},responses:{200:{description:"Webinar deleted successfully",summary:"Webinar Deleted"},400:{description:"Invalid webinar ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"Webinar not found with the provided ID",summary:"Webinar Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}};var y=new vh;y.registerComponent("securitySchemes","bearerAuth",{type:"http",scheme:"bearer",bearerFormat:"JWT"});y.registerPath(rm);y.registerPath(om);y.registerPath(im);y.registerPath(nm);y.registerPath(am);y.registerPath(mm);y.registerPath(sm);y.registerPath(Np);y.registerPath(kp);y.registerPath(Lp);y.registerPath(Gp);y.registerPath(vc);y.registerPath(jc);y.registerPath(Ec);y.registerPath(xc);y.registerPath(cm);y.registerPath(pm);y.registerPath(dm);y.registerPath(lm);y.registerPath(um);y.registerPath(kc);y.registerPath(Lc);y.registerPath(Gc);y.registerPath(_c);y.registerPath(Wc);y.registerPath(vm);y.registerPath(jm);y.registerPath(Em);y.registerPath(xm);y.registerPath(Mm);y.registerPath(Sp);y.registerPath(vp);y.registerPath(jp);y.registerPath(Ep);y.registerPath(xp);y.registerPath(Mp);y.registerPath(ym);y.registerPath(fm);y.registerPath(hm);y.registerPath(Rm);y.registerPath(Im);y.registerPath(Fc);y.registerPath(Uc);y.registerPath(qc);y.registerPath(Bc);y.registerPath(Oc);y.registerPath(ic);y.registerPath(nc);y.registerPath(sc);y.registerPath(ac);y.registerPath(mc);y.registerPath(Tp);y.registerPath(Ap);y.registerPath(Dp);y.registerPath(Fp);y.registerPath(Up);y.registerPath(Jm);y.registerPath(Qm);y.registerPath(ec);y.registerPath(tc);y.registerPath(rc);y.registerPath(Yc);y.registerPath(Xc);y.registerPath($c);y.registerPath(Jc);y.registerPath(Qc);y.registerPath(ep);y.registerPath(hc);y.registerPath(Rc);y.registerPath(Ic);y.registerPath(Cc);y.registerPath(bc);y.registerPath(wc);y.registerPath(uc);y.registerPath(gc);y.registerPath(yc);y.registerPath(fc);y.registerPath(zm);y.registerPath(Zm);y.registerPath(Vm);y.registerPath(Km);y.registerPath(Ym);y.registerPath(Xm);y.registerPath(Gm);y.registerPath(_m);y.registerPath(Wm);y.registerPath(Hm);y.registerPath(Fm);y.registerPath(Um);y.registerPath(qm);y.registerPath(Bm);y.registerPath(hp);y.registerPath(Rp);y.registerPath(Ip);y.registerPath(Cp);y.registerPath(bp);y.registerPath(wp);y.registerPath(up);y.registerPath(gp);y.registerPath(yp);y.registerPath(fp);y.registerPath(np);y.registerPath(sp);y.registerPath(ap);y.registerPath(mp);y.registerPath(Hp);y.registerPath(zp);y.registerPath(Zp);y.registerPath(Vp);y.registerPath(Kp);var Eh=new jh(y.definitions),Yp=Eh.generateDocument({openapi:"3.0.0",info:{title:"API da Rede CT",version:"1.0.0",description:"API com valida\xE7\xE3o Zod"}});import{Router as Fh}from"express";import{extendZodWithOpenApi as xh}from"@asteasolutions/zod-to-openapi";import Ua from"zod";xh(Ua);var Mh=Ua.object({authenticatedUserId:Ua.uuid()}),Ii=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{authenticatedUserId:t}=Mh.parse({authenticatedUserId:e.user.id}),i=await this.userRepository.findById(t);if(!i)throw new l("Usu\xE1rio n\xE3o encontrado.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{PrismaClient as Ph}from"@prisma/client";var L=new Ph({log:["warn","error"]});var Ci=class{constructor(e){this.prisma=e}async register({userId:e,title:r,description:t,certificationUrl:i}){await this.prisma.certification.create({data:{title:r,description:t,certificationUrl:i,user:{connect:{id:e}}}})}async find({pagination:{offset:e,limit:r},filter:{description:t,orderBy:i,title:n,userId:a}}){let m={},c=[];return a&&(m.userId=a),n&&c.push({title:{contains:n,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.certification.findMany({where:m,include:{user:{omit:{passwordHash:!0}}},orderBy:{updatedAt:i},skip:e,take:r})}async findById(e){return await this.prisma.certification.findFirst({where:{id:e}})}async findByUserId({pagination:{limit:e,offset:r},filter:{description:t,orderBy:i,title:n},userId:a}){let m={userId:a},c=[];return n&&c.push({title:{contains:n,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.certification.findMany({where:m,include:{user:{omit:{passwordHash:!0}}},skip:r,take:e,orderBy:i?{updatedAt:i}:{updatedAt:"desc"}})}async update({id:e,...r}){await this.prisma.certification.update({where:{id:e},data:r})}async deleteById(e){await this.prisma.certification.delete({where:{id:e}})}async count({filter:{description:e,title:r,userId:t}}){let i={},n=[];return t&&(i.userId=t),r&&n.push({title:{contains:r,mode:"insensitive"}}),e&&n.push({description:{contains:e,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.certification.count({where:i})}};function _e(){return new Ci(L)}var bi=class{constructor(e){this.prisma=e}async create(e){await this.prisma.news.create({data:e})}async find({pagination:{offset:e,limit:r},filter:{authorId:t,content:i,title:n,orderBy:a}}){let m={};t&&(m.authorId={contains:t,mode:"insensitive"});let c=[];return n&&c.push({title:{contains:n,mode:"insensitive"}}),i&&c.push({content:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.news.findMany({where:m,omit:{authorId:!0},include:{author:!0},orderBy:{updatedAt:a},skip:e,take:r})}async findById(e){return await this.prisma.news.findUnique({where:{id:e},omit:{authorId:!0},include:{author:!0}})}async findByAuthorId({authorId:e,pagination:{offset:r,limit:t},filter:{orderBy:i="desc",content:n,title:a}}){let m={authorId:e},c=[];return a&&c.push({title:{contains:a,mode:"insensitive"}}),n&&c.push({content:{contains:n,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.news.findMany({omit:{authorId:!0},where:m,orderBy:{updatedAt:i},skip:r,take:t})}async update(e){await this.prisma.news.update({where:{id:e.id},data:{title:e.title,content:e.content,imageUrl:e.imageUrl}})}async delete(e){await this.prisma.news.delete({where:{id:e}})}async count({filter:{authorId:e,content:r,title:t}}){let i={};e&&(i.authorId={contains:e,mode:"insensitive"});let n=[];return t&&n.push({title:{contains:t,mode:"insensitive"}}),r&&n.push({content:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.news.count({where:i})}};function ve(){return new bi(L)}var wi=class{constructor(e){this.prisma=e}async create(e){await this.prisma.pendency.create({data:e})}async find({filter:{description:e,orderBy:r,title:t,status:i,userId:n},pagination:{limit:a,offset:m}}){let c={userId:n,AND:{status:{equals:i}}};e&&(c.description={contains:e,mode:"insensitive"});let u=[];return t&&u.push({title:{contains:t,mode:"insensitive"}}),u.length>0&&(c.OR=u),await this.prisma.pendency.findMany({where:c,orderBy:{updatedAt:r},include:{user:{omit:{passwordHash:!0}}},skip:m,take:a})}async findById(e){return await this.prisma.pendency.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async findByUserId({filter:{description:e,orderBy:r,title:t,status:i},pagination:{limit:n,offset:a},userId:m}){let c={userId:m,AND:{status:{equals:i}}},u=[];return e&&u.push({description:{contains:e,mode:"insensitive"}}),t&&u.push({title:{contains:t,mode:"insensitive"}}),u.length>0&&(c.OR=u),await this.prisma.pendency.findMany({where:c,orderBy:{updatedAt:r},include:{user:{omit:{passwordHash:!0}}},skip:a,take:n})}async update({id:e,...r}){await this.prisma.pendency.update({where:{id:e},data:r})}async deleteById(e){await this.prisma.pendency.delete({where:{id:e}})}async count({filter:{description:e,title:r,status:t,userId:i}}){let n={userId:i},a=[];return e&&a.push({description:{contains:e,mode:"insensitive"}}),r&&a.push({title:{contains:r,mode:"insensitive"}}),t&&a.push({status:{equals:t}}),a.length>0&&(n.OR=a),await this.prisma.pendency.count({where:n})}};function We(){return new wi(L)}var Si=class{constructor(e){this.prisma=e}async create(e){await this.prisma.user.create({data:e})}async update(e){await this.prisma.user.update({where:{id:e.id},data:{lattesUrl:e.lattesUrl??null,orcid:e.orcid??null,phone:e.phone??null,avatarUrl:e.avatarUrl??null}})}async deleteById(e){await this.prisma.user.delete({where:{id:e}})}async find(){return await this.prisma.user.findMany({omit:{passwordHash:!0}})}async findByEmail(e){return await this.prisma.user.findFirst({where:{emailAddress:e}})}async findById(e){return await this.prisma.user.findFirst({where:{id:e},omit:{passwordHash:!0}})}};function re(){return new Si(L)}import{compare as Th,hash as Ah}from"bcryptjs";var vi=class{constructor(e,r){this.hashFn=e;this.compareFn=r}async hash(e){return await this.hashFn(e,6)}async compare({password:e,hashedPassword:r}){return await this.compareFn(e,r)}};function qa(){return new vi(Ah,Th)}import Xp from"jsonwebtoken";import oe from"zod";var Dh=oe.object({JWT_SECRET:oe.string(),FIREBASE_BUCKET:oe.string(),FIREBASE_CLIENT_EMAIL:oe.string(),FIREBASE_PRIVATE_KEY:oe.string(),FIREBASE_PROJECT_ID:oe.string(),FIREBASE_TYPE:oe.string(),FIREBASE_PRIVATE_KEY_ID:oe.string(),FIREBASE_CLIENT_ID:oe.string(),FIREBASE_AUTH_URI:oe.string(),FIREBASE_TOKEN_URI:oe.string(),FIREBASE_AUTH_PROVIDER_X509_CERT_URL:oe.string(),FIREBASE_CLIENT_X509_CERT_URL:oe.string()}),J=Dh.parse(process.env);var ji=class{constructor(e,r){this.signFn=e;this.verifyFn=r}sign(e){try{return this.signFn(e,J.JWT_SECRET,{expiresIn:"3d",subject:e.id})}catch{return null}}verify(e){try{return this.verifyFn(e,J.JWT_SECRET)}catch{return null}}};function Ei(){return new ji(Xp.sign,Xp.verify)}function $p(){return{signUpController:new ar(re(),qa())}}function Jp(){return{signInController:new nr(re(),qa(),Ei())}}function Qp(){return{findAuthenticatedUserController:new Ii(re())}}function ed(){return{findAuthenticatedUserController:new rr(ve())}}function td(){return{findAuthenticatedUserCertificationsController:new tr(_e())}}function rd(){return{findAuthenticatedUserPendenciesController:new or(We())}}var xi=class{constructor(e){this.jwtService=e}authenticated(e,r,t){let i=e.headers.authorization;if(!i?.startsWith("Bearer "))return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});let n=i.split(" ")[1];if(!n)return r.status(401).json({message:"Token n\xE3o fornecido."});try{let a=this.jwtService.verify(n);if(!a)return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});e.user=a,t()}catch(a){if(console.log(a),a instanceof Error)return r.status(401).json({message:a.message})}}isAdmin(e,r,t){let i=e.headers.authorization;if(!i?.startsWith("Bearer "))return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});let n=i.split(" ")[1];if(!n)return r.status(401).json({message:"Token n\xE3o fornecido."});try{let a=this.jwtService.verify(n);if(!a)return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});if(a.role!=="ADMIN")return r.status(401).json({message:"\xC9 necess\xE1rio ter permiss\xF5es de administrador."});e.user=a,t()}catch(a){if(console.log(a),a instanceof Error)return r.status(401).json({message:a.message})}}};function _(){return{authMiddleware:new xi(Ei())}}var je=Fh(),{authMiddleware:Vt}=_();je.post("/sign-up",async(o,e)=>{let{signUpController:r}=$p();await r.handle(o,e)});je.post("/sign-in",async(o,e)=>{let{signInController:r}=Jp();await r.handle(o,e)});je.get("/user",(o,e,r)=>{Vt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserController:r}=Qp();await r.handle(o,e)});je.get("/user/news",(o,e,r)=>{Vt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserController:r}=ed();await r.handle(o,e)});je.get("/admin",(o,e,r)=>{Vt.isAdmin(o,e,r)},(o,e)=>{try{e.status(200).json({success:!0})}catch(r){r instanceof Error&&e.status(500).json({message:r.message})}});je.get("/certifications",(o,e,r)=>{Vt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserCertificationsController:r}=td();await r.handle(o,e)});je.get("/pendencies",(o,e,r)=>{Vt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserPendenciesController:r}=rd();await r.handle(o,e)});import{Router as kh}from"express";import{getStorage as qh}from"firebase-admin/storage";import{config as Uh}from"dotenv";import od from"firebase-admin";Uh();var Ba=od.initializeApp({credential:od.credential.cert({clientEmail:J.FIREBASE_CLIENT_EMAIL,privateKey:J.FIREBASE_PRIVATE_KEY,projectId:J.FIREBASE_PROJECT_ID,type:J.FIREBASE_TYPE,privateKeyId:J.FIREBASE_PRIVATE_KEY_ID,clientId:J.FIREBASE_CLIENT_ID,authUri:J.FIREBASE_AUTH_URI,tokenUri:J.FIREBASE_TOKEN_URI,authProviderX509CertUrl:J.FIREBASE_AUTH_PROVIDER_X509_CERT_URL,clientX509CertUrl:J.FIREBASE_CLIENT_X509_CERT_URL}),storageBucket:J.FIREBASE_BUCKET});Ba.name?console.log("\u{1F525} Firebase conectado com sucesso!"):console.error("\u274C Erro ao se conectar ao Firebase.");var Bh=qh(Ba),id=Bh.bucket(J.FIREBASE_BUCKET);import{randomUUID as Oh}from"node:crypto";var Nh=/https:\/\/storage\.googleapis\.com\/[^/]+\/(.+)$/,Mi=class{constructor(e){this.bucket=e}async uploadFile({file:e,folder:r,id:t}){let i=`${Oh()}-${e?.originalname}`,n=this.bucket.file(`${r}/${t}/${i}`);return await new Promise((a,m)=>{let c=n.createWriteStream({metadata:{contentType:e?.mimetype}});c.on("error",u=>{m(u)}),c.on("finish",async()=>{try{await n.makePublic();let u=`https://storage.googleapis.com/${this.bucket.name}/${n.name}`;a(u)}catch(u){m(u)}}),c.end(e.buffer)})}async updateFile({file:e,id:r,fileUrl:t,folder:i}){try{let n=this.getPath(t);if(!n)throw new Error("Arquivo n\xE3o encontrado.");let[a,m]=await Promise.all([this.bucket.file(n).delete(),this.uploadFile({file:e,id:r,folder:i})]);return m}catch{throw new Error("Erro ao atualizar o arquivo.")}}async deleteFile({fileUrl:e}){let r=this.getPath(e);if(!r)throw new Error("Arquivo n\xE3o encontrado.");try{await this.bucket.file(r).delete()}catch{throw new Error("Erro ao deletar o arquivo.")}}getPath(e){let r=e.match(Nh);return r?r[1]:null}};function U(){return new Mi(id)}function nd(){return{registerCertificationController:new dr(re(),_e(),U())}}function sd(){return{findCertificationsController:new pr(_e())}}function ad(){return{findCertificationByIdController:new cr(_e())}}function md(){return{updateCertificationController:new ur(_e(),U())}}function cd(){return{deleteCertificationController:new mr(_e(),U())}}import pd from"multer";var G=pd({storage:pd.memoryStorage()});var rt=kh(),{authMiddleware:Kt}=_();rt.post("/:user_id",(o,e,r)=>{Kt.isAdmin(o,e,r)},G.single("certification"),async(o,e)=>{let{registerCertificationController:r}=nd();await r.handle(o,e)});rt.get("/",(o,e,r)=>{Kt.isAdmin(o,e,r)},async(o,e)=>{let{findCertificationsController:r}=sd();await r.handle(o,e)});rt.get("/:certification_id",(o,e,r)=>{Kt.isAdmin(o,e,r)},async(o,e)=>{let{findCertificationByIdController:r}=ad();await r.handle(o,e)});rt.put("/:certification_id",(o,e,r)=>{Kt.isAdmin(o,e,r)},G.single("certification"),async(o,e)=>{let{updateCertificationController:r}=md();await r.handle(o,e)});rt.delete("/:certification_id",(o,e,r)=>{Kt.isAdmin(o,e,r)},async(o,e)=>{let{deleteCertificationController:r}=cd();await r.handle(o,e)});import{Router as Hh}from"express";import{extendZodWithOpenApi as Lh}from"@asteasolutions/zod-to-openapi";import Ee from"zod";var Gh=1,_h=9;Lh(Ee);var Wh=Ee.object({page:Ee.coerce.number().min(1).default(Gh),limit:Ee.coerce.number().min(1).default(_h),code:Ee.string().optional(),title:Ee.string().optional(),description:Ee.string().optional(),notes:Ee.string().optional(),orderBy:Ee.enum(["asc","desc"]).default("desc")}),Pi=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Wh.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.etpRepository.find({pagination:{offset:a,limit:i},filter:n}),this.etpRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:a,limit:i,etps:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Ti=class{constructor(e){this.prisma=e}async create(e){let{leaderId:r,deputyLeaderId:t,secretaryId:i,memberIds:n,...a}=e;await this.prisma.$transaction(async m=>{let c=await m.eTP.create({data:a});await m.eTPLeader.create({data:{etpId:c.id,researcherId:r}}),await m.eTPDeputy.create({data:{etpId:c.id,researcherId:t}}),await m.eTPSecretary.create({data:{etpId:c.id,researcherId:i}}),await m.eTP.update({where:{id:c.id},data:{members:{connect:n.map(u=>({id:u}))}}})})}async update(e){let{leaderId:r,deputyLeaderId:t,secretaryId:i,memberIds:n,...a}=e;await this.prisma.$transaction(async m=>{await m.eTP.update({where:{id:e.id},data:a}),await this.updateLeader(m,e.id,r),await this.updateDeputyLeader(m,e.id,t),await this.updateSecretary(m,e.id,i),await this.updateMembers(m,e.id,n)})}async updateLeader(e,r,t){t!==void 0&&(await e.eTPLeader.deleteMany({where:{etpId:r}}),t&&await e.eTPLeader.create({data:{etpId:r,researcherId:t}}))}async updateDeputyLeader(e,r,t){t!==void 0&&(await e.eTPDeputy.deleteMany({where:{etpId:r}}),t&&await e.eTPDeputy.create({data:{etpId:r,researcherId:t}}))}async updateSecretary(e,r,t){t!==void 0&&(await e.eTPSecretary.deleteMany({where:{etpId:r}}),t&&await e.eTPSecretary.create({data:{etpId:r,researcherId:t}}))}async updateMembers(e,r,t){t!==void 0&&await e.eTP.update({where:{id:r},data:{members:{set:t.map(i=>({id:i}))}}})}async deleteById(e){await this.prisma.eTP.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{code:t,title:i,description:n,notes:a,orderBy:m}}){let c={},u=[];return t&&u.push({code:{contains:t,mode:"insensitive"}}),i&&u.push({title:{contains:i,mode:"insensitive"}}),n&&u.push({description:{contains:n,mode:"insensitive"}}),a&&u.push({notes:{contains:a,mode:"insensitive"}}),u.length>0&&(c.OR=u),await this.prisma.eTP.findMany({where:c,include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}},orderBy:{updatedAt:m},skip:e,take:r})}async findById(e){return await this.prisma.eTP.findFirst({where:{id:e},include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}}})}async findByCode(e){return await this.prisma.eTP.findFirst({where:{code:e},include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}}})}async count({filter:{code:e,title:r,description:t,notes:i}}){let n={},a=[];return e&&a.push({code:{contains:e,mode:"insensitive"}}),r&&a.push({title:{contains:r,mode:"insensitive"}}),t&&a.push({description:{contains:t,mode:"insensitive"}}),i&&a.push({notes:{contains:i,mode:"insensitive"}}),a.length>0&&(n.OR=a),await this.prisma.eTP.count({where:n})}};function vt(){return new Ti(L)}function dd(){return{createETPController:new yr(vt())}}function ld(){return{findETPsController:new Pi(vt())}}function ud(){return{findETPByIdController:new hr(vt())}}function gd(){return{updateETPController:new Ir(vt())}}function yd(){return{deleteETPController:new fr(vt())}}var ot=Hh(),{authMiddleware:Oa}=_();ot.post("/",(o,e,r)=>{Oa.authenticated(o,e,r)},async(o,e)=>{let{createETPController:r}=dd();await r.handle(o,e)});ot.get("/",async(o,e)=>{let{findETPsController:r}=ld();await r.handle(o,e)});ot.get("/:id",async(o,e)=>{let{findETPByIdController:r}=ud();await r.handle(o,e)});ot.put("/:id",(o,e,r)=>{Oa.authenticated(o,e,r)},async(o,e)=>{let{updateETPController:r}=gd();await r.handle(o,e)});ot.delete("/:id",(o,e,r)=>{Oa.authenticated(o,e,r)},async(o,e)=>{let{deleteETPController:r}=yd();await r.handle(o,e)});import{Router as zh}from"express";var Ai=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.inMemoriam.create({data:e})}async update(e){await this.prisma.inMemoriam.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.inMemoriam.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{name:t,biography:i,role:n,orderBy:a}}){let m={},c=[];return n&&(m.role=n),t&&c.push({name:{contains:t,mode:"insensitive"}}),i&&c.push({biography:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.inMemoriam.findMany({where:m,orderBy:{updatedAt:a},skip:e,take:r})}async findById(e){return await this.prisma.inMemoriam.findFirst({where:{id:e}})}async findByRole(e){return await this.prisma.inMemoriam.findMany({where:{role:e}})}async count({filter:{name:e,biography:r,role:t}}){let i={},n=[];return t&&(i.role=t),e&&n.push({name:{contains:e,mode:"insensitive"}}),r&&n.push({biography:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.inMemoriam.count({where:i})}};function it(){return new Ai(L)}function fd(){return{createInMemoriamController:new br(it(),U())}}function hd(){return{findInMemoriamsController:new Er(it())}}function Rd(){return{findInMemoriamByIdController:new Sr(it())}}function Id(){return{findInMemoriamByRoleController:new jr(it())}}function Cd(){return{updateInMemoriamController:new xr(it(),U())}}function bd(){return{deleteInMemoriamController:new wr(it(),U())}}var He=zh(),{authMiddleware:Na}=_();He.post("/",(o,e,r)=>{Na.authenticated(o,e,r)},G.single("photo"),async(o,e)=>{let{createInMemoriamController:r}=fd();await r.handle(o,e)});He.get("/",async(o,e)=>{let{findInMemoriamsController:r}=hd();await r.handle(o,e)});He.get("/:id",async(o,e)=>{let{findInMemoriamByIdController:r}=Rd();await r.handle(o,e)});He.get("/role/:role",async(o,e)=>{let{findInMemoriamByRoleController:r}=Id();await r.handle(o,e)});He.put("/:id",(o,e,r)=>{Na.authenticated(o,e,r)},G.single("photo"),async(o,e)=>{let{updateInMemoriamController:r}=Cd();await r.handle(o,e)});He.delete("/:id",(o,e,r)=>{Na.authenticated(o,e,r)},async(o,e)=>{let{deleteInMemoriamController:r}=bd();await r.handle(o,e)});import{Router as Zh}from"express";var ka=Zh();ka.get("/",(o,e)=>{e.status(200).json({message:"Rede CT"})});import{Router as $h}from"express";var Di=class{constructor(e){this.prisma=e}async create(e){await this.prisma.internationalScientificCongress.create({data:e})}async update(e){await this.prisma.internationalScientificCongress.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.internationalScientificCongress.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,edition:i,location:n,orderBy:a}}){let m={},c=[];return i&&c.push({edition:{equals:i}}),t&&c.push({title:{contains:t,mode:"insensitive"}}),n&&c.push({location:{contains:n,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.internationalScientificCongress.findMany({where:m,include:{partners:!0,galleries:!0},orderBy:a?{startDate:a}:{startDate:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.internationalScientificCongress.findFirst({where:{id:e},include:{partners:!0,galleries:!0}})}async findByEdition(e){return await this.prisma.internationalScientificCongress.findMany({where:{edition:e},include:{partners:!0,galleries:!0}})}async count({filter:{title:e,edition:r,location:t}}){let i={},n=[];return r&&n.push({edition:{equals:r}}),e&&n.push({title:{contains:e,mode:"insensitive"}}),t&&n.push({location:{contains:t,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.internationalScientificCongress.count({where:i})}};function ue(){return new Di(L)}function wd(){return{createInternationalScientificCongressController:new Nr(ue())}}function Sd(){return{findInternationalScientificCongressesController:new Wr(ue())}}function vd(){return{findInternationalScientificCongressByIdController:new Gr(ue())}}function jd(){return{findInternationalScientificCongressByEditionController:new Lr(ue())}}function Ed(){return{updateInternationalScientificCongressController:new Hr(ue())}}function xd(){return{deleteInternationalScientificCongressController:new kr(ue())}}import{extendZodWithOpenApi as Vh}from"@asteasolutions/zod-to-openapi";import La from"zod";Vh(La);var Kh=La.object({id:La.uuid()}),Fi=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=Kh.parse({id:e.params.id}),i=await this.internationalScientificCongressGalleryRepository.findById(t);if(!i)throw new l("A imagem da galeria n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Ui=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.internationalScientificCongressGalleryItem.create({data:e})}async update(e){await this.prisma.internationalScientificCongressGalleryItem.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.internationalScientificCongressGalleryItem.delete({where:{id:e}})}async findByCongressId(e){let{pagination:r,filter:t}=e;return await this.prisma.internationalScientificCongressGalleryItem.findMany({where:{congressId:t.congressId,...t.caption&&{caption:{contains:t.caption,mode:"insensitive"}}},skip:r.offset,take:r.limit})}async findById(e){return await this.prisma.internationalScientificCongressGalleryItem.findFirst({where:{id:e}})}async count(e){let{filter:r}=e;return await this.prisma.internationalScientificCongressGalleryItem.count({where:{congressId:r.congressId,...r.caption&&{caption:{contains:r.caption,mode:"insensitive"}}}})}};function jt(){return new Ui(L)}function Md(){return{createInternationalScientificCongressGalleryController:new Mr(jt(),ue(),U())}}function Pd(){return{findInternationalScientificCongressGalleriesByCongressIdController:new Ar(jt())}}function Td(){return{findInternationalScientificCongressGalleryByIdController:new Fi(jt())}}function Ad(){return{updateInternationalScientificCongressGalleryController:new Dr(jt(),U())}}function Dd(){return{deleteInternationalScientificCongressGalleryController:new Pr(jt())}}import{extendZodWithOpenApi as Yh}from"@asteasolutions/zod-to-openapi";import Ga from"zod";Yh(Ga);var Xh=Ga.object({id:Ga.uuid()}),qi=class{constructor(e){this.internationalScientificCongressPartnerRepository=e}async handle(e,r){try{let{id:t}=Xh.parse({id:e.params.id}),i=await this.internationalScientificCongressPartnerRepository.findById(t);if(!i)throw new l("O parceiro n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Bi=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.internationalScientificCongressPartner.create({data:e})}async update(e){await this.prisma.internationalScientificCongressPartner.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.internationalScientificCongressPartner.delete({where:{id:e}})}async findByCongressId(e){return await this.prisma.internationalScientificCongressPartner.findMany({where:{congressId:e.filter.congressId,name:e.filter.name?{contains:e.filter.name,mode:"insensitive"}:void 0},skip:e.pagination?.offset,take:e.pagination?.limit})}async findById(e){return await this.prisma.internationalScientificCongressPartner.findFirst({where:{id:e}})}async count(e){return await this.prisma.internationalScientificCongressPartner.count({where:{congressId:e.filter.congressId,name:e.filter.name?{contains:e.filter.name,mode:"insensitive"}:void 0}})}};function Et(){return new Bi(L)}function Fd(){return{createInternationalScientificCongressPartnerController:new Fr(Et(),ue(),U())}}function Ud(){return{findInternationalScientificCongressPartnersByCongressIdController:new Br(Et())}}function qd(){return{findInternationalScientificCongressPartnerByIdController:new qi(Et())}}function Bd(){return{updateInternationalScientificCongressPartnerController:new Or(Et(),U())}}function Od(){return{deleteInternationalScientificCongressPartnerController:new Ur(Et())}}var X=$h(),{authMiddleware:xe}=_();X.post("/",(o,e,r)=>{xe.authenticated(o,e,r)},async(o,e)=>{let{createInternationalScientificCongressController:r}=wd();await r.handle(o,e)});X.get("/",async(o,e)=>{let{findInternationalScientificCongressesController:r}=Sd();await r.handle(o,e)});X.get("/:id",async(o,e)=>{let{findInternationalScientificCongressByIdController:r}=vd();await r.handle(o,e)});X.get("/edition/:edition",async(o,e)=>{let{findInternationalScientificCongressByEditionController:r}=jd();await r.handle(o,e)});X.put("/:id",(o,e,r)=>{xe.authenticated(o,e,r)},async(o,e)=>{let{updateInternationalScientificCongressController:r}=Ed();await r.handle(o,e)});X.delete("/:id",(o,e,r)=>{xe.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressController:r}=xd();await r.handle(o,e)});X.post("/:congressId/gallery",(o,e,r)=>{xe.authenticated(o,e,r)},G.single("image"),async(o,e)=>{let{createInternationalScientificCongressGalleryController:r}=Md();await r.handle(o,e)});X.get("/:congressId/gallery",async(o,e)=>{let{findInternationalScientificCongressGalleriesByCongressIdController:r}=Pd();await r.handle(o,e)});X.get("/gallery/:id",async(o,e)=>{let{findInternationalScientificCongressGalleryByIdController:r}=Td();await r.handle(o,e)});X.put("/gallery/:id",(o,e,r)=>{xe.authenticated(o,e,r)},G.single("image"),async(o,e)=>{let{updateInternationalScientificCongressGalleryController:r}=Ad();await r.handle(o,e)});X.delete("/gallery/:id",(o,e,r)=>{xe.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressGalleryController:r}=Dd();await r.handle(o,e)});X.post("/:congressId/partner",(o,e,r)=>{xe.authenticated(o,e,r)},G.single("logo"),async(o,e)=>{let{createInternationalScientificCongressPartnerController:r}=Fd();await r.handle(o,e)});X.get("/:congressId/partner",async(o,e)=>{let{findInternationalScientificCongressPartnersByCongressIdController:r}=Ud();await r.handle(o,e)});X.get("/partner/:id",async(o,e)=>{let{findInternationalScientificCongressPartnerByIdController:r}=qd();await r.handle(o,e)});X.put("/partner/:id",(o,e,r)=>{xe.authenticated(o,e,r)},G.single("logo"),async(o,e)=>{let{updateInternationalScientificCongressPartnerController:r}=Bd();await r.handle(o,e)});X.delete("/partner/:id",(o,e,r)=>{xe.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressPartnerController:r}=Od();await r.handle(o,e)});import{Router as eR}from"express";import{extendZodWithOpenApi as Jh}from"@asteasolutions/zod-to-openapi";import Oi from"zod";Jh(Oi);var Qh=Oi.object({role:Oi.string().optional(),orderBy:Oi.enum(["asc","desc"]).optional()}),Ni=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let t=Qh.parse(e.query),i=await this.legitimatorCommitteeMemberRepository.find({filter:t});r.status(200).json({members:i})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var ki=class{constructor(e){this.prisma=e}async create(e){await this.prisma.legitimatorCommitteeMember.create({data:{...e,order:e.order??0}})}async update(e){let{id:r,...t}=e;await this.prisma.legitimatorCommitteeMember.update({where:{id:r},data:t})}async deleteById(e){await this.prisma.legitimatorCommitteeMember.delete({where:{id:e}})}async find({filter:{role:e,orderBy:r}}){let t={};return e&&(t.role={contains:e,mode:"insensitive"}),await this.prisma.legitimatorCommitteeMember.findMany({where:t,include:{user:{omit:{passwordHash:!0}}},orderBy:r?[{order:"asc"},{updatedAt:r}]:[{order:"asc"},{updatedAt:"desc"}]})}async findById(e){return await this.prisma.legitimatorCommitteeMember.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{role:e}}){let r={};return e&&(r.role={contains:e,mode:"insensitive"}),await this.prisma.legitimatorCommitteeMember.count({where:r})}};function xt(){return new ki(L)}function Nd(){return{createLegitimatorCommitteeMemberController:new zr(xt())}}function kd(){return{findLegitimatorCommitteeMembersController:new Ni(xt())}}function Ld(){return{findLegitimatorCommitteeMemberByIdController:new Vr(xt())}}function Gd(){return{updateLegitimatorCommitteeMemberController:new Yr(xt())}}function _d(){return{deleteLegitimatorCommitteeMemberController:new Zr(xt())}}var nt=eR(),{authMiddleware:_a}=_();nt.post("/",(o,e,r)=>{_a.authenticated(o,e,r)},async(o,e)=>{let{createLegitimatorCommitteeMemberController:r}=Nd();await r.handle(o,e)});nt.get("/",async(o,e)=>{let{findLegitimatorCommitteeMembersController:r}=kd();await r.handle(o,e)});nt.get("/:id",async(o,e)=>{let{findLegitimatorCommitteeMemberByIdController:r}=Ld();await r.handle(o,e)});nt.put("/:id",(o,e,r)=>{_a.authenticated(o,e,r)},async(o,e)=>{let{updateLegitimatorCommitteeMemberController:r}=Gd();await r.handle(o,e)});nt.delete("/:id",(o,e,r)=>{_a.authenticated(o,e,r)},async(o,e)=>{let{deleteLegitimatorCommitteeMemberController:r}=_d();await r.handle(o,e)});import{Router as oR}from"express";import{extendZodWithOpenApi as tR}from"@asteasolutions/zod-to-openapi";import Yt from"zod";tR(Yt);var rR=Yt.object({name:Yt.string().optional(),description:Yt.string().optional(),orderBy:Yt.enum(["asc","desc"]).default("desc")}),Li=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let t=rR.parse(e.query),i=await this.managementTeamRepository.find({filter:t});r.status(200).json({teams:i})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Gi=class{constructor(e){this.prisma=e}async create(e){let{members:r,...t}=e;await this.prisma.$transaction(async i=>{let n=await i.managementTeam.create({data:t});return await i.managementTeamMember.createMany({data:r.map(({userId:a,role:m,order:c})=>({teamId:n.id,userId:a,role:m,order:c??0}))}),n})}async update(e){let{members:r,...t}=e;await this.prisma.$transaction(async i=>{let n=await i.managementTeam.update({where:{id:e.id},data:t});return r!==void 0&&(await i.managementTeamMember.deleteMany({where:{teamId:e.id}}),r.length>0&&await i.managementTeamMember.createMany({data:r.map(({userId:a,role:m,order:c})=>({teamId:e.id,userId:a,role:m,order:c??0}))})),n})}async deleteById(e){await this.prisma.managementTeam.delete({where:{id:e}})}async find({filter:{name:e,description:r,orderBy:t}}){let i={},n=[];return e&&n.push({name:{contains:e,mode:"insensitive"}}),r&&n.push({description:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.managementTeam.findMany({where:i,include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}},orderBy:{updatedAt:t}})}async findById(e){return await this.prisma.managementTeam.findFirst({where:{id:e},include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}}})}async findByName(e){return await this.prisma.managementTeam.findFirst({where:{name:e},include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}}})}async count({filter:{name:e,description:r}}){let t={},i=[];return e&&i.push({name:{contains:e,mode:"insensitive"}}),r&&i.push({description:{contains:r,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.managementTeam.count({where:t})}};function Mt(){return new Gi(L)}function Wd(){return{createManagementTeamController:new Xr(Mt())}}function Hd(){return{findManagementTeamsController:new Li(Mt())}}function zd(){return{findManagementTeamByIdController:new Jr(Mt())}}function Zd(){return{updateManagementTeamController:new eo(Mt())}}function Vd(){return{deleteManagementTeamController:new $r(Mt())}}var st=oR(),{authMiddleware:Wa}=_();st.post("/",(o,e,r)=>{Wa.authenticated(o,e,r)},async(o,e)=>{let{createManagementTeamController:r}=Wd();await r.handle(o,e)});st.get("/",async(o,e)=>{let{findManagementTeamsController:r}=Hd();await r.handle(o,e)});st.get("/:id",async(o,e)=>{let{findManagementTeamByIdController:r}=zd();await r.handle(o,e)});st.put("/:id",(o,e,r)=>{Wa.authenticated(o,e,r)},async(o,e)=>{let{updateManagementTeamController:r}=Zd();await r.handle(o,e)});st.delete("/:id",(o,e,r)=>{Wa.authenticated(o,e,r)},async(o,e)=>{let{deleteManagementTeamController:r}=Vd();await r.handle(o,e)});import{Router as sR}from"express";var _i=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.meeting.create({data:e})}async update(e){await this.prisma.meeting.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.meeting.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,format:i,status:n,orderBy:a}}){let m={},c=[];return i&&(m.format=i),n&&(m.status=n),t&&c.push({title:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.meeting.findMany({where:m,include:{minutes:!0},orderBy:a?{scheduledAt:a}:{scheduledAt:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.meeting.findFirst({where:{id:e},include:{minutes:!0}})}async findByStatus(e){return await this.prisma.meeting.findMany({where:{status:e},include:{minutes:!0}})}async count({filter:{title:e,format:r,status:t}}){let i={},n=[];return r&&(i.format=r),t&&(i.status=t),e&&n.push({title:{contains:e,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.meeting.count({where:i})}};function Me(){return new _i(L)}function Kd(){return{createMeetingController:new no(Me())}}function Yd(){return{findMeetingsController:new po(Me())}}function Xd(){return{findMeetingByIdController:new ao(Me())}}function $d(){return{findMeetingByStatusController:new co(Me())}}function Jd(){return{updateMeetingController:new lo(Me())}}function Qd(){return{deleteMeetingController:new so(Me())}}import{extendZodWithOpenApi as iR}from"@asteasolutions/zod-to-openapi";import Ha from"zod";iR(Ha);var nR=Ha.object({meetingId:Ha.uuid()}),Wi=class{constructor(e,r){this.meetingMinuteRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{meetingId:t}=nR.parse({meetingId:e.params.meetingId}),i=await this.meetingMinuteRepository.findByMeetingId(t);if(!i)throw new l("A ata n\xE3o existe para esta reuni\xE3o.");return i.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl}),await this.meetingMinuteRepository.deleteByMeetingId(i.id),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Hi=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.meetingMinute.create({data:e,include:{meeting:!0}})}async update(e){await this.prisma.meetingMinute.update({where:{id:e.id},data:e})}async deleteByMeetingId(e){await this.prisma.meetingMinute.delete({where:{id:e}})}async findByMeetingId(e){return await this.prisma.meetingMinute.findFirst({where:{meetingId:e},include:{meeting:!0}})}};function Xt(){return new Hi(L)}function el(){return{createMeetingMinuteController:new to(Xt(),Me(),U())}}function tl(){return{findMeetingMinuteByMeetingIdController:new ro(Xt())}}function rl(){return{updateMeetingMinuteByMeetingIdController:new oo(Xt(),U())}}function ol(){return{deleteMeetingMinuteByMeetingIdController:new Wi(Xt(),U())}}var me=sR(),{authMiddleware:Pt}=_();me.post("/",(o,e,r)=>{Pt.authenticated(o,e,r)},async(o,e)=>{let{createMeetingController:r}=Kd();await r.handle(o,e)});me.get("/",async(o,e)=>{let{findMeetingsController:r}=Yd();await r.handle(o,e)});me.get("/:id",async(o,e)=>{let{findMeetingByIdController:r}=Xd();await r.handle(o,e)});me.get("/status/:status",async(o,e)=>{let{findMeetingByStatusController:r}=$d();await r.handle(o,e)});me.put("/:id",(o,e,r)=>{Pt.authenticated(o,e,r)},async(o,e)=>{let{updateMeetingController:r}=Jd();await r.handle(o,e)});me.delete("/:id",(o,e,r)=>{Pt.authenticated(o,e,r)},async(o,e)=>{let{deleteMeetingController:r}=Qd();await r.handle(o,e)});me.post("/:meetingId/minute",(o,e,r)=>{Pt.authenticated(o,e,r)},G.single("document"),async(o,e)=>{let{createMeetingMinuteController:r}=el();await r.handle(o,e)});me.get("/:meetingId/minute",async(o,e)=>{let{findMeetingMinuteByMeetingIdController:r}=tl();await r.handle(o,e)});me.put("/:meetingId/minute",(o,e,r)=>{Pt.authenticated(o,e,r)},G.single("document"),async(o,e)=>{let{updateMeetingMinuteByMeetingIdController:r}=rl();await r.handle(o,e)});me.delete("/:meetingId/minute",(o,e,r)=>{Pt.authenticated(o,e,r)},async(o,e)=>{let{deleteMeetingMinuteByMeetingIdController:r}=ol();await r.handle(o,e)});import{Router as gR}from"express";import{extendZodWithOpenApi as aR}from"@asteasolutions/zod-to-openapi";import za from"zod";aR(za);var mR=za.object({id:za.string()}),zi=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=mR.parse(e.params),i=e.user.id,n=await this.newsRepository.findById(t);if(!n)throw new l("Not\xEDcia n\xE3o encontrada.");if(n.author.id!==i)throw new ie("Sem permiss\xE3o.");await Promise.all([this.newsRepository.delete(t),this.firebaseStorageService.deleteFile({fileUrl:n.imageUrl})]),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new s(t.message)}}};import{extendZodWithOpenApi as cR}from"@asteasolutions/zod-to-openapi";import Tt from"zod";var pR=5,il=1024,dR=il*il,lR=pR*dR;cR(Tt);var uR=Tt.object({id:Tt.string(),title:Tt.string().min(1),content:Tt.string().min(1),image:Tt.any().optional().refine(o=>!o||typeof o=="object"&&typeof o.mimetype=="string"&&o.mimetype.startsWith("image/")&&typeof o.size=="number"&&o.size<=lR,"A imagem deve ser uma imagem v\xE1lida de no m\xE1ximo 5MB.")}),Zi=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,title:i,content:n,image:a}=uR.parse({id:e.params.id,image:e.file,...e.body}),m=await this.newsRepository.findById(t);if(!m)throw new l("Not\xEDcia n\xE3o encontrada.");let c=e.user.id;if(m.author.id!==c)throw new ie("Sem permiss\xE3o.");let u=m.imageUrl||"";a&&m.imageUrl&&(u=await this.firebaseStorageService.updateFile({file:a,folder:F.NEWS,id:t,fileUrl:m.imageUrl}));let T=await this.newsRepository.update({id:t,title:i,content:n,imageUrl:u});r.status(200).json(T)}catch(t){if(t instanceof Error)throw new s(t.message)}}};function nl(){return{createNewsController:new uo(ve(),U())}}function sl(){return{findAllNewsController:new ho(ve())}}function al(){return{findNewsByIdController:new fo(ve())}}function ml(){return{findNewsByAuthorIdController:new go(ve())}}function cl(){return{updateNewsController:new Zi(ve(),U())}}function pl(){return{deleteNewsController:new zi(ve(),U())}}var ze=gR(),{authMiddleware:Za}=_();ze.post("/",(o,e,r)=>{Za.authenticated(o,e,r)},G.single("image"),async(o,e)=>{let{createNewsController:r}=nl();await r.handle(o,e)});ze.get("/",async(o,e)=>{let{findAllNewsController:r}=sl();await r.handle(o,e)});ze.get("/:id",async(o,e)=>{let{findNewsByIdController:r}=al();await r.handle(o,e)});ze.get("/author/:authorId",async(o,e)=>{let{findNewsByAuthorIdController:r}=ml();await r.handle(o,e)});ze.put("/:id",(o,e,r)=>{Za.authenticated(o,e,r)},G.single("image"),async(o,e)=>{let{updateNewsController:r}=cl();await r.handle(o,e)});ze.delete("/:id",(o,e,r)=>{Za.authenticated(o,e,r)},async(o,e)=>{let{deleteNewsController:r}=pl();await r.handle(o,e)});import{Router as yR}from"express";var Vi=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.partner.create({data:e})}async update(e){await this.prisma.partner.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.partner.delete({where:{id:e}})}async find({pagination:e,filter:{name:r,description:t,category:i,isActive:n,orderBy:a}}){let m={},c=[];return n!==void 0&&(m.isActive=n),r&&c.push({name:{contains:r,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),i&&c.push({category:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.partner.findMany({where:m,orderBy:a?{updatedAt:a}:{updatedAt:"desc"},...e&&{skip:e.offset,take:e.limit}})}async findById(e){return await this.prisma.partner.findFirst({where:{id:e}})}async count({filter:{name:e,description:r,category:t,isActive:i}}){let n={},a=[];return i!==void 0&&(n.isActive=i),e&&a.push({name:{contains:e,mode:"insensitive"}}),r&&a.push({description:{contains:r,mode:"insensitive"}}),t&&a.push({category:{contains:t,mode:"insensitive"}}),a.length>0&&(n.OR=a),await this.prisma.partner.count({where:n})}};function At(){return new Vi(L)}function dl(){return{createPartnerController:new Ro(At(),U())}}function ll(){return{findPartnersController:new wo(At())}}function ul(){return{findPartnerByIdController:new Co(At())}}function gl(){return{updatePartnerController:new So(At(),U())}}function yl(){return{deletePartnerController:new Io(At(),U())}}var at=yR(),{authMiddleware:Va}=_();at.post("/",(o,e,r)=>{Va.authenticated(o,e,r)},G.single("logo"),async(o,e)=>{let{createPartnerController:r}=dl();await r.handle(o,e)});at.get("/",async(o,e)=>{let{findPartnersController:r}=ll();await r.handle(o,e)});at.get("/:id",async(o,e)=>{let{findPartnerByIdController:r}=ul();await r.handle(o,e)});at.put("/:id",(o,e,r)=>{Va.authenticated(o,e,r)},G.single("logo"),async(o,e)=>{let{updatePartnerController:r}=gl();await r.handle(o,e)});at.delete("/:id",(o,e,r)=>{Va.authenticated(o,e,r)},async(o,e)=>{let{deletePartnerController:r}=yl();await r.handle(o,e)});import{Router as fR}from"express";function fl(){return{createPendencyController:new vo(re(),We(),U())}}function hl(){return{findPendenciesController:new xo(We())}}function Rl(){return{findPendencyByIdController:new Mo(We())}}function Il(){return{updatePendencyController:new Po(We(),U())}}function Cl(){return{deletePendencyController:new Eo(We(),U())}}var mt=fR(),{authMiddleware:$t}=_();mt.post("/:user_id",(o,e,r)=>{$t.isAdmin(o,e,r)},G.single("document"),async(o,e)=>{let{createPendencyController:r}=fl();await r.handle(o,e)});mt.get("/",(o,e,r)=>{$t.isAdmin(o,e,r)},async(o,e)=>{let{findPendenciesController:r}=hl();await r.handle(o,e)});mt.get("/:pendency_id",(o,e,r)=>{$t.isAdmin(o,e,r)},async(o,e)=>{let{findPendencyByIdController:r}=Rl();await r.handle(o,e)});mt.put("/:pendency_id",(o,e,r)=>{$t.isAdmin(o,e,r)},G.single("document"),async(o,e)=>{let{updatePendencyController:r}=Il();await r.handle(o,e)});mt.delete("/:pendency_id",(o,e,r)=>{$t.isAdmin(o,e,r)},async(o,e)=>{let{deletePendencyController:r}=Cl();await r.handle(o,e)});import{Router as hR}from"express";var Ki=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.regiment.create({data:e})}async update(e){await this.prisma.regiment.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.regiment.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,status:i,orderBy:n}}){let a={},m=[];return i&&(a.status=i),t&&m.push({title:{contains:t,mode:"insensitive"}}),m.length>0&&(a.OR=m),await this.prisma.regiment.findMany({where:a,orderBy:n?{updatedAt:n}:{updatedAt:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.regiment.findFirst({where:{id:e}})}async findByStatus(e){return await this.prisma.regiment.findMany({where:{status:e}})}async count({filter:{title:e,status:r}}){let t={},i=[];return r&&(t.status=r),e&&i.push({title:{contains:e,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.regiment.count({where:t})}};function ct(){return new Ki(L)}function bl(){return{createRegimentController:new Ao(ct(),U())}}function wl(){return{findRegimentsController:new Bo(ct())}}function Sl(){return{findRegimentByIdController:new Fo(ct())}}function vl(){return{findRegimentByStatusController:new qo(ct())}}function jl(){return{updateRegimentController:new Oo(ct(),U())}}function El(){return{deleteRegimentController:new Do(ct(),U())}}var Ze=hR(),{authMiddleware:Ka}=_();Ze.post("/",(o,e,r)=>{Ka.authenticated(o,e,r)},G.single("document"),async(o,e)=>{let{createRegimentController:r}=bl();await r.handle(o,e)});Ze.get("/",async(o,e)=>{let{findRegimentsController:r}=wl();await r.handle(o,e)});Ze.get("/:id",async(o,e)=>{let{findRegimentByIdController:r}=Sl();await r.handle(o,e)});Ze.get("/status/:status",async(o,e)=>{let{findRegimentByStatusController:r}=vl();await r.handle(o,e)});Ze.put("/:id",(o,e,r)=>{Ka.authenticated(o,e,r)},G.single("document"),async(o,e)=>{let{updateRegimentController:r}=jl();await r.handle(o,e)});Ze.delete("/:id",(o,e,r)=>{Ka.authenticated(o,e,r)},async(o,e)=>{let{deleteRegimentController:r}=El();await r.handle(o,e)});import{Router as wR}from"express";import{extendZodWithOpenApi as RR}from"@asteasolutions/zod-to-openapi";import Ya from"zod";RR(Ya);var IR=Ya.object({id:Ya.string().uuid("ID inv\xE1lido")}),Yi=class{constructor(e){this.regionalCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=IR.parse(e.params),i=await this.regionalCongressGalleryRepository.findById(t);if(!i)throw new l("Item de galeria n\xE3o encontrado");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Xi=class{constructor(e){this.prisma=e}async create(e){await this.prisma.regionalCongress.create({data:e})}async update(e){await this.prisma.regionalCongress.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.regionalCongress.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,edition:i,location:n,orderBy:a}}){let m={},c=[];return i&&c.push({edition:{equals:i}}),t&&c.push({title:{contains:t,mode:"insensitive"}}),n&&c.push({location:{contains:n,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.regionalCongress.findMany({where:m,include:{regionalCongressPartners:!0,regionalCongressGalleryItems:!0},orderBy:a?{startDate:a}:{startDate:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.regionalCongress.findFirst({where:{id:e},include:{regionalCongressPartners:!0,regionalCongressGalleryItems:!0}})}async findByEdition(e){return await this.prisma.regionalCongress.findMany({where:{edition:e},include:{regionalCongressPartners:!0,regionalCongressGalleryItems:!0}})}async count({filter:{title:e,edition:r,location:t}}){let i={},n=[];return r&&n.push({edition:{equals:r}}),e&&n.push({title:{contains:e,mode:"insensitive"}}),t&&n.push({location:{contains:t,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.regionalCongress.count({where:i})}};function ge(){return new Xi(L)}var $i=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.regionalCongressGalleryItem.create({data:e})}async update(e){await this.prisma.regionalCongressGalleryItem.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.regionalCongressGalleryItem.delete({where:{id:e}})}async findByCongressId({pagination:e,filter:r}){return await this.prisma.regionalCongressGalleryItem.findMany({where:{congressId:r.congressId,...r.caption&&{caption:{contains:r.caption,mode:"insensitive"}}},skip:e.offset,take:e.limit})}async findById(e){return await this.prisma.regionalCongressGalleryItem.findFirst({where:{id:e}})}async count({filter:e}){return await this.prisma.regionalCongressGalleryItem.count({where:{congressId:e.congressId,...e.caption&&{caption:{contains:e.caption,mode:"insensitive"}}}})}};function Dt(){return new $i(L)}function xl(){return{createRegionalCongressGalleryController:new No(Dt(),ge(),U())}}function Ml(){return{findRegionalCongressGalleriesByCongressIdController:new Go(Dt())}}function Pl(){return{findRegionalCongressGalleryByIdController:new Yi(Dt())}}function Tl(){return{updateRegionalCongressGalleryController:new _o(Dt(),U())}}function Al(){return{deleteRegionalCongressGalleryController:new ko(Dt())}}import{extendZodWithOpenApi as CR}from"@asteasolutions/zod-to-openapi";import Xa from"zod";CR(Xa);var bR=Xa.object({id:Xa.string().uuid("ID inv\xE1lido")}),Ji=class{constructor(e){this.regionalCongressPartnerRepository=e}async handle(e,r){try{let{id:t}=bR.parse(e.params),i=await this.regionalCongressPartnerRepository.findById(t);if(!i)throw new l("Parceiro n\xE3o encontrado");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var Qi=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.regionalCongressPartner.create({data:e})}async update(e){await this.prisma.regionalCongressPartner.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.regionalCongressPartner.delete({where:{id:e}})}async findByCongressId(e){return await this.prisma.regionalCongressPartner.findMany({where:{congressId:e.filter.congressId,name:e.filter.name?{contains:e.filter.name,mode:"insensitive"}:void 0},skip:e.pagination?.offset,take:e.pagination?.limit})}async findById(e){return await this.prisma.regionalCongressPartner.findFirst({where:{id:e}})}async count(e){return await this.prisma.regionalCongressPartner.count({where:{congressId:e.filter.congressId,name:e.filter.name?{contains:e.filter.name,mode:"insensitive"}:void 0}})}};function Ft(){return new Qi(L)}function Dl(){return{createRegionalCongressPartnerController:new Wo(Ft(),ge(),U())}}function Fl(){return{findRegionalCongressPartnersByCongressIdController:new Zo(Ft())}}function Ul(){return{findRegionalCongressPartnerByIdController:new Ji(Ft())}}function ql(){return{updateRegionalCongressPartnerController:new Vo(Ft(),U())}}function Bl(){return{deleteRegionalCongressPartnerController:new Ho(Ft())}}function Ol(){return{createRegionalCongressController:new Ko(ge())}}function Nl(){return{findRegionalCongressesController:new Qo(ge())}}function kl(){return{findRegionalCongressByIdController:new $o(ge())}}function Ll(){return{findRegionalCongressByEditionController:new Xo(ge())}}function Gl(){return{updateRegionalCongressController:new ei(ge())}}function _l(){return{deleteRegionalCongressController:new Yo(ge())}}var $=wR(),{authMiddleware:Pe}=_();$.post("/",(o,e,r)=>{Pe.authenticated(o,e,r)},async(o,e)=>{let{createRegionalCongressController:r}=Ol();await r.handle(o,e)});$.get("/",async(o,e)=>{let{findRegionalCongressesController:r}=Nl();await r.handle(o,e)});$.get("/:id",async(o,e)=>{let{findRegionalCongressByIdController:r}=kl();await r.handle(o,e)});$.get("/edition/:edition",async(o,e)=>{let{findRegionalCongressByEditionController:r}=Ll();await r.handle(o,e)});$.put("/:id",(o,e,r)=>{Pe.authenticated(o,e,r)},async(o,e)=>{let{updateRegionalCongressController:r}=Gl();await r.handle(o,e)});$.delete("/:id",(o,e,r)=>{Pe.authenticated(o,e,r)},async(o,e)=>{let{deleteRegionalCongressController:r}=_l();await r.handle(o,e)});$.post("/:congressId/gallery",(o,e,r)=>{Pe.authenticated(o,e,r)},G.single("image"),async(o,e)=>{let{createRegionalCongressGalleryController:r}=xl();await r.handle(o,e)});$.get("/:congressId/gallery",async(o,e)=>{let{findRegionalCongressGalleriesByCongressIdController:r}=Ml();await r.handle(o,e)});$.get("/gallery/:id",async(o,e)=>{let{findRegionalCongressGalleryByIdController:r}=Pl();await r.handle(o,e)});$.put("/gallery/:id",(o,e,r)=>{Pe.authenticated(o,e,r)},G.single("image"),async(o,e)=>{let{updateRegionalCongressGalleryController:r}=Tl();await r.handle(o,e)});$.delete("/gallery/:id",(o,e,r)=>{Pe.authenticated(o,e,r)},async(o,e)=>{let{deleteRegionalCongressGalleryController:r}=Al();await r.handle(o,e)});$.post("/:congressId/partner",(o,e,r)=>{Pe.authenticated(o,e,r)},G.single("logo"),async(o,e)=>{let{createRegionalCongressPartnerController:r}=Dl();await r.handle(o,e)});$.get("/:congressId/partner",async(o,e)=>{let{findRegionalCongressPartnersByCongressIdController:r}=Fl();await r.handle(o,e)});$.get("/partner/:id",async(o,e)=>{let{findRegionalCongressPartnerByIdController:r}=Ul();await r.handle(o,e)});$.put("/partner/:id",(o,e,r)=>{Pe.authenticated(o,e,r)},G.single("logo"),async(o,e)=>{let{updateRegionalCongressPartnerController:r}=ql();await r.handle(o,e)});$.delete("/partner/:id",(o,e,r)=>{Pe.authenticated(o,e,r)},async(o,e)=>{let{deleteRegionalCongressPartnerController:r}=Bl();await r.handle(o,e)});import{Router as xR}from"express";import{extendZodWithOpenApi as SR}from"@asteasolutions/zod-to-openapi";import te from"zod";var vR=1,jR=9;SR(te);var ER=te.object({page:te.coerce.number().min(1).default(vR),limit:te.coerce.number().min(1).default(jR),userId:te.string().optional(),registrationNumber:te.string().optional(),name:te.string().optional(),emailAddress:te.string().optional(),mainEtps:te.string().optional(),formations:te.string().optional(),occupations:te.string().optional(),institutions:te.string().optional(),biography:te.string().optional(),orderBy:te.enum(["asc","desc"]).default("desc")}),en=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=ER.parse(e.query),a=i*t-i,[m,c]=await Promise.all([this.researcherRepository.find({pagination:{offset:a,limit:i},filter:{userName:n.name,...n}}),this.researcherRepository.count({filter:{userName:n.name,...n}})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:a,limit:i,researchers:m})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var tn=class{constructor(e){this.prisma=e}async create(e){await this.prisma.researcher.create({data:e})}async update(e){await this.prisma.researcher.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.researcher.delete({where:{id:e}})}async find({pagination:e,filter:{biography:r,degrees:t,formations:i,institutions:n,mainEtps:a,occupations:m,orderBy:c,registrationNumber:u,seniority:T,userId:k,userName:Z}}){let Q={},Ie=[];return Z&&Ie.push({user:{name:{contains:Z,mode:"insensitive"}}}),u&&Ie.push({registrationNumber:{contains:u,mode:"insensitive"}}),a&&Ie.push({mainEtps:{contains:a,mode:"insensitive"}}),i&&Ie.push({formations:{contains:i,mode:"insensitive"}}),m&&Ie.push({occupations:{contains:m,mode:"insensitive"}}),n&&Ie.push({institutions:{contains:n,mode:"insensitive"}}),r&&Ie.push({biography:{contains:r,mode:"insensitive"}}),Ie.length>0&&(Q.OR=Ie),t&&t.length>0&&(Q.degrees={hasSome:t}),T&&(Q.seniority=T),k&&(Q.userId={equals:k}),await this.prisma.researcher.findMany({where:Q,omit:{userId:!0},include:{user:{omit:{passwordHash:!0}}},orderBy:{updatedAt:c},...e&&{skip:e.offset,take:e.limit}})}async findById(e){return await this.prisma.researcher.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async findByUserId(e){return await this.prisma.researcher.findFirst({where:{userId:e},include:{user:{omit:{passwordHash:!0}}}})}async findByRegistrationNumber(e){return await this.prisma.researcher.findFirst({where:{registrationNumber:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{biography:e,degrees:r,formations:t,institutions:i,mainEtps:n,occupations:a,registrationNumber:m,seniority:c,userId:u,userName:T}}){let k={},Z=[];return T&&Z.push({user:{name:{contains:T,mode:"insensitive"}}}),m&&Z.push({registrationNumber:{contains:m,mode:"insensitive"}}),Z.length>0&&(k.OR=Z),n&&(k.mainEtps={contains:n,mode:"insensitive"}),t&&(k.formations={contains:t,mode:"insensitive"}),r&&r.length>0&&(k.degrees={hasSome:r}),a&&(k.occupations={contains:a,mode:"insensitive"}),c&&(k.seniority=c),i&&(k.institutions={contains:i,mode:"insensitive"}),e&&(k.biography={contains:e,mode:"insensitive"}),u&&(k.userId={equals:u}),await this.prisma.researcher.count({where:k})}};function pt(){return new tn(L)}function Wl(){return{createResearcherController:new ti(pt())}}function Hl(){return{findResearchersController:new en(pt())}}function zl(){return{findResearcherByIdController:new oi(pt())}}function Zl(){return{findResearcherByUserIdController:new ni(pt())}}function Vl(){return{updateResearcherController:new si(pt())}}function Kl(){return{deleteResearcherController:new ri(pt())}}var Ve=xR(),{authMiddleware:$a}=_();Ve.post("/",(o,e,r)=>{$a.authenticated(o,e,r)},async(o,e)=>{let{createResearcherController:r}=Wl();await r.handle(o,e)});Ve.get("/",async(o,e)=>{let{findResearchersController:r}=Hl();await r.handle(o,e)});Ve.get("/:id",async(o,e)=>{let{findResearcherByIdController:r}=zl();await r.handle(o,e)});Ve.get("/user/:userId",async(o,e)=>{let{findResearcherByUserIdController:r}=Zl();await r.handle(o,e)});Ve.put("/:id",(o,e,r)=>{$a.authenticated(o,e,r)},async(o,e)=>{let{updateResearcherController:r}=Vl();await r.handle(o,e)});Ve.delete("/:id",(o,e,r)=>{$a.authenticated(o,e,r)},async(o,e)=>{let{deleteResearcherController:r}=Kl();await r.handle(o,e)});import{Router as TR}from"express";import{extendZodWithOpenApi as MR}from"@asteasolutions/zod-to-openapi";import rn from"zod";MR(rn);var PR=rn.object({role:rn.string().optional(),orderBy:rn.enum(["asc","desc"]).optional()}),on=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let t=PR.parse(e.query),i=await this.sdhcTeamMemberRepository.find({filter:t});r.status(200).json({members:i})}catch(t){if(t instanceof Error)throw new s(t.message)}}};var nn=class{constructor(e){this.prisma=e}async create(e){await this.prisma.sDHCTeamMember.create({data:{...e,order:e.order??0}})}async update(e){let{id:r,...t}=e;await this.prisma.sDHCTeamMember.update({where:{id:r},data:t})}async deleteById(e){await this.prisma.sDHCTeamMember.delete({where:{id:e}})}async find({filter:{role:e,orderBy:r}}){let t={};return e&&(t.role={contains:e,mode:"insensitive"}),await this.prisma.sDHCTeamMember.findMany({where:t,include:{user:{omit:{passwordHash:!0}}},orderBy:r?[{order:"asc"},{updatedAt:r}]:[{order:"asc"},{updatedAt:"desc"}]})}async findById(e){return await this.prisma.sDHCTeamMember.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{role:e}}){let r={};return e&&(r.role={contains:e,mode:"insensitive"}),await this.prisma.sDHCTeamMember.count({where:r})}};function Ut(){return new nn(L)}function Yl(){return{createSDHCTeamMemberController:new ai(Ut())}}function Xl(){return{findSDHCTeamMembersController:new on(Ut())}}function $l(){return{findSDHCTeamMemberByIdController:new ci(Ut())}}function Jl(){return{updateSDHCTeamMemberController:new di(Ut())}}function Ql(){return{deleteSDHCTeamMemberController:new mi(Ut())}}var dt=TR(),{authMiddleware:Ja}=_();dt.post("/",(o,e,r)=>{Ja.authenticated(o,e,r)},async(o,e)=>{let{createSDHCTeamMemberController:r}=Yl();await r.handle(o,e)});dt.get("/",async(o,e)=>{let{findSDHCTeamMembersController:r}=Xl();await r.handle(o,e)});dt.get("/:id",async(o,e)=>{let{findSDHCTeamMemberByIdController:r}=$l();await r.handle(o,e)});dt.put("/:id",(o,e,r)=>{Ja.authenticated(o,e,r)},async(o,e)=>{let{updateSDHCTeamMemberController:r}=Jl();await r.handle(o,e)});dt.delete("/:id",(o,e,r)=>{Ja.authenticated(o,e,r)},async(o,e)=>{let{deleteSDHCTeamMemberController:r}=Ql();await r.handle(o,e)});import{Router as AR}from"express";var sn=class{constructor(e){this.userRepository=e}async handle(e,r){try{let t=await this.userRepository.find();r.status(200).json(t)}catch(t){if(t instanceof Error)throw new s(t.message)}}};function eu(){return{updateUserController:new gi(re(),U())}}function tu(){return{deleteUserController:new li(re())}}function ru(){return{findUsersController:new sn(re())}}function ou(){return{findUserController:new ui(re())}}var qt=AR(),{authMiddleware:iu}=_();qt.get("/:id",async(o,e)=>{let{findUserController:r}=ou();await r.handle(o,e)});qt.put("/",(o,e,r)=>{iu.authenticated(o,e,r)},G.single("avatarImage"),async(o,e)=>{let{updateUserController:r}=eu();await r.handle(o,e)});qt.delete("/:id",(o,e,r)=>{iu.authenticated(o,e,r)},async(o,e)=>{let{deleteUserController:r}=tu();await r.handle(o,e)});qt.get("/",async(o,e)=>{let{findUsersController:r}=ru();await r.handle(o,e)});import{Router as OR}from"express";import{extendZodWithOpenApi as DR}from"@asteasolutions/zod-to-openapi";import Re from"zod";var FR=5,nu=1024,UR=nu*nu,qR=FR*UR;DR(Re);var BR=Re.object({title:Re.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio."),description:Re.string().optional(),scheduledAt:Re.coerce.date(),webinarLink:Re.url().optional(),guestIds:Re.transform(o=>typeof o=="string"?o.split(","):o).pipe(Re.array(Re.uuid())),thumbnail:Re.any().refine(o=>!o||typeof o=="object"&&typeof o.mimetype=="string"&&o.mimetype.startsWith("image/")&&typeof o.size=="number"&&o.size<=qR,"A thumbnail deve ser uma imagem v\xE1lida de no m\xE1ximo 5MB.")}),an=class{constructor(e,r){this.webinarRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{title:t,description:i,scheduledAt:n,webinarLink:a,guestIds:m,thumbnail:c}=BR.parse({...e.body,thumbnail:e.file}),u=await this.webinarRepository.create({title:t,description:i,scheduledAt:n,webinarLink:a||void 0,guestIds:m}),T=await this.firebaseStorageService.uploadFile({file:c,folder:F.WEBINAR,id:u.id});return await this.webinarRepository.update({id:u.id,thumbnailUrl:T}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new s(t.message)}}};var mn=class{constructor(e){this.prisma=e}async create({title:e,description:r,scheduledAt:t,webinarLink:i,thumbnailUrl:n,guestIds:a}){return await this.prisma.webinar.create({data:{title:e,description:r,scheduledAt:t,webinarLink:i,thumbnailUrl:n,guests:a?{connect:a.map(m=>({id:m}))}:void 0}})}async find({pagination:{offset:e,limit:r},filter:{description:t,orderBy:i,title:n}}){let a={},m=[];return n&&m.push({title:{contains:n,mode:"insensitive"}}),t&&m.push({description:{contains:t,mode:"insensitive"}}),m.length>0&&(a.OR=m),await this.prisma.webinar.findMany({where:a,include:{guests:{omit:{passwordHash:!0}}},orderBy:{updatedAt:i},skip:e,take:r})}async findById(e){return await this.prisma.webinar.findFirst({where:{id:e},include:{guests:{omit:{passwordHash:!0}}}})}async update({id:e,title:r,description:t,scheduledAt:i,webinarLink:n,thumbnailUrl:a,guestIds:m}){await this.prisma.webinar.update({where:{id:e},data:{title:r,description:t,scheduledAt:i,webinarLink:n,thumbnailUrl:a,guests:m?{connect:m.map(c=>({id:c}))}:void 0}})}async deleteById(e){await this.prisma.webinar.delete({where:{id:e}})}async count({filter:{description:e,title:r}}){let t={},i=[];return r&&i.push({title:{contains:r,mode:"insensitive"}}),e&&i.push({description:{contains:e,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.webinar.count({where:t})}};function Bt(){return new mn(L)}function su(){return{createWebinarController:new an(Bt(),U())}}function au(){return{findWebinarsController:new hi(Bt())}}function mu(){return{findWebinarByIdController:new fi(Bt())}}function cu(){return{updateWebinarController:new Ri(Bt(),U())}}function pu(){return{deleteWebinarController:new yi(Bt(),U())}}var lt=OR(),{authMiddleware:Jt}=_();lt.post("/",(o,e,r)=>{Jt.isAdmin(o,e,r)},G.single("thumbnail"),async(o,e)=>{let{createWebinarController:r}=su();await r.handle(o,e)});lt.get("/",(o,e,r)=>{Jt.isAdmin(o,e,r)},async(o,e)=>{let{findWebinarsController:r}=au();await r.handle(o,e)});lt.get("/:id",(o,e,r)=>{Jt.isAdmin(o,e,r)},async(o,e)=>{let{findWebinarByIdController:r}=mu();await r.handle(o,e)});lt.put("/:id",(o,e,r)=>{Jt.isAdmin(o,e,r)},G.single("thumbnail"),async(o,e)=>{let{updateWebinarController:r}=cu();await r.handle(o,e)});lt.delete("/:id",(o,e,r)=>{Jt.isAdmin(o,e,r)},async(o,e)=>{let{deleteWebinarController:r}=pu();await r.handle(o,e)});var z=Qa(),LR={methods:["GET","POST","PUT","DELETE"],origin:["http://localhost:3000","https://rede-ct.vercel.app"],credentials:!0};z.use(kR(LR));z.use(Qa.json());z.use(Qa.urlencoded({extended:!1}));z.use("/docs",NR({content:Yp,theme:"kepler"}));z.use("/",ka);z.use("/auth",je);z.use("/user",qt);z.use("/news",ze);z.use("/certification",rt);z.use("/pendency",mt);z.use("/researcher",Ve);z.use("/in-memoriam",He);z.use("/etp",ot);z.use("/partner",at);z.use("/management-team",st);z.use("/sdhc-team-member",dt);z.use("/legitimator-committee-member",nt);z.use("/regiment",Ze);z.use("/meeting",me);z.use("/international-scientific-congress",X);z.use("/regional-congress",$);z.use("/webinars",lt);z.use((o,e,r,t)=>{let{errorHandler:i}=em();i.handle(o,e,r,t)});var _R=GR.createServer(z),du=4e3;_R.listen(du,()=>{console.log(`\u{1F680} Aplica\xE7\xE3o rodando na porta ${du}.`)});

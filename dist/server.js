import jg from"node:http";import{apiReference as vg}from"@scalar/express-api-reference";import Mg from"cors";import ss from"express";import dp from"zod";var V=class extends Error{};var z=class extends Error{};var a=class extends Error{};var d=class extends Error{};var $=class extends Error{};import{ZodError as pp}from"zod";var vt=class extends pp{};var Mt=class{handle(e,r,t,i){return e instanceof vt?t.status(400).json({message:"Validation error",error:dp.treeifyError(e)}):e instanceof V?t.status(400).json({message:e.message}):e instanceof d?t.status(404).json({message:e.message}):e instanceof $?t.status(401).json({message:e.message}):e instanceof z?t.status(409).json({message:e.message}):e instanceof a?t.status(500).json({message:e.message}):t.status(500).json({message:"Internal server error"})}};function as(){return{errorHandler:new Mt}}import{OpenAPIRegistry as Ml,OpenApiGeneratorV3 as El}from"@asteasolutions/zod-to-openapi";import{$Enums as ms}from"@prisma/client";import p from"zod";import{extendZodWithOpenApi as up}from"@asteasolutions/zod-to-openapi";import De from"zod";var lp=1,gp=6;up(De);var Zo=De.object({page:De.coerce.number().min(1).default(lp),limit:De.coerce.number().min(1).default(gp),title:De.string().optional(),description:De.string().optional(),orderBy:De.enum(["asc","desc"]).default("desc")}),Et=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{title:t,description:i,limit:n,orderBy:s,page:m}=Zo.parse(e.query),c=m*n-n,u=e.user.id,[P,D]=await Promise.all([this.certificationRepository.findByUserId({userId:u,pagination:{offset:c,limit:n},filter:{title:t,description:i,orderBy:s}}),this.certificationRepository.count({filter:{title:t,description:i,userId:u}})]),L=Math.max(Math.ceil(D/n),1);return r.status(200).json({page:m,totalPages:L,offset:c,limit:n,totalCertifications:D,certifications:P})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as fp}from"@asteasolutions/zod-to-openapi";import qe from"zod";var yp=1,hp=7;fp(qe);var Vo=qe.object({page:qe.coerce.number().min(1).default(yp),limit:qe.coerce.number().min(1).default(hp),title:qe.string().optional(),content:qe.string().optional(),orderBy:qe.enum(["asc","desc"]).default("desc")}),jt=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,content:n,orderBy:s,title:m}=Vo.parse(e.query),c=i*t-i,u=e.user.id,[P,D]=await Promise.all([this.newsRepository.findByAuthorId({authorId:u,pagination:{offset:c,limit:i},filter:{orderBy:s,title:m,content:n}}),this.newsRepository.count({filter:{authorId:u,content:n,title:m}})]),L=Math.ceil(D/i);r.status(200).json({page:t,totalPages:L,offset:c,limit:i,news:P})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Rp}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Ip}from"@prisma/client";import ye from"zod";var bp=1,wp=6;Rp(ye);var Go=ye.object({page:ye.coerce.number().min(1).default(bp),limit:ye.coerce.number().min(1).default(wp),title:ye.string().optional(),description:ye.string().optional(),status:ye.enum(Ip).default("PENDING"),orderBy:ye.enum(["asc","desc"]).default("desc")}),xt=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{limit:t,page:i,...n}=Go.parse(e.query),s=i*t-t,m=e.user.id,[c,u]=await Promise.all([this.pendencyRepository.findByUserId({userId:m,pagination:{offset:s,limit:t},filter:n}),this.pendencyRepository.count({filter:{...n,userId:m}})]),P=Math.max(Math.ceil(u/t),1);return r.status(200).json({page:i,totalPages:P,offset:s,limit:t,pendencies:c})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Cp}from"@asteasolutions/zod-to-openapi";import Tt from"zod";Cp(Tt);var Ko=Tt.object({password:Tt.string(),email:Tt.email()}),Pt=class{constructor(e,r,t){this.userRepository=e;this.bcrypt=r;this.jwtService=t}async handle(e,r){try{let{email:t,password:i}=Ko.parse(e.body),n=await this.userRepository.findByEmail(t);if(!n)return r.status(401).json({message:"Usu\xE1rio n\xE3o existe."});if(!await this.bcrypt.compare({password:i,hashedPassword:n.passwordHash}))throw new $("Senha inv\xE1lida.");let{id:m,role:c}=n,u=this.jwtService.sign({id:m,role:c,email:t});return r.status(200).json({token:u})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Sp}from"@asteasolutions/zod-to-openapi";import Je from"zod";var At=8;Sp(Je);var Yo=Je.object({name:Je.string("Nome \xE9 obrigat\xF3rio.").min(1,"Nome \xE9 obrigat\xF3rio."),emailAddress:Je.email("E-mail inv\xE1lido.").min(1,"E-mail \xE9 obrigat\xF3rio."),password:Je.string("A senha \xE9 obrigat\xF3ria.").min(At,`A senha deve ter pelo menos ${At} caracteres.`),confirmPassword:Je.string("A senha \xE9 obrigat\xF3ria.").min(At,`A senha deve ter pelo menos ${At} caracteres.`)}).refine(o=>o.password===o.confirmPassword,{message:"As senhas n\xE3o coincidem.",path:["confirmPassword"]}),Ut=class{constructor(e,r){this.userRepository=e;this.bcrypt=r}async handle(e,r){try{let{emailAddress:t,name:i,password:n}=Yo.parse(e.body);if(await this.userRepository.findByEmail(t))throw new z("Usu\xE1rio j\xE1 existe.");let m=await this.bcrypt.hash(n);return await this.userRepository.create({name:i,emailAddress:t,passwordHash:m}),r.status(201).json()}catch(t){if(t instanceof Error)throw new a(t.message)}}};var cs={method:"post",path:"/auth/sign-up",tags:["Authentication"],summary:"Create a new user",request:{body:{content:{"application/json":{schema:Yo}}}},responses:{201:{description:"User created successfully",summary:"User Registration Successful",content:{"application/json":{schema:p.object({message:p.string()})}}},400:{description:"Invalid input data provided",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},409:{description:"User already exists with this email",summary:"User Already Exists",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},ps={method:"post",path:"/auth/sign-in",tags:["Authentication"],summary:"Sign in",request:{body:{content:{"application/json":{schema:Ko}}}},responses:{200:{description:"Authentication successful, JWT token returned",summary:"Login Successful",content:{"application/json":{schema:p.object({token:p.string()})}}},400:{description:"Invalid credentials or input data",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},401:{description:"Invalid email or password",summary:"Authentication Failed",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},ds={method:"get",path:"/auth/user",tags:["Authentication"],summary:"Search for authenticated user",security:[{bearerAuth:[]}],responses:{200:{description:"Authenticated user information retrieved successfully",summary:"User Information Retrieved",content:{"application/json":{schema:p.object({name:p.string(),id:p.string(),avatarUrl:p.string().nullable(),createdAt:p.date(),updatedAt:p.date(),emailAddress:p.string(),orcid:p.string().nullable(),phone:p.string().nullable(),lattesUrl:p.string().nullable(),role:p.enum(ms.UserRole)}).nullable()}}},400:{description:"Invalid request parameters",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},404:{description:"User not found or not authenticated",summary:"User Not Found",content:{"application/json":{schema:p.object({message:p.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},us={method:"get",path:"/auth/user/news",tags:["Authentication"],summary:"List authenticated user news",security:[{bearerAuth:[]}],request:{query:Vo},responses:{200:{description:"Paginated list of authenticated user news retrieved successfully",summary:"User News Retrieved",content:{"application/json":{schema:p.object({page:p.number(),totalPages:p.number(),offset:p.number(),limit:p.number(),news:p.object({content:p.string(),id:p.string(),title:p.string(),createdAt:p.date(),updatedAt:p.date(),imageUrl:p.string().nullable()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},ls={method:"get",path:"/auth/admin",tags:["Authentication"],summary:"Verify admin access",security:[{bearerAuth:[]}],responses:{200:{description:"Admin access verified successfully",summary:"Admin Access Granted",content:{"application/json":{schema:p.object({success:p.boolean()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},gs={method:"get",path:"/auth/certifications",tags:["Authentication"],summary:"List all authenticated user's certifications",security:[{bearerAuth:[]}],request:{query:Zo},responses:{200:{description:"Paginated list of authenticated user certifications retrieved successfully",summary:"User Certifications Retrieved",content:{"application/json":{schema:p.object({page:p.number(),totalPages:p.number(),offset:p.number(),limit:p.number(),certifications:p.object({description:p.string(),id:p.string(),title:p.string(),certificationUrl:p.string(),createdAt:p.date(),updatedAt:p.date(),userId:p.string()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}},fs={method:"get",path:"/auth/pendencies",tags:["Authentication"],summary:"List all authenticated user's pendencies",security:[{bearerAuth:[]}],request:{query:Go},responses:{200:{description:"Paginated list of authenticated user pendencies retrieved successfully",summary:"User Pendencies Retrieved",content:{"application/json":{schema:p.object({page:p.number(),totalPages:p.number(),offset:p.number(),limit:p.number(),pendencies:p.object({id:p.string(),title:p.string(),description:p.string(),status:p.enum(ms.PendencyStatus),createdAt:p.date(),updatedAt:p.date(),userId:p.string()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:p.object({errors:p.record(p.string(),p.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:p.object({message:p.string()})}}}}};import{$Enums as Ap}from"@prisma/client";import I from"zod";import{extendZodWithOpenApi as vp}from"@asteasolutions/zod-to-openapi";import $o from"zod";vp($o);var Xo=$o.object({id:$o.string()}),Dt=class{constructor(e,r){this.certificationRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=Xo.parse({id:e.params.certification_id}),i=await this.certificationRepository.findById(t);if(!i)throw new d("A certifica\xE7\xE3o n\xE3o existe.");return await Promise.all([this.certificationRepository.deleteById(i.id),this.firebaseStorageService.deleteFile({fileUrl:i.certificationUrl})]),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Mp}from"@asteasolutions/zod-to-openapi";import Jo from"zod";Mp(Jo);var Qo=Jo.object({certificationId:Jo.uuid()}),qt=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{certificationId:t}=Qo.parse({certificationId:e.params.certification_id}),i=await this.certificationRepository.findById(t);if(!i)throw new d("Certificado n\xE3o encontrado.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Ep}from"@asteasolutions/zod-to-openapi";import he from"zod";var jp=1,xp=6;Ep(he);var ei=he.object({page:he.coerce.number().min(1).default(jp),limit:he.coerce.number().min(1).default(xp),title:he.string().optional(),description:he.string().optional(),userId:he.uuid().optional(),orderBy:he.enum(["asc","desc"]).default("desc")}),Ft=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{limit:t,page:i,...n}=ei.parse(e.query),s=i*t-t,[m,c]=await Promise.all([this.certificationRepository.find({pagination:{offset:s,limit:t},filter:n}),this.certificationRepository.count({filter:n})]),u=Math.max(Math.ceil(c/t),1);return r.status(200).json({page:i,totalPages:u,offset:s,limit:t,certifications:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Tp}from"@asteasolutions/zod-to-openapi";import Qe from"zod";var O={NEWS:"images/news",USER:"images/user",IN_MEMORIAM:"images/in-memoriam",PARTNER:"images/partners",CERTIFICATION:"documents/certifications",PENDENCY:"documents/pendencies",REGIMENT:"documents/regiments",MEETING_MINUTE:"documents/meeting-minutes"};Tp(Qe);var Ot=Qe.object({userId:Qe.uuid(),title:Qe.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio."),description:Qe.string().min(1,"Descri\xE7\xE3o \xE9 obrigat\xF3ria."),certification:Qe.any().refine(o=>o&&typeof o=="object"&&o.size>0,"Arquivo do certificado \xE9 obrigat\xF3rio")}),Bt=class{constructor(e,r,t){this.userRepository=e;this.certificationRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{userId:t,title:i,description:n,certification:s}=Ot.parse({...e.body,userId:e.params.user_id,certification:e.file});if(!await this.userRepository.findById(t))throw new V("O usu\xE1rio n\xE3o existe.");let c=await this.firebaseStorageService.uploadFile({file:s,id:t,folder:O.CERTIFICATION});return await this.certificationRepository.register({userId:t,title:i,description:n,certificationUrl:c}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Pp}from"@asteasolutions/zod-to-openapi";import et from"zod";Pp(et);var kt=et.object({id:et.uuid(),title:et.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio."),description:et.string().min(1,"Descri\xE7\xE3o \xE9 obrigat\xF3ria."),certification:et.any().refine(o=>o==null||typeof o=="object"&&typeof o.size=="number"&&(o.size===0||o.size>0),"Arquivo do certificado \xE9 inv\xE1lido").optional()}),Nt=class{constructor(e,r){this.certificationRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{certification:t,id:i,...n}=kt.parse({...e.body,id:e.params.certification_id,certification:e.file}),s=await this.certificationRepository.findById(i);if(!s)throw new V("A certifica\xE7\xE3o n\xE3o existe");let m=s.certificationUrl;return t&&t.size>0&&(m=await this.firebaseStorageService.updateFile({file:t,id:s.userId,folder:O.CERTIFICATION,fileUrl:s.certificationUrl})),await this.certificationRepository.update({...n,id:i,certificationUrl:m}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ys={method:"post",path:"/certifications/{user_id}",tags:["Certifications"],summary:"Register certification for user",security:[{bearerAuth:[]}],request:{params:Ot.pick({userId:!0}).transform(()=>({user_id:""})),body:{content:{"multipart/form-data":{schema:Ot.omit({userId:!0})}}}},responses:{201:{description:"Certification registered successfully for the user",summary:"Certification Registered",content:{"application/json":{schema:I.object({message:I.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"User not found with the provided ID",summary:"User Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},hs={method:"get",path:"/certifications",tags:["Certifications"],summary:"List certifications",security:[{bearerAuth:[]}],request:{query:ei},responses:{200:{description:"Paginated list of certifications with user information retrieved successfully",summary:"Certifications Retrieved",content:{"application/json":{schema:I.object({page:I.number(),totalPages:I.number(),offset:I.number(),limit:I.number(),certifications:I.array(I.object({description:I.string(),userId:I.string(),title:I.string(),id:I.string(),createdAt:I.date(),updatedAt:I.date(),certificationUrl:I.url(),user:I.object({id:I.uuid(),name:I.string(),createdAt:I.date(),updatedAt:I.date(),avatarUrl:I.string().nullable(),emailAddress:I.email(),orcid:I.string().nullable(),phone:I.string().nullable(),lattesUrl:I.url().nullable(),role:I.enum(Ap.UserRole)})}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},Rs={method:"get",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Find certification by ID",security:[{bearerAuth:[]}],request:{params:Qo},responses:{200:{description:"Certification details retrieved successfully",summary:"Certification Retrieved",content:{"application/json":{schema:I.object({description:I.string(),userId:I.string(),title:I.string(),id:I.string(),createdAt:I.date(),updatedAt:I.date(),certificationUrl:I.url()}).nullable()}}},400:{description:"Invalid certification ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},Is={method:"put",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Update certification",security:[{bearerAuth:[]}],request:{params:kt.pick({id:!0}).transform(()=>({certification_id:""})),body:{content:{"multipart/form-data":{schema:kt.omit({id:!0})}}}},responses:{204:{description:"Certification updated successfully",summary:"Certification Updated"},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},bs={method:"delete",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Delete certification",security:[{bearerAuth:[]}],request:{params:Xo},responses:{204:{description:"Certification deleted successfully",summary:"Certification Deleted"},400:{description:"Invalid certification ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}};import{$Enums as si}from"@prisma/client";import f from"zod";import{extendZodWithOpenApi as Up}from"@asteasolutions/zod-to-openapi";import te from"zod";Up(te);var ti=te.object({code:te.string(),title:te.string(),description:te.string().optional(),notes:te.string().optional(),leaderId:te.uuid(),deputyLeaderId:te.uuid(),secretaryId:te.uuid(),memberIds:te.array(te.uuid())}),Lt=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{code:t,title:i,description:n,notes:s,leaderId:m,deputyLeaderId:c,secretaryId:u,memberIds:P}=ti.parse(e.body);if(await this.etpRepository.findByCode(t))throw new z("J\xE1 existe um ETP cadastrado com este c\xF3digo.");return await this.etpRepository.create({code:t,title:i,description:n,notes:s,leaderId:m,deputyLeaderId:c,secretaryId:u,memberIds:P}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Dp}from"@asteasolutions/zod-to-openapi";import ri from"zod";Dp(ri);var oi=ri.object({id:ri.uuid()}),Ht=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t}=oi.parse({id:e.params.id});if(!await this.etpRepository.findById(t))throw new d("O ETP n\xE3o existe.");return await this.etpRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as qp}from"@asteasolutions/zod-to-openapi";import ii from"zod";qp(ii);var zt=ii.object({id:ii.uuid()}),_t=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t}=zt.parse({id:e.params.id}),i=await this.etpRepository.findById(t);if(!i)throw new d("O ETP n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Fp}from"@asteasolutions/zod-to-openapi";import X from"zod";Fp(X);var ni=X.object({id:X.uuid(),code:X.string().optional(),title:X.string().optional(),description:X.string().optional(),notes:X.string().optional(),leaderId:X.uuid().optional(),deputyLeaderId:X.uuid().optional(),secretaryId:X.uuid().optional(),memberIds:X.array(X.uuid()).optional()}),Wt=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t,code:i,title:n,description:s,notes:m,leaderId:c,deputyLeaderId:u,secretaryId:P,memberIds:D}=ni.parse({id:e.params.id,...e.body});if(!await this.etpRepository.findById(t))throw new d("O ETP n\xE3o existe.");if(i){let Z=await this.etpRepository.findByCode(i);if(Z&&Z.id!==t)throw new z("J\xE1 existe um ETP com este c\xF3digo.")}return await this.etpRepository.update({id:t,code:i,title:n,description:s,notes:m,leaderId:c,deputyLeaderId:u,secretaryId:P,memberIds:D}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Bp=1,Op=9,Zt=f.object({id:f.uuid(),registrationNumber:f.string(),mainEtps:f.string().nullable(),formations:f.string().nullable(),degrees:f.array(f.enum(si.Degree)),occupations:f.string(),seniority:f.enum(si.Seniority),institutions:f.string(),biography:f.string().nullable(),createdAt:f.date(),updatedAt:f.date(),user:f.object({id:f.uuid(),name:f.string(),emailAddress:f.string(),avatarUrl:f.string().nullable(),orcid:f.string().nullable(),phone:f.string().nullable(),lattesUrl:f.string().nullable(),role:f.enum(si.UserRole)})}),ws=f.object({id:f.uuid(),code:f.string(),title:f.string(),description:f.string().nullable(),notes:f.string().nullable(),createdAt:f.date(),updatedAt:f.date(),leader:f.object({id:f.uuid(),researcher:Zt}).nullable(),deputyLeader:f.object({id:f.uuid(),researcher:Zt}).nullable(),secretary:f.object({id:f.uuid(),researcher:Zt}).nullable(),members:f.array(Zt)}),Cs={method:"post",path:"/etp",tags:["ETPs"],summary:"Create a new ETP with single leader, deputy leader, secretary and multiple members",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:ti}}}},responses:{201:{description:"ETP created successfully",summary:"ETP Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:f.object({message:f.string()})}}},409:{description:"ETP with this code already exists",summary:"Conflict",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},Ss={method:"get",path:"/etp",tags:["ETPs"],summary:"List all ETPs with pagination and filters",request:{query:f.object({page:f.coerce.number().min(1).default(Bp).optional(),limit:f.coerce.number().min(1).default(Op).optional(),code:f.string().optional(),title:f.string().optional(),description:f.string().optional(),notes:f.string().optional(),orderBy:f.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of ETPs retrieved successfully with pagination",summary:"ETPs Retrieved",content:{"application/json":{schema:f.object({page:f.number(),totalPages:f.number(),offset:f.number(),limit:f.number(),etps:f.array(ws)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},vs={method:"get",path:"/etp/{id}",tags:["ETPs"],summary:"Find ETP by ID",request:{params:zt},responses:{200:{description:"ETP details retrieved successfully",summary:"ETP Retrieved",content:{"application/json":{schema:ws}}},400:{description:"Invalid ETP ID format",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},Ms={method:"put",path:"/etp/{id}",tags:["ETPs"],summary:"Update ETP and manage user relationships (single leader, deputy leader, secretary, multiple members)",security:[{bearerAuth:[]}],request:{params:zt,body:{content:{"application/json":{schema:ni.omit({id:!0})}}}},responses:{200:{description:"ETP updated successfully",summary:"ETP Updated"},400:{description:"Invalid input data or ETP ID format",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:f.object({message:f.string()})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:f.object({message:f.string()})}}},409:{description:"ETP with this code already exists",summary:"Conflict",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},Es={method:"delete",path:"/etp/{id}",tags:["ETPs"],summary:"Delete ETP",security:[{bearerAuth:[]}],request:{params:oi},responses:{200:{description:"ETP deleted successfully",summary:"ETP Deleted"},400:{description:"Invalid ETP ID format",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:f.object({message:f.string()})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}};import{InMemoriamRole as ed}from"@prisma/client";import w from"zod";import{extendZodWithOpenApi as Np}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as kp}from"@prisma/client";import Re from"zod";var xs=2,js=1024,Lp=js*js,Hp=xs*Lp;Np(Re);var ai=Re.object({name:Re.string().min(1,"Nome \xE9 obrigat\xF3rio"),birthDate:Re.coerce.date(),deathDate:Re.coerce.date(),biography:Re.string().optional(),photo:Re.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Hp,`A imagem deve ter no m\xE1ximo ${xs}MB.`).optional(),role:Re.enum(kp)}).refine(o=>o.deathDate>o.birthDate,{message:"Data de falecimento deve ser posterior \xE0 data de nascimento",path:["deathDate"]}),Vt=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{name:t,birthDate:i,deathDate:n,biography:s,role:m,photo:c}=ai.parse({...e.body,photo:e.file}),u=await this.inMemoriamRepository.create({name:t,birthDate:i,deathDate:n,biography:s??void 0,role:m}),P;return c&&(P=await this.firebaseStorageService.uploadFile({file:c,id:u.id,folder:O.IN_MEMORIAM}),await this.inMemoriamRepository.update({id:u.id,photoUrl:P})),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as _p}from"@asteasolutions/zod-to-openapi";import mi from"zod";_p(mi);var ci=mi.object({id:mi.uuid()}),Gt=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=ci.parse({id:e.params.id}),i=await this.inMemoriamRepository.findById(t);if(!i)throw new d("O in memoriam n\xE3o existe.");return i.photoUrl&&this.firebaseStorageService.deleteFile({fileUrl:i.photoUrl}),await this.inMemoriamRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as zp}from"@asteasolutions/zod-to-openapi";import pi from"zod";zp(pi);var Yt=pi.object({id:pi.uuid()}),Kt=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{id:t}=Yt.parse({id:e.params.id}),i=await this.inMemoriamRepository.findById(t);if(!i)throw new d("O in memoriam n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Wp}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as Zp}from"@prisma/client";import di from"zod";Wp(di);var ui=di.object({role:di.enum(Zp)}),$t=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{role:t}=ui.parse({role:e.params.role}),i=await this.inMemoriamRepository.findByRole(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Vp}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as Gp}from"@prisma/client";import Ie from"zod";var Kp=1,Yp=9;Vp(Ie);var li=Ie.object({page:Ie.coerce.number().min(1).default(Kp),limit:Ie.coerce.number().min(1).default(Yp),name:Ie.string().optional(),biography:Ie.string().optional(),role:Ie.enum(Gp).optional(),orderBy:Ie.enum(["asc","desc"]).default("desc")}),Xt=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=li.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.inMemoriamRepository.find({pagination:{offset:s,limit:i},filter:n}),this.inMemoriamRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:s,limit:i,inMemoriam:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as $p}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as Xp}from"@prisma/client";import me from"zod";var Ps=2,Ts=1024,Jp=Ts*Ts,Qp=Ps*Jp;$p(me);var gi=me.object({id:me.uuid(),name:me.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),birthDate:me.coerce.date().optional(),deathDate:me.coerce.date().optional(),biography:me.string().optional(),photo:me.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Qp,`A imagem deve ter no m\xE1ximo ${Ps}MB.`).optional(),role:me.enum(Xp).optional()}).refine(o=>o.birthDate&&o.deathDate?o.deathDate>o.birthDate:!0,{message:"Data de falecimento deve ser posterior \xE0 data de nascimento",path:["deathDate"]}),Jt=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,birthDate:n,deathDate:s,biography:m,photo:c,role:u}=gi.parse({id:e.params.id,...e.body,photo:e.file}),P=await this.inMemoriamRepository.findById(t);if(!P)throw new d("O registro in memoriam n\xE3o existe.");let D=P.photoUrl;return c&&(D=await this.firebaseStorageService.uploadFile({file:c,id:t,folder:O.IN_MEMORIAM})),await this.inMemoriamRepository.update({id:t,name:i,birthDate:n,deathDate:s,biography:m,photoUrl:D??void 0,role:u}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var fi=w.object({id:w.uuid(),name:w.string(),birthDate:w.date(),deathDate:w.date(),biography:w.string().nullable(),photoUrl:w.string().nullable(),role:w.enum(ed),createdAt:w.date(),updatedAt:w.date()}),As={method:"post",path:"/in-memoriam",tags:["In Memoriam"],summary:"Create a new in memoriam record with optional photo upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:ai}}}},responses:{201:{description:"In memoriam record created successfully",summary:"In Memoriam Created"},400:{description:"Invalid input data, missing required fields, or invalid photo format/size",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:w.object({message:w.string()})}}},409:{description:"In memoriam record with this name already exists",summary:"Conflict",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},Us={method:"get",path:"/in-memoriam",tags:["In Memoriam"],summary:"List all in memoriam records with pagination and filters",request:{query:li},responses:{200:{description:"List of in memoriam records retrieved successfully with pagination",summary:"In Memoriam Records Retrieved",content:{"application/json":{schema:w.object({page:w.number(),totalPages:w.number(),offset:w.number(),limit:w.number(),inMemoriam:w.array(fi)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},Ds={method:"get",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Find in memoriam record by ID",request:{params:Yt},responses:{200:{description:"In memoriam record details retrieved successfully",summary:"In Memoriam Record Retrieved",content:{"application/json":{schema:fi}}},400:{description:"Invalid in memoriam record ID format",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},qs={method:"put",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Update in memoriam record with optional photo upload",security:[{bearerAuth:[]}],request:{params:Yt,body:{content:{"multipart/form-data":{schema:gi.omit({id:!0})}}}},responses:{200:{description:"In memoriam record updated successfully",summary:"In Memoriam Record Updated"},400:{description:"Invalid input data, in memoriam record ID format, or invalid photo format/size",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:w.object({message:w.string()})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},409:{description:"In memoriam record with this name already exists",summary:"Conflict",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},Fs={method:"delete",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Delete in memoriam record",security:[{bearerAuth:[]}],request:{params:ci},responses:{200:{description:"In memoriam record deleted successfully",summary:"In Memoriam Record Deleted"},400:{description:"Invalid in memoriam record ID format",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:w.object({message:w.string()})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},_h={method:"get",path:"/in-memoriam/role/{role}",tags:["In Memoriam"],summary:"Find in memoriam records by role",request:{params:ui},responses:{200:{description:"In memoriam records retrieved successfully by role",summary:"In Memoriam Records Retrieved by Role",content:{"application/json":{schema:w.array(fi)}}},400:{description:"Invalid role parameter provided",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}};import A from"zod";import{extendZodWithOpenApi as td}from"@asteasolutions/zod-to-openapi";import ft from"zod";td(ft);var Bs=ft.object({imageUrl:ft.url("URL da imagem deve ser uma URL v\xE1lida"),caption:ft.string().optional(),congressId:ft.uuid()});import{extendZodWithOpenApi as rd}from"@asteasolutions/zod-to-openapi";import yi from"zod";rd(yi);var hi=yi.object({id:yi.uuid()});import{extendZodWithOpenApi as od}from"@asteasolutions/zod-to-openapi";import Ri from"zod";od(Ri);var Os=Ri.object({congressId:Ri.uuid()});import{extendZodWithOpenApi as id}from"@asteasolutions/zod-to-openapi";import yt from"zod";id(yt);var Ns=yt.object({id:yt.uuid(),imageUrl:yt.string().url("URL da imagem deve ser uma URL v\xE1lida").optional(),caption:yt.string().optional()});var nd=A.object({id:A.uuid(),imageUrl:A.string(),caption:A.string().nullable(),congressId:A.uuid()}),ks={method:"post",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congresses"],summary:"Create a new congress gallery image",security:[{bearerAuth:[]}],request:{params:A.object({congressId:A.uuid()}),body:{content:{"application/json":{schema:Bs.omit({congressId:!0})}}}},responses:{201:{description:"Congress gallery image created successfully",summary:"Congress Gallery Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:A.object({message:A.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},Ls={method:"get",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congresses"],summary:"Find congress gallery images by congress ID",request:{params:Os},responses:{200:{description:"Congress gallery images retrieved successfully by congress ID",summary:"Congress Galleries Retrieved",content:{"application/json":{schema:A.array(nd)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},Hs={method:"put",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congresses"],summary:"Update congress gallery image",security:[{bearerAuth:[]}],request:{params:hi,body:{content:{"application/json":{schema:Ns.omit({id:!0})}}}},responses:{200:{description:"Congress gallery image updated successfully",summary:"Congress Gallery Updated"},400:{description:"Invalid input data or gallery ID format",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:A.object({message:A.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},_s={method:"delete",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congresses"],summary:"Delete congress gallery image",security:[{bearerAuth:[]}],request:{params:hi},responses:{200:{description:"Congress gallery image deleted successfully",summary:"Congress Gallery Deleted"},400:{description:"Invalid gallery ID format",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:A.object({message:A.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}};import U from"zod";import{extendZodWithOpenApi as sd}from"@asteasolutions/zod-to-openapi";import tt from"zod";sd(tt);var zs=tt.object({name:tt.string().min(1,"Nome \xE9 obrigat\xF3rio"),logoUrl:tt.string().url("Logo deve ser uma URL v\xE1lida").optional().or(tt.literal("")),congressId:tt.uuid()});import{extendZodWithOpenApi as ad}from"@asteasolutions/zod-to-openapi";import Ii from"zod";ad(Ii);var bi=Ii.object({id:Ii.uuid()});import{extendZodWithOpenApi as md}from"@asteasolutions/zod-to-openapi";import wi from"zod";md(wi);var Ws=wi.object({congressId:wi.uuid()});import{extendZodWithOpenApi as cd}from"@asteasolutions/zod-to-openapi";import rt from"zod";cd(rt);var Zs=rt.object({id:rt.uuid(),name:rt.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),logoUrl:rt.string().url("Logo deve ser uma URL v\xE1lida").optional().or(rt.literal(""))});var pd=U.object({id:U.uuid(),name:U.string(),logoUrl:U.string().nullable(),congressId:U.uuid()}),Vs={method:"post",path:"/international-scientific-congress/{congressId}/partner",tags:["International Scientific Congresses"],summary:"Create a new congress partner",security:[{bearerAuth:[]}],request:{params:U.object({congressId:U.uuid()}),body:{content:{"application/json":{schema:zs.omit({congressId:!0})}}}},responses:{201:{description:"Congress partner created successfully",summary:"Congress Partner Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:U.object({errors:U.record(U.string(),U.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:U.object({message:U.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:U.object({message:U.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:U.object({message:U.string()})}}}}},Gs={method:"get",path:"/international-scientific-congress/{congressId}/partner",tags:["International Scientific Congresses"],summary:"Find congress partners by congress ID",request:{params:Ws},responses:{200:{description:"Congress partners retrieved successfully by congress ID",summary:"Congress Partners Retrieved",content:{"application/json":{schema:U.array(pd)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:U.object({errors:U.record(U.string(),U.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:U.object({message:U.string()})}}}}},Ks={method:"put",path:"/international-scientific-congress/partner/{id}",tags:["International Scientific Congresses"],summary:"Update congress partner",security:[{bearerAuth:[]}],request:{params:bi,body:{content:{"application/json":{schema:Zs.omit({id:!0})}}}},responses:{200:{description:"Congress partner updated successfully",summary:"Congress Partner Updated"},400:{description:"Invalid input data or partner ID format",summary:"Validation Error",content:{"application/json":{schema:U.object({errors:U.record(U.string(),U.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:U.object({message:U.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:U.object({message:U.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:U.object({message:U.string()})}}}}},Ys={method:"delete",path:"/international-scientific-congress/partner/{id}",tags:["International Scientific Congresses"],summary:"Delete congress partner",security:[{bearerAuth:[]}],request:{params:bi},responses:{200:{description:"Congress partner deleted successfully",summary:"Congress Partner Deleted"},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:U.object({errors:U.record(U.string(),U.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:U.object({message:U.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:U.object({message:U.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:U.object({message:U.string()})}}}}};import h from"zod";import{extendZodWithOpenApi as dd}from"@asteasolutions/zod-to-openapi";import _ from"zod";dd(_);var Ci=_.object({title:_.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),edition:_.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo"),startDate:_.coerce.date(),endDate:_.coerce.date(),description:_.string().optional(),location:_.string().optional(),congressLink:_.url("Link do congresso deve ser uma URL v\xE1lida").optional().or(_.literal("")),noticeUrl:_.url("URL do edital deve ser uma URL v\xE1lida").optional().or(_.literal("")),scheduleUrl:_.url("URL do cronograma deve ser uma URL v\xE1lida").optional().or(_.literal("")),programUrl:_.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida").optional().or(_.literal("")),adminReportUrl:_.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida").optional().or(_.literal("")),proceedingsUrl:_.url("URL dos anais deve ser uma URL v\xE1lida").optional().or(_.literal(""))}).refine(o=>o.endDate>=o.startDate,{message:"Data de t\xE9rmino deve ser posterior ou igual \xE0 data de in\xEDcio",path:["endDate"]}),Qt=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let t=Ci.parse(e.body);return await this.internationalScientificCongressRepository.create(t),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ud}from"@asteasolutions/zod-to-openapi";import Si from"zod";ud(Si);var vi=Si.object({id:Si.uuid()}),er=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t}=vi.parse({id:e.params.id});if(!await this.internationalScientificCongressRepository.findById(t))throw new d("O congresso n\xE3o existe.");return await this.internationalScientificCongressRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ld}from"@asteasolutions/zod-to-openapi";import Mi from"zod";ld(Mi);var Ei=Mi.object({edition:Mi.coerce.number().int().positive()}),tr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{edition:t}=Ei.parse({edition:e.params.edition}),i=await this.internationalScientificCongressRepository.findByEdition(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as gd}from"@asteasolutions/zod-to-openapi";import ji from"zod";gd(ji);var or=ji.object({id:ji.uuid()}),rr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t}=or.parse({id:e.params.id}),i=await this.internationalScientificCongressRepository.findById(t);if(!i)throw new d("O congresso n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as fd}from"@asteasolutions/zod-to-openapi";import Fe from"zod";var yd=1,hd=10;fd(Fe);var xi=Fe.object({page:Fe.coerce.number().min(1).default(yd),limit:Fe.coerce.number().min(1).default(hd),title:Fe.string().optional(),edition:Fe.coerce.number().int().positive().optional(),orderBy:Fe.enum(["asc","desc"]).optional()}),ir=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=xi.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.internationalScientificCongressRepository.find({pagination:{offset:s,limit:i},filter:n}),this.internationalScientificCongressRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:s,limit:i,congresses:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Rd}from"@asteasolutions/zod-to-openapi";import H from"zod";Rd(H);var Ti=H.object({id:H.uuid(),title:H.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),edition:H.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo").optional(),startDate:H.coerce.date().optional(),endDate:H.coerce.date().optional(),description:H.string().optional(),location:H.string().optional(),congressLink:H.url("Link do congresso deve ser uma URL v\xE1lida").optional().or(H.literal("")),noticeUrl:H.url("URL do edital deve ser uma URL v\xE1lida").optional().or(H.literal("")),scheduleUrl:H.url("URL do cronograma deve ser uma URL v\xE1lida").optional().or(H.literal("")),programUrl:H.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida").optional().or(H.literal("")),adminReportUrl:H.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida").optional().or(H.literal("")),proceedingsUrl:H.url("URL dos anais deve ser uma URL v\xE1lida").optional().or(H.literal(""))}),nr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t,...i}=Ti.parse({id:e.params.id,...e.body});if(!await this.internationalScientificCongressRepository.findById(t))throw new d("O congresso n\xE3o existe.");return await this.internationalScientificCongressRepository.update({...i,id:t}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Id=h.object({id:h.uuid(),name:h.string(),logoUrl:h.string().nullable(),congressId:h.uuid()}),bd=h.object({id:h.uuid(),imageUrl:h.string(),caption:h.string().nullable(),congressId:h.uuid()}),Pi=h.object({id:h.uuid(),title:h.string(),edition:h.number(),startDate:h.date(),endDate:h.date(),description:h.string().nullable(),location:h.string().nullable(),congressLink:h.string().nullable(),noticeUrl:h.string().nullable(),scheduleUrl:h.string().nullable(),programUrl:h.string().nullable(),adminReportUrl:h.string().nullable(),proceedingsUrl:h.string().nullable(),partners:h.array(Id),galleries:h.array(bd),createdAt:h.date(),updatedAt:h.date()}),$s={method:"post",path:"/international-scientific-congress",tags:["International Scientific Congresses"],summary:"Create a new international scientific congress",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Ci}}}},responses:{201:{description:"International scientific congress created successfully",summary:"International Scientific Congress Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},Xs={method:"get",path:"/international-scientific-congress",tags:["International Scientific Congresses"],summary:"List all international scientific congresses with pagination and filters",request:{query:xi},responses:{200:{description:"List of international scientific congresses retrieved successfully with pagination",summary:"International Scientific Congresses Retrieved",content:{"application/json":{schema:h.object({page:h.number(),totalPages:h.number(),offset:h.number(),limit:h.number(),congresses:h.array(Pi)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},Js={method:"get",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Find international scientific congress by ID",request:{params:or},responses:{200:{description:"International scientific congress details retrieved successfully",summary:"International Scientific Congress Retrieved",content:{"application/json":{schema:Pi}}},400:{description:"Invalid international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},Qs={method:"get",path:"/international-scientific-congress/edition/{edition}",tags:["International Scientific Congresses"],summary:"Find international scientific congresses by edition",request:{params:Ei},responses:{200:{description:"International scientific congresses retrieved successfully by edition",summary:"International Scientific Congresses Retrieved by Edition",content:{"application/json":{schema:h.array(Pi)}}},400:{description:"Invalid edition parameter provided",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},ea={method:"put",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Update international scientific congress",security:[{bearerAuth:[]}],request:{params:or,body:{content:{"application/json":{schema:Ti.omit({id:!0})}}}},responses:{200:{description:"International scientific congress updated successfully",summary:"International Scientific Congress Updated"},400:{description:"Invalid input data or international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}},ta={method:"delete",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Delete international scientific congress",security:[{bearerAuth:[]}],request:{params:vi},responses:{200:{description:"International scientific congress deleted successfully",summary:"International Scientific Congress Deleted"},400:{description:"Invalid international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:h.object({errors:h.record(h.string(),h.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:h.object({message:h.string()})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:h.object({message:h.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:h.object({message:h.string()})}}}}};import{$Enums as Md}from"@prisma/client";import E from"zod";import{extendZodWithOpenApi as wd}from"@asteasolutions/zod-to-openapi";import ot from"zod";wd(ot);var Ai=ot.object({role:ot.string().min(1),description:ot.string().optional(),userId:ot.uuid(),order:ot.number().optional()}),sr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{role:t,description:i,userId:n,order:s}=Ai.parse(e.body);return await this.legitimatorCommitteeMemberRepository.create({role:t,description:i,userId:n,order:s??0}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Cd}from"@asteasolutions/zod-to-openapi";import Ui from"zod";Cd(Ui);var Di=Ui.object({id:Ui.uuid()}),ar=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t}=Di.parse({id:e.params.id});if(!await this.legitimatorCommitteeMemberRepository.findById(t))throw new d("O membro do comit\xEA legitimador n\xE3o existe.");return await this.legitimatorCommitteeMemberRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Sd}from"@asteasolutions/zod-to-openapi";import qi from"zod";Sd(qi);var cr=qi.object({id:qi.uuid()}),mr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t}=cr.parse({id:e.params.id}),i=await this.legitimatorCommitteeMemberRepository.findById(t);if(!i)throw new d("O membro do comit\xEA legitimador n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as vd}from"@asteasolutions/zod-to-openapi";import Be from"zod";vd(Be);var Fi=Be.object({id:Be.uuid(),role:Be.string().min(1).optional(),description:Be.string().optional(),userId:Be.uuid().optional(),order:Be.number().optional()}),pr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t,role:i,description:n,userId:s,order:m}=Fi.parse({id:e.params.id,...e.body});if(!await this.legitimatorCommitteeMemberRepository.findById(t))throw new d("O membro do comit\xEA legitimador n\xE3o existe.");return await this.legitimatorCommitteeMemberRepository.update({id:t,role:i,description:n,userId:s,order:m}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Ed=E.object({id:E.uuid(),name:E.string(),emailAddress:E.string(),avatarUrl:E.string().nullable(),orcid:E.string().nullable(),phone:E.string().nullable(),lattesUrl:E.string().nullable(),role:E.enum(Md.UserRole)}),ra=E.object({id:E.uuid(),role:E.string(),description:E.string().nullable(),order:E.number(),createdAt:E.date(),updatedAt:E.date(),userId:E.uuid(),user:Ed}),oa={method:"post",path:"/legitimator-committee-member",tags:["Legitimator Committee Members"],summary:"Create a new Legitimator Committee Member",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Ai}}}},responses:{201:{description:"Legitimator Committee Member created successfully",summary:"Legitimator Committee Member Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},ia={method:"get",path:"/legitimator-committee-member",tags:["Legitimator Committee Members"],summary:"List all Legitimator Committee Members with filters",request:{query:E.object({role:E.string().optional(),orderBy:E.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of Legitimator Committee Members retrieved successfully",summary:"Legitimator Committee Members Retrieved",content:{"application/json":{schema:E.object({members:E.array(ra)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},na={method:"get",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Find Legitimator Committee Member by ID",request:{params:cr},responses:{200:{description:"Legitimator Committee Member details retrieved successfully",summary:"Legitimator Committee Member Retrieved",content:{"application/json":{schema:ra}}},400:{description:"Invalid Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},sa={method:"put",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Update Legitimator Committee Member",security:[{bearerAuth:[]}],request:{params:cr,body:{content:{"application/json":{schema:Fi.omit({id:!0})}}}},responses:{200:{description:"Legitimator Committee Member updated successfully",summary:"Legitimator Committee Member Updated"},400:{description:"Invalid input data or Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:E.object({message:E.string()})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},aa={method:"delete",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Delete Legitimator Committee Member",security:[{bearerAuth:[]}],request:{params:Di},responses:{200:{description:"Legitimator Committee Member deleted successfully",summary:"Legitimator Committee Member Deleted"},400:{description:"Invalid Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:E.object({message:E.string()})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}};import{$Enums as Ad}from"@prisma/client";import b from"zod";import{extendZodWithOpenApi as jd}from"@asteasolutions/zod-to-openapi";import ce from"zod";jd(ce);var Bi=ce.object({name:ce.string().min(1),description:ce.string().optional(),members:ce.array(ce.object({userId:ce.uuid(),role:ce.string().min(1),order:ce.number().optional()}))}),dr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{name:t,description:i,members:n}=Bi.parse(e.body);if(await this.managementTeamRepository.findByName(t))throw new z("J\xE1 existe um time de gest\xE3o cadastrado com este nome.");return await this.managementTeamRepository.create({name:t,description:i,members:n.map(m=>({userId:m.userId,role:m.role,order:m.order??0}))}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as xd}from"@asteasolutions/zod-to-openapi";import Oi from"zod";xd(Oi);var Ni=Oi.object({id:Oi.uuid()}),ur=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t}=Ni.parse({id:e.params.id});if(!await this.managementTeamRepository.findById(t))throw new d("O time de gest\xE3o n\xE3o existe.");return await this.managementTeamRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Td}from"@asteasolutions/zod-to-openapi";import ki from"zod";Td(ki);var gr=ki.object({id:ki.uuid()}),lr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t}=gr.parse({id:e.params.id}),i=await this.managementTeamRepository.findById(t);if(!i)throw new d("O time de gest\xE3o n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Pd}from"@asteasolutions/zod-to-openapi";import ie from"zod";Pd(ie);var Li=ie.object({id:ie.uuid(),name:ie.string().min(1).optional(),description:ie.string().optional(),members:ie.array(ie.object({userId:ie.uuid(),role:ie.string().min(1),order:ie.number().optional()})).optional()}),fr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t,name:i,description:n,members:s}=Li.parse({id:e.params.id,...e.body}),m=await this.managementTeamRepository.findById(t);if(!m)throw new d("O time de gest\xE3o n\xE3o existe.");if(i&&i!==m.name){let c=await this.managementTeamRepository.findByName(i);if(c&&c.id!==t)throw new z("J\xE1 existe um time de gest\xE3o com este nome.")}return await this.managementTeamRepository.update({id:t,name:i,description:n,members:s?s.map(c=>({userId:c.userId,role:c.role,order:c.order??0})):void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Ud=b.object({id:b.uuid(),name:b.string(),emailAddress:b.string(),avatarUrl:b.string().nullable(),orcid:b.string().nullable(),phone:b.string().nullable(),lattesUrl:b.string().nullable(),role:b.enum(Ad.UserRole)}),Dd=b.object({id:b.uuid(),role:b.string(),description:b.string().nullable(),order:b.number(),teamId:b.uuid(),userId:b.uuid(),createdAt:b.date(),updatedAt:b.date(),user:Ud}),ma=b.object({id:b.uuid(),name:b.string(),description:b.string().nullable(),createdAt:b.date(),updatedAt:b.date(),members:b.array(Dd)}),ca={method:"post",path:"/management-team",tags:["Management Teams"],summary:"Create a new Management Team with multiple members",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Bi}}}},responses:{201:{description:"Management Team created successfully",summary:"Management Team Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},409:{description:"Management Team with this name already exists",summary:"Conflict",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},pa={method:"get",path:"/management-team",tags:["Management Teams"],summary:"List all Management Teams with filters",request:{query:b.object({name:b.string().optional(),description:b.string().optional(),orderBy:b.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of Management Teams retrieved successfully",summary:"Management Teams Retrieved",content:{"application/json":{schema:b.object({teams:b.array(ma)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},da={method:"get",path:"/management-team/{id}",tags:["Management Teams"],summary:"Find Management Team by ID",request:{params:gr},responses:{200:{description:"Management Team details retrieved successfully",summary:"Management Team Retrieved",content:{"application/json":{schema:ma}}},400:{description:"Invalid Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},ua={method:"put",path:"/management-team/{id}",tags:["Management Teams"],summary:"Update Management Team and manage member relationships",security:[{bearerAuth:[]}],request:{params:gr,body:{content:{"application/json":{schema:Li.omit({id:!0})}}}},responses:{200:{description:"Management Team updated successfully",summary:"Management Team Updated"},400:{description:"Invalid input data or Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},409:{description:"Management Team with this name already exists",summary:"Conflict",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},la={method:"delete",path:"/management-team/{id}",tags:["Management Teams"],summary:"Delete Management Team",security:[{bearerAuth:[]}],request:{params:Ni},responses:{200:{description:"Management Team deleted successfully",summary:"Management Team Deleted"},400:{description:"Invalid Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}};import{MeetingFormat as Hd,MeetingStatus as _d}from"@prisma/client";import x from"zod";import{extendZodWithOpenApi as qd}from"@asteasolutions/zod-to-openapi";import it from"zod";var fa=10,ga=1024,Fd=ga*ga,Bd=fa*Fd;qd(it);var Hi=it.object({title:it.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),publishedAt:it.coerce.date(),meetingId:it.uuid(),document:it.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=Bd,`O documento deve ter no m\xE1ximo ${fa}MB.`)}),yr=class{constructor(e,r,t){this.meetingMinuteRepository=e;this.meetingRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{title:t,publishedAt:i,meetingId:n,document:s}=Hi.parse({...e.body,...e.params,document:e.file});if(!await this.meetingRepository.findById(n))throw new d("A reuni\xE3o n\xE3o existe.");if(await this.meetingMinuteRepository.findByMeetingId(n))throw new a("Esta reuni\xE3o j\xE1 possui uma ata.");let u=await this.meetingMinuteRepository.create({title:t,publishedAt:i,meetingId:n,documentUrl:""}),P=await this.firebaseStorageService.uploadFile({file:s,id:u.id,folder:O.MEETING_MINUTE});return await this.meetingMinuteRepository.update({id:u.id,documentUrl:P}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Od}from"@asteasolutions/zod-to-openapi";import _i from"zod";Od(_i);var ht=_i.object({meetingId:_i.uuid()}),hr=class{constructor(e){this.meetingMinuteRepository=e}async handle(e,r){try{let{meetingId:t}=ht.parse({meetingId:e.params.meetingId}),i=await this.meetingMinuteRepository.findByMeetingId(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Nd}from"@asteasolutions/zod-to-openapi";import nt from"zod";var ha=10,ya=1024,kd=ya*ya,Ld=ha*kd;Nd(nt);var zi=nt.object({meetingId:nt.uuid(),title:nt.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),publishedAt:nt.coerce.date().optional(),document:nt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Ld,`O documento deve ter no m\xE1ximo ${ha}MB.`).optional()}),Rr=class{constructor(e,r){this.meetingMinuteRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{meetingId:t,title:i,publishedAt:n,document:s}=zi.parse({meetingId:e.params.meetingId,...e.body,document:e.file}),m=await this.meetingMinuteRepository.findByMeetingId(t);if(!m)throw new d("A ata n\xE3o existe para esta reuni\xE3o.");let c=m.documentUrl;return s&&(m.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:m.documentUrl}),c=await this.firebaseStorageService.uploadFile({file:s,id:m.id,folder:O.MEETING_MINUTE})),await this.meetingMinuteRepository.update({id:m.id,title:i,publishedAt:n,documentUrl:c??void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var zd=x.object({id:x.uuid(),title:x.string(),scheduledAt:x.date(),format:x.enum(Hd),agenda:x.string(),meetingLink:x.string().nullable(),location:x.string().nullable(),status:x.enum(_d),createdAt:x.date(),updatedAt:x.date()}),Wd=x.object({id:x.uuid(),title:x.string(),publishedAt:x.date(),documentUrl:x.string(),meetingId:x.uuid(),meeting:zd,createdAt:x.date(),updatedAt:x.date()}),Ra={method:"post",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Create a new meeting minute with document upload",security:[{bearerAuth:[]}],request:{params:x.object({meetingId:x.uuid()}),body:{content:{"multipart/form-data":{schema:Hi.omit({meetingId:!0})}}}},responses:{201:{description:"Meeting minute created successfully",summary:"Meeting Minute Created"},400:{description:"Invalid input data, missing required fields, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:x.object({message:x.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},409:{description:"Meeting already has a minute",summary:"Conflict",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Ia={method:"get",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Find meeting minute by meeting ID",request:{params:ht},responses:{200:{description:"Meeting minute retrieved successfully by meeting ID",summary:"Meeting Minute Retrieved by Meeting ID",content:{"application/json":{schema:Wd.nullable()}}},400:{description:"Invalid meeting ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},ba={method:"put",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Update meeting minute with optional document upload",security:[{bearerAuth:[]}],request:{params:ht,body:{content:{"multipart/form-data":{schema:zi.omit({meetingId:!0})}}}},responses:{200:{description:"Meeting minute updated successfully",summary:"Meeting Minute Updated"},400:{description:"Invalid input data, meeting minute ID format, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:x.object({message:x.string()})}}},404:{description:"Meeting minute not found with the provided ID",summary:"Meeting Minute Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},wa={method:"delete",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Delete meeting minute",security:[{bearerAuth:[]}],request:{params:ht},responses:{200:{description:"Meeting minute deleted successfully",summary:"Meeting Minute Deleted"},400:{description:"Invalid meeting minute ID format",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:x.object({message:x.string()})}}},404:{description:"Meeting minute not found with the provided ID",summary:"Meeting Minute Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}};import{MeetingFormat as iu,MeetingStatus as nu}from"@prisma/client";import R from"zod";import{extendZodWithOpenApi as Zd}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as Ir,MeetingStatus as Wi}from"@prisma/client";import ne from"zod";Zd(ne);var Zi=ne.object({title:ne.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),scheduledAt:ne.coerce.date(),format:ne.enum(Ir).default(Ir.ONLINE),agenda:ne.string().min(1,"Pauta \xE9 obrigat\xF3ria"),meetingLink:ne.string().url("Link da reuni\xE3o deve ser uma URL v\xE1lida").optional().or(ne.literal("")),location:ne.string().optional(),status:ne.enum(Wi).default(Wi.PENDING)}).refine(o=>o.format===Ir.ONLINE?!!o.meetingLink:o.format===Ir.IN_PERSON?!!o.location:!0,{message:"Reuni\xF5es online devem ter link e reuni\xF5es presenciais devem ter localiza\xE7\xE3o",path:["format"]}),br=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{title:t,scheduledAt:i,format:n,agenda:s,meetingLink:m,location:c,status:u}=Zi.parse(e.body);return await this.meetingRepository.create({title:t,scheduledAt:i,format:n,agenda:s,meetingLink:m||void 0,location:c||void 0,status:u??Wi.PENDING}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Vd}from"@asteasolutions/zod-to-openapi";import Vi from"zod";Vd(Vi);var Gi=Vi.object({id:Vi.uuid()}),wr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t}=Gi.parse({id:e.params.id});if(!await this.meetingRepository.findById(t))throw new d("A reuni\xE3o n\xE3o existe.");return await this.meetingRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Gd}from"@asteasolutions/zod-to-openapi";import Ki from"zod";Gd(Ki);var Sr=Ki.object({id:Ki.uuid()}),Cr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t}=Sr.parse({id:e.params.id}),i=await this.meetingRepository.findById(t);if(!i)throw new d("A reuni\xE3o n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Kd}from"@asteasolutions/zod-to-openapi";import{MeetingStatus as Yd}from"@prisma/client";import Yi from"zod";Kd(Yi);var $i=Yi.object({status:Yi.enum(Yd)}),vr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{status:t}=$i.parse({status:e.params.status}),i=await this.meetingRepository.findByStatus(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as $d}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as Xd,MeetingStatus as Jd}from"@prisma/client";import be from"zod";var Qd=1,eu=10;$d(be);var Xi=be.object({page:be.coerce.number().min(1).default(Qd),limit:be.coerce.number().min(1).default(eu),title:be.string().optional(),format:be.enum(Xd).optional(),status:be.enum(Jd).optional(),orderBy:be.enum(["asc","desc"]).optional()}),Mr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Xi.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.meetingRepository.find({pagination:{offset:s,limit:i},filter:n}),this.meetingRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:s,limit:i,meetings:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as tu}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as ru,MeetingStatus as ou}from"@prisma/client";import re from"zod";tu(re);var Ji=re.object({id:re.uuid(),title:re.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),scheduledAt:re.coerce.date().optional(),format:re.enum(ru).optional(),agenda:re.string().min(1,"Pauta \xE9 obrigat\xF3ria").optional(),meetingLink:re.string().url("Link da reuni\xE3o deve ser uma URL v\xE1lida").optional().or(re.literal("")),location:re.string().optional(),status:re.enum(ou).optional()}),Er=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t,title:i,scheduledAt:n,format:s,agenda:m,meetingLink:c,location:u,status:P}=Ji.parse({id:e.params.id,...e.body});if(!await this.meetingRepository.findById(t))throw new d("A reuni\xE3o n\xE3o existe.");return await this.meetingRepository.update({id:t,title:i,scheduledAt:n,format:s,agenda:m,meetingLink:c||void 0,location:u||void 0,status:P}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var su=R.object({id:R.uuid(),title:R.string(),publishedAt:R.date(),documentUrl:R.string(),meetingId:R.uuid(),createdAt:R.date(),updatedAt:R.date()}),Qi=R.object({id:R.uuid(),title:R.string(),scheduledAt:R.date(),format:R.enum(iu),agenda:R.string(),meetingLink:R.string().nullable(),location:R.string().nullable(),status:R.enum(nu),minutes:su.nullable(),createdAt:R.date(),updatedAt:R.date()}),Ca={method:"post",path:"/meeting",tags:["Meetings"],summary:"Create a new meeting",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Zi}}}},responses:{201:{description:"Meeting created successfully",summary:"Meeting Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},Sa={method:"get",path:"/meeting",tags:["Meetings"],summary:"List all meetings with pagination and filters",request:{query:Xi},responses:{200:{description:"List of meetings retrieved successfully with pagination",summary:"Meetings Retrieved",content:{"application/json":{schema:R.object({page:R.number(),totalPages:R.number(),offset:R.number(),limit:R.number(),meetings:R.array(Qi)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},va={method:"get",path:"/meeting/{id}",tags:["Meetings"],summary:"Find meeting by ID",request:{params:Sr},responses:{200:{description:"Meeting details retrieved successfully",summary:"Meeting Retrieved",content:{"application/json":{schema:Qi}}},400:{description:"Invalid meeting ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},Ma={method:"get",path:"/meeting/status/{status}",tags:["Meetings"],summary:"Find meetings by status",request:{params:$i},responses:{200:{description:"Meetings retrieved successfully by status",summary:"Meetings Retrieved by Status",content:{"application/json":{schema:R.array(Qi)}}},400:{description:"Invalid status parameter provided",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},Ea={method:"put",path:"/meeting/{id}",tags:["Meetings"],summary:"Update meeting",security:[{bearerAuth:[]}],request:{params:Sr,body:{content:{"application/json":{schema:Ji.omit({id:!0})}}}},responses:{200:{description:"Meeting updated successfully",summary:"Meeting Updated"},400:{description:"Invalid input data or meeting ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},ja={method:"delete",path:"/meeting/{id}",tags:["Meetings"],summary:"Delete meeting",security:[{bearerAuth:[]}],request:{params:Gi},responses:{200:{description:"Meeting deleted successfully",summary:"Meeting Deleted"},400:{description:"Invalid meeting ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}};import C from"zod";import{extendZodWithOpenApi as au}from"@asteasolutions/zod-to-openapi";import Rt from"zod";var mu=5,xa=1024,cu=xa*xa,pu=mu*cu;au(Rt);var en=Rt.object({title:Rt.string().min(1),content:Rt.string().min(1),image:Rt.any().refine(o=>!o||typeof o=="object"&&typeof o.mimetype=="string"&&o.mimetype.startsWith("image/")&&typeof o.size=="number"&&o.size<=pu,{message:"A imagem deve ser uma imagem v\xE1lida de no m\xE1ximo 5MB."})}),jr=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{title:t,content:i,image:n}=en.parse({...e.body,image:e.file}),s=e.user.id,m=await this.firebaseStorageService.uploadFile({file:n,folder:O.NEWS,id:s});await this.newsRepository.create({title:t,content:i,authorId:s,imageUrl:m}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as du}from"@asteasolutions/zod-to-openapi";import we from"zod";var uu=1,lu=7;du(we);var Tr=we.object({page:we.coerce.number().min(1).default(uu),limit:we.coerce.number().min(1).default(lu),authorId:we.string(),title:we.string().optional(),content:we.string().optional(),orderBy:we.enum(["asc","desc"]).default("desc")}),xr=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,authorId:n,...s}=Tr.parse(e.query),m=i*t-i,[c,u]=await Promise.all([this.newsRepository.findByAuthorId({authorId:n,pagination:{offset:m,limit:i},filter:s}),this.newsRepository.count({filter:{authorId:n,...s}})]),P=Math.max(Math.ceil(u/i),1);r.status(200).json({page:t,totalPages:P,offset:m,limit:i,news:c})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as gu}from"@asteasolutions/zod-to-openapi";import tn from"zod";gu(tn);var rn=tn.object({id:tn.string()}),Pr=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{id:t}=rn.parse(e.params),i=await this.newsRepository.findById(t);if(!i)throw new d("Not\xEDcia n\xE3o encontrada.");r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as fu}from"@asteasolutions/zod-to-openapi";import Ce from"zod";var yu=1,hu=9;fu(Ce);var on=Ce.object({page:Ce.coerce.number().min(1).default(yu),limit:Ce.coerce.number().min(1).default(hu),title:Ce.string().optional(),content:Ce.string().optional(),authorId:Ce.string().optional(),orderBy:Ce.enum(["asc","desc"]).default("desc")}),Ar=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=on.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.newsRepository.find({pagination:{offset:s,limit:i},filter:n}),this.newsRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:s,limit:i,news:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Ta={method:"post",path:"/news",tags:["News"],summary:"Create news",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:en}}}},responses:{201:{description:"News article created successfully",summary:"News Created",content:{"application/json":{schema:C.object({message:C.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Pa={method:"get",path:"/news",tags:["News"],summary:"List news",request:{query:on},responses:{200:{description:"Paginated list of news articles retrieved successfully",summary:"News Retrieved",content:{"application/json":{schema:C.object({page:C.number(),totalPages:C.number(),offset:C.number(),limit:C.number(),news:C.array(C.object({title:C.string(),content:C.string(),id:C.string(),createdAt:C.date(),updatedAt:C.date(),imageUrl:C.string().nullable()}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Aa={method:"get",path:"/news/{id}",tags:["News"],summary:"Find news by ID",request:{params:rn},responses:{200:{description:"News article details retrieved successfully",summary:"News Retrieved",content:{"application/json":{schema:C.object({page:C.number(),totalPages:C.number(),offset:C.number(),limit:C.number(),news:C.object({title:C.string(),content:C.string(),id:C.string(),createdAt:C.date(),updatedAt:C.date(),imageUrl:C.string().nullable()})})}}},400:{description:"Invalid news ID format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},404:{description:"News article not found with the provided ID",summary:"News Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},Ua={method:"get",path:"/news/author/{author_id}",tags:["News"],summary:"List news by author",request:{params:Tr.pick({authorId:!0}).transform(()=>({author_id:""})),query:Tr.omit({authorId:!0})},responses:{200:{description:"Paginated list of news articles by author retrieved successfully",summary:"Author News Retrieved",content:{"application/json":{schema:C.object({page:C.number(),totalPages:C.number(),offset:C.number(),limit:C.number(),news:C.array(C.object({title:C.string(),content:C.string(),id:C.string(),createdAt:C.date(),updatedAt:C.date(),imageUrl:C.string().nullable()}))})}}},400:{description:"Invalid author ID or query parameters",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},404:{description:"Author not found with the provided ID",summary:"Author Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}};import v from"zod";import{extendZodWithOpenApi as Ru}from"@asteasolutions/zod-to-openapi";import se from"zod";var qa=2,Da=1024,Iu=Da*Da,bu=qa*Iu;Ru(se);var nn=se.object({name:se.string().min(1,"Nome \xE9 obrigat\xF3rio"),logo:se.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=bu,`A imagem deve ter no m\xE1ximo ${qa}MB.`),websiteUrl:se.url("URL do site deve ser v\xE1lida").optional(),description:se.string().optional(),category:se.string().optional(),since:se.coerce.date(),isActive:se.preprocess(o=>o==="true",se.boolean().optional())}),Ur=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{name:t,logo:i,websiteUrl:n,description:s,category:m,since:c,isActive:u}=nn.parse({...e.body,logo:e.file}),P=await this.partnerRepository.create({name:t,websiteUrl:n,description:s,category:m,since:c,isActive:u}),D=await this.firebaseStorageService.uploadFile({file:i,id:P.id,folder:O.PARTNER});return await this.partnerRepository.update({id:P.id,logoUrl:D}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as wu}from"@asteasolutions/zod-to-openapi";import sn from"zod";wu(sn);var an=sn.object({id:sn.uuid()}),Dr=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=an.parse({id:e.params.id}),i=await this.partnerRepository.findById(t);if(!i)throw new d("O parceiro n\xE3o existe.");return i.logoUrl&&this.firebaseStorageService.deleteFile({fileUrl:i.logoUrl}),await this.partnerRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Cu}from"@asteasolutions/zod-to-openapi";import mn from"zod";Cu(mn);var Fr=mn.object({id:mn.uuid()}),qr=class{constructor(e){this.partnerRepository=e}async handle(e,r){try{let{id:t}=Fr.parse({id:e.params.id}),i=await this.partnerRepository.findById(t);if(!i)throw new d("O parceiro n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Su}from"@asteasolutions/zod-to-openapi";import pe from"zod";var vu=1,Mu=9;Su(pe);var cn=pe.object({page:pe.coerce.number().min(1).default(vu),limit:pe.coerce.number().min(1).default(Mu),name:pe.string().optional(),description:pe.string().optional(),category:pe.string().optional(),isActive:pe.coerce.boolean().optional(),orderBy:pe.enum(["asc","desc"]).optional()}),Br=class{constructor(e){this.partnerRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=cn.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.partnerRepository.find({pagination:{offset:s,limit:i},filter:n}),this.partnerRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:s,limit:i,partners:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Eu}from"@asteasolutions/zod-to-openapi";import oe from"zod";var Ba=2,Fa=1024,ju=Fa*Fa,xu=Ba*ju;Eu(oe);var pn=oe.object({id:oe.uuid(),name:oe.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),logo:oe.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=xu,`A imagem deve ter no m\xE1ximo ${Ba}MB.`).optional(),websiteUrl:oe.url("URL do site deve ser v\xE1lida").optional(),description:oe.string().optional(),category:oe.string().optional(),since:oe.coerce.date().optional(),isActive:oe.preprocess(o=>o==="true",oe.boolean().optional())}),Or=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,logo:n,websiteUrl:s,description:m,category:c,since:u,isActive:P}=pn.parse({id:e.params.id,...e.body,logo:e.file}),D=await this.partnerRepository.findById(t);if(!D)throw new d("O parceiro n\xE3o existe.");let L=D.logoUrl;if(n&&(L=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:"images/partners"})),!L)throw new a("Logo URL \xE9 obrigat\xF3rio");return await this.partnerRepository.update({id:t,name:i,logoUrl:L,websiteUrl:s,description:m,category:c,since:u,isActive:P}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Oa=v.object({id:v.uuid(),name:v.string(),logoUrl:v.string(),description:v.string().nullable(),category:v.string().nullable(),since:v.date(),isActive:v.boolean(),createdAt:v.date(),updatedAt:v.date()}),Na={method:"post",path:"/partner",tags:["Partners"],summary:"Create a new partner with logo upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:nn}}}},responses:{201:{description:"Partner created successfully",summary:"Partner Created"},400:{description:"Invalid input data, missing required fields, or invalid logo format/size",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},409:{description:"Partner with this name already exists",summary:"Conflict",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},ka={method:"get",path:"/partner",tags:["Partners"],summary:"List all partners with pagination and filters",request:{query:cn},responses:{200:{description:"List of partners retrieved successfully with pagination",summary:"Partners Retrieved",content:{"application/json":{schema:v.object({page:v.number(),totalPages:v.number(),offset:v.number(),limit:v.number(),partners:v.array(Oa)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},La={method:"get",path:"/partner/{id}",tags:["Partners"],summary:"Find partner by ID",request:{params:Fr},responses:{200:{description:"Partner details retrieved successfully",summary:"Partner Retrieved",content:{"application/json":{schema:Oa}}},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},Ha={method:"put",path:"/partner/{id}",tags:["Partners"],summary:"Update partner with optional logo upload",security:[{bearerAuth:[]}],request:{params:Fr,body:{content:{"multipart/form-data":{schema:pn.omit({id:!0})}}}},responses:{200:{description:"Partner updated successfully",summary:"Partner Updated"},400:{description:"Invalid input data, partner ID format, or invalid logo format/size",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},409:{description:"Partner with this name already exists",summary:"Conflict",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},_a={method:"delete",path:"/partner/{id}",tags:["Partners"],summary:"Delete partner",security:[{bearerAuth:[]}],request:{params:an},responses:{200:{description:"Partner deleted successfully",summary:"Partner Deleted"},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}};import{$Enums as za}from"@prisma/client";import M from"zod";import{extendZodWithOpenApi as Tu}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Pu}from"@prisma/client";import Se from"zod";Tu(Se);var kr=Se.object({userId:Se.uuid(),title:Se.string().min(1),description:Se.string().optional(),status:Se.enum(Pu).default("PENDING"),dueDate:Se.coerce.date().optional(),document:Se.any().refine(o=>o&&typeof o=="object"&&o.size>0,"Arquivo do documento \xE9 obrigat\xF3rio")}),Nr=class{constructor(e,r,t){this.userRepository=e;this.pendencyRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{userId:t,title:i,description:n,status:s,dueDate:m,document:c}=kr.parse({...e.body,userId:e.params.user_id,document:e.file});if(!await this.userRepository.findById(t))throw new V("O usu\xE1rio n\xE3o existe.");let P=await this.firebaseStorageService.uploadFile({file:c,id:t,folder:O.PENDENCY});return await this.pendencyRepository.create({userId:t,title:i,description:n,status:s,dueDate:m,documentUrl:P}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Au}from"@asteasolutions/zod-to-openapi";import dn from"zod";Au(dn);var un=dn.object({id:dn.uuid()}),Lr=class{constructor(e,r){this.pendencyRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=un.parse({id:e.params.pendency_id}),i=await this.pendencyRepository.findById(t);if(!i)throw new d("A pend\xEAncia n\xE3o existe.");return await Promise.all([this.pendencyRepository.deleteById(i.id),this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl})]),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Uu}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Du}from"@prisma/client";import de from"zod";var qu=1,Fu=6;Uu(de);var ln=de.object({page:de.coerce.number().min(1).default(qu),limit:de.coerce.number().min(1).default(Fu),title:de.string().optional(),description:de.string().optional(),status:de.enum(Du).default("PENDING"),userId:de.uuid().optional(),orderBy:de.enum(["asc","desc"]).default("desc")}),Hr=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{description:t,limit:i,orderBy:n,page:s,title:m,status:c,userId:u}=ln.parse(e.query),P=s*i-i,[D,L]=await Promise.all([this.pendencyRepository.find({pagination:{offset:P,limit:i},filter:{title:m,description:t,status:c,orderBy:n,userId:u}}),this.pendencyRepository.count({filter:{title:m,description:t,status:c,userId:u}})]),Z=Math.max(Math.ceil(L/i),1);return r.status(200).json({page:s,totalPages:Z,offset:P,limit:i,pendencies:D})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Bu}from"@asteasolutions/zod-to-openapi";import gn from"zod";Bu(gn);var fn=gn.object({pendencyId:gn.uuid()}),_r=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{pendencyId:t}=fn.parse({pendencyId:e.params.pendency_id}),i=await this.pendencyRepository.findById(t);if(!i)throw new d("Pend\xEAncia n\xE3o encontrada.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Ou}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Nu}from"@prisma/client";import ve from"zod";Ou(ve);var Wr=ve.object({id:ve.uuid(),title:ve.string().min(1),description:ve.string().optional(),status:ve.enum(Nu),dueDate:ve.coerce.date().optional(),document:ve.any().refine(o=>o==null||typeof o=="object"&&typeof o.size=="number"&&(o.size===0||o.size>0),"Arquivo do documento \xE9 inv\xE1lido").optional()}),zr=class{constructor(e,r){this.pendencyRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{document:t,id:i,...n}=Wr.parse({...e.body,id:e.params.pendency_id,document:e.file}),s=await this.pendencyRepository.findById(i);if(!s)throw new V("A pend\xEAncia n\xE3o existe");let m=s.documentUrl;return t&&t.size>0&&(m=await this.firebaseStorageService.updateFile({file:t,id:s.userId,folder:O.PENDENCY,fileUrl:s.documentUrl})),await this.pendencyRepository.update({...n,id:i,documentUrl:m}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Wa={method:"post",path:"/pendency/{user_id}",tags:["Pendencies"],summary:"Create pendency for user",security:[{bearerAuth:[]}],request:{params:kr.pick({userId:!0}).transform(()=>({user_id:""})),body:{content:{"multipart/form-data":{schema:kr.omit({userId:!0})}}}},responses:{201:{description:"Pendency created successfully for the user",summary:"Pendency Created",content:{"application/json":{schema:M.object({})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},Za={method:"get",path:"/pendency",tags:["Pendencies"],summary:"List pendencies",security:[{bearerAuth:[]}],request:{query:ln},responses:{200:{description:"Paginated list of pendencies retrieved successfully",summary:"Pendencies Retrieved",content:{"application/json":{schema:M.object({page:M.number(),totalPages:M.number(),offset:M.number(),limit:M.number(),pendencies:M.array(M.object({id:M.string(),title:M.string(),description:M.string().nullable(),status:M.enum(za.PendencyStatus),dueDate:M.date().nullable(),documentUrl:M.string(),userId:M.string(),createdAt:M.date(),updatedAt:M.date()}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},Va={method:"get",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Find pendency by ID",security:[{bearerAuth:[]}],request:{params:fn},responses:{200:{description:"Pendency details retrieved successfully",summary:"Pendency Retrieved",content:{"application/json":{schema:M.object({id:M.string(),title:M.string(),description:M.string().nullable(),status:M.enum(za.PendencyStatus),dueDate:M.date().nullable(),documentUrl:M.string(),userId:M.string(),createdAt:M.date(),updatedAt:M.date()}).nullable()}}},400:{description:"Invalid pendency ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},404:{description:"Pendency not found with the provided ID",summary:"Pendency Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},Ga={method:"put",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Update pendency",security:[{bearerAuth:[]}],request:{params:Wr.pick({id:!0}).transform(()=>({pendency_id:""})),body:{content:{"multipart/form-data":{schema:Wr.omit({id:!0})}}}},responses:{204:{description:"Pendency updated successfully",summary:"Pendency Updated"},400:{description:"Invalid input data or pendency does not exist",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},Ka={method:"delete",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Delete pendency",security:[{bearerAuth:[]}],request:{params:un},responses:{204:{description:"Pendency deleted successfully",summary:"Pendency Deleted"},400:{description:"Invalid pendency ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},404:{description:"Pendency not found with the provided ID",summary:"Pendency Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}};import{RegimentStatus as el}from"@prisma/client";import S from"zod";import{extendZodWithOpenApi as ku}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as $a}from"@prisma/client";import Oe from"zod";var Xa=10,Ya=1024,Lu=Ya*Ya,Hu=Xa*Lu;ku(Oe);var yn=Oe.object({title:Oe.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),version:Oe.string().min(1,"Vers\xE3o \xE9 obrigat\xF3ria"),publishedAt:Oe.coerce.date(),document:Oe.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=Hu,`O documento deve ter no m\xE1ximo ${Xa}MB.`),status:Oe.enum($a).optional()}),Zr=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{title:t,version:i,publishedAt:n,document:s,status:m}=yn.parse({...e.body,document:e.file}),c=await this.regimentRepository.create({title:t,version:i,publishedAt:n,documentUrl:"",status:m??$a.IN_FORCE}),u=await this.firebaseStorageService.uploadFile({file:s,id:c.id,folder:O.REGIMENT});return await this.regimentRepository.update({id:c.id,documentUrl:u}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as _u}from"@asteasolutions/zod-to-openapi";import hn from"zod";_u(hn);var Rn=hn.object({id:hn.uuid()}),Vr=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=Rn.parse({id:e.params.id}),i=await this.regimentRepository.findById(t);if(!i)throw new d("O regimento n\xE3o existe.");return i.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl}),await this.regimentRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as zu}from"@asteasolutions/zod-to-openapi";import In from"zod";zu(In);var Kr=In.object({id:In.uuid()}),Gr=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{id:t}=Kr.parse({id:e.params.id}),i=await this.regimentRepository.findById(t);if(!i)throw new d("O regimento n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Wu}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as Zu}from"@prisma/client";import bn from"zod";Wu(bn);var wn=bn.object({status:bn.enum(Zu)}),Yr=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{status:t}=wn.parse({status:e.params.status}),i=await this.regimentRepository.findByStatus(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Vu}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as Gu}from"@prisma/client";import Ne from"zod";var Ku=1,Yu=10;Vu(Ne);var Cn=Ne.object({page:Ne.coerce.number().min(1).default(Ku),limit:Ne.coerce.number().min(1).default(Yu),title:Ne.string().optional(),status:Ne.enum(Gu).optional(),orderBy:Ne.enum(["asc","desc"]).optional()}),$r=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Cn.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.regimentRepository.find({pagination:{offset:s,limit:i},filter:n}),this.regimentRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:s,limit:i,regiments:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as $u}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as Xu}from"@prisma/client";import Me from"zod";var Qa=10,Ja=1024,Ju=Ja*Ja,Qu=Qa*Ju;$u(Me);var Sn=Me.object({id:Me.uuid(),title:Me.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),version:Me.string().min(1,"Vers\xE3o \xE9 obrigat\xF3ria").optional(),publishedAt:Me.coerce.date().optional(),document:Me.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Qu,`O documento deve ter no m\xE1ximo ${Qa}MB.`).optional(),status:Me.enum(Xu).optional()}),Xr=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,title:i,version:n,publishedAt:s,document:m,status:c}=Sn.parse({id:e.params.id,...e.body,document:e.file}),u=await this.regimentRepository.findById(t);if(!u)throw new d("O regimento n\xE3o existe.");let P=u.documentUrl;return m&&(u.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:u.documentUrl}),P=await this.firebaseStorageService.uploadFile({file:m,id:t,folder:O.REGIMENT})),await this.regimentRepository.update({id:t,title:i,version:n,publishedAt:s,documentUrl:P??void 0,status:c}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var vn=S.object({id:S.uuid(),title:S.string(),version:S.string(),publishedAt:S.date(),documentUrl:S.string(),status:S.enum(el),createdAt:S.date(),updatedAt:S.date()}),em={method:"post",path:"/regiment",tags:["Regiments"],summary:"Create a new regiment with document upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:yn}}}},responses:{201:{description:"Regiment created successfully",summary:"Regiment Created"},400:{description:"Invalid input data, missing required fields, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},tm={method:"get",path:"/regiment",tags:["Regiments"],summary:"List all regiments with pagination and filters",request:{query:Cn},responses:{200:{description:"List of regiments retrieved successfully with pagination",summary:"Regiments Retrieved",content:{"application/json":{schema:S.object({page:S.number(),totalPages:S.number(),offset:S.number(),limit:S.number(),regiments:S.array(vn)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},rm={method:"get",path:"/regiment/{id}",tags:["Regiments"],summary:"Find regiment by ID",request:{params:Kr},responses:{200:{description:"Regiment details retrieved successfully",summary:"Regiment Retrieved",content:{"application/json":{schema:vn}}},400:{description:"Invalid regiment ID format",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},om={method:"get",path:"/regiment/status/{status}",tags:["Regiments"],summary:"Find regiments by status",request:{params:wn},responses:{200:{description:"Regiments retrieved successfully by status",summary:"Regiments Retrieved by Status",content:{"application/json":{schema:S.array(vn)}}},400:{description:"Invalid status parameter provided",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},im={method:"put",path:"/regiment/{id}",tags:["Regiments"],summary:"Update regiment with optional document upload",security:[{bearerAuth:[]}],request:{params:Kr,body:{content:{"multipart/form-data":{schema:Sn.omit({id:!0})}}}},responses:{200:{description:"Regiment updated successfully",summary:"Regiment Updated"},400:{description:"Invalid input data, regiment ID format, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},nm={method:"delete",path:"/regiment/{id}",tags:["Regiments"],summary:"Delete regiment",security:[{bearerAuth:[]}],request:{params:Rn},responses:{200:{description:"Regiment deleted successfully",summary:"Regiment Deleted"},400:{description:"Invalid regiment ID format",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}};import{$Enums as Un}from"@prisma/client";import g from"zod";import{extendZodWithOpenApi as tl}from"@asteasolutions/zod-to-openapi";import{Degree as rl,Seniority as ol}from"@prisma/client";import J from"zod";tl(J);var Mn=J.object({registrationNumber:J.string(),mainEtps:J.string().optional(),formations:J.string().optional(),degrees:J.array(J.enum(rl)),occupations:J.string(),seniority:J.enum(ol),institutions:J.string(),biography:J.string().optional(),userId:J.string()}),Jr=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{registrationNumber:t,mainEtps:i,formations:n,degrees:s,occupations:m,seniority:c,institutions:u,biography:P,userId:D}=Mn.parse(e.body);if(await this.researcherRepository.findByRegistrationNumber(t))throw new z("J\xE1 existe um pesquisador cadastrado com este n\xFAmero de registro.");if(await this.researcherRepository.findByUserId(D))throw new z("Usu\xE1rio j\xE1 possui um perfil de pesquisador.");return await this.researcherRepository.create({registrationNumber:t,mainEtps:i,formations:n,degrees:s,occupations:m,seniority:c,institutions:u,biography:P,userId:D}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as il}from"@asteasolutions/zod-to-openapi";import En from"zod";il(En);var jn=En.object({id:En.uuid()}),Qr=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t}=jn.parse({id:e.params.id});if(!await this.researcherRepository.findById(t))throw new d("O pesquisador n\xE3o existe.");return await this.researcherRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as nl}from"@asteasolutions/zod-to-openapi";import xn from"zod";nl(xn);var to=xn.object({id:xn.uuid()}),eo=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t}=to.parse({id:e.params.id}),i=await this.researcherRepository.findById(t);if(!i)throw new d("O pesquisador n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as sl}from"@asteasolutions/zod-to-openapi";import Tn from"zod";sl(Tn);var Pn=Tn.object({userId:Tn.uuid()}),ro=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{userId:t}=Pn.parse({userId:e.params.userId}),i=await this.researcherRepository.findByUserId(t);if(!i)throw new d("O pesquisador n\xE3o existe para este usu\xE1rio.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as al}from"@asteasolutions/zod-to-openapi";import{Degree as ml,Seniority as cl}from"@prisma/client";import Q from"zod";al(Q);var An=Q.object({id:Q.uuid(),registrationNumber:Q.string().optional(),mainEtps:Q.string().optional(),formations:Q.string().optional(),degrees:Q.array(Q.enum(ml)).optional(),occupations:Q.string().optional(),seniority:Q.enum(cl).optional(),institutions:Q.string().optional(),biography:Q.string().optional()}),oo=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t,registrationNumber:i,mainEtps:n,formations:s,degrees:m,occupations:c,seniority:u,institutions:P,biography:D}=An.parse({id:e.params.id,...e.body}),L=await this.researcherRepository.findById(t);if(!L)throw new d("O pesquisador n\xE3o existe.");if(i&&i!==L.registrationNumber){let Z=await this.researcherRepository.findByRegistrationNumber(i);if(Z&&Z.id!==t)throw new z("J\xE1 existe um pesquisador com este n\xFAmero de registro.")}return await this.researcherRepository.update({id:t,registrationNumber:i,mainEtps:n,formations:s,degrees:m,occupations:c,seniority:u,institutions:P,biography:D}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var pl=1,dl=9,Dn=g.object({id:g.uuid(),registrationNumber:g.string(),mainEtps:g.string().nullable(),formations:g.string().nullable(),degrees:g.array(g.enum(Un.Degree)),occupations:g.string(),seniority:g.enum(Un.Seniority),institutions:g.string(),biography:g.string().nullable(),createdAt:g.date(),updatedAt:g.date(),userId:g.uuid(),user:g.object({id:g.uuid(),name:g.string(),emailAddress:g.string(),avatarUrl:g.string().nullable(),orcid:g.string().nullable(),phone:g.string().nullable(),lattesUrl:g.string().nullable(),role:g.enum(Un.UserRole)})}),sm={method:"post",path:"/researcher",tags:["Researchers"],summary:"Create a new researcher profile",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Mn}}}},responses:{201:{description:"Researcher profile created successfully",summary:"Researcher Created",content:{"application/json":{schema:g.object({message:g.string()})}}},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:g.object({errors:g.record(g.string(),g.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:g.object({message:g.string()})}}},409:{description:"Researcher with this registration number already exists or user already has a researcher profile",summary:"Conflict",content:{"application/json":{schema:g.object({message:g.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:g.object({message:g.string()})}}}}},am={method:"get",path:"/researcher",tags:["Researchers"],summary:"List all researchers with pagination and filters",request:{query:g.object({page:g.coerce.number().min(1).default(pl).optional(),limit:g.coerce.number().min(1).default(dl).optional(),userId:g.string().optional(),registrationNumber:g.string().optional(),name:g.string().optional(),emailAddress:g.string().optional(),mainEtps:g.string().optional(),formations:g.string().optional(),occupations:g.string().optional(),institutions:g.string().optional(),biography:g.string().optional(),orderBy:g.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of researchers retrieved successfully with pagination",summary:"Researchers Retrieved",content:{"application/json":{schema:g.object({page:g.number(),totalPages:g.number(),offset:g.number(),limit:g.number(),researchers:g.array(Dn)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:g.object({message:g.string()})}}}}},mm={method:"get",path:"/researcher/{id}",tags:["Researchers"],summary:"Find researcher by ID",request:{params:to},responses:{200:{description:"Researcher details retrieved successfully",summary:"Researcher Retrieved",content:{"application/json":{schema:Dn}}},400:{description:"Invalid researcher ID format",summary:"Validation Error",content:{"application/json":{schema:g.object({errors:g.record(g.string(),g.string())})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:g.object({message:g.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:g.object({message:g.string()})}}}}},cm={method:"get",path:"/researcher/user/{userId}",tags:["Researchers"],summary:"Find researcher by user ID",request:{params:Pn},responses:{200:{description:"Researcher details retrieved successfully",summary:"Researcher Retrieved",content:{"application/json":{schema:Dn}}},400:{description:"Invalid user ID format",summary:"Validation Error",content:{"application/json":{schema:g.object({errors:g.record(g.string(),g.string())})}}},404:{description:"Researcher not found for this user",summary:"Researcher Not Found",content:{"application/json":{schema:g.object({message:g.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:g.object({message:g.string()})}}}}},pm={method:"put",path:"/researcher/{id}",tags:["Researchers"],summary:"Update researcher profile",security:[{bearerAuth:[]}],request:{params:to,body:{content:{"application/json":{schema:An.omit({id:!0})}}}},responses:{200:{description:"Researcher profile updated successfully",summary:"Researcher Updated",content:{"application/json":{schema:g.object({message:g.string()})}}},400:{description:"Invalid input data or researcher ID format",summary:"Validation Error",content:{"application/json":{schema:g.object({errors:g.record(g.string(),g.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:g.object({message:g.string()})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:g.object({message:g.string()})}}},409:{description:"Researcher with this registration number already exists",summary:"Conflict",content:{"application/json":{schema:g.object({message:g.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:g.object({message:g.string()})}}}}},dm={method:"delete",path:"/researcher/{id}",tags:["Researchers"],summary:"Delete researcher profile",security:[{bearerAuth:[]}],request:{params:jn},responses:{200:{description:"Researcher profile deleted successfully",summary:"Researcher Deleted"},400:{description:"Invalid researcher ID format",summary:"Validation Error",content:{"application/json":{schema:g.object({errors:g.record(g.string(),g.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:g.object({message:g.string()})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:g.object({message:g.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:g.object({message:g.string()})}}}}};import{$Enums as yl}from"@prisma/client";import j from"zod";import{extendZodWithOpenApi as ul}from"@asteasolutions/zod-to-openapi";import st from"zod";ul(st);var qn=st.object({role:st.string().min(1),description:st.string().optional(),userId:st.uuid(),order:st.number().optional()}),io=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{role:t,description:i,userId:n,order:s}=qn.parse(e.body);return await this.sdhcTeamMemberRepository.create({role:t,description:i,userId:n,order:s??0}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ll}from"@asteasolutions/zod-to-openapi";import Fn from"zod";ll(Fn);var Bn=Fn.object({id:Fn.uuid()}),no=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t}=Bn.parse({id:e.params.id});if(!await this.sdhcTeamMemberRepository.findById(t))throw new d("O membro da equipe SDHC n\xE3o existe.");return await this.sdhcTeamMemberRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as gl}from"@asteasolutions/zod-to-openapi";import On from"zod";gl(On);var ao=On.object({id:On.uuid()}),so=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t}=ao.parse({id:e.params.id}),i=await this.sdhcTeamMemberRepository.findById(t);if(!i)throw new d("O membro da equipe SDHC n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as fl}from"@asteasolutions/zod-to-openapi";import ke from"zod";fl(ke);var Nn=ke.object({id:ke.uuid(),role:ke.string().min(1).optional(),description:ke.string().optional(),userId:ke.uuid().optional(),order:ke.number().optional()}),mo=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t,role:i,description:n,userId:s,order:m}=Nn.parse({id:e.params.id,...e.body});if(!await this.sdhcTeamMemberRepository.findById(t))throw new d("O membro da equipe SDHC n\xE3o existe.");return await this.sdhcTeamMemberRepository.update({id:t,role:i,description:n,userId:s,order:m}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var hl=j.object({id:j.uuid(),name:j.string(),emailAddress:j.string(),avatarUrl:j.string().nullable(),orcid:j.string().nullable(),phone:j.string().nullable(),lattesUrl:j.string().nullable(),role:j.enum(yl.UserRole)}),um=j.object({id:j.uuid(),role:j.string(),description:j.string().nullable(),order:j.number(),createdAt:j.date(),updatedAt:j.date(),userId:j.uuid(),user:hl}),lm={method:"post",path:"/sdhc-team-member",tags:["SDHC Team Members"],summary:"Create a new SDHC Team Member",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:qn}}}},responses:{201:{description:"SDHC Team Member created successfully",summary:"SDHC Team Member Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},gm={method:"get",path:"/sdhc-team-member",tags:["SDHC Team Members"],summary:"List all SDHC Team Members with filters",request:{query:j.object({role:j.string().optional(),orderBy:j.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of SDHC Team Members retrieved successfully",summary:"SDHC Team Members Retrieved",content:{"application/json":{schema:j.object({members:j.array(um)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},fm={method:"get",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Find SDHC Team Member by ID",request:{params:ao},responses:{200:{description:"SDHC Team Member details retrieved successfully",summary:"SDHC Team Member Retrieved",content:{"application/json":{schema:um}}},400:{description:"Invalid SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},ym={method:"put",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Update SDHC Team Member",security:[{bearerAuth:[]}],request:{params:ao,body:{content:{"application/json":{schema:Nn.omit({id:!0})}}}},responses:{200:{description:"SDHC Team Member updated successfully",summary:"SDHC Team Member Updated"},400:{description:"Invalid input data or SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},hm={method:"delete",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Delete SDHC Team Member",security:[{bearerAuth:[]}],request:{params:Bn},responses:{200:{description:"SDHC Team Member deleted successfully",summary:"SDHC Team Member Deleted"},400:{description:"Invalid SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}};import{$Enums as bm}from"@prisma/client";import T from"zod";import{extendZodWithOpenApi as Rl}from"@asteasolutions/zod-to-openapi";import kn from"zod";Rl(kn);var Ln=kn.object({id:kn.string()}),co=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{id:t}=Ln.parse({id:e.params.id}),i=await this.userRepository.findById(t);if(!i)throw new d("O usu\xE1rio n\xE3o existe.");let n=e.user.id;if(i.id!==n)throw new $("Voc\xEA n\xE3o tem permiss\xE3o para deletar o usu\xE1rio");return await this.userRepository.deleteById(i.id),r.sendStatus(204)}catch(t){if(console.log(t),t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Il}from"@asteasolutions/zod-to-openapi";import{z as Hn}from"zod";Il(Hn);var _n=Hn.object({id:Hn.string().min(1,"id do usu\xE1rio n\xE3o fornecido.")}),po=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{id:t}=_n.parse(e.params),i=await this.userRepository.findById(t);if(!i)throw new d("Usu\xE1rio n\xE3o encontrado");r.status(200).json(i)}catch(t){if(console.log(t),t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as bl}from"@asteasolutions/zod-to-openapi";import Le from"zod";var Im=2,Rm=1024,wl=Rm*Rm,Cl=Im*wl,Sl=/^\d{4}-\d{4}-\d{4}-\d{4}$/,vl=/^\(?\d{2}\)?[\s-]?\d{4,5}-?\d{4}$/;bl(Le);var zn=Le.object({name:Le.string().optional(),lattesUrl:Le.string().optional(),orcid:Le.string().optional().transform(o=>o===void 0?void 0:o.trim()).refine(o=>o===void 0||o===""||Sl.test(o),{message:"ORCID inv\xE1lido. Deve estar no formato 0000-0000-0000-0000"}),phone:Le.string().optional().refine(o=>o===void 0||o===""||vl.test(o),{message:"Telefone inv\xE1lido. Deve estar no formato (99) 99999-9999"}),avatarImage:Le.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Cl,`A imagem deve ter no m\xE1ximo ${Im}MB.`).optional()}),uo=class{constructor(e,r){this.userRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{avatarImage:t,...i}=zn.parse({...e.body,avatarImage:e.file}),n=e.user.id,s=await this.userRepository.findById(n);if(!s)throw new V("O usu\xE1rio n\xE3o existe");let m=s.avatarUrl;return t&&(s.avatarUrl?m=await this.firebaseStorageService.updateFile({file:t,id:n,folder:O.USER,fileUrl:s.avatarUrl}):m=await this.firebaseStorageService.uploadFile({file:t,id:n,folder:O.USER})),await this.userRepository.update({...i,id:n,avatarUrl:m||void 0}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var wm={method:"get",path:"/users/{id}",tags:["Users"],summary:"Find user by ID",request:{params:_n},responses:{200:{description:"User details retrieved successfully",summary:"User Retrieved",content:{"application/json":{schema:T.object({id:T.string(),name:T.string(),createdAt:T.date(),updatedAt:T.date(),role:T.enum(bm.UserRole),lattesUrl:T.string().nullable(),orcid:T.string().nullable(),phone:T.string().nullable(),avatarUrl:T.url().nullable(),emailAddress:T.email()})}}},400:{description:"Invalid user ID format",summary:"Validation Error",content:{"application/json":{schema:T.object({errors:T.record(T.string(),T.string())})}}},404:{description:"User not found with the provided ID",summary:"User Not Found",content:{"application/json":{schema:T.object({message:T.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:T.object({message:T.string()})}}}}},Cm={method:"put",path:"/users",tags:["Users"],summary:"Update authenticated user",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:zn}}}},responses:{200:{description:"User profile updated successfully",summary:"User Updated",content:{"application/json":{schema:T.object({message:T.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:T.object({errors:T.record(T.string(),T.string())})}}},401:{description:"User not authenticated or unauthorized",summary:"Authentication Required",content:{"application/json":{schema:T.object({message:T.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:T.object({message:T.string()})}}}}},Sm={method:"delete",path:"/users",tags:["Users"],summary:"Delete authenticated user",security:[{bearerAuth:[]}],request:{params:Ln},responses:{200:{description:"User account deleted successfully",summary:"User Deleted",content:{"application/json":{schema:T.object({message:T.string()})}}},400:{description:"Invalid request parameters",summary:"Validation Error",content:{"application/json":{schema:T.object({errors:T.record(T.string(),T.string())})}}},401:{description:"User not authenticated or unauthorized",summary:"Authentication Required",content:{"application/json":{schema:T.object({message:T.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:T.object({message:T.string()})}}}}},vm={method:"get",path:"/users",tags:["Users"],summary:"List users",responses:{200:{description:"Complete list of users retrieved successfully",summary:"Users Retrieved",content:{"application/json":{schema:T.array(T.object({id:T.string(),name:T.string(),createdAt:T.date(),updatedAt:T.date(),role:T.enum(bm.UserRole),lattesUrl:T.url().nullable(),orcid:T.string().nullable(),phone:T.string().nullable(),avatarUrl:T.string().nullable(),emailAddress:T.email()}))}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:T.object({message:T.string()})}}}}};var y=new Ml;y.registerComponent("securitySchemes","bearerAuth",{type:"http",scheme:"bearer",bearerFormat:"JWT"});y.registerPath(cs);y.registerPath(ps);y.registerPath(ds);y.registerPath(us);y.registerPath(gs);y.registerPath(fs);y.registerPath(ls);y.registerPath(wm);y.registerPath(Cm);y.registerPath(Sm);y.registerPath(vm);y.registerPath(Ta);y.registerPath(Pa);y.registerPath(Aa);y.registerPath(Ua);y.registerPath(ys);y.registerPath(hs);y.registerPath(Rs);y.registerPath(Is);y.registerPath(bs);y.registerPath(Wa);y.registerPath(Za);y.registerPath(Va);y.registerPath(Ga);y.registerPath(Ka);y.registerPath(As);y.registerPath(Us);y.registerPath(Ds);y.registerPath(qs);y.registerPath(Fs);y.registerPath(sm);y.registerPath(am);y.registerPath(mm);y.registerPath(cm);y.registerPath(pm);y.registerPath(dm);y.registerPath(Cs);y.registerPath(Ss);y.registerPath(vs);y.registerPath(Ms);y.registerPath(Es);y.registerPath(Na);y.registerPath(ka);y.registerPath(La);y.registerPath(Ha);y.registerPath(_a);y.registerPath(ca);y.registerPath(pa);y.registerPath(da);y.registerPath(ua);y.registerPath(la);y.registerPath(lm);y.registerPath(gm);y.registerPath(fm);y.registerPath(ym);y.registerPath(hm);y.registerPath(oa);y.registerPath(ia);y.registerPath(na);y.registerPath(sa);y.registerPath(aa);y.registerPath(em);y.registerPath(tm);y.registerPath(rm);y.registerPath(om);y.registerPath(im);y.registerPath(nm);y.registerPath(Ca);y.registerPath(Sa);y.registerPath(va);y.registerPath(Ma);y.registerPath(Ea);y.registerPath(ja);y.registerPath(Ra);y.registerPath(Ia);y.registerPath(ba);y.registerPath(wa);y.registerPath($s);y.registerPath(Xs);y.registerPath(Js);y.registerPath(Qs);y.registerPath(ea);y.registerPath(ta);y.registerPath(Vs);y.registerPath(Gs);y.registerPath(Ks);y.registerPath(Ys);y.registerPath(ks);y.registerPath(Ls);y.registerPath(Hs);y.registerPath(_s);var jl=new El(y.definitions),Mm=jl.generateDocument({openapi:"3.0.0",info:{title:"API da Rede CT",version:"1.0.0",description:"API com valida\xE7\xE3o Zod"}});import{Router as ql}from"express";import{extendZodWithOpenApi as xl}from"@asteasolutions/zod-to-openapi";import Wn from"zod";xl(Wn);var Tl=Wn.object({authenticatedUserId:Wn.uuid()}),lo=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{authenticatedUserId:t}=Tl.parse({authenticatedUserId:e.user.id}),i=await this.userRepository.findById(t);if(!i)throw new d("Usu\xE1rio n\xE3o encontrado.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{PrismaClient as Pl}from"@prisma/client";var q=new Pl({log:["warn","error"]});var go=class{constructor(e){this.prisma=e}async register({userId:e,title:r,description:t,certificationUrl:i}){await this.prisma.certification.create({data:{title:r,description:t,certificationUrl:i,user:{connect:{id:e}}}})}async find({pagination:{offset:e,limit:r},filter:{description:t,orderBy:i,title:n,userId:s}}){let m={},c=[];return s&&(m.userId=s),n&&c.push({title:{contains:n,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.certification.findMany({where:m,include:{user:{omit:{passwordHash:!0}}},orderBy:{updatedAt:i},skip:e,take:r})}async findById(e){return await this.prisma.certification.findFirst({where:{id:e}})}async findByUserId({pagination:{limit:e,offset:r},filter:{description:t,orderBy:i,title:n},userId:s}){let m={userId:s},c=[];return n&&c.push({title:{contains:n,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.certification.findMany({where:m,include:{user:{omit:{passwordHash:!0}}},skip:r,take:e,orderBy:i?{updatedAt:i}:{updatedAt:"desc"}})}async update({id:e,...r}){await this.prisma.certification.update({where:{id:e},data:r})}async deleteById(e){await this.prisma.certification.delete({where:{id:e}})}async count({filter:{description:e,title:r,userId:t}}){let i={},n=[];return t&&(i.userId=t),r&&n.push({title:{contains:r,mode:"insensitive"}}),e&&n.push({description:{contains:e,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.certification.count({where:i})}};function Ee(){return new go(q)}var fo=class{constructor(e){this.prisma=e}async create(e){await this.prisma.news.create({data:e})}async find({pagination:{offset:e,limit:r},filter:{authorId:t,content:i,title:n,orderBy:s}}){let m={};t&&(m.authorId={contains:t,mode:"insensitive"});let c=[];return n&&c.push({title:{contains:n,mode:"insensitive"}}),i&&c.push({content:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.news.findMany({where:m,omit:{authorId:!0},include:{author:!0},orderBy:{updatedAt:s},skip:e,take:r})}async findById(e){return await this.prisma.news.findUnique({where:{id:e},omit:{authorId:!0},include:{author:!0}})}async findByAuthorId({authorId:e,pagination:{offset:r,limit:t},filter:{orderBy:i="desc",content:n,title:s}}){let m={authorId:e},c=[];return s&&c.push({title:{contains:s,mode:"insensitive"}}),n&&c.push({content:{contains:n,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.news.findMany({omit:{authorId:!0},where:m,orderBy:{updatedAt:i},skip:r,take:t})}async update(e){await this.prisma.news.update({where:{id:e.id},data:{title:e.title,content:e.content,imageUrl:e.imageUrl}})}async delete(e){await this.prisma.news.delete({where:{id:e}})}async count({filter:{authorId:e,content:r,title:t}}){let i={};e&&(i.authorId={contains:e,mode:"insensitive"});let n=[];return t&&n.push({title:{contains:t,mode:"insensitive"}}),r&&n.push({content:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.news.count({where:i})}};function ue(){return new fo(q)}var yo=class{constructor(e){this.prisma=e}async create(e){await this.prisma.pendency.create({data:e})}async find({filter:{description:e,orderBy:r,title:t,status:i,userId:n},pagination:{limit:s,offset:m}}){let c={userId:n,AND:{status:{equals:i}}};e&&(c.description={contains:e,mode:"insensitive"});let u=[];return t&&u.push({title:{contains:t,mode:"insensitive"}}),u.length>0&&(c.OR=u),await this.prisma.pendency.findMany({where:c,orderBy:{updatedAt:r},include:{user:{omit:{passwordHash:!0}}},skip:m,take:s})}async findById(e){return await this.prisma.pendency.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async findByUserId({filter:{description:e,orderBy:r,title:t,status:i},pagination:{limit:n,offset:s},userId:m}){let c={userId:m,AND:{status:{equals:i}}},u=[];return e&&u.push({description:{contains:e,mode:"insensitive"}}),t&&u.push({title:{contains:t,mode:"insensitive"}}),u.length>0&&(c.OR=u),await this.prisma.pendency.findMany({where:c,orderBy:{updatedAt:r},include:{user:{omit:{passwordHash:!0}}},skip:s,take:n})}async update({id:e,...r}){await this.prisma.pendency.update({where:{id:e},data:r})}async deleteById(e){await this.prisma.pendency.delete({where:{id:e}})}async count({filter:{description:e,title:r,status:t,userId:i}}){let n={userId:i},s=[];return e&&s.push({description:{contains:e,mode:"insensitive"}}),r&&s.push({title:{contains:r,mode:"insensitive"}}),t&&s.push({status:{equals:t}}),s.length>0&&(n.OR=s),await this.prisma.pendency.count({where:n})}};function je(){return new yo(q)}var ho=class{constructor(e){this.prisma=e}async create(e){await this.prisma.user.create({data:e})}async update(e){await this.prisma.user.update({where:{id:e.id},data:{lattesUrl:e.lattesUrl??null,orcid:e.orcid??null,phone:e.phone??null,avatarUrl:e.avatarUrl??null}})}async deleteById(e){await this.prisma.user.delete({where:{id:e}})}async find(){return await this.prisma.user.findMany({omit:{passwordHash:!0}})}async findByEmail(e){return await this.prisma.user.findFirst({where:{emailAddress:e}})}async findById(e){return await this.prisma.user.findFirst({where:{id:e},omit:{passwordHash:!0}})}};function K(){return new ho(q)}import{compare as Al,hash as Ul}from"bcryptjs";var Ro=class{constructor(e,r){this.hashFn=e;this.compareFn=r}async hash(e){return await this.hashFn(e,6)}async compare({password:e,hashedPassword:r}){return await this.compareFn(e,r)}};function Zn(){return new Ro(Ul,Al)}import Em from"jsonwebtoken";import Y from"zod";var Dl=Y.object({JWT_SECRET:Y.string(),FIREBASE_BUCKET:Y.string(),FIREBASE_CLIENT_EMAIL:Y.string(),FIREBASE_PRIVATE_KEY:Y.string(),FIREBASE_PROJECT_ID:Y.string(),FIREBASE_TYPE:Y.string(),FIREBASE_PRIVATE_KEY_ID:Y.string(),FIREBASE_CLIENT_ID:Y.string(),FIREBASE_AUTH_URI:Y.string(),FIREBASE_TOKEN_URI:Y.string(),FIREBASE_AUTH_PROVIDER_X509_CERT_URL:Y.string(),FIREBASE_CLIENT_X509_CERT_URL:Y.string()}),W=Dl.parse(process.env);var Io=class{constructor(e,r){this.signFn=e;this.verifyFn=r}sign(e){try{return this.signFn(e,W.JWT_SECRET,{expiresIn:"3d",subject:e.id})}catch{return null}}verify(e){try{return this.verifyFn(e,W.JWT_SECRET)}catch{return null}}};function bo(){return new Io(Em.sign,Em.verify)}function jm(){return{signUpController:new Ut(K(),Zn())}}function xm(){return{signInController:new Pt(K(),Zn(),bo())}}function Tm(){return{findAuthenticatedUserController:new lo(K())}}function Pm(){return{findAuthenticatedUserController:new jt(ue())}}function Am(){return{findAuthenticatedUserCertificationsController:new Et(Ee())}}function Um(){return{findAuthenticatedUserPendenciesController:new xt(je())}}var wo=class{constructor(e){this.jwtService=e}authenticated(e,r,t){let i=e.headers.authorization;if(!i?.startsWith("Bearer "))return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});let n=i.split(" ")[1];if(!n)return r.status(401).json({message:"Token n\xE3o fornecido."});try{let s=this.jwtService.verify(n);if(!s)return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});e.user=s,t()}catch(s){if(console.log(s),s instanceof Error)return r.status(401).json({message:s.message})}}isAdmin(e,r,t){let i=e.headers.authorization;if(!i?.startsWith("Bearer "))return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});let n=i.split(" ")[1];if(!n)return r.status(401).json({message:"Token n\xE3o fornecido."});try{let s=this.jwtService.verify(n);if(!s)return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});if(s.role!=="ADMIN")return r.status(401).json({message:"\xC9 necess\xE1rio ter permiss\xF5es de administrador."});t()}catch(s){if(console.log(s),s instanceof Error)return r.status(401).json({message:s.message})}}};function F(){return{authMiddleware:new wo(bo())}}var le=ql(),{authMiddleware:It}=F();le.post("/sign-up",async(o,e)=>{let{signUpController:r}=jm();await r.handle(o,e)});le.post("/sign-in",async(o,e)=>{let{signInController:r}=xm();await r.handle(o,e)});le.get("/user",(o,e,r)=>{It.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserController:r}=Tm();await r.handle(o,e)});le.get("/user/news",(o,e,r)=>{It.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserController:r}=Pm();await r.handle(o,e)});le.get("/admin",(o,e,r)=>{It.isAdmin(o,e,r)},(o,e)=>{try{e.status(200).json({success:!0})}catch(r){r instanceof Error&&e.status(500).json({message:r.message})}});le.get("/certifications",(o,e,r)=>{It.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserCertificationsController:r}=Am();await r.handle(o,e)});le.get("/pendencies",(o,e,r)=>{It.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserPendenciesController:r}=Um();await r.handle(o,e)});import{Router as Ll}from"express";import{getStorage as Bl}from"firebase-admin/storage";import{config as Fl}from"dotenv";import Dm from"firebase-admin";Fl();var Vn=Dm.initializeApp({credential:Dm.credential.cert({clientEmail:W.FIREBASE_CLIENT_EMAIL,privateKey:W.FIREBASE_PRIVATE_KEY,projectId:W.FIREBASE_PROJECT_ID,type:W.FIREBASE_TYPE,privateKeyId:W.FIREBASE_PRIVATE_KEY_ID,clientId:W.FIREBASE_CLIENT_ID,authUri:W.FIREBASE_AUTH_URI,tokenUri:W.FIREBASE_TOKEN_URI,authProviderX509CertUrl:W.FIREBASE_AUTH_PROVIDER_X509_CERT_URL,clientX509CertUrl:W.FIREBASE_CLIENT_X509_CERT_URL}),storageBucket:W.FIREBASE_BUCKET});Vn.name?console.log("\u{1F525} Firebase conectado com sucesso!"):console.error("\u274C Erro ao se conectar ao Firebase.");var Ol=Bl(Vn),qm=Ol.bucket(W.FIREBASE_BUCKET);import{randomUUID as Nl}from"node:crypto";var kl=/https:\/\/storage\.googleapis\.com\/[^/]+\/(.+)$/,Co=class{constructor(e){this.bucket=e}async uploadFile({file:e,folder:r,id:t}){let i=`${Nl()}-${e?.originalname}`,n=this.bucket.file(`${r}/${t}/${i}`);return await new Promise((s,m)=>{let c=n.createWriteStream({metadata:{contentType:e?.mimetype}});c.on("error",u=>{m(u)}),c.on("finish",async()=>{try{await n.makePublic();let u=`https://storage.googleapis.com/${this.bucket.name}/${n.name}`;s(u)}catch(u){m(u)}}),c.end(e.buffer)})}async updateFile({file:e,id:r,fileUrl:t,folder:i}){try{let n=this.getPath(t);if(!n)throw new Error("Arquivo n\xE3o encontrado.");let[s,m]=await Promise.all([this.bucket.file(n).delete(),this.uploadFile({file:e,id:r,folder:i})]);return m}catch{throw new Error("Erro ao atualizar o arquivo.")}}async deleteFile({fileUrl:e}){let r=this.getPath(e);if(!r)throw new Error("Arquivo n\xE3o encontrado.");try{await this.bucket.file(r).delete()}catch{throw new Error("Erro ao deletar o arquivo.")}}getPath(e){let r=e.match(kl);return r?r[1]:null}};function B(){return new Co(qm)}function Fm(){return{registerCertificationController:new Bt(K(),Ee(),B())}}function Bm(){return{findCertificationsController:new Ft(Ee())}}function Om(){return{findCertificationByIdController:new qt(Ee())}}function Nm(){return{updateCertificationController:new Nt(Ee(),B())}}function km(){return{deleteCertificationController:new Dt(Ee(),B())}}import Lm from"multer";var N=Lm({storage:Lm.memoryStorage()});var He=Ll(),{authMiddleware:bt}=F();He.post("/:user_id",(o,e,r)=>{bt.isAdmin(o,e,r)},N.single("certification"),async(o,e)=>{let{registerCertificationController:r}=Fm();await r.handle(o,e)});He.get("/",(o,e,r)=>{bt.isAdmin(o,e,r)},async(o,e)=>{let{findCertificationsController:r}=Bm();await r.handle(o,e)});He.get("/:certification_id",(o,e,r)=>{bt.isAdmin(o,e,r)},async(o,e)=>{let{findCertificationByIdController:r}=Om();await r.handle(o,e)});He.put("/:certification_id",(o,e,r)=>{bt.isAdmin(o,e,r)},N.single("certification"),async(o,e)=>{let{updateCertificationController:r}=Nm();await r.handle(o,e)});He.delete("/:certification_id",(o,e,r)=>{bt.isAdmin(o,e,r)},async(o,e)=>{let{deleteCertificationController:r}=km();await r.handle(o,e)});import{Router as Zl}from"express";import{extendZodWithOpenApi as Hl}from"@asteasolutions/zod-to-openapi";import ge from"zod";var _l=1,zl=9;Hl(ge);var Wl=ge.object({page:ge.coerce.number().min(1).default(_l),limit:ge.coerce.number().min(1).default(zl),code:ge.string().optional(),title:ge.string().optional(),description:ge.string().optional(),notes:ge.string().optional(),orderBy:ge.enum(["asc","desc"]).default("desc")}),So=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Wl.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.etpRepository.find({pagination:{offset:s,limit:i},filter:n}),this.etpRepository.count({filter:n})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:s,limit:i,etps:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var vo=class{constructor(e){this.prisma=e}async create(e){let{leaderId:r,deputyLeaderId:t,secretaryId:i,memberIds:n,...s}=e;await this.prisma.$transaction(async m=>{let c=await m.eTP.create({data:s});await m.eTPLeader.create({data:{etpId:c.id,researcherId:r}}),await m.eTPDeputy.create({data:{etpId:c.id,researcherId:t}}),await m.eTPSecretary.create({data:{etpId:c.id,researcherId:i}}),await m.eTP.update({where:{id:c.id},data:{members:{connect:n.map(u=>({id:u}))}}})})}async update(e){let{leaderId:r,deputyLeaderId:t,secretaryId:i,memberIds:n,...s}=e;await this.prisma.$transaction(async m=>{await m.eTP.update({where:{id:e.id},data:s}),await this.updateLeader(m,e.id,r),await this.updateDeputyLeader(m,e.id,t),await this.updateSecretary(m,e.id,i),await this.updateMembers(m,e.id,n)})}async updateLeader(e,r,t){t!==void 0&&(await e.eTPLeader.deleteMany({where:{etpId:r}}),t&&await e.eTPLeader.create({data:{etpId:r,researcherId:t}}))}async updateDeputyLeader(e,r,t){t!==void 0&&(await e.eTPDeputy.deleteMany({where:{etpId:r}}),t&&await e.eTPDeputy.create({data:{etpId:r,researcherId:t}}))}async updateSecretary(e,r,t){t!==void 0&&(await e.eTPSecretary.deleteMany({where:{etpId:r}}),t&&await e.eTPSecretary.create({data:{etpId:r,researcherId:t}}))}async updateMembers(e,r,t){t!==void 0&&await e.eTP.update({where:{id:r},data:{members:{set:t.map(i=>({id:i}))}}})}async deleteById(e){await this.prisma.eTP.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{code:t,title:i,description:n,notes:s,orderBy:m}}){let c={},u=[];return t&&u.push({code:{contains:t,mode:"insensitive"}}),i&&u.push({title:{contains:i,mode:"insensitive"}}),n&&u.push({description:{contains:n,mode:"insensitive"}}),s&&u.push({notes:{contains:s,mode:"insensitive"}}),u.length>0&&(c.OR=u),await this.prisma.eTP.findMany({where:c,include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}},orderBy:{updatedAt:m},skip:e,take:r})}async findById(e){return await this.prisma.eTP.findFirst({where:{id:e},include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}}})}async findByCode(e){return await this.prisma.eTP.findFirst({where:{code:e},include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}}})}async count({filter:{code:e,title:r,description:t,notes:i}}){let n={},s=[];return e&&s.push({code:{contains:e,mode:"insensitive"}}),r&&s.push({title:{contains:r,mode:"insensitive"}}),t&&s.push({description:{contains:t,mode:"insensitive"}}),i&&s.push({notes:{contains:i,mode:"insensitive"}}),s.length>0&&(n.OR=s),await this.prisma.eTP.count({where:n})}};function at(){return new vo(q)}function Hm(){return{createETPController:new Lt(at())}}function _m(){return{findETPsController:new So(at())}}function zm(){return{findETPByIdController:new _t(at())}}function Wm(){return{updateETPController:new Wt(at())}}function Zm(){return{deleteETPController:new Ht(at())}}var _e=Zl(),{authMiddleware:Gn}=F();_e.post("/",(o,e,r)=>{Gn.authenticated(o,e,r)},async(o,e)=>{let{createETPController:r}=Hm();await r.handle(o,e)});_e.get("/",async(o,e)=>{let{findETPsController:r}=_m();await r.handle(o,e)});_e.get("/:id",async(o,e)=>{let{findETPByIdController:r}=zm();await r.handle(o,e)});_e.put("/:id",(o,e,r)=>{Gn.authenticated(o,e,r)},async(o,e)=>{let{updateETPController:r}=Wm();await r.handle(o,e)});_e.delete("/:id",(o,e,r)=>{Gn.authenticated(o,e,r)},async(o,e)=>{let{deleteETPController:r}=Zm();await r.handle(o,e)});import{Router as Vl}from"express";var Mo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.inMemoriam.create({data:e})}async update(e){await this.prisma.inMemoriam.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.inMemoriam.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{name:t,biography:i,role:n,orderBy:s}}){let m={},c=[];return n&&(m.role=n),t&&c.push({name:{contains:t,mode:"insensitive"}}),i&&c.push({biography:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.inMemoriam.findMany({where:m,orderBy:{updatedAt:s},skip:e,take:r})}async findById(e){return await this.prisma.inMemoriam.findFirst({where:{id:e}})}async findByRole(e){return await this.prisma.inMemoriam.findMany({where:{role:e}})}async count({filter:{name:e,biography:r,role:t}}){let i={},n=[];return t&&(i.role=t),e&&n.push({name:{contains:e,mode:"insensitive"}}),r&&n.push({biography:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.inMemoriam.count({where:i})}};function ze(){return new Mo(q)}function Vm(){return{createInMemoriamController:new Vt(ze(),B())}}function Gm(){return{findInMemoriamsController:new Xt(ze())}}function Km(){return{findInMemoriamByIdController:new Kt(ze())}}function Ym(){return{findInMemoriamByRoleController:new $t(ze())}}function $m(){return{updateInMemoriamController:new Jt(ze(),B())}}function Xm(){return{deleteInMemoriamController:new Gt(ze(),B())}}var xe=Vl(),{authMiddleware:Kn}=F();xe.post("/",(o,e,r)=>{Kn.authenticated(o,e,r)},N.single("photo"),async(o,e)=>{let{createInMemoriamController:r}=Vm();await r.handle(o,e)});xe.get("/",async(o,e)=>{let{findInMemoriamsController:r}=Gm();await r.handle(o,e)});xe.get("/:id",async(o,e)=>{let{findInMemoriamByIdController:r}=Km();await r.handle(o,e)});xe.get("/role/:role",async(o,e)=>{let{findInMemoriamByRoleController:r}=Ym();await r.handle(o,e)});xe.put("/:id",(o,e,r)=>{Kn.authenticated(o,e,r)},N.single("photo"),async(o,e)=>{let{updateInMemoriamController:r}=$m();await r.handle(o,e)});xe.delete("/:id",(o,e,r)=>{Kn.authenticated(o,e,r)},async(o,e)=>{let{deleteInMemoriamController:r}=Xm();await r.handle(o,e)});import{Router as Gl}from"express";var Yn=Gl();Yn.get("/",(o,e)=>{e.status(200).json({message:"Rede CT"})});import{Router as Kl}from"express";var Eo=class{constructor(e){this.prisma=e}async create(e){await this.prisma.internationalScientificCongress.create({data:e})}async update(e){await this.prisma.internationalScientificCongress.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.internationalScientificCongress.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,edition:i,orderBy:n}}){let s={},m=[];return i&&(s.edition=i),t&&m.push({title:{contains:t,mode:"insensitive"}}),m.length>0&&(s.OR=m),await this.prisma.internationalScientificCongress.findMany({where:s,include:{partners:!0,galleries:!0},orderBy:n?{startDate:n}:{startDate:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.internationalScientificCongress.findFirst({where:{id:e},include:{partners:!0,galleries:!0}})}async findByEdition(e){return await this.prisma.internationalScientificCongress.findMany({where:{edition:e},include:{partners:!0,galleries:!0}})}async count({filter:{title:e,edition:r}}){let t={},i=[];return r&&(t.edition=r),e&&i.push({title:{contains:e,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.internationalScientificCongress.count({where:t})}};function We(){return new Eo(q)}function Jm(){return{createInternationalScientificCongressController:new Qt(We())}}function Qm(){return{findInternationalScientificCongressesController:new ir(We())}}function ec(){return{findInternationalScientificCongressByIdController:new rr(We())}}function tc(){return{findInternationalScientificCongressByEditionController:new tr(We())}}function rc(){return{updateInternationalScientificCongressController:new nr(We())}}function oc(){return{deleteInternationalScientificCongressController:new er(We())}}var Te=Kl(),{authMiddleware:$n}=F();Te.post("/",(o,e,r)=>{$n.authenticated(o,e,r)},async(o,e)=>{let{createInternationalScientificCongressController:r}=Jm();await r.handle(o,e)});Te.get("/",async(o,e)=>{let{findInternationalScientificCongressesController:r}=Qm();await r.handle(o,e)});Te.get("/:id",async(o,e)=>{let{findInternationalScientificCongressByIdController:r}=ec();await r.handle(o,e)});Te.get("/edition/:edition",async(o,e)=>{let{findInternationalScientificCongressByEditionController:r}=tc();await r.handle(o,e)});Te.put("/:id",(o,e,r)=>{$n.authenticated(o,e,r)},async(o,e)=>{let{updateInternationalScientificCongressController:r}=rc();await r.handle(o,e)});Te.delete("/:id",(o,e,r)=>{$n.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressController:r}=oc();await r.handle(o,e)});import{Router as Xl}from"express";import{extendZodWithOpenApi as Yl}from"@asteasolutions/zod-to-openapi";import jo from"zod";Yl(jo);var $l=jo.object({role:jo.string().optional(),orderBy:jo.enum(["asc","desc"]).optional()}),xo=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let t=$l.parse(e.query),i=await this.legitimatorCommitteeMemberRepository.find({filter:t});r.status(200).json({members:i})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var To=class{constructor(e){this.prisma=e}async create(e){await this.prisma.legitimatorCommitteeMember.create({data:{...e,order:e.order??0}})}async update(e){let{id:r,...t}=e;await this.prisma.legitimatorCommitteeMember.update({where:{id:r},data:t})}async deleteById(e){await this.prisma.legitimatorCommitteeMember.delete({where:{id:e}})}async find({filter:{role:e,orderBy:r}}){let t={};return e&&(t.role={contains:e,mode:"insensitive"}),await this.prisma.legitimatorCommitteeMember.findMany({where:t,include:{user:{omit:{passwordHash:!0}}},orderBy:r?[{order:"asc"},{updatedAt:r}]:[{order:"asc"},{updatedAt:"desc"}]})}async findById(e){return await this.prisma.legitimatorCommitteeMember.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{role:e}}){let r={};return e&&(r.role={contains:e,mode:"insensitive"}),await this.prisma.legitimatorCommitteeMember.count({where:r})}};function mt(){return new To(q)}function ic(){return{createLegitimatorCommitteeMemberController:new sr(mt())}}function nc(){return{findLegitimatorCommitteeMembersController:new xo(mt())}}function sc(){return{findLegitimatorCommitteeMemberByIdController:new mr(mt())}}function ac(){return{updateLegitimatorCommitteeMemberController:new pr(mt())}}function mc(){return{deleteLegitimatorCommitteeMemberController:new ar(mt())}}var Ze=Xl(),{authMiddleware:Xn}=F();Ze.post("/",(o,e,r)=>{Xn.authenticated(o,e,r)},async(o,e)=>{let{createLegitimatorCommitteeMemberController:r}=ic();await r.handle(o,e)});Ze.get("/",async(o,e)=>{let{findLegitimatorCommitteeMembersController:r}=nc();await r.handle(o,e)});Ze.get("/:id",async(o,e)=>{let{findLegitimatorCommitteeMemberByIdController:r}=sc();await r.handle(o,e)});Ze.put("/:id",(o,e,r)=>{Xn.authenticated(o,e,r)},async(o,e)=>{let{updateLegitimatorCommitteeMemberController:r}=ac();await r.handle(o,e)});Ze.delete("/:id",(o,e,r)=>{Xn.authenticated(o,e,r)},async(o,e)=>{let{deleteLegitimatorCommitteeMemberController:r}=mc();await r.handle(o,e)});import{Router as eg}from"express";import{extendZodWithOpenApi as Jl}from"@asteasolutions/zod-to-openapi";import wt from"zod";Jl(wt);var Ql=wt.object({name:wt.string().optional(),description:wt.string().optional(),orderBy:wt.enum(["asc","desc"]).default("desc")}),Po=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let t=Ql.parse(e.query),i=await this.managementTeamRepository.find({filter:t});r.status(200).json({teams:i})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Ao=class{constructor(e){this.prisma=e}async create(e){let{members:r,...t}=e;await this.prisma.$transaction(async i=>{let n=await i.managementTeam.create({data:t});return await i.managementTeamMember.createMany({data:r.map(({userId:s,role:m,order:c})=>({teamId:n.id,userId:s,role:m,order:c??0}))}),n})}async update(e){let{members:r,...t}=e;await this.prisma.$transaction(async i=>{let n=await i.managementTeam.update({where:{id:e.id},data:t});return r!==void 0&&(await i.managementTeamMember.deleteMany({where:{teamId:e.id}}),r.length>0&&await i.managementTeamMember.createMany({data:r.map(({userId:s,role:m,order:c})=>({teamId:e.id,userId:s,role:m,order:c??0}))})),n})}async deleteById(e){await this.prisma.managementTeam.delete({where:{id:e}})}async find({filter:{name:e,description:r,orderBy:t}}){let i={},n=[];return e&&n.push({name:{contains:e,mode:"insensitive"}}),r&&n.push({description:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.managementTeam.findMany({where:i,include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}},orderBy:{updatedAt:t}})}async findById(e){return await this.prisma.managementTeam.findFirst({where:{id:e},include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}}})}async findByName(e){return await this.prisma.managementTeam.findFirst({where:{name:e},include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}}})}async count({filter:{name:e,description:r}}){let t={},i=[];return e&&i.push({name:{contains:e,mode:"insensitive"}}),r&&i.push({description:{contains:r,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.managementTeam.count({where:t})}};function ct(){return new Ao(q)}function cc(){return{createManagementTeamController:new dr(ct())}}function pc(){return{findManagementTeamsController:new Po(ct())}}function dc(){return{findManagementTeamByIdController:new lr(ct())}}function uc(){return{updateManagementTeamController:new fr(ct())}}function lc(){return{deleteManagementTeamController:new ur(ct())}}var Ve=eg(),{authMiddleware:Jn}=F();Ve.post("/",(o,e,r)=>{Jn.authenticated(o,e,r)},async(o,e)=>{let{createManagementTeamController:r}=cc();await r.handle(o,e)});Ve.get("/",async(o,e)=>{let{findManagementTeamsController:r}=pc();await r.handle(o,e)});Ve.get("/:id",async(o,e)=>{let{findManagementTeamByIdController:r}=dc();await r.handle(o,e)});Ve.put("/:id",(o,e,r)=>{Jn.authenticated(o,e,r)},async(o,e)=>{let{updateManagementTeamController:r}=uc();await r.handle(o,e)});Ve.delete("/:id",(o,e,r)=>{Jn.authenticated(o,e,r)},async(o,e)=>{let{deleteManagementTeamController:r}=lc();await r.handle(o,e)});import{Router as og}from"express";var Uo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.meeting.create({data:e})}async update(e){await this.prisma.meeting.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.meeting.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,format:i,status:n,orderBy:s}}){let m={},c=[];return i&&(m.format=i),n&&(m.status=n),t&&c.push({title:{contains:t,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.meeting.findMany({where:m,include:{minutes:!0},orderBy:s?{scheduledAt:s}:{scheduledAt:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.meeting.findFirst({where:{id:e},include:{minutes:!0}})}async findByStatus(e){return await this.prisma.meeting.findMany({where:{status:e},include:{minutes:!0}})}async count({filter:{title:e,format:r,status:t}}){let i={},n=[];return r&&(i.format=r),t&&(i.status=t),e&&n.push({title:{contains:e,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.meeting.count({where:i})}};function fe(){return new Uo(q)}function gc(){return{createMeetingController:new br(fe())}}function fc(){return{findMeetingsController:new Mr(fe())}}function yc(){return{findMeetingByIdController:new Cr(fe())}}function hc(){return{findMeetingByStatusController:new vr(fe())}}function Rc(){return{updateMeetingController:new Er(fe())}}function Ic(){return{deleteMeetingController:new wr(fe())}}import{extendZodWithOpenApi as tg}from"@asteasolutions/zod-to-openapi";import Qn from"zod";tg(Qn);var rg=Qn.object({meetingId:Qn.uuid()}),Do=class{constructor(e,r){this.meetingMinuteRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{meetingId:t}=rg.parse({meetingId:e.params.meetingId}),i=await this.meetingMinuteRepository.findByMeetingId(t);if(!i)throw new d("A ata n\xE3o existe para esta reuni\xE3o.");return i.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl}),await this.meetingMinuteRepository.deleteByMeetingId(i.id),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var qo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.meetingMinute.create({data:e,include:{meeting:!0}})}async update(e){await this.prisma.meetingMinute.update({where:{id:e.id},data:e})}async deleteByMeetingId(e){await this.prisma.meetingMinute.delete({where:{id:e}})}async findByMeetingId(e){return await this.prisma.meetingMinute.findFirst({where:{meetingId:e},include:{meeting:!0}})}};function Ct(){return new qo(q)}function bc(){return{createMeetingMinuteController:new yr(Ct(),fe(),B())}}function wc(){return{findMeetingMinuteByMeetingIdController:new hr(Ct())}}function Cc(){return{updateMeetingMinuteByMeetingIdController:new Rr(Ct(),B())}}function Sc(){return{deleteMeetingMinuteByMeetingIdController:new Do(Ct(),B())}}var ee=og(),{authMiddleware:pt}=F();ee.post("/",(o,e,r)=>{pt.authenticated(o,e,r)},async(o,e)=>{let{createMeetingController:r}=gc();await r.handle(o,e)});ee.get("/",async(o,e)=>{let{findMeetingsController:r}=fc();await r.handle(o,e)});ee.get("/:id",async(o,e)=>{let{findMeetingByIdController:r}=yc();await r.handle(o,e)});ee.get("/status/:status",async(o,e)=>{let{findMeetingByStatusController:r}=hc();await r.handle(o,e)});ee.put("/:id",(o,e,r)=>{pt.authenticated(o,e,r)},async(o,e)=>{let{updateMeetingController:r}=Rc();await r.handle(o,e)});ee.delete("/:id",(o,e,r)=>{pt.authenticated(o,e,r)},async(o,e)=>{let{deleteMeetingController:r}=Ic();await r.handle(o,e)});ee.post("/:meetingId/minute",(o,e,r)=>{pt.authenticated(o,e,r)},N.single("document"),async(o,e)=>{let{createMeetingMinuteController:r}=bc();await r.handle(o,e)});ee.get("/:meetingId/minute",async(o,e)=>{let{findMeetingMinuteByMeetingIdController:r}=wc();await r.handle(o,e)});ee.put("/:meetingId/minute",(o,e,r)=>{pt.authenticated(o,e,r)},N.single("document"),async(o,e)=>{let{updateMeetingMinuteByMeetingIdController:r}=Cc();await r.handle(o,e)});ee.delete("/:meetingId/minute",(o,e,r)=>{pt.authenticated(o,e,r)},async(o,e)=>{let{deleteMeetingMinuteByMeetingIdController:r}=Sc();await r.handle(o,e)});import{Router as dg}from"express";import{extendZodWithOpenApi as ig}from"@asteasolutions/zod-to-openapi";import es from"zod";ig(es);var ng=es.object({id:es.string()}),Fo=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=ng.parse(e.params),i=e.user.id,n=await this.newsRepository.findById(t);if(!n)throw new d("Not\xEDcia n\xE3o encontrada.");if(n.author.id!==i)throw new $("Sem permiss\xE3o.");await Promise.all([this.newsRepository.delete(t),this.firebaseStorageService.deleteFile({fileUrl:n.imageUrl})]),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as sg}from"@asteasolutions/zod-to-openapi";import dt from"zod";var ag=5,vc=1024,mg=vc*vc,cg=ag*mg;sg(dt);var pg=dt.object({id:dt.string(),title:dt.string().min(1),content:dt.string().min(1),image:dt.any().optional().refine(o=>!o||typeof o=="object"&&typeof o.mimetype=="string"&&o.mimetype.startsWith("image/")&&typeof o.size=="number"&&o.size<=cg,"A imagem deve ser uma imagem v\xE1lida de no m\xE1ximo 5MB.")}),Bo=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,title:i,content:n,image:s}=pg.parse({id:e.params.id,image:e.file,...e.body}),m=await this.newsRepository.findById(t);if(!m)throw new d("Not\xEDcia n\xE3o encontrada.");let c=e.user.id;if(m.author.id!==c)throw new $("Sem permiss\xE3o.");let u=m.imageUrl||"";s&&m.imageUrl&&(u=await this.firebaseStorageService.updateFile({file:s,folder:O.NEWS,id:t,fileUrl:m.imageUrl}));let P=await this.newsRepository.update({id:t,title:i,content:n,imageUrl:u});r.status(200).json(P)}catch(t){if(t instanceof Error)throw new a(t.message)}}};function Mc(){return{createNewsController:new jr(ue(),B())}}function Ec(){return{findAllNewsController:new Ar(ue())}}function jc(){return{findNewsByIdController:new Pr(ue())}}function xc(){return{findNewsByAuthorIdController:new xr(ue())}}function Tc(){return{updateNewsController:new Bo(ue(),B())}}function Pc(){return{deleteNewsController:new Fo(ue(),B())}}var Pe=dg(),{authMiddleware:ts}=F();Pe.post("/",(o,e,r)=>{ts.authenticated(o,e,r)},N.single("image"),async(o,e)=>{let{createNewsController:r}=Mc();await r.handle(o,e)});Pe.get("/",async(o,e)=>{let{findAllNewsController:r}=Ec();await r.handle(o,e)});Pe.get("/:id",async(o,e)=>{let{findNewsByIdController:r}=jc();await r.handle(o,e)});Pe.get("/author/:authorId",async(o,e)=>{let{findNewsByAuthorIdController:r}=xc();await r.handle(o,e)});Pe.put("/:id",(o,e,r)=>{ts.authenticated(o,e,r)},N.single("image"),async(o,e)=>{let{updateNewsController:r}=Tc();await r.handle(o,e)});Pe.delete("/:id",(o,e,r)=>{ts.authenticated(o,e,r)},async(o,e)=>{let{deleteNewsController:r}=Pc();await r.handle(o,e)});import{Router as ug}from"express";var Oo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.partner.create({data:e})}async update(e){await this.prisma.partner.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.partner.delete({where:{id:e}})}async find({pagination:e,filter:{name:r,description:t,category:i,isActive:n,orderBy:s}}){let m={},c=[];return n!==void 0&&(m.isActive=n),r&&c.push({name:{contains:r,mode:"insensitive"}}),t&&c.push({description:{contains:t,mode:"insensitive"}}),i&&c.push({category:{contains:i,mode:"insensitive"}}),c.length>0&&(m.OR=c),await this.prisma.partner.findMany({where:m,orderBy:s?{updatedAt:s}:{updatedAt:"desc"},...e&&{skip:e.offset,take:e.limit}})}async findById(e){return await this.prisma.partner.findFirst({where:{id:e}})}async count({filter:{name:e,description:r,category:t,isActive:i}}){let n={},s=[];return i!==void 0&&(n.isActive=i),e&&s.push({name:{contains:e,mode:"insensitive"}}),r&&s.push({description:{contains:r,mode:"insensitive"}}),t&&s.push({category:{contains:t,mode:"insensitive"}}),s.length>0&&(n.OR=s),await this.prisma.partner.count({where:n})}};function ut(){return new Oo(q)}function Ac(){return{createPartnerController:new Ur(ut(),B())}}function Uc(){return{findPartnersController:new Br(ut())}}function Dc(){return{findPartnerByIdController:new qr(ut())}}function qc(){return{updatePartnerController:new Or(ut(),B())}}function Fc(){return{deletePartnerController:new Dr(ut(),B())}}var Ge=ug(),{authMiddleware:rs}=F();Ge.post("/",(o,e,r)=>{rs.authenticated(o,e,r)},N.single("logo"),async(o,e)=>{let{createPartnerController:r}=Ac();await r.handle(o,e)});Ge.get("/",async(o,e)=>{let{findPartnersController:r}=Uc();await r.handle(o,e)});Ge.get("/:id",async(o,e)=>{let{findPartnerByIdController:r}=Dc();await r.handle(o,e)});Ge.put("/:id",(o,e,r)=>{rs.authenticated(o,e,r)},N.single("logo"),async(o,e)=>{let{updatePartnerController:r}=qc();await r.handle(o,e)});Ge.delete("/:id",(o,e,r)=>{rs.authenticated(o,e,r)},async(o,e)=>{let{deletePartnerController:r}=Fc();await r.handle(o,e)});import{Router as lg}from"express";function Bc(){return{createPendencyController:new Nr(K(),je(),B())}}function Oc(){return{findPendenciesController:new Hr(je())}}function Nc(){return{findPendencyByIdController:new _r(je())}}function kc(){return{updatePendencyController:new zr(je(),B())}}function Lc(){return{deletePendencyController:new Lr(je(),B())}}var Ke=lg(),{authMiddleware:St}=F();Ke.post("/:user_id",(o,e,r)=>{St.isAdmin(o,e,r)},N.single("document"),async(o,e)=>{let{createPendencyController:r}=Bc();await r.handle(o,e)});Ke.get("/",(o,e,r)=>{St.isAdmin(o,e,r)},async(o,e)=>{let{findPendenciesController:r}=Oc();await r.handle(o,e)});Ke.get("/:pendency_id",(o,e,r)=>{St.isAdmin(o,e,r)},async(o,e)=>{let{findPendencyByIdController:r}=Nc();await r.handle(o,e)});Ke.put("/:pendency_id",(o,e,r)=>{St.isAdmin(o,e,r)},N.single("document"),async(o,e)=>{let{updatePendencyController:r}=kc();await r.handle(o,e)});Ke.delete("/:pendency_id",(o,e,r)=>{St.isAdmin(o,e,r)},async(o,e)=>{let{deletePendencyController:r}=Lc();await r.handle(o,e)});import{Router as gg}from"express";var No=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.regiment.create({data:e})}async update(e){await this.prisma.regiment.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.regiment.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,status:i,orderBy:n}}){let s={},m=[];return i&&(s.status=i),t&&m.push({title:{contains:t,mode:"insensitive"}}),m.length>0&&(s.OR=m),await this.prisma.regiment.findMany({where:s,orderBy:n?{updatedAt:n}:{updatedAt:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.regiment.findFirst({where:{id:e}})}async findByStatus(e){return await this.prisma.regiment.findMany({where:{status:e}})}async count({filter:{title:e,status:r}}){let t={},i=[];return r&&(t.status=r),e&&i.push({title:{contains:e,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.regiment.count({where:t})}};function Ye(){return new No(q)}function Hc(){return{createRegimentController:new Zr(Ye(),B())}}function _c(){return{findRegimentsController:new $r(Ye())}}function zc(){return{findRegimentByIdController:new Gr(Ye())}}function Wc(){return{findRegimentByStatusController:new Yr(Ye())}}function Zc(){return{updateRegimentController:new Xr(Ye(),B())}}function Vc(){return{deleteRegimentController:new Vr(Ye(),B())}}var Ae=gg(),{authMiddleware:os}=F();Ae.post("/",(o,e,r)=>{os.authenticated(o,e,r)},N.single("document"),async(o,e)=>{let{createRegimentController:r}=Hc();await r.handle(o,e)});Ae.get("/",async(o,e)=>{let{findRegimentsController:r}=_c();await r.handle(o,e)});Ae.get("/:id",async(o,e)=>{let{findRegimentByIdController:r}=zc();await r.handle(o,e)});Ae.get("/status/:status",async(o,e)=>{let{findRegimentByStatusController:r}=Wc();await r.handle(o,e)});Ae.put("/:id",(o,e,r)=>{os.authenticated(o,e,r)},N.single("document"),async(o,e)=>{let{updateRegimentController:r}=Zc();await r.handle(o,e)});Ae.delete("/:id",(o,e,r)=>{os.authenticated(o,e,r)},async(o,e)=>{let{deleteRegimentController:r}=Vc();await r.handle(o,e)});import{Router as Ig}from"express";import{extendZodWithOpenApi as fg}from"@asteasolutions/zod-to-openapi";import G from"zod";var yg=1,hg=9;fg(G);var Rg=G.object({page:G.coerce.number().min(1).default(yg),limit:G.coerce.number().min(1).default(hg),userId:G.string().optional(),registrationNumber:G.string().optional(),name:G.string().optional(),emailAddress:G.string().optional(),mainEtps:G.string().optional(),formations:G.string().optional(),occupations:G.string().optional(),institutions:G.string().optional(),biography:G.string().optional(),orderBy:G.enum(["asc","desc"]).default("desc")}),ko=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Rg.parse(e.query),s=i*t-i,[m,c]=await Promise.all([this.researcherRepository.find({pagination:{offset:s,limit:i},filter:{userName:n.name,...n}}),this.researcherRepository.count({filter:{userName:n.name,...n}})]),u=Math.max(Math.ceil(c/i),1);r.status(200).json({page:t,totalPages:u,offset:s,limit:i,researchers:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Lo=class{constructor(e){this.prisma=e}async create(e){await this.prisma.researcher.create({data:e})}async update(e){await this.prisma.researcher.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.researcher.delete({where:{id:e}})}async find({pagination:e,filter:{biography:r,degrees:t,formations:i,institutions:n,mainEtps:s,occupations:m,orderBy:c,registrationNumber:u,seniority:P,userId:D,userName:L}}){let Z={},ae=[];return L&&ae.push({user:{name:{contains:L,mode:"insensitive"}}}),u&&ae.push({registrationNumber:{contains:u,mode:"insensitive"}}),s&&ae.push({mainEtps:{contains:s,mode:"insensitive"}}),i&&ae.push({formations:{contains:i,mode:"insensitive"}}),m&&ae.push({occupations:{contains:m,mode:"insensitive"}}),n&&ae.push({institutions:{contains:n,mode:"insensitive"}}),r&&ae.push({biography:{contains:r,mode:"insensitive"}}),ae.length>0&&(Z.OR=ae),t&&t.length>0&&(Z.degrees={hasSome:t}),P&&(Z.seniority=P),D&&(Z.userId={equals:D}),await this.prisma.researcher.findMany({where:Z,omit:{userId:!0},include:{user:{omit:{passwordHash:!0}}},orderBy:{updatedAt:c},...e&&{skip:e.offset,take:e.limit}})}async findById(e){return await this.prisma.researcher.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async findByUserId(e){return await this.prisma.researcher.findFirst({where:{userId:e},include:{user:{omit:{passwordHash:!0}}}})}async findByRegistrationNumber(e){return await this.prisma.researcher.findFirst({where:{registrationNumber:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{biography:e,degrees:r,formations:t,institutions:i,mainEtps:n,occupations:s,registrationNumber:m,seniority:c,userId:u,userName:P}}){let D={},L=[];return P&&L.push({user:{name:{contains:P,mode:"insensitive"}}}),m&&L.push({registrationNumber:{contains:m,mode:"insensitive"}}),L.length>0&&(D.OR=L),n&&(D.mainEtps={contains:n,mode:"insensitive"}),t&&(D.formations={contains:t,mode:"insensitive"}),r&&r.length>0&&(D.degrees={hasSome:r}),s&&(D.occupations={contains:s,mode:"insensitive"}),c&&(D.seniority=c),i&&(D.institutions={contains:i,mode:"insensitive"}),e&&(D.biography={contains:e,mode:"insensitive"}),u&&(D.userId={equals:u}),await this.prisma.researcher.count({where:D})}};function $e(){return new Lo(q)}function Gc(){return{createResearcherController:new Jr($e())}}function Kc(){return{findResearchersController:new ko($e())}}function Yc(){return{findResearcherByIdController:new eo($e())}}function $c(){return{findResearcherByUserIdController:new ro($e())}}function Xc(){return{updateResearcherController:new oo($e())}}function Jc(){return{deleteResearcherController:new Qr($e())}}var Ue=Ig(),{authMiddleware:is}=F();Ue.post("/",(o,e,r)=>{is.authenticated(o,e,r)},async(o,e)=>{let{createResearcherController:r}=Gc();await r.handle(o,e)});Ue.get("/",async(o,e)=>{let{findResearchersController:r}=Kc();await r.handle(o,e)});Ue.get("/:id",async(o,e)=>{let{findResearcherByIdController:r}=Yc();await r.handle(o,e)});Ue.get("/user/:userId",async(o,e)=>{let{findResearcherByUserIdController:r}=$c();await r.handle(o,e)});Ue.put("/:id",(o,e,r)=>{is.authenticated(o,e,r)},async(o,e)=>{let{updateResearcherController:r}=Xc();await r.handle(o,e)});Ue.delete("/:id",(o,e,r)=>{is.authenticated(o,e,r)},async(o,e)=>{let{deleteResearcherController:r}=Jc();await r.handle(o,e)});import{Router as Cg}from"express";import{extendZodWithOpenApi as bg}from"@asteasolutions/zod-to-openapi";import Ho from"zod";bg(Ho);var wg=Ho.object({role:Ho.string().optional(),orderBy:Ho.enum(["asc","desc"]).optional()}),_o=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let t=wg.parse(e.query),i=await this.sdhcTeamMemberRepository.find({filter:t});r.status(200).json({members:i})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var zo=class{constructor(e){this.prisma=e}async create(e){await this.prisma.sDHCTeamMember.create({data:{...e,order:e.order??0}})}async update(e){let{id:r,...t}=e;await this.prisma.sDHCTeamMember.update({where:{id:r},data:t})}async deleteById(e){await this.prisma.sDHCTeamMember.delete({where:{id:e}})}async find({filter:{role:e,orderBy:r}}){let t={};return e&&(t.role={contains:e,mode:"insensitive"}),await this.prisma.sDHCTeamMember.findMany({where:t,include:{user:{omit:{passwordHash:!0}}},orderBy:r?[{order:"asc"},{updatedAt:r}]:[{order:"asc"},{updatedAt:"desc"}]})}async findById(e){return await this.prisma.sDHCTeamMember.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{role:e}}){let r={};return e&&(r.role={contains:e,mode:"insensitive"}),await this.prisma.sDHCTeamMember.count({where:r})}};function lt(){return new zo(q)}function Qc(){return{createSDHCTeamMemberController:new io(lt())}}function ep(){return{findSDHCTeamMembersController:new _o(lt())}}function tp(){return{findSDHCTeamMemberByIdController:new so(lt())}}function rp(){return{updateSDHCTeamMemberController:new mo(lt())}}function op(){return{deleteSDHCTeamMemberController:new no(lt())}}var Xe=Cg(),{authMiddleware:ns}=F();Xe.post("/",(o,e,r)=>{ns.authenticated(o,e,r)},async(o,e)=>{let{createSDHCTeamMemberController:r}=Qc();await r.handle(o,e)});Xe.get("/",async(o,e)=>{let{findSDHCTeamMembersController:r}=ep();await r.handle(o,e)});Xe.get("/:id",async(o,e)=>{let{findSDHCTeamMemberByIdController:r}=tp();await r.handle(o,e)});Xe.put("/:id",(o,e,r)=>{ns.authenticated(o,e,r)},async(o,e)=>{let{updateSDHCTeamMemberController:r}=rp();await r.handle(o,e)});Xe.delete("/:id",(o,e,r)=>{ns.authenticated(o,e,r)},async(o,e)=>{let{deleteSDHCTeamMemberController:r}=op();await r.handle(o,e)});import{Router as Sg}from"express";var Wo=class{constructor(e){this.userRepository=e}async handle(e,r){try{let t=await this.userRepository.find();r.status(200).json(t)}catch(t){if(t instanceof Error)throw new a(t.message)}}};function ip(){return{updateUserController:new uo(K(),B())}}function np(){return{deleteUserController:new co(K())}}function sp(){return{findUsersController:new Wo(K())}}function ap(){return{findUserController:new po(K())}}var gt=Sg(),{authMiddleware:mp}=F();gt.get("/:id",async(o,e)=>{let{findUserController:r}=ap();await r.handle(o,e)});gt.put("/",(o,e,r)=>{mp.authenticated(o,e,r)},N.single("avatarImage"),async(o,e)=>{let{updateUserController:r}=ip();await r.handle(o,e)});gt.delete("/:id",(o,e,r)=>{mp.authenticated(o,e,r)},async(o,e)=>{let{deleteUserController:r}=np();await r.handle(o,e)});gt.get("/",async(o,e)=>{let{findUsersController:r}=sp();await r.handle(o,e)});var k=ss(),Eg={methods:["GET","POST","PUT","DELETE"],origin:["http://localhost:3000","https://rede-ct.vercel.app"],credentials:!0};k.use(Mg(Eg));k.use(ss.json());k.use(ss.urlencoded({extended:!1}));k.use("/docs",vg({content:Mm,theme:"kepler"}));k.use("/",Yn);k.use("/auth",le);k.use("/user",gt);k.use("/news",Pe);k.use("/certification",He);k.use("/pendency",Ke);k.use("/researcher",Ue);k.use("/in-memoriam",xe);k.use("/etp",_e);k.use("/partner",Ge);k.use("/management-team",Ve);k.use("/sdhc-team-member",Xe);k.use("/legitimator-committee-member",Ze);k.use("/regiment",Ae);k.use("/meeting",ee);k.use("/international-scientific-congress",Te);k.use((o,e,r,t)=>{let{errorHandler:i}=as();i.handle(o,e,r,t)});var xg=jg.createServer(k),cp=4e3;xg.listen(cp,()=>{console.log(`\u{1F680} Aplica\xE7\xE3o rodando na porta ${cp}.`)});

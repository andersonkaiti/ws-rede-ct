import Mf from"node:http";import{apiReference as vf}from"@scalar/express-api-reference";import Ef from"cors";import Ts from"express";import Zp from"zod";var V=class extends Error{};var z=class extends Error{};var a=class extends Error{};var d=class extends Error{};var $=class extends Error{};import{ZodError as Wp}from"zod";var Tt=class extends Wp{};var Pt=class{handle(e,r,t,i){return e instanceof Tt?t.status(400).json({message:"Validation error",error:Zp.treeifyError(e)}):e instanceof V?t.status(400).json({message:e.message}):e instanceof d?t.status(404).json({message:e.message}):e instanceof $?t.status(401).json({message:e.message}):e instanceof z?t.status(409).json({message:e.message}):e instanceof a?t.status(500).json({message:e.message}):t.status(500).json({message:"Internal server error"})}};function Ps(){return{errorHandler:new Pt}}import{OpenAPIRegistry as bg,OpenApiGeneratorV3 as Cg}from"@asteasolutions/zod-to-openapi";import{$Enums as As}from"@prisma/client";import u from"zod";import{extendZodWithOpenApi as Vp}from"@asteasolutions/zod-to-openapi";import qe from"zod";var Kp=1,Yp=6;Vp(qe);var pi=qe.object({page:qe.coerce.number().min(1).default(Kp),limit:qe.coerce.number().min(1).default(Yp),title:qe.string().optional(),description:qe.string().optional(),orderBy:qe.enum(["asc","desc"]).default("desc")}),At=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{title:t,description:i,limit:n,orderBy:s,page:m}=pi.parse(e.query),p=m*n-n,l=e.user.id,[P,U]=await Promise.all([this.certificationRepository.findByUserId({userId:l,pagination:{offset:p,limit:n},filter:{title:t,description:i,orderBy:s}}),this.certificationRepository.count({filter:{title:t,description:i,userId:l}})]),k=Math.max(Math.ceil(U/n),1);return r.status(200).json({page:m,totalPages:k,offset:p,limit:n,totalCertifications:U,certifications:P})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Xp}from"@asteasolutions/zod-to-openapi";import Be from"zod";var $p=1,Jp=7;Xp(Be);var di=Be.object({page:Be.coerce.number().min(1).default($p),limit:Be.coerce.number().min(1).default(Jp),title:Be.string().optional(),content:Be.string().optional(),orderBy:Be.enum(["asc","desc"]).default("desc")}),Dt=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,content:n,orderBy:s,title:m}=di.parse(e.query),p=i*t-i,l=e.user.id,[P,U]=await Promise.all([this.newsRepository.findByAuthorId({authorId:l,pagination:{offset:p,limit:i},filter:{orderBy:s,title:m,content:n}}),this.newsRepository.count({filter:{authorId:l,content:n,title:m}})]),k=Math.ceil(U/i);r.status(200).json({page:t,totalPages:k,offset:p,limit:i,news:P})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Qp}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as ed}from"@prisma/client";import Ie from"zod";var td=1,rd=6;Qp(Ie);var li=Ie.object({page:Ie.coerce.number().min(1).default(td),limit:Ie.coerce.number().min(1).default(rd),title:Ie.string().optional(),description:Ie.string().optional(),status:Ie.enum(ed).default("PENDING"),orderBy:Ie.enum(["asc","desc"]).default("desc")}),Ut=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{limit:t,page:i,...n}=li.parse(e.query),s=i*t-t,m=e.user.id,[p,l]=await Promise.all([this.pendencyRepository.findByUserId({userId:m,pagination:{offset:s,limit:t},filter:n}),this.pendencyRepository.count({filter:{...n,userId:m}})]),P=Math.max(Math.ceil(l/t),1);return r.status(200).json({page:i,totalPages:P,offset:s,limit:t,pendencies:p})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as od}from"@asteasolutions/zod-to-openapi";import Ft from"zod";od(Ft);var ui=Ft.object({password:Ft.string(),email:Ft.email()}),qt=class{constructor(e,r,t){this.userRepository=e;this.bcrypt=r;this.jwtService=t}async handle(e,r){try{let{email:t,password:i}=ui.parse(e.body),n=await this.userRepository.findByEmail(t);if(!n)return r.status(401).json({message:"Usu\xE1rio n\xE3o existe."});if(!await this.bcrypt.compare({password:i,hashedPassword:n.passwordHash}))throw new $("Senha inv\xE1lida.");let{id:m,role:p}=n,l=this.jwtService.sign({id:m,role:p,email:t});return r.status(200).json({token:l})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as id}from"@asteasolutions/zod-to-openapi";import Qe from"zod";var Bt=8;id(Qe);var gi=Qe.object({name:Qe.string("Nome \xE9 obrigat\xF3rio.").min(1,"Nome \xE9 obrigat\xF3rio."),emailAddress:Qe.email("E-mail inv\xE1lido.").min(1,"E-mail \xE9 obrigat\xF3rio."),password:Qe.string("A senha \xE9 obrigat\xF3ria.").min(Bt,`A senha deve ter pelo menos ${Bt} caracteres.`),confirmPassword:Qe.string("A senha \xE9 obrigat\xF3ria.").min(Bt,`A senha deve ter pelo menos ${Bt} caracteres.`)}).refine(o=>o.password===o.confirmPassword,{message:"As senhas n\xE3o coincidem.",path:["confirmPassword"]}),Ot=class{constructor(e,r){this.userRepository=e;this.bcrypt=r}async handle(e,r){try{let{emailAddress:t,name:i,password:n}=gi.parse(e.body);if(await this.userRepository.findByEmail(t))throw new z("Usu\xE1rio j\xE1 existe.");let m=await this.bcrypt.hash(n);return await this.userRepository.create({name:i,emailAddress:t,passwordHash:m}),r.status(201).json()}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Ds={method:"post",path:"/auth/sign-up",tags:["Authentication"],summary:"Create a new user",request:{body:{content:{"application/json":{schema:gi}}}},responses:{201:{description:"User created successfully",summary:"User Registration Successful",content:{"application/json":{schema:u.object({message:u.string()})}}},400:{description:"Invalid input data provided",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},409:{description:"User already exists with this email",summary:"User Already Exists",content:{"application/json":{schema:u.object({message:u.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},Us={method:"post",path:"/auth/sign-in",tags:["Authentication"],summary:"Sign in",request:{body:{content:{"application/json":{schema:ui}}}},responses:{200:{description:"Authentication successful, JWT token returned",summary:"Login Successful",content:{"application/json":{schema:u.object({token:u.string()})}}},400:{description:"Invalid credentials or input data",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},401:{description:"Invalid email or password",summary:"Authentication Failed",content:{"application/json":{schema:u.object({message:u.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},Fs={method:"get",path:"/auth/user",tags:["Authentication"],summary:"Search for authenticated user",security:[{bearerAuth:[]}],responses:{200:{description:"Authenticated user information retrieved successfully",summary:"User Information Retrieved",content:{"application/json":{schema:u.object({name:u.string(),id:u.string(),avatarUrl:u.string().nullable(),createdAt:u.date(),updatedAt:u.date(),emailAddress:u.string(),orcid:u.string().nullable(),phone:u.string().nullable(),lattesUrl:u.string().nullable(),role:u.enum(As.UserRole)}).nullable()}}},400:{description:"Invalid request parameters",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},404:{description:"User not found or not authenticated",summary:"User Not Found",content:{"application/json":{schema:u.object({message:u.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},qs={method:"get",path:"/auth/user/news",tags:["Authentication"],summary:"List authenticated user news",security:[{bearerAuth:[]}],request:{query:di},responses:{200:{description:"Paginated list of authenticated user news retrieved successfully",summary:"User News Retrieved",content:{"application/json":{schema:u.object({page:u.number(),totalPages:u.number(),offset:u.number(),limit:u.number(),news:u.object({content:u.string(),id:u.string(),title:u.string(),createdAt:u.date(),updatedAt:u.date(),imageUrl:u.string().nullable()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},Bs={method:"get",path:"/auth/admin",tags:["Authentication"],summary:"Verify admin access",security:[{bearerAuth:[]}],responses:{200:{description:"Admin access verified successfully",summary:"Admin Access Granted",content:{"application/json":{schema:u.object({success:u.boolean()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},Os={method:"get",path:"/auth/certifications",tags:["Authentication"],summary:"List all authenticated user's certifications",security:[{bearerAuth:[]}],request:{query:pi},responses:{200:{description:"Paginated list of authenticated user certifications retrieved successfully",summary:"User Certifications Retrieved",content:{"application/json":{schema:u.object({page:u.number(),totalPages:u.number(),offset:u.number(),limit:u.number(),certifications:u.object({description:u.string(),id:u.string(),title:u.string(),certificationUrl:u.string(),createdAt:u.date(),updatedAt:u.date(),userId:u.string()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}},Ns={method:"get",path:"/auth/pendencies",tags:["Authentication"],summary:"List all authenticated user's pendencies",security:[{bearerAuth:[]}],request:{query:li},responses:{200:{description:"Paginated list of authenticated user pendencies retrieved successfully",summary:"User Pendencies Retrieved",content:{"application/json":{schema:u.object({page:u.number(),totalPages:u.number(),offset:u.number(),limit:u.number(),pendencies:u.object({id:u.string(),title:u.string(),description:u.string(),status:u.enum(As.PendencyStatus),createdAt:u.date(),updatedAt:u.date(),userId:u.string()})})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:u.object({errors:u.record(u.string(),u.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:u.object({message:u.string()})}}}}};import{$Enums as ld}from"@prisma/client";import I from"zod";import{extendZodWithOpenApi as nd}from"@asteasolutions/zod-to-openapi";import fi from"zod";nd(fi);var yi=fi.object({id:fi.string()}),Nt=class{constructor(e,r){this.certificationRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=yi.parse({id:e.params.certification_id}),i=await this.certificationRepository.findById(t);if(!i)throw new d("A certifica\xE7\xE3o n\xE3o existe.");return await Promise.all([this.certificationRepository.deleteById(i.id),this.firebaseStorageService.deleteFile({fileUrl:i.certificationUrl})]),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as sd}from"@asteasolutions/zod-to-openapi";import hi from"zod";sd(hi);var Ri=hi.object({certificationId:hi.uuid()}),kt=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{certificationId:t}=Ri.parse({certificationId:e.params.certification_id}),i=await this.certificationRepository.findById(t);if(!i)throw new d("Certificado n\xE3o encontrado.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ad}from"@asteasolutions/zod-to-openapi";import be from"zod";var md=1,cd=6;ad(be);var Ii=be.object({page:be.coerce.number().min(1).default(md),limit:be.coerce.number().min(1).default(cd),title:be.string().optional(),description:be.string().optional(),userId:be.uuid().optional(),orderBy:be.enum(["asc","desc"]).default("desc")}),Lt=class{constructor(e){this.certificationRepository=e}async handle(e,r){try{let{limit:t,page:i,...n}=Ii.parse(e.query),s=i*t-t,[m,p]=await Promise.all([this.certificationRepository.find({pagination:{offset:s,limit:t},filter:n}),this.certificationRepository.count({filter:n})]),l=Math.max(Math.ceil(p/t),1);return r.status(200).json({page:i,totalPages:l,offset:s,limit:t,certifications:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as pd}from"@asteasolutions/zod-to-openapi";import et from"zod";var F={NEWS:"images/news",USER:"images/user",IN_MEMORIAM:"images/in-memoriam",PARTNER:"images/partners",CERTIFICATION:"documents/certifications",PENDENCY:"documents/pendencies",REGIMENT:"documents/regiments",MEETING_MINUTE:"documents/meeting-minutes",INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY:"images/international-scientific-congress-gallery"};pd(et);var Ht=et.object({userId:et.uuid(),title:et.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio."),description:et.string().min(1,"Descri\xE7\xE3o \xE9 obrigat\xF3ria."),certification:et.any().refine(o=>o&&typeof o=="object"&&o.size>0,"Arquivo do certificado \xE9 obrigat\xF3rio")}),_t=class{constructor(e,r,t){this.userRepository=e;this.certificationRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{userId:t,title:i,description:n,certification:s}=Ht.parse({...e.body,userId:e.params.user_id,certification:e.file});if(!await this.userRepository.findById(t))throw new V("O usu\xE1rio n\xE3o existe.");let p=await this.firebaseStorageService.uploadFile({file:s,id:t,folder:F.CERTIFICATION});return await this.certificationRepository.register({userId:t,title:i,description:n,certificationUrl:p}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as dd}from"@asteasolutions/zod-to-openapi";import tt from"zod";dd(tt);var Gt=tt.object({id:tt.uuid(),title:tt.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio."),description:tt.string().min(1,"Descri\xE7\xE3o \xE9 obrigat\xF3ria."),certification:tt.any().refine(o=>o==null||typeof o=="object"&&typeof o.size=="number"&&(o.size===0||o.size>0),"Arquivo do certificado \xE9 inv\xE1lido").optional()}),zt=class{constructor(e,r){this.certificationRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{certification:t,id:i,...n}=Gt.parse({...e.body,id:e.params.certification_id,certification:e.file}),s=await this.certificationRepository.findById(i);if(!s)throw new V("A certifica\xE7\xE3o n\xE3o existe");let m=s.certificationUrl;return t&&t.size>0&&(m=await this.firebaseStorageService.updateFile({file:t,id:s.userId,folder:F.CERTIFICATION,fileUrl:s.certificationUrl})),await this.certificationRepository.update({...n,id:i,certificationUrl:m}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ks={method:"post",path:"/certifications/{user_id}",tags:["Certifications"],summary:"Register certification for user",security:[{bearerAuth:[]}],request:{params:Ht.pick({userId:!0}).transform(()=>({user_id:""})),body:{content:{"multipart/form-data":{schema:Ht.omit({userId:!0})}}}},responses:{201:{description:"Certification registered successfully for the user",summary:"Certification Registered",content:{"application/json":{schema:I.object({message:I.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"User not found with the provided ID",summary:"User Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},Ls={method:"get",path:"/certifications",tags:["Certifications"],summary:"List certifications",security:[{bearerAuth:[]}],request:{query:Ii},responses:{200:{description:"Paginated list of certifications with user information retrieved successfully",summary:"Certifications Retrieved",content:{"application/json":{schema:I.object({page:I.number(),totalPages:I.number(),offset:I.number(),limit:I.number(),certifications:I.array(I.object({description:I.string(),userId:I.string(),title:I.string(),id:I.string(),createdAt:I.date(),updatedAt:I.date(),certificationUrl:I.url(),user:I.object({id:I.uuid(),name:I.string(),createdAt:I.date(),updatedAt:I.date(),avatarUrl:I.string().nullable(),emailAddress:I.email(),orcid:I.string().nullable(),phone:I.string().nullable(),lattesUrl:I.url().nullable(),role:I.enum(ld.UserRole)})}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},_s={method:"get",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Find certification by ID",security:[{bearerAuth:[]}],request:{params:Ri},responses:{200:{description:"Certification details retrieved successfully",summary:"Certification Retrieved",content:{"application/json":{schema:I.object({description:I.string(),userId:I.string(),title:I.string(),id:I.string(),createdAt:I.date(),updatedAt:I.date(),certificationUrl:I.url()}).nullable()}}},400:{description:"Invalid certification ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},Hs={method:"put",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Update certification",security:[{bearerAuth:[]}],request:{params:Gt.pick({id:!0}).transform(()=>({certification_id:""})),body:{content:{"multipart/form-data":{schema:Gt.omit({id:!0})}}}},responses:{204:{description:"Certification updated successfully",summary:"Certification Updated"},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}},zs={method:"delete",path:"/certifications/{certification_id}",tags:["Certifications"],summary:"Delete certification",security:[{bearerAuth:[]}],request:{params:yi},responses:{204:{description:"Certification deleted successfully",summary:"Certification Deleted"},400:{description:"Invalid certification ID format",summary:"Validation Error",content:{"application/json":{schema:I.object({errors:I.record(I.string(),I.string())})}}},404:{description:"Certification not found with the provided ID",summary:"Certification Not Found",content:{"application/json":{schema:I.object({message:I.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:I.object({message:I.string()})}}}}};import{$Enums as Ei}from"@prisma/client";import y from"zod";import{extendZodWithOpenApi as ud}from"@asteasolutions/zod-to-openapi";import re from"zod";ud(re);var bi=re.object({code:re.string(),title:re.string(),description:re.string().optional(),notes:re.string().optional(),leaderId:re.uuid(),deputyLeaderId:re.uuid(),secretaryId:re.uuid(),memberIds:re.array(re.uuid())}),Wt=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{code:t,title:i,description:n,notes:s,leaderId:m,deputyLeaderId:p,secretaryId:l,memberIds:P}=bi.parse(e.body);if(await this.etpRepository.findByCode(t))throw new z("J\xE1 existe um ETP cadastrado com este c\xF3digo.");return await this.etpRepository.create({code:t,title:i,description:n,notes:s,leaderId:m,deputyLeaderId:p,secretaryId:l,memberIds:P}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as gd}from"@asteasolutions/zod-to-openapi";import Ci from"zod";gd(Ci);var wi=Ci.object({id:Ci.uuid()}),Zt=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t}=wi.parse({id:e.params.id});if(!await this.etpRepository.findById(t))throw new d("O ETP n\xE3o existe.");return await this.etpRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as fd}from"@asteasolutions/zod-to-openapi";import Si from"zod";fd(Si);var Kt=Si.object({id:Si.uuid()}),Vt=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t}=Kt.parse({id:e.params.id}),i=await this.etpRepository.findById(t);if(!i)throw new d("O ETP n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as yd}from"@asteasolutions/zod-to-openapi";import J from"zod";yd(J);var vi=J.object({id:J.uuid(),code:J.string().optional(),title:J.string().optional(),description:J.string().optional(),notes:J.string().optional(),leaderId:J.uuid().optional(),deputyLeaderId:J.uuid().optional(),secretaryId:J.uuid().optional(),memberIds:J.array(J.uuid()).optional()}),Yt=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{id:t,code:i,title:n,description:s,notes:m,leaderId:p,deputyLeaderId:l,secretaryId:P,memberIds:U}=vi.parse({id:e.params.id,...e.body});if(!await this.etpRepository.findById(t))throw new d("O ETP n\xE3o existe.");if(i){let Z=await this.etpRepository.findByCode(i);if(Z&&Z.id!==t)throw new z("J\xE1 existe um ETP com este c\xF3digo.")}return await this.etpRepository.update({id:t,code:i,title:n,description:s,notes:m,leaderId:p,deputyLeaderId:l,secretaryId:P,memberIds:U}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var hd=1,Rd=9,Xt=y.object({id:y.uuid(),registrationNumber:y.string(),mainEtps:y.string().nullable(),formations:y.string().nullable(),degrees:y.array(y.enum(Ei.Degree)),occupations:y.string(),seniority:y.enum(Ei.Seniority),institutions:y.string(),biography:y.string().nullable(),createdAt:y.date(),updatedAt:y.date(),user:y.object({id:y.uuid(),name:y.string(),emailAddress:y.string(),avatarUrl:y.string().nullable(),orcid:y.string().nullable(),phone:y.string().nullable(),lattesUrl:y.string().nullable(),role:y.enum(Ei.UserRole)})}),Gs=y.object({id:y.uuid(),code:y.string(),title:y.string(),description:y.string().nullable(),notes:y.string().nullable(),createdAt:y.date(),updatedAt:y.date(),leader:y.object({id:y.uuid(),researcher:Xt}).nullable(),deputyLeader:y.object({id:y.uuid(),researcher:Xt}).nullable(),secretary:y.object({id:y.uuid(),researcher:Xt}).nullable(),members:y.array(Xt)}),Ws={method:"post",path:"/etp",tags:["ETPs"],summary:"Create a new ETP with single leader, deputy leader, secretary and multiple members",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:bi}}}},responses:{201:{description:"ETP created successfully",summary:"ETP Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:y.object({errors:y.record(y.string(),y.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:y.object({message:y.string()})}}},409:{description:"ETP with this code already exists",summary:"Conflict",content:{"application/json":{schema:y.object({message:y.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:y.object({message:y.string()})}}}}},Zs={method:"get",path:"/etp",tags:["ETPs"],summary:"List all ETPs with pagination and filters",request:{query:y.object({page:y.coerce.number().min(1).default(hd).optional(),limit:y.coerce.number().min(1).default(Rd).optional(),code:y.string().optional(),title:y.string().optional(),description:y.string().optional(),notes:y.string().optional(),orderBy:y.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of ETPs retrieved successfully with pagination",summary:"ETPs Retrieved",content:{"application/json":{schema:y.object({page:y.number(),totalPages:y.number(),offset:y.number(),limit:y.number(),etps:y.array(Gs)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:y.object({message:y.string()})}}}}},Vs={method:"get",path:"/etp/{id}",tags:["ETPs"],summary:"Find ETP by ID",request:{params:Kt},responses:{200:{description:"ETP details retrieved successfully",summary:"ETP Retrieved",content:{"application/json":{schema:Gs}}},400:{description:"Invalid ETP ID format",summary:"Validation Error",content:{"application/json":{schema:y.object({errors:y.record(y.string(),y.string())})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:y.object({message:y.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:y.object({message:y.string()})}}}}},Ks={method:"put",path:"/etp/{id}",tags:["ETPs"],summary:"Update ETP and manage user relationships (single leader, deputy leader, secretary, multiple members)",security:[{bearerAuth:[]}],request:{params:Kt,body:{content:{"application/json":{schema:vi.omit({id:!0})}}}},responses:{200:{description:"ETP updated successfully",summary:"ETP Updated"},400:{description:"Invalid input data or ETP ID format",summary:"Validation Error",content:{"application/json":{schema:y.object({errors:y.record(y.string(),y.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:y.object({message:y.string()})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:y.object({message:y.string()})}}},409:{description:"ETP with this code already exists",summary:"Conflict",content:{"application/json":{schema:y.object({message:y.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:y.object({message:y.string()})}}}}},Ys={method:"delete",path:"/etp/{id}",tags:["ETPs"],summary:"Delete ETP",security:[{bearerAuth:[]}],request:{params:wi},responses:{200:{description:"ETP deleted successfully",summary:"ETP Deleted"},400:{description:"Invalid ETP ID format",summary:"Validation Error",content:{"application/json":{schema:y.object({errors:y.record(y.string(),y.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:y.object({message:y.string()})}}},404:{description:"ETP not found with the provided ID",summary:"ETP Not Found",content:{"application/json":{schema:y.object({message:y.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:y.object({message:y.string()})}}}}};import{InMemoriamRole as qd}from"@prisma/client";import C from"zod";import{extendZodWithOpenApi as Id}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as bd}from"@prisma/client";import Ce from"zod";var $s=2,Xs=1024,Cd=Xs*Xs,wd=$s*Cd;Id(Ce);var ji=Ce.object({name:Ce.string().min(1,"Nome \xE9 obrigat\xF3rio"),birthDate:Ce.coerce.date(),deathDate:Ce.coerce.date(),biography:Ce.string().optional(),photo:Ce.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=wd,`A imagem deve ter no m\xE1ximo ${$s}MB.`).optional(),role:Ce.enum(bd)}).refine(o=>o.deathDate>o.birthDate,{message:"Data de falecimento deve ser posterior \xE0 data de nascimento",path:["deathDate"]}),$t=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{name:t,birthDate:i,deathDate:n,biography:s,role:m,photo:p}=ji.parse({...e.body,photo:e.file}),l=await this.inMemoriamRepository.create({name:t,birthDate:i,deathDate:n,biography:s??void 0,role:m}),P;return p&&(P=await this.firebaseStorageService.uploadFile({file:p,id:l.id,folder:F.IN_MEMORIAM}),await this.inMemoriamRepository.update({id:l.id,photoUrl:P})),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Sd}from"@asteasolutions/zod-to-openapi";import Mi from"zod";Sd(Mi);var xi=Mi.object({id:Mi.uuid()}),Jt=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=xi.parse({id:e.params.id}),i=await this.inMemoriamRepository.findById(t);if(!i)throw new d("O in memoriam n\xE3o existe.");return i.photoUrl&&this.firebaseStorageService.deleteFile({fileUrl:i.photoUrl}),await this.inMemoriamRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as vd}from"@asteasolutions/zod-to-openapi";import Ti from"zod";vd(Ti);var er=Ti.object({id:Ti.uuid()}),Qt=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{id:t}=er.parse({id:e.params.id}),i=await this.inMemoriamRepository.findById(t);if(!i)throw new d("O in memoriam n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Ed}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as jd}from"@prisma/client";import Pi from"zod";Ed(Pi);var Ai=Pi.object({role:Pi.enum(jd)}),tr=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{role:t}=Ai.parse({role:e.params.role}),i=await this.inMemoriamRepository.findByRole(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Md}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as xd}from"@prisma/client";import we from"zod";var Td=1,Pd=9;Md(we);var Di=we.object({page:we.coerce.number().min(1).default(Td),limit:we.coerce.number().min(1).default(Pd),name:we.string().optional(),biography:we.string().optional(),role:we.enum(xd).optional(),orderBy:we.enum(["asc","desc"]).default("desc")}),rr=class{constructor(e){this.inMemoriamRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Di.parse(e.query),s=i*t-i,[m,p]=await Promise.all([this.inMemoriamRepository.find({pagination:{offset:s,limit:i},filter:n}),this.inMemoriamRepository.count({filter:n})]),l=Math.max(Math.ceil(p/i),1);r.status(200).json({page:t,totalPages:l,offset:s,limit:i,inMemoriam:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Ad}from"@asteasolutions/zod-to-openapi";import{InMemoriamRole as Dd}from"@prisma/client";import pe from"zod";var Qs=2,Js=1024,Ud=Js*Js,Fd=Qs*Ud;Ad(pe);var Ui=pe.object({id:pe.uuid(),name:pe.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),birthDate:pe.coerce.date().optional(),deathDate:pe.coerce.date().optional(),biography:pe.string().optional(),photo:pe.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Fd,`A imagem deve ter no m\xE1ximo ${Qs}MB.`).optional(),role:pe.enum(Dd).optional()}).refine(o=>o.birthDate&&o.deathDate?o.deathDate>o.birthDate:!0,{message:"Data de falecimento deve ser posterior \xE0 data de nascimento",path:["deathDate"]}),or=class{constructor(e,r){this.inMemoriamRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,birthDate:n,deathDate:s,biography:m,photo:p,role:l}=Ui.parse({id:e.params.id,...e.body,photo:e.file}),P=await this.inMemoriamRepository.findById(t);if(!P)throw new d("O registro in memoriam n\xE3o existe.");let U=P.photoUrl;return p&&(U=await this.firebaseStorageService.uploadFile({file:p,id:t,folder:F.IN_MEMORIAM})),await this.inMemoriamRepository.update({id:t,name:i,birthDate:n,deathDate:s,biography:m,photoUrl:U??void 0,role:l}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Fi=C.object({id:C.uuid(),name:C.string(),birthDate:C.date(),deathDate:C.date(),biography:C.string().nullable(),photoUrl:C.string().nullable(),role:C.enum(qd),createdAt:C.date(),updatedAt:C.date()}),ea={method:"post",path:"/in-memoriam",tags:["In Memoriam"],summary:"Create a new in memoriam record with optional photo upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:ji}}}},responses:{201:{description:"In memoriam record created successfully",summary:"In Memoriam Created"},400:{description:"Invalid input data, missing required fields, or invalid photo format/size",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:C.object({message:C.string()})}}},409:{description:"In memoriam record with this name already exists",summary:"Conflict",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},ta={method:"get",path:"/in-memoriam",tags:["In Memoriam"],summary:"List all in memoriam records with pagination and filters",request:{query:Di},responses:{200:{description:"List of in memoriam records retrieved successfully with pagination",summary:"In Memoriam Records Retrieved",content:{"application/json":{schema:C.object({page:C.number(),totalPages:C.number(),offset:C.number(),limit:C.number(),inMemoriam:C.array(Fi)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},ra={method:"get",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Find in memoriam record by ID",request:{params:er},responses:{200:{description:"In memoriam record details retrieved successfully",summary:"In Memoriam Record Retrieved",content:{"application/json":{schema:Fi}}},400:{description:"Invalid in memoriam record ID format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},oa={method:"put",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Update in memoriam record with optional photo upload",security:[{bearerAuth:[]}],request:{params:er,body:{content:{"multipart/form-data":{schema:Ui.omit({id:!0})}}}},responses:{200:{description:"In memoriam record updated successfully",summary:"In Memoriam Record Updated"},400:{description:"Invalid input data, in memoriam record ID format, or invalid photo format/size",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:C.object({message:C.string()})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},409:{description:"In memoriam record with this name already exists",summary:"Conflict",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},ia={method:"delete",path:"/in-memoriam/{id}",tags:["In Memoriam"],summary:"Delete in memoriam record",security:[{bearerAuth:[]}],request:{params:xi},responses:{200:{description:"In memoriam record deleted successfully",summary:"In Memoriam Record Deleted"},400:{description:"Invalid in memoriam record ID format",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:C.object({message:C.string()})}}},404:{description:"In memoriam record not found with the provided ID",summary:"In Memoriam Record Not Found",content:{"application/json":{schema:C.object({message:C.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}},_R={method:"get",path:"/in-memoriam/role/{role}",tags:["In Memoriam"],summary:"Find in memoriam records by role",request:{params:Ai},responses:{200:{description:"In memoriam records retrieved successfully by role",summary:"In Memoriam Records Retrieved by Role",content:{"application/json":{schema:C.array(Fi)}}},400:{description:"Invalid role parameter provided",summary:"Validation Error",content:{"application/json":{schema:C.object({errors:C.record(C.string(),C.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:C.object({message:C.string()})}}}}};import A from"zod";import{extendZodWithOpenApi as Bd}from"@asteasolutions/zod-to-openapi";import Rt from"zod";var sa=2,na=1024,Od=na*na,Nd=sa*Od;Bd(Rt);var qi=Rt.object({image:Rt.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=Nd,`A imagem deve ter no m\xE1ximo ${sa}MB.`),caption:Rt.string().optional(),congressId:Rt.uuid()}),ir=class{constructor(e,r,t){this.internationalScientificCongressGalleryRepository=e;this.internationalScientificCongressRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{image:t,caption:i,congressId:n}=qi.parse({...e.body,...e.params,image:e.file});if(!await this.internationalScientificCongressRepository.findById(n))throw new d("O congresso n\xE3o existe.");let m=await this.internationalScientificCongressGalleryRepository.create({imageUrl:"",caption:i||void 0,congressId:n}),p=await this.firebaseStorageService.uploadFile({file:t,id:m.id,folder:F.INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY});return await this.internationalScientificCongressGalleryRepository.update({id:m.id,imageUrl:p}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as kd}from"@asteasolutions/zod-to-openapi";import Bi from"zod";kd(Bi);var sr=Bi.object({id:Bi.uuid()}),nr=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=sr.parse({id:e.params.id});if(!await this.internationalScientificCongressGalleryRepository.findById(t))throw new d("A imagem da galeria n\xE3o existe.");return await this.internationalScientificCongressGalleryRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Ld}from"@asteasolutions/zod-to-openapi";import rt from"zod";var _d=1,Hd=9;Ld(rt);var Oi=rt.object({congressId:rt.uuid(),page:rt.coerce.number().min(1).default(_d),limit:rt.coerce.number().min(1).default(Hd),caption:rt.string().optional()}),ar=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{congressId:t,page:i,limit:n,...s}=Oi.parse({congressId:e.params.congressId,...e.query}),m=n*i-n,[p,l]=await Promise.all([this.internationalScientificCongressGalleryRepository.findByCongressId({pagination:{offset:m,limit:n},filter:{congressId:t,...s}}),this.internationalScientificCongressGalleryRepository.count({filter:{congressId:t,caption:s.caption}})]),P=Math.max(Math.ceil(l/n),1);return r.status(200).json({page:i,totalPages:P,offset:m,limit:n,galleryImages:p})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as zd}from"@asteasolutions/zod-to-openapi";import It from"zod";var ma=2,aa=1024,Gd=aa*aa,Wd=ma*Gd;zd(It);var Ni=It.object({id:It.uuid(),image:It.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Wd,`A imagem deve ter no m\xE1ximo ${ma}MB.`).optional(),caption:It.string().optional()}),mr=class{constructor(e,r){this.internationalScientificCongressGalleryRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,image:i,caption:n}=Ni.parse({id:e.params.id,...e.body,image:e.file}),s=await this.internationalScientificCongressGalleryRepository.findById(t);if(!s)throw new d("A imagem da galeria n\xE3o existe.");let m=s.imageUrl;return i&&(m=await this.firebaseStorageService.uploadFile({file:i,id:t,folder:F.INTERNATIONAL_SCIENTIFIC_CONGRESS_GALLERY})),await this.internationalScientificCongressGalleryRepository.update({id:t,imageUrl:m??void 0,caption:n||void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Zd=A.object({id:A.uuid(),imageUrl:A.string(),caption:A.string().nullable(),congressId:A.uuid()}),ca={method:"post",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congresses"],summary:"Create a new congress gallery image",security:[{bearerAuth:[]}],request:{params:A.object({congressId:A.uuid()}),body:{content:{"application/json":{schema:qi.omit({congressId:!0})}}}},responses:{201:{description:"Congress gallery image created successfully",summary:"Congress Gallery Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:A.object({message:A.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},pa={method:"get",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congresses"],summary:"Find congress gallery images by congress ID",request:{params:Oi},responses:{200:{description:"Congress gallery images retrieved successfully by congress ID",summary:"Congress Galleries Retrieved",content:{"application/json":{schema:A.array(Zd)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},da={method:"put",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congresses"],summary:"Update congress gallery image",security:[{bearerAuth:[]}],request:{params:sr,body:{content:{"application/json":{schema:Ni.omit({id:!0})}}}},responses:{200:{description:"Congress gallery image updated successfully",summary:"Congress Gallery Updated"},400:{description:"Invalid input data or gallery ID format",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:A.object({message:A.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}},la={method:"delete",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congresses"],summary:"Delete congress gallery image",security:[{bearerAuth:[]}],request:{params:sr},responses:{200:{description:"Congress gallery image deleted successfully",summary:"Congress Gallery Deleted"},400:{description:"Invalid gallery ID format",summary:"Validation Error",content:{"application/json":{schema:A.object({errors:A.record(A.string(),A.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:A.object({message:A.string()})}}},404:{description:"Congress gallery image not found with the provided ID",summary:"Congress Gallery Not Found",content:{"application/json":{schema:A.object({message:A.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:A.object({message:A.string()})}}}}};import D from"zod";import{extendZodWithOpenApi as Vd}from"@asteasolutions/zod-to-openapi";import bt from"zod";var ga=2,ua=1024,Kd=ua*ua,Yd=ga*Kd;Vd(bt);var ki=bt.object({name:bt.string().min(1,"Nome \xE9 obrigat\xF3rio"),logo:bt.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Yd,`A imagem deve ter no m\xE1ximo ${ga}MB.`).optional(),congressId:bt.uuid()}),cr=class{constructor(e,r,t){this.internationalScientificCongressPartnerRepository=e;this.internationalScientificCongressRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{name:t,logo:i,congressId:n}=ki.parse({...e.body,...e.params,logo:e.file});if(!await this.internationalScientificCongressRepository.findById(n))throw new d("O congresso n\xE3o existe.");let m=await this.internationalScientificCongressPartnerRepository.create({name:t,congressId:n}),p;return i&&(p=await this.firebaseStorageService.uploadFile({file:i,id:m.id,folder:F.PARTNER}),await this.internationalScientificCongressPartnerRepository.update({id:m.id,logoUrl:p})),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Xd}from"@asteasolutions/zod-to-openapi";import Li from"zod";Xd(Li);var dr=Li.object({id:Li.uuid()}),pr=class{constructor(e){this.internationalScientificCongressPartnerRepository=e}async handle(e,r){try{let{id:t}=dr.parse({id:e.params.id});if(!await this.internationalScientificCongressPartnerRepository.findById(t))throw new d("O parceiro n\xE3o existe.");return await this.internationalScientificCongressPartnerRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as $d}from"@asteasolutions/zod-to-openapi";import ot from"zod";var Jd=1,Qd=9;$d(ot);var _i=ot.object({congressId:ot.uuid(),page:ot.coerce.number().min(1).optional(),limit:ot.coerce.number().min(1).optional(),name:ot.string().optional()}),lr=class{constructor(e){this.internationalScientificCongressPartnerRepository=e}async handle(e,r){try{let{congressId:t,page:i,limit:n,...s}=_i.parse({congressId:e.params.congressId,...e.query});if(i!==void 0&&n!==void 0){let p=i||Jd,l=n||Qd,P=l*p-l,[U,k]=await Promise.all([this.internationalScientificCongressPartnerRepository.findByCongressId({pagination:{offset:P,limit:l},filter:{congressId:t,...s}}),this.internationalScientificCongressPartnerRepository.count({filter:{congressId:t,name:s.name}})]),Z=Math.max(Math.ceil(k/l),1);return r.status(200).json({page:p,totalPages:Z,offset:P,limit:l,partners:U})}let m=await this.internationalScientificCongressPartnerRepository.findByCongressId({filter:{congressId:t,...s}});return r.status(200).json(m)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as el}from"@asteasolutions/zod-to-openapi";import Ct from"zod";var ya=2,fa=1024,tl=fa*fa,rl=ya*tl;el(Ct);var Hi=Ct.object({id:Ct.uuid(),name:Ct.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),logo:Ct.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=rl,`A imagem deve ter no m\xE1ximo ${ya}MB.`).optional()}),ur=class{constructor(e,r){this.internationalScientificCongressPartnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,logo:n}=Hi.parse({id:e.params.id,...e.body,logo:e.file}),s=await this.internationalScientificCongressPartnerRepository.findById(t);if(!s)throw new d("O parceiro n\xE3o existe.");let m=s.logoUrl;return n&&(m=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:F.PARTNER})),await this.internationalScientificCongressPartnerRepository.update({id:t,name:i,logoUrl:m??void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ol=D.object({id:D.uuid(),name:D.string(),logoUrl:D.string().nullable(),congressId:D.uuid()}),ha={method:"post",path:"/international-scientific-congress/{congressId}/partner",tags:["International Scientific Congresses"],summary:"Create a new congress partner",security:[{bearerAuth:[]}],request:{params:D.object({congressId:D.uuid()}),body:{content:{"application/json":{schema:ki.omit({congressId:!0})}}}},responses:{201:{description:"Congress partner created successfully",summary:"Congress Partner Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:D.object({errors:D.record(D.string(),D.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:D.object({message:D.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:D.object({message:D.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:D.object({message:D.string()})}}}}},Ra={method:"get",path:"/international-scientific-congress/{congressId}/partner",tags:["International Scientific Congresses"],summary:"Find congress partners by congress ID",request:{params:_i},responses:{200:{description:"Congress partners retrieved successfully by congress ID",summary:"Congress Partners Retrieved",content:{"application/json":{schema:D.array(ol)}}},400:{description:"Invalid congress ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:D.object({errors:D.record(D.string(),D.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:D.object({message:D.string()})}}}}},Ia={method:"put",path:"/international-scientific-congress/partner/{id}",tags:["International Scientific Congresses"],summary:"Update congress partner",security:[{bearerAuth:[]}],request:{params:dr,body:{content:{"application/json":{schema:Hi.omit({id:!0})}}}},responses:{200:{description:"Congress partner updated successfully",summary:"Congress Partner Updated"},400:{description:"Invalid input data or partner ID format",summary:"Validation Error",content:{"application/json":{schema:D.object({errors:D.record(D.string(),D.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:D.object({message:D.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:D.object({message:D.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:D.object({message:D.string()})}}}}},ba={method:"delete",path:"/international-scientific-congress/partner/{id}",tags:["International Scientific Congresses"],summary:"Delete congress partner",security:[{bearerAuth:[]}],request:{params:dr},responses:{200:{description:"Congress partner deleted successfully",summary:"Congress Partner Deleted"},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:D.object({errors:D.record(D.string(),D.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:D.object({message:D.string()})}}},404:{description:"Congress partner not found with the provided ID",summary:"Congress Partner Not Found",content:{"application/json":{schema:D.object({message:D.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:D.object({message:D.string()})}}}}};import c from"zod";import{extendZodWithOpenApi as il}from"@asteasolutions/zod-to-openapi";import H from"zod";il(H);var zi=H.object({title:H.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),edition:H.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo"),startDate:H.coerce.date(),endDate:H.coerce.date(),description:H.string().optional(),location:H.string().optional(),congressLink:H.url("Link do congresso deve ser uma URL v\xE1lida").optional().or(H.literal("")),noticeUrl:H.url("URL do edital deve ser uma URL v\xE1lida").optional().or(H.literal("")),scheduleUrl:H.url("URL do cronograma deve ser uma URL v\xE1lida").optional().or(H.literal("")),programUrl:H.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida").optional().or(H.literal("")),adminReportUrl:H.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida").optional().or(H.literal("")),proceedingsUrl:H.url("URL dos anais deve ser uma URL v\xE1lida").optional().or(H.literal(""))}).refine(o=>o.endDate>=o.startDate,{message:"Data de t\xE9rmino deve ser posterior ou igual \xE0 data de in\xEDcio",path:["endDate"]}),gr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let t=zi.parse(e.body);return await this.internationalScientificCongressRepository.create(t),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as nl}from"@asteasolutions/zod-to-openapi";import Gi from"zod";nl(Gi);var Wi=Gi.object({id:Gi.uuid()}),fr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t}=Wi.parse({id:e.params.id});if(!await this.internationalScientificCongressRepository.findById(t))throw new d("O congresso n\xE3o existe.");return await this.internationalScientificCongressRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as sl}from"@asteasolutions/zod-to-openapi";import Zi from"zod";sl(Zi);var Vi=Zi.object({edition:Zi.coerce.number().int().positive()}),yr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{edition:t}=Vi.parse({edition:e.params.edition}),i=await this.internationalScientificCongressRepository.findByEdition(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as al}from"@asteasolutions/zod-to-openapi";import Ki from"zod";al(Ki);var Rr=Ki.object({id:Ki.uuid()}),hr=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t}=Rr.parse({id:e.params.id}),i=await this.internationalScientificCongressRepository.findById(t);if(!i)throw new d("O congresso n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ml}from"@asteasolutions/zod-to-openapi";import Oe from"zod";var cl=1,pl=10;ml(Oe);var Yi=Oe.object({page:Oe.coerce.number().min(1).default(cl),limit:Oe.coerce.number().min(1).default(pl),title:Oe.string().optional(),edition:Oe.coerce.number().int().positive().optional(),orderBy:Oe.enum(["asc","desc"]).optional()}),Ir=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Yi.parse(e.query),s=i*t-i,[m,p]=await Promise.all([this.internationalScientificCongressRepository.find({pagination:{offset:s,limit:i},filter:n}),this.internationalScientificCongressRepository.count({filter:n})]),l=Math.max(Math.ceil(p/i),1);r.status(200).json({page:t,totalPages:l,offset:s,limit:i,congresses:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as dl}from"@asteasolutions/zod-to-openapi";import _ from"zod";dl(_);var Xi=_.object({id:_.uuid(),title:_.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),edition:_.coerce.number().int().positive("Edi\xE7\xE3o deve ser um n\xFAmero positivo").optional(),startDate:_.coerce.date().optional(),endDate:_.coerce.date().optional(),description:_.string().optional(),location:_.string().optional(),congressLink:_.url("Link do congresso deve ser uma URL v\xE1lida").optional().or(_.literal("")),noticeUrl:_.url("URL do edital deve ser uma URL v\xE1lida").optional().or(_.literal("")),scheduleUrl:_.url("URL do cronograma deve ser uma URL v\xE1lida").optional().or(_.literal("")),programUrl:_.url("URL da programa\xE7\xE3o deve ser uma URL v\xE1lida").optional().or(_.literal("")),adminReportUrl:_.url("URL do relat\xF3rio administrativo deve ser uma URL v\xE1lida").optional().or(_.literal("")),proceedingsUrl:_.url("URL dos anais deve ser uma URL v\xE1lida").optional().or(_.literal(""))}),br=class{constructor(e){this.internationalScientificCongressRepository=e}async handle(e,r){try{let{id:t,...i}=Xi.parse({id:e.params.id,...e.body});if(!await this.internationalScientificCongressRepository.findById(t))throw new d("O congresso n\xE3o existe.");return await this.internationalScientificCongressRepository.update({...i,id:t}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ll=9,ul=c.object({image:c.any().openapi({type:"string",format:"binary"}),caption:c.string().optional()}),gl=c.object({image:c.any().openapi({type:"string",format:"binary"}).optional(),caption:c.string().optional()}),fl=c.object({id:c.uuid(),name:c.string(),logoUrl:c.string().nullable(),congressId:c.uuid()}),$i=c.object({id:c.uuid(),imageUrl:c.string(),caption:c.string().nullable(),congressId:c.uuid()}),Ji=c.object({id:c.uuid(),title:c.string(),edition:c.number(),startDate:c.date(),endDate:c.date(),description:c.string().nullable(),location:c.string().nullable(),congressLink:c.string().nullable(),noticeUrl:c.string().nullable(),scheduleUrl:c.string().nullable(),programUrl:c.string().nullable(),adminReportUrl:c.string().nullable(),proceedingsUrl:c.string().nullable(),partners:c.array(fl),galleries:c.array($i),createdAt:c.date(),updatedAt:c.date()}),Ca={method:"post",path:"/international-scientific-congress",tags:["International Scientific Congresses"],summary:"Create a new international scientific congress",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:zi}}}},responses:{201:{description:"International scientific congress created successfully",summary:"International Scientific Congress Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:c.object({errors:c.record(c.string(),c.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:c.object({message:c.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:c.object({message:c.string()})}}}}},wa={method:"get",path:"/international-scientific-congress",tags:["International Scientific Congresses"],summary:"List all international scientific congresses with pagination and filters",request:{query:Yi},responses:{200:{description:"List of international scientific congresses retrieved successfully with pagination",summary:"International Scientific Congresses Retrieved",content:{"application/json":{schema:c.object({page:c.number(),totalPages:c.number(),offset:c.number(),limit:c.number(),congresses:c.array(Ji)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:c.object({errors:c.record(c.string(),c.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:c.object({message:c.string()})}}}}},Sa={method:"get",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Find international scientific congress by ID",request:{params:Rr},responses:{200:{description:"International scientific congress details retrieved successfully",summary:"International Scientific Congress Retrieved",content:{"application/json":{schema:Ji}}},400:{description:"Invalid international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:c.object({errors:c.record(c.string(),c.string())})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:c.object({message:c.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:c.object({message:c.string()})}}}}},va={method:"get",path:"/international-scientific-congress/edition/{edition}",tags:["International Scientific Congresses"],summary:"Find international scientific congresses by edition",request:{params:Vi},responses:{200:{description:"International scientific congresses retrieved successfully by edition",summary:"International Scientific Congresses Retrieved by Edition",content:{"application/json":{schema:c.array(Ji)}}},400:{description:"Invalid edition parameter provided",summary:"Validation Error",content:{"application/json":{schema:c.object({errors:c.record(c.string(),c.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:c.object({message:c.string()})}}}}},Ea={method:"put",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Update international scientific congress",security:[{bearerAuth:[]}],request:{params:Rr,body:{content:{"application/json":{schema:Xi.omit({id:!0})}}}},responses:{200:{description:"International scientific congress updated successfully",summary:"International Scientific Congress Updated"},400:{description:"Invalid input data or international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:c.object({errors:c.record(c.string(),c.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:c.object({message:c.string()})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:c.object({message:c.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:c.object({message:c.string()})}}}}},ja={method:"delete",path:"/international-scientific-congress/{id}",tags:["International Scientific Congresses"],summary:"Delete international scientific congress",security:[{bearerAuth:[]}],request:{params:Wi},responses:{200:{description:"International scientific congress deleted successfully",summary:"International Scientific Congress Deleted"},400:{description:"Invalid international scientific congress ID format",summary:"Validation Error",content:{"application/json":{schema:c.object({errors:c.record(c.string(),c.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:c.object({message:c.string()})}}},404:{description:"International scientific congress not found with the provided ID",summary:"International Scientific Congress Not Found",content:{"application/json":{schema:c.object({message:c.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:c.object({message:c.string()})}}}}},Ob={method:"post",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congress Gallery"],summary:"Create a new gallery image for a congress",security:[{bearerAuth:[]}],request:{params:c.object({congressId:c.uuid()}),body:{content:{"multipart/form-data":{schema:ul}}}},responses:{201:{description:"Gallery image created successfully",summary:"Gallery Image Created"},400:{description:"Invalid input data, missing required fields, or invalid image format/size",summary:"Validation Error",content:{"application/json":{schema:c.object({errors:c.record(c.string(),c.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:c.object({message:c.string()})}}},404:{description:"Congress not found with the provided ID",summary:"Congress Not Found",content:{"application/json":{schema:c.object({message:c.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:c.object({message:c.string()})}}}}},Nb={method:"get",path:"/international-scientific-congress/{congressId}/gallery",tags:["International Scientific Congress Gallery"],summary:"List all gallery images for a congress with pagination",request:{params:c.object({congressId:c.uuid()}),query:c.object({page:c.coerce.number().min(1).default(1),limit:c.coerce.number().min(1).default(ll),caption:c.string().optional()})},responses:{200:{description:"Gallery images retrieved successfully with pagination",summary:"Gallery Images Retrieved",content:{"application/json":{schema:c.object({page:c.number(),totalPages:c.number(),offset:c.number(),limit:c.number(),galleries:c.array($i)})}}},400:{description:"Invalid congress ID format or query parameters",summary:"Validation Error",content:{"application/json":{schema:c.object({errors:c.record(c.string(),c.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:c.object({message:c.string()})}}}}},kb={method:"get",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congress Gallery"],summary:"Find a gallery image by ID",request:{params:c.object({id:c.uuid()})},responses:{200:{description:"Gallery image retrieved successfully",summary:"Gallery Image Retrieved",content:{"application/json":{schema:$i}}},400:{description:"Invalid gallery image ID format",summary:"Validation Error",content:{"application/json":{schema:c.object({errors:c.record(c.string(),c.string())})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:c.object({message:c.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:c.object({message:c.string()})}}}}},Lb={method:"put",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congress Gallery"],summary:"Update a gallery image with optional image upload",security:[{bearerAuth:[]}],request:{params:c.object({id:c.uuid()}),body:{content:{"multipart/form-data":{schema:gl}}}},responses:{200:{description:"Gallery image updated successfully",summary:"Gallery Image Updated"},400:{description:"Invalid input data, gallery ID format, or invalid image format/size",summary:"Validation Error",content:{"application/json":{schema:c.object({errors:c.record(c.string(),c.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:c.object({message:c.string()})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:c.object({message:c.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:c.object({message:c.string()})}}}}},_b={method:"delete",path:"/international-scientific-congress/gallery/{id}",tags:["International Scientific Congress Gallery"],summary:"Delete a gallery image",security:[{bearerAuth:[]}],request:{params:c.object({id:c.uuid()})},responses:{200:{description:"Gallery image deleted successfully",summary:"Gallery Image Deleted"},400:{description:"Invalid gallery ID format",summary:"Validation Error",content:{"application/json":{schema:c.object({errors:c.record(c.string(),c.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:c.object({message:c.string()})}}},404:{description:"Gallery image not found with the provided ID",summary:"Gallery Image Not Found",content:{"application/json":{schema:c.object({message:c.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:c.object({message:c.string()})}}}}};import{$Enums as bl}from"@prisma/client";import j from"zod";import{extendZodWithOpenApi as yl}from"@asteasolutions/zod-to-openapi";import it from"zod";yl(it);var Qi=it.object({role:it.string().min(1),description:it.string().optional(),userId:it.uuid(),order:it.number().optional()}),Cr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{role:t,description:i,userId:n,order:s}=Qi.parse(e.body);return await this.legitimatorCommitteeMemberRepository.create({role:t,description:i,userId:n,order:s??0}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as hl}from"@asteasolutions/zod-to-openapi";import en from"zod";hl(en);var tn=en.object({id:en.uuid()}),wr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t}=tn.parse({id:e.params.id});if(!await this.legitimatorCommitteeMemberRepository.findById(t))throw new d("O membro do comit\xEA legitimador n\xE3o existe.");return await this.legitimatorCommitteeMemberRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Rl}from"@asteasolutions/zod-to-openapi";import rn from"zod";Rl(rn);var vr=rn.object({id:rn.uuid()}),Sr=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t}=vr.parse({id:e.params.id}),i=await this.legitimatorCommitteeMemberRepository.findById(t);if(!i)throw new d("O membro do comit\xEA legitimador n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Il}from"@asteasolutions/zod-to-openapi";import Ne from"zod";Il(Ne);var on=Ne.object({id:Ne.uuid(),role:Ne.string().min(1).optional(),description:Ne.string().optional(),userId:Ne.uuid().optional(),order:Ne.number().optional()}),Er=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let{id:t,role:i,description:n,userId:s,order:m}=on.parse({id:e.params.id,...e.body});if(!await this.legitimatorCommitteeMemberRepository.findById(t))throw new d("O membro do comit\xEA legitimador n\xE3o existe.");return await this.legitimatorCommitteeMemberRepository.update({id:t,role:i,description:n,userId:s,order:m}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Cl=j.object({id:j.uuid(),name:j.string(),emailAddress:j.string(),avatarUrl:j.string().nullable(),orcid:j.string().nullable(),phone:j.string().nullable(),lattesUrl:j.string().nullable(),role:j.enum(bl.UserRole)}),Ma=j.object({id:j.uuid(),role:j.string(),description:j.string().nullable(),order:j.number(),createdAt:j.date(),updatedAt:j.date(),userId:j.uuid(),user:Cl}),xa={method:"post",path:"/legitimator-committee-member",tags:["Legitimator Committee Members"],summary:"Create a new Legitimator Committee Member",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Qi}}}},responses:{201:{description:"Legitimator Committee Member created successfully",summary:"Legitimator Committee Member Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},Ta={method:"get",path:"/legitimator-committee-member",tags:["Legitimator Committee Members"],summary:"List all Legitimator Committee Members with filters",request:{query:j.object({role:j.string().optional(),orderBy:j.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of Legitimator Committee Members retrieved successfully",summary:"Legitimator Committee Members Retrieved",content:{"application/json":{schema:j.object({members:j.array(Ma)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},Pa={method:"get",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Find Legitimator Committee Member by ID",request:{params:vr},responses:{200:{description:"Legitimator Committee Member details retrieved successfully",summary:"Legitimator Committee Member Retrieved",content:{"application/json":{schema:Ma}}},400:{description:"Invalid Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},Aa={method:"put",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Update Legitimator Committee Member",security:[{bearerAuth:[]}],request:{params:vr,body:{content:{"application/json":{schema:on.omit({id:!0})}}}},responses:{200:{description:"Legitimator Committee Member updated successfully",summary:"Legitimator Committee Member Updated"},400:{description:"Invalid input data or Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}},Da={method:"delete",path:"/legitimator-committee-member/{id}",tags:["Legitimator Committee Members"],summary:"Delete Legitimator Committee Member",security:[{bearerAuth:[]}],request:{params:tn},responses:{200:{description:"Legitimator Committee Member deleted successfully",summary:"Legitimator Committee Member Deleted"},400:{description:"Invalid Legitimator Committee Member ID format",summary:"Validation Error",content:{"application/json":{schema:j.object({errors:j.record(j.string(),j.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:j.object({message:j.string()})}}},404:{description:"Legitimator Committee Member not found with the provided ID",summary:"Legitimator Committee Member Not Found",content:{"application/json":{schema:j.object({message:j.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:j.object({message:j.string()})}}}}};import{$Enums as jl}from"@prisma/client";import b from"zod";import{extendZodWithOpenApi as wl}from"@asteasolutions/zod-to-openapi";import de from"zod";wl(de);var nn=de.object({name:de.string().min(1),description:de.string().optional(),members:de.array(de.object({userId:de.uuid(),role:de.string().min(1),order:de.number().optional()}))}),jr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{name:t,description:i,members:n}=nn.parse(e.body);if(await this.managementTeamRepository.findByName(t))throw new z("J\xE1 existe um time de gest\xE3o cadastrado com este nome.");return await this.managementTeamRepository.create({name:t,description:i,members:n.map(m=>({userId:m.userId,role:m.role,order:m.order??0}))}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Sl}from"@asteasolutions/zod-to-openapi";import sn from"zod";Sl(sn);var an=sn.object({id:sn.uuid()}),Mr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t}=an.parse({id:e.params.id});if(!await this.managementTeamRepository.findById(t))throw new d("O time de gest\xE3o n\xE3o existe.");return await this.managementTeamRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as vl}from"@asteasolutions/zod-to-openapi";import mn from"zod";vl(mn);var Tr=mn.object({id:mn.uuid()}),xr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t}=Tr.parse({id:e.params.id}),i=await this.managementTeamRepository.findById(t);if(!i)throw new d("O time de gest\xE3o n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as El}from"@asteasolutions/zod-to-openapi";import se from"zod";El(se);var cn=se.object({id:se.uuid(),name:se.string().min(1).optional(),description:se.string().optional(),members:se.array(se.object({userId:se.uuid(),role:se.string().min(1),order:se.number().optional()})).optional()}),Pr=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let{id:t,name:i,description:n,members:s}=cn.parse({id:e.params.id,...e.body}),m=await this.managementTeamRepository.findById(t);if(!m)throw new d("O time de gest\xE3o n\xE3o existe.");if(i&&i!==m.name){let p=await this.managementTeamRepository.findByName(i);if(p&&p.id!==t)throw new z("J\xE1 existe um time de gest\xE3o com este nome.")}return await this.managementTeamRepository.update({id:t,name:i,description:n,members:s?s.map(p=>({userId:p.userId,role:p.role,order:p.order??0})):void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Ml=b.object({id:b.uuid(),name:b.string(),emailAddress:b.string(),avatarUrl:b.string().nullable(),orcid:b.string().nullable(),phone:b.string().nullable(),lattesUrl:b.string().nullable(),role:b.enum(jl.UserRole)}),xl=b.object({id:b.uuid(),role:b.string(),description:b.string().nullable(),order:b.number(),teamId:b.uuid(),userId:b.uuid(),createdAt:b.date(),updatedAt:b.date(),user:Ml}),Ua=b.object({id:b.uuid(),name:b.string(),description:b.string().nullable(),createdAt:b.date(),updatedAt:b.date(),members:b.array(xl)}),Fa={method:"post",path:"/management-team",tags:["Management Teams"],summary:"Create a new Management Team with multiple members",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:nn}}}},responses:{201:{description:"Management Team created successfully",summary:"Management Team Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},409:{description:"Management Team with this name already exists",summary:"Conflict",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},qa={method:"get",path:"/management-team",tags:["Management Teams"],summary:"List all Management Teams with filters",request:{query:b.object({name:b.string().optional(),description:b.string().optional(),orderBy:b.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of Management Teams retrieved successfully",summary:"Management Teams Retrieved",content:{"application/json":{schema:b.object({teams:b.array(Ua)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},Ba={method:"get",path:"/management-team/{id}",tags:["Management Teams"],summary:"Find Management Team by ID",request:{params:Tr},responses:{200:{description:"Management Team details retrieved successfully",summary:"Management Team Retrieved",content:{"application/json":{schema:Ua}}},400:{description:"Invalid Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},Oa={method:"put",path:"/management-team/{id}",tags:["Management Teams"],summary:"Update Management Team and manage member relationships",security:[{bearerAuth:[]}],request:{params:Tr,body:{content:{"application/json":{schema:cn.omit({id:!0})}}}},responses:{200:{description:"Management Team updated successfully",summary:"Management Team Updated"},400:{description:"Invalid input data or Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},409:{description:"Management Team with this name already exists",summary:"Conflict",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}},Na={method:"delete",path:"/management-team/{id}",tags:["Management Teams"],summary:"Delete Management Team",security:[{bearerAuth:[]}],request:{params:an},responses:{200:{description:"Management Team deleted successfully",summary:"Management Team Deleted"},400:{description:"Invalid Management Team ID format",summary:"Validation Error",content:{"application/json":{schema:b.object({errors:b.record(b.string(),b.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:b.object({message:b.string()})}}},404:{description:"Management Team not found with the provided ID",summary:"Management Team Not Found",content:{"application/json":{schema:b.object({message:b.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:b.object({message:b.string()})}}}}};import{MeetingFormat as Bl,MeetingStatus as Ol}from"@prisma/client";import x from"zod";import{extendZodWithOpenApi as Tl}from"@asteasolutions/zod-to-openapi";import nt from"zod";var La=10,ka=1024,Pl=ka*ka,Al=La*Pl;Tl(nt);var pn=nt.object({title:nt.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),publishedAt:nt.coerce.date(),meetingId:nt.uuid(),document:nt.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=Al,`O documento deve ter no m\xE1ximo ${La}MB.`)}),Ar=class{constructor(e,r,t){this.meetingMinuteRepository=e;this.meetingRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{title:t,publishedAt:i,meetingId:n,document:s}=pn.parse({...e.body,...e.params,document:e.file});if(!await this.meetingRepository.findById(n))throw new d("A reuni\xE3o n\xE3o existe.");if(await this.meetingMinuteRepository.findByMeetingId(n))throw new a("Esta reuni\xE3o j\xE1 possui uma ata.");let l=await this.meetingMinuteRepository.create({title:t,publishedAt:i,meetingId:n,documentUrl:""}),P=await this.firebaseStorageService.uploadFile({file:s,id:l.id,folder:F.MEETING_MINUTE});return await this.meetingMinuteRepository.update({id:l.id,documentUrl:P}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Dl}from"@asteasolutions/zod-to-openapi";import dn from"zod";Dl(dn);var wt=dn.object({meetingId:dn.uuid()}),Dr=class{constructor(e){this.meetingMinuteRepository=e}async handle(e,r){try{let{meetingId:t}=wt.parse({meetingId:e.params.meetingId}),i=await this.meetingMinuteRepository.findByMeetingId(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Ul}from"@asteasolutions/zod-to-openapi";import st from"zod";var Ha=10,_a=1024,Fl=_a*_a,ql=Ha*Fl;Ul(st);var ln=st.object({meetingId:st.uuid(),title:st.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),publishedAt:st.coerce.date().optional(),document:st.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=ql,`O documento deve ter no m\xE1ximo ${Ha}MB.`).optional()}),Ur=class{constructor(e,r){this.meetingMinuteRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{meetingId:t,title:i,publishedAt:n,document:s}=ln.parse({meetingId:e.params.meetingId,...e.body,document:e.file}),m=await this.meetingMinuteRepository.findByMeetingId(t);if(!m)throw new d("A ata n\xE3o existe para esta reuni\xE3o.");let p=m.documentUrl;return s&&(m.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:m.documentUrl}),p=await this.firebaseStorageService.uploadFile({file:s,id:m.id,folder:F.MEETING_MINUTE})),await this.meetingMinuteRepository.update({id:m.id,title:i,publishedAt:n,documentUrl:p??void 0}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Nl=x.object({id:x.uuid(),title:x.string(),scheduledAt:x.date(),format:x.enum(Bl),agenda:x.string(),meetingLink:x.string().nullable(),location:x.string().nullable(),status:x.enum(Ol),createdAt:x.date(),updatedAt:x.date()}),kl=x.object({id:x.uuid(),title:x.string(),publishedAt:x.date(),documentUrl:x.string(),meetingId:x.uuid(),meeting:Nl,createdAt:x.date(),updatedAt:x.date()}),za={method:"post",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Create a new meeting minute with document upload",security:[{bearerAuth:[]}],request:{params:x.object({meetingId:x.uuid()}),body:{content:{"multipart/form-data":{schema:pn.omit({meetingId:!0})}}}},responses:{201:{description:"Meeting minute created successfully",summary:"Meeting Minute Created"},400:{description:"Invalid input data, missing required fields, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:x.object({message:x.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},409:{description:"Meeting already has a minute",summary:"Conflict",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Ga={method:"get",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Find meeting minute by meeting ID",request:{params:wt},responses:{200:{description:"Meeting minute retrieved successfully by meeting ID",summary:"Meeting Minute Retrieved by Meeting ID",content:{"application/json":{schema:kl.nullable()}}},400:{description:"Invalid meeting ID parameter provided",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Wa={method:"put",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Update meeting minute with optional document upload",security:[{bearerAuth:[]}],request:{params:wt,body:{content:{"multipart/form-data":{schema:ln.omit({meetingId:!0})}}}},responses:{200:{description:"Meeting minute updated successfully",summary:"Meeting Minute Updated"},400:{description:"Invalid input data, meeting minute ID format, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:x.object({message:x.string()})}}},404:{description:"Meeting minute not found with the provided ID",summary:"Meeting Minute Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}},Za={method:"delete",path:"/meeting/{meetingId}/minute",tags:["Meetings"],summary:"Delete meeting minute",security:[{bearerAuth:[]}],request:{params:wt},responses:{200:{description:"Meeting minute deleted successfully",summary:"Meeting Minute Deleted"},400:{description:"Invalid meeting minute ID format",summary:"Validation Error",content:{"application/json":{schema:x.object({errors:x.record(x.string(),x.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:x.object({message:x.string()})}}},404:{description:"Meeting minute not found with the provided ID",summary:"Meeting Minute Not Found",content:{"application/json":{schema:x.object({message:x.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:x.object({message:x.string()})}}}}};import{MeetingFormat as Ql,MeetingStatus as eu}from"@prisma/client";import R from"zod";import{extendZodWithOpenApi as Ll}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as Fr,MeetingStatus as un}from"@prisma/client";import ae from"zod";Ll(ae);var gn=ae.object({title:ae.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),scheduledAt:ae.coerce.date(),format:ae.enum(Fr).default(Fr.ONLINE),agenda:ae.string().min(1,"Pauta \xE9 obrigat\xF3ria"),meetingLink:ae.string().url("Link da reuni\xE3o deve ser uma URL v\xE1lida").optional().or(ae.literal("")),location:ae.string().optional(),status:ae.enum(un).default(un.PENDING)}).refine(o=>o.format===Fr.ONLINE?!!o.meetingLink:o.format===Fr.IN_PERSON?!!o.location:!0,{message:"Reuni\xF5es online devem ter link e reuni\xF5es presenciais devem ter localiza\xE7\xE3o",path:["format"]}),qr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{title:t,scheduledAt:i,format:n,agenda:s,meetingLink:m,location:p,status:l}=gn.parse(e.body);return await this.meetingRepository.create({title:t,scheduledAt:i,format:n,agenda:s,meetingLink:m||void 0,location:p||void 0,status:l??un.PENDING}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as _l}from"@asteasolutions/zod-to-openapi";import fn from"zod";_l(fn);var yn=fn.object({id:fn.uuid()}),Br=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t}=yn.parse({id:e.params.id});if(!await this.meetingRepository.findById(t))throw new d("A reuni\xE3o n\xE3o existe.");return await this.meetingRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Hl}from"@asteasolutions/zod-to-openapi";import hn from"zod";Hl(hn);var Nr=hn.object({id:hn.uuid()}),Or=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t}=Nr.parse({id:e.params.id}),i=await this.meetingRepository.findById(t);if(!i)throw new d("A reuni\xE3o n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as zl}from"@asteasolutions/zod-to-openapi";import{MeetingStatus as Gl}from"@prisma/client";import Rn from"zod";zl(Rn);var In=Rn.object({status:Rn.enum(Gl)}),kr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{status:t}=In.parse({status:e.params.status}),i=await this.meetingRepository.findByStatus(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Wl}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as Zl,MeetingStatus as Vl}from"@prisma/client";import Se from"zod";var Kl=1,Yl=10;Wl(Se);var bn=Se.object({page:Se.coerce.number().min(1).default(Kl),limit:Se.coerce.number().min(1).default(Yl),title:Se.string().optional(),format:Se.enum(Zl).optional(),status:Se.enum(Vl).optional(),orderBy:Se.enum(["asc","desc"]).optional()}),Lr=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=bn.parse(e.query),s=i*t-i,[m,p]=await Promise.all([this.meetingRepository.find({pagination:{offset:s,limit:i},filter:n}),this.meetingRepository.count({filter:n})]),l=Math.max(Math.ceil(p/i),1);r.status(200).json({page:t,totalPages:l,offset:s,limit:i,meetings:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Xl}from"@asteasolutions/zod-to-openapi";import{MeetingFormat as $l,MeetingStatus as Jl}from"@prisma/client";import oe from"zod";Xl(oe);var Cn=oe.object({id:oe.uuid(),title:oe.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),scheduledAt:oe.coerce.date().optional(),format:oe.enum($l).optional(),agenda:oe.string().min(1,"Pauta \xE9 obrigat\xF3ria").optional(),meetingLink:oe.string().url("Link da reuni\xE3o deve ser uma URL v\xE1lida").optional().or(oe.literal("")),location:oe.string().optional(),status:oe.enum(Jl).optional()}),_r=class{constructor(e){this.meetingRepository=e}async handle(e,r){try{let{id:t,title:i,scheduledAt:n,format:s,agenda:m,meetingLink:p,location:l,status:P}=Cn.parse({id:e.params.id,...e.body});if(!await this.meetingRepository.findById(t))throw new d("A reuni\xE3o n\xE3o existe.");return await this.meetingRepository.update({id:t,title:i,scheduledAt:n,format:s,agenda:m,meetingLink:p||void 0,location:l||void 0,status:P}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var tu=R.object({id:R.uuid(),title:R.string(),publishedAt:R.date(),documentUrl:R.string(),meetingId:R.uuid(),createdAt:R.date(),updatedAt:R.date()}),wn=R.object({id:R.uuid(),title:R.string(),scheduledAt:R.date(),format:R.enum(Ql),agenda:R.string(),meetingLink:R.string().nullable(),location:R.string().nullable(),status:R.enum(eu),minutes:tu.nullable(),createdAt:R.date(),updatedAt:R.date()}),Va={method:"post",path:"/meeting",tags:["Meetings"],summary:"Create a new meeting",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:gn}}}},responses:{201:{description:"Meeting created successfully",summary:"Meeting Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},Ka={method:"get",path:"/meeting",tags:["Meetings"],summary:"List all meetings with pagination and filters",request:{query:bn},responses:{200:{description:"List of meetings retrieved successfully with pagination",summary:"Meetings Retrieved",content:{"application/json":{schema:R.object({page:R.number(),totalPages:R.number(),offset:R.number(),limit:R.number(),meetings:R.array(wn)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},Ya={method:"get",path:"/meeting/{id}",tags:["Meetings"],summary:"Find meeting by ID",request:{params:Nr},responses:{200:{description:"Meeting details retrieved successfully",summary:"Meeting Retrieved",content:{"application/json":{schema:wn}}},400:{description:"Invalid meeting ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},Xa={method:"get",path:"/meeting/status/{status}",tags:["Meetings"],summary:"Find meetings by status",request:{params:In},responses:{200:{description:"Meetings retrieved successfully by status",summary:"Meetings Retrieved by Status",content:{"application/json":{schema:R.array(wn)}}},400:{description:"Invalid status parameter provided",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},$a={method:"put",path:"/meeting/{id}",tags:["Meetings"],summary:"Update meeting",security:[{bearerAuth:[]}],request:{params:Nr,body:{content:{"application/json":{schema:Cn.omit({id:!0})}}}},responses:{200:{description:"Meeting updated successfully",summary:"Meeting Updated"},400:{description:"Invalid input data or meeting ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}},Ja={method:"delete",path:"/meeting/{id}",tags:["Meetings"],summary:"Delete meeting",security:[{bearerAuth:[]}],request:{params:yn},responses:{200:{description:"Meeting deleted successfully",summary:"Meeting Deleted"},400:{description:"Invalid meeting ID format",summary:"Validation Error",content:{"application/json":{schema:R.object({errors:R.record(R.string(),R.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:R.object({message:R.string()})}}},404:{description:"Meeting not found with the provided ID",summary:"Meeting Not Found",content:{"application/json":{schema:R.object({message:R.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:R.object({message:R.string()})}}}}};import w from"zod";import{extendZodWithOpenApi as ru}from"@asteasolutions/zod-to-openapi";import St from"zod";var ou=5,Qa=1024,iu=Qa*Qa,nu=ou*iu;ru(St);var Sn=St.object({title:St.string().min(1),content:St.string().min(1),image:St.any().refine(o=>!o||typeof o=="object"&&typeof o.mimetype=="string"&&o.mimetype.startsWith("image/")&&typeof o.size=="number"&&o.size<=nu,{message:"A imagem deve ser uma imagem v\xE1lida de no m\xE1ximo 5MB."})}),Hr=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{title:t,content:i,image:n}=Sn.parse({...e.body,image:e.file}),s=e.user.id,m=await this.firebaseStorageService.uploadFile({file:n,folder:F.NEWS,id:s});await this.newsRepository.create({title:t,content:i,authorId:s,imageUrl:m}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as su}from"@asteasolutions/zod-to-openapi";import ve from"zod";var au=1,mu=7;su(ve);var Gr=ve.object({page:ve.coerce.number().min(1).default(au),limit:ve.coerce.number().min(1).default(mu),authorId:ve.string(),title:ve.string().optional(),content:ve.string().optional(),orderBy:ve.enum(["asc","desc"]).default("desc")}),zr=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,authorId:n,...s}=Gr.parse(e.query),m=i*t-i,[p,l]=await Promise.all([this.newsRepository.findByAuthorId({authorId:n,pagination:{offset:m,limit:i},filter:s}),this.newsRepository.count({filter:{authorId:n,...s}})]),P=Math.max(Math.ceil(l/i),1);r.status(200).json({page:t,totalPages:P,offset:m,limit:i,news:p})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as cu}from"@asteasolutions/zod-to-openapi";import vn from"zod";cu(vn);var En=vn.object({id:vn.string()}),Wr=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{id:t}=En.parse(e.params),i=await this.newsRepository.findById(t);if(!i)throw new d("Not\xEDcia n\xE3o encontrada.");r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as pu}from"@asteasolutions/zod-to-openapi";import Ee from"zod";var du=1,lu=9;pu(Ee);var jn=Ee.object({page:Ee.coerce.number().min(1).default(du),limit:Ee.coerce.number().min(1).default(lu),title:Ee.string().optional(),content:Ee.string().optional(),authorId:Ee.string().optional(),orderBy:Ee.enum(["asc","desc"]).default("desc")}),Zr=class{constructor(e){this.newsRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=jn.parse(e.query),s=i*t-i,[m,p]=await Promise.all([this.newsRepository.find({pagination:{offset:s,limit:i},filter:n}),this.newsRepository.count({filter:n})]),l=Math.max(Math.ceil(p/i),1);r.status(200).json({page:t,totalPages:l,offset:s,limit:i,news:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var em={method:"post",path:"/news",tags:["News"],summary:"Create news",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:Sn}}}},responses:{201:{description:"News article created successfully",summary:"News Created",content:{"application/json":{schema:w.object({message:w.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},tm={method:"get",path:"/news",tags:["News"],summary:"List news",request:{query:jn},responses:{200:{description:"Paginated list of news articles retrieved successfully",summary:"News Retrieved",content:{"application/json":{schema:w.object({page:w.number(),totalPages:w.number(),offset:w.number(),limit:w.number(),news:w.array(w.object({title:w.string(),content:w.string(),id:w.string(),createdAt:w.date(),updatedAt:w.date(),imageUrl:w.string().nullable()}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},rm={method:"get",path:"/news/{id}",tags:["News"],summary:"Find news by ID",request:{params:En},responses:{200:{description:"News article details retrieved successfully",summary:"News Retrieved",content:{"application/json":{schema:w.object({page:w.number(),totalPages:w.number(),offset:w.number(),limit:w.number(),news:w.object({title:w.string(),content:w.string(),id:w.string(),createdAt:w.date(),updatedAt:w.date(),imageUrl:w.string().nullable()})})}}},400:{description:"Invalid news ID format",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},404:{description:"News article not found with the provided ID",summary:"News Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}},om={method:"get",path:"/news/author/{author_id}",tags:["News"],summary:"List news by author",request:{params:Gr.pick({authorId:!0}).transform(()=>({author_id:""})),query:Gr.omit({authorId:!0})},responses:{200:{description:"Paginated list of news articles by author retrieved successfully",summary:"Author News Retrieved",content:{"application/json":{schema:w.object({page:w.number(),totalPages:w.number(),offset:w.number(),limit:w.number(),news:w.array(w.object({title:w.string(),content:w.string(),id:w.string(),createdAt:w.date(),updatedAt:w.date(),imageUrl:w.string().nullable()}))})}}},400:{description:"Invalid author ID or query parameters",summary:"Validation Error",content:{"application/json":{schema:w.object({errors:w.record(w.string(),w.string())})}}},404:{description:"Author not found with the provided ID",summary:"Author Not Found",content:{"application/json":{schema:w.object({message:w.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:w.object({message:w.string()})}}}}};import v from"zod";import{extendZodWithOpenApi as uu}from"@asteasolutions/zod-to-openapi";import me from"zod";var nm=2,im=1024,gu=im*im,fu=nm*gu;uu(me);var Mn=me.object({name:me.string().min(1,"Nome \xE9 obrigat\xF3rio"),logo:me.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=fu,`A imagem deve ter no m\xE1ximo ${nm}MB.`),websiteUrl:me.url("URL do site deve ser v\xE1lida").optional(),description:me.string().optional(),category:me.string().optional(),since:me.coerce.date(),isActive:me.preprocess(o=>o==="true",me.boolean().optional())}),Vr=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{name:t,logo:i,websiteUrl:n,description:s,category:m,since:p,isActive:l}=Mn.parse({...e.body,logo:e.file}),P=await this.partnerRepository.create({name:t,websiteUrl:n,description:s,category:m,since:p,isActive:l}),U=await this.firebaseStorageService.uploadFile({file:i,id:P.id,folder:F.PARTNER});return await this.partnerRepository.update({id:P.id,logoUrl:U}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as yu}from"@asteasolutions/zod-to-openapi";import xn from"zod";yu(xn);var Tn=xn.object({id:xn.uuid()}),Kr=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=Tn.parse({id:e.params.id}),i=await this.partnerRepository.findById(t);if(!i)throw new d("O parceiro n\xE3o existe.");return i.logoUrl&&this.firebaseStorageService.deleteFile({fileUrl:i.logoUrl}),await this.partnerRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as hu}from"@asteasolutions/zod-to-openapi";import Pn from"zod";hu(Pn);var Xr=Pn.object({id:Pn.uuid()}),Yr=class{constructor(e){this.partnerRepository=e}async handle(e,r){try{let{id:t}=Xr.parse({id:e.params.id}),i=await this.partnerRepository.findById(t);if(!i)throw new d("O parceiro n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Ru}from"@asteasolutions/zod-to-openapi";import le from"zod";var Iu=1,bu=9;Ru(le);var An=le.object({page:le.coerce.number().min(1).default(Iu),limit:le.coerce.number().min(1).default(bu),name:le.string().optional(),description:le.string().optional(),category:le.string().optional(),isActive:le.coerce.boolean().optional(),orderBy:le.enum(["asc","desc"]).optional()}),$r=class{constructor(e){this.partnerRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=An.parse(e.query),s=i*t-i,[m,p]=await Promise.all([this.partnerRepository.find({pagination:{offset:s,limit:i},filter:n}),this.partnerRepository.count({filter:n})]),l=Math.max(Math.ceil(p/i),1);r.status(200).json({page:t,totalPages:l,offset:s,limit:i,partners:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Cu}from"@asteasolutions/zod-to-openapi";import ie from"zod";var am=2,sm=1024,wu=sm*sm,Su=am*wu;Cu(ie);var Dn=ie.object({id:ie.uuid(),name:ie.string().min(1,"Nome \xE9 obrigat\xF3rio").optional(),logo:ie.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Su,`A imagem deve ter no m\xE1ximo ${am}MB.`).optional(),websiteUrl:ie.url("URL do site deve ser v\xE1lida").optional(),description:ie.string().optional(),category:ie.string().optional(),since:ie.coerce.date().optional(),isActive:ie.preprocess(o=>o==="true",ie.boolean().optional())}),Jr=class{constructor(e,r){this.partnerRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,name:i,logo:n,websiteUrl:s,description:m,category:p,since:l,isActive:P}=Dn.parse({id:e.params.id,...e.body,logo:e.file}),U=await this.partnerRepository.findById(t);if(!U)throw new d("O parceiro n\xE3o existe.");let k=U.logoUrl;if(n&&(k=await this.firebaseStorageService.uploadFile({file:n,id:t,folder:"images/partners"})),!k)throw new a("Logo URL \xE9 obrigat\xF3rio");return await this.partnerRepository.update({id:t,name:i,logoUrl:k,websiteUrl:s,description:m,category:p,since:l,isActive:P}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var mm=v.object({id:v.uuid(),name:v.string(),logoUrl:v.string(),description:v.string().nullable(),category:v.string().nullable(),since:v.date(),isActive:v.boolean(),createdAt:v.date(),updatedAt:v.date()}),cm={method:"post",path:"/partner",tags:["Partners"],summary:"Create a new partner with logo upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:Mn}}}},responses:{201:{description:"Partner created successfully",summary:"Partner Created"},400:{description:"Invalid input data, missing required fields, or invalid logo format/size",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},409:{description:"Partner with this name already exists",summary:"Conflict",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},pm={method:"get",path:"/partner",tags:["Partners"],summary:"List all partners with pagination and filters",request:{query:An},responses:{200:{description:"List of partners retrieved successfully with pagination",summary:"Partners Retrieved",content:{"application/json":{schema:v.object({page:v.number(),totalPages:v.number(),offset:v.number(),limit:v.number(),partners:v.array(mm)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},dm={method:"get",path:"/partner/{id}",tags:["Partners"],summary:"Find partner by ID",request:{params:Xr},responses:{200:{description:"Partner details retrieved successfully",summary:"Partner Retrieved",content:{"application/json":{schema:mm}}},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},lm={method:"put",path:"/partner/{id}",tags:["Partners"],summary:"Update partner with optional logo upload",security:[{bearerAuth:[]}],request:{params:Xr,body:{content:{"multipart/form-data":{schema:Dn.omit({id:!0})}}}},responses:{200:{description:"Partner updated successfully",summary:"Partner Updated"},400:{description:"Invalid input data, partner ID format, or invalid logo format/size",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},409:{description:"Partner with this name already exists",summary:"Conflict",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}},um={method:"delete",path:"/partner/{id}",tags:["Partners"],summary:"Delete partner",security:[{bearerAuth:[]}],request:{params:Tn},responses:{200:{description:"Partner deleted successfully",summary:"Partner Deleted"},400:{description:"Invalid partner ID format",summary:"Validation Error",content:{"application/json":{schema:v.object({errors:v.record(v.string(),v.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:v.object({message:v.string()})}}},404:{description:"Partner not found with the provided ID",summary:"Partner Not Found",content:{"application/json":{schema:v.object({message:v.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:v.object({message:v.string()})}}}}};import{$Enums as gm}from"@prisma/client";import E from"zod";import{extendZodWithOpenApi as vu}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Eu}from"@prisma/client";import je from"zod";vu(je);var eo=je.object({userId:je.uuid(),title:je.string().min(1),description:je.string().optional(),status:je.enum(Eu).default("PENDING"),dueDate:je.coerce.date().optional(),document:je.any().refine(o=>o&&typeof o=="object"&&o.size>0,"Arquivo do documento \xE9 obrigat\xF3rio")}),Qr=class{constructor(e,r,t){this.userRepository=e;this.pendencyRepository=r;this.firebaseStorageService=t}async handle(e,r){try{let{userId:t,title:i,description:n,status:s,dueDate:m,document:p}=eo.parse({...e.body,userId:e.params.user_id,document:e.file});if(!await this.userRepository.findById(t))throw new V("O usu\xE1rio n\xE3o existe.");let P=await this.firebaseStorageService.uploadFile({file:p,id:t,folder:F.PENDENCY});return await this.pendencyRepository.create({userId:t,title:i,description:n,status:s,dueDate:m,documentUrl:P}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ju}from"@asteasolutions/zod-to-openapi";import Un from"zod";ju(Un);var Fn=Un.object({id:Un.uuid()}),to=class{constructor(e,r){this.pendencyRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=Fn.parse({id:e.params.pendency_id}),i=await this.pendencyRepository.findById(t);if(!i)throw new d("A pend\xEAncia n\xE3o existe.");return await Promise.all([this.pendencyRepository.deleteById(i.id),this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl})]),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Mu}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as xu}from"@prisma/client";import ue from"zod";var Tu=1,Pu=6;Mu(ue);var qn=ue.object({page:ue.coerce.number().min(1).default(Tu),limit:ue.coerce.number().min(1).default(Pu),title:ue.string().optional(),description:ue.string().optional(),status:ue.enum(xu).default("PENDING"),userId:ue.uuid().optional(),orderBy:ue.enum(["asc","desc"]).default("desc")}),ro=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{description:t,limit:i,orderBy:n,page:s,title:m,status:p,userId:l}=qn.parse(e.query),P=s*i-i,[U,k]=await Promise.all([this.pendencyRepository.find({pagination:{offset:P,limit:i},filter:{title:m,description:t,status:p,orderBy:n,userId:l}}),this.pendencyRepository.count({filter:{title:m,description:t,status:p,userId:l}})]),Z=Math.max(Math.ceil(k/i),1);return r.status(200).json({page:s,totalPages:Z,offset:P,limit:i,pendencies:U})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Au}from"@asteasolutions/zod-to-openapi";import Bn from"zod";Au(Bn);var On=Bn.object({pendencyId:Bn.uuid()}),oo=class{constructor(e){this.pendencyRepository=e}async handle(e,r){try{let{pendencyId:t}=On.parse({pendencyId:e.params.pendency_id}),i=await this.pendencyRepository.findById(t);if(!i)throw new d("Pend\xEAncia n\xE3o encontrada.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Du}from"@asteasolutions/zod-to-openapi";import{PendencyStatus as Uu}from"@prisma/client";import Me from"zod";Du(Me);var no=Me.object({id:Me.uuid(),title:Me.string().min(1),description:Me.string().optional(),status:Me.enum(Uu),dueDate:Me.coerce.date().optional(),document:Me.any().refine(o=>o==null||typeof o=="object"&&typeof o.size=="number"&&(o.size===0||o.size>0),"Arquivo do documento \xE9 inv\xE1lido").optional()}),io=class{constructor(e,r){this.pendencyRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{document:t,id:i,...n}=no.parse({...e.body,id:e.params.pendency_id,document:e.file}),s=await this.pendencyRepository.findById(i);if(!s)throw new V("A pend\xEAncia n\xE3o existe");let m=s.documentUrl;return t&&t.size>0&&(m=await this.firebaseStorageService.updateFile({file:t,id:s.userId,folder:F.PENDENCY,fileUrl:s.documentUrl})),await this.pendencyRepository.update({...n,id:i,documentUrl:m}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var fm={method:"post",path:"/pendency/{user_id}",tags:["Pendencies"],summary:"Create pendency for user",security:[{bearerAuth:[]}],request:{params:eo.pick({userId:!0}).transform(()=>({user_id:""})),body:{content:{"multipart/form-data":{schema:eo.omit({userId:!0})}}}},responses:{201:{description:"Pendency created successfully for the user",summary:"Pendency Created",content:{"application/json":{schema:E.object({})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},ym={method:"get",path:"/pendency",tags:["Pendencies"],summary:"List pendencies",security:[{bearerAuth:[]}],request:{query:qn},responses:{200:{description:"Paginated list of pendencies retrieved successfully",summary:"Pendencies Retrieved",content:{"application/json":{schema:E.object({page:E.number(),totalPages:E.number(),offset:E.number(),limit:E.number(),pendencies:E.array(E.object({id:E.string(),title:E.string(),description:E.string().nullable(),status:E.enum(gm.PendencyStatus),dueDate:E.date().nullable(),documentUrl:E.string(),userId:E.string(),createdAt:E.date(),updatedAt:E.date()}))})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},hm={method:"get",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Find pendency by ID",security:[{bearerAuth:[]}],request:{params:On},responses:{200:{description:"Pendency details retrieved successfully",summary:"Pendency Retrieved",content:{"application/json":{schema:E.object({id:E.string(),title:E.string(),description:E.string().nullable(),status:E.enum(gm.PendencyStatus),dueDate:E.date().nullable(),documentUrl:E.string(),userId:E.string(),createdAt:E.date(),updatedAt:E.date()}).nullable()}}},400:{description:"Invalid pendency ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},404:{description:"Pendency not found with the provided ID",summary:"Pendency Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},Rm={method:"put",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Update pendency",security:[{bearerAuth:[]}],request:{params:no.pick({id:!0}).transform(()=>({pendency_id:""})),body:{content:{"multipart/form-data":{schema:no.omit({id:!0})}}}},responses:{204:{description:"Pendency updated successfully",summary:"Pendency Updated"},400:{description:"Invalid input data or pendency does not exist",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}},Im={method:"delete",path:"/pendency/{pendency_id}",tags:["Pendencies"],summary:"Delete pendency",security:[{bearerAuth:[]}],request:{params:Fn},responses:{204:{description:"Pendency deleted successfully",summary:"Pendency Deleted"},400:{description:"Invalid pendency ID format",summary:"Validation Error",content:{"application/json":{schema:E.object({errors:E.record(E.string(),E.string())})}}},404:{description:"Pendency not found with the provided ID",summary:"Pendency Not Found",content:{"application/json":{schema:E.object({message:E.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:E.object({message:E.string()})}}}}};import{RegimentStatus as Yu}from"@prisma/client";import S from"zod";import{extendZodWithOpenApi as Fu}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as Cm}from"@prisma/client";import ke from"zod";var wm=10,bm=1024,qu=bm*bm,Bu=wm*qu;Fu(ke);var Nn=ke.object({title:ke.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio"),version:ke.string().min(1,"Vers\xE3o \xE9 obrigat\xF3ria"),publishedAt:ke.coerce.date(),document:ke.any().refine(o=>o==null||typeof o!="object"||typeof o.size!="number"?!1:o.size<=Bu,`O documento deve ter no m\xE1ximo ${wm}MB.`),status:ke.enum(Cm).optional()}),so=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{title:t,version:i,publishedAt:n,document:s,status:m}=Nn.parse({...e.body,document:e.file}),p=await this.regimentRepository.create({title:t,version:i,publishedAt:n,documentUrl:"",status:m??Cm.IN_FORCE}),l=await this.firebaseStorageService.uploadFile({file:s,id:p.id,folder:F.REGIMENT});return await this.regimentRepository.update({id:p.id,documentUrl:l}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Ou}from"@asteasolutions/zod-to-openapi";import kn from"zod";Ou(kn);var Ln=kn.object({id:kn.uuid()}),ao=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=Ln.parse({id:e.params.id}),i=await this.regimentRepository.findById(t);if(!i)throw new d("O regimento n\xE3o existe.");return i.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl}),await this.regimentRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Nu}from"@asteasolutions/zod-to-openapi";import _n from"zod";Nu(_n);var co=_n.object({id:_n.uuid()}),mo=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{id:t}=co.parse({id:e.params.id}),i=await this.regimentRepository.findById(t);if(!i)throw new d("O regimento n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as ku}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as Lu}from"@prisma/client";import Hn from"zod";ku(Hn);var zn=Hn.object({status:Hn.enum(Lu)}),po=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{status:t}=zn.parse({status:e.params.status}),i=await this.regimentRepository.findByStatus(t);return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as _u}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as Hu}from"@prisma/client";import Le from"zod";var zu=1,Gu=10;_u(Le);var Gn=Le.object({page:Le.coerce.number().min(1).default(zu),limit:Le.coerce.number().min(1).default(Gu),title:Le.string().optional(),status:Le.enum(Hu).optional(),orderBy:Le.enum(["asc","desc"]).optional()}),lo=class{constructor(e){this.regimentRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Gn.parse(e.query),s=i*t-i,[m,p]=await Promise.all([this.regimentRepository.find({pagination:{offset:s,limit:i},filter:n}),this.regimentRepository.count({filter:n})]),l=Math.max(Math.ceil(p/i),1);r.status(200).json({page:t,totalPages:l,offset:s,limit:i,regiments:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Wu}from"@asteasolutions/zod-to-openapi";import{RegimentStatus as Zu}from"@prisma/client";import xe from"zod";var vm=10,Sm=1024,Vu=Sm*Sm,Ku=vm*Vu;Wu(xe);var Wn=xe.object({id:xe.uuid(),title:xe.string().min(1,"T\xEDtulo \xE9 obrigat\xF3rio").optional(),version:xe.string().min(1,"Vers\xE3o \xE9 obrigat\xF3ria").optional(),publishedAt:xe.coerce.date().optional(),document:xe.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=Ku,`O documento deve ter no m\xE1ximo ${vm}MB.`).optional(),status:xe.enum(Zu).optional()}),uo=class{constructor(e,r){this.regimentRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,title:i,version:n,publishedAt:s,document:m,status:p}=Wn.parse({id:e.params.id,...e.body,document:e.file}),l=await this.regimentRepository.findById(t);if(!l)throw new d("O regimento n\xE3o existe.");let P=l.documentUrl;return m&&(l.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:l.documentUrl}),P=await this.firebaseStorageService.uploadFile({file:m,id:t,folder:F.REGIMENT})),await this.regimentRepository.update({id:t,title:i,version:n,publishedAt:s,documentUrl:P??void 0,status:p}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Zn=S.object({id:S.uuid(),title:S.string(),version:S.string(),publishedAt:S.date(),documentUrl:S.string(),status:S.enum(Yu),createdAt:S.date(),updatedAt:S.date()}),Em={method:"post",path:"/regiment",tags:["Regiments"],summary:"Create a new regiment with document upload",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:Nn}}}},responses:{201:{description:"Regiment created successfully",summary:"Regiment Created"},400:{description:"Invalid input data, missing required fields, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},jm={method:"get",path:"/regiment",tags:["Regiments"],summary:"List all regiments with pagination and filters",request:{query:Gn},responses:{200:{description:"List of regiments retrieved successfully with pagination",summary:"Regiments Retrieved",content:{"application/json":{schema:S.object({page:S.number(),totalPages:S.number(),offset:S.number(),limit:S.number(),regiments:S.array(Zn)})}}},400:{description:"Invalid query parameters provided",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},Mm={method:"get",path:"/regiment/{id}",tags:["Regiments"],summary:"Find regiment by ID",request:{params:co},responses:{200:{description:"Regiment details retrieved successfully",summary:"Regiment Retrieved",content:{"application/json":{schema:Zn}}},400:{description:"Invalid regiment ID format",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},xm={method:"get",path:"/regiment/status/{status}",tags:["Regiments"],summary:"Find regiments by status",request:{params:zn},responses:{200:{description:"Regiments retrieved successfully by status",summary:"Regiments Retrieved by Status",content:{"application/json":{schema:S.array(Zn)}}},400:{description:"Invalid status parameter provided",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},Tm={method:"put",path:"/regiment/{id}",tags:["Regiments"],summary:"Update regiment with optional document upload",security:[{bearerAuth:[]}],request:{params:co,body:{content:{"multipart/form-data":{schema:Wn.omit({id:!0})}}}},responses:{200:{description:"Regiment updated successfully",summary:"Regiment Updated"},400:{description:"Invalid input data, regiment ID format, or invalid document format/size",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}},Pm={method:"delete",path:"/regiment/{id}",tags:["Regiments"],summary:"Delete regiment",security:[{bearerAuth:[]}],request:{params:Ln},responses:{200:{description:"Regiment deleted successfully",summary:"Regiment Deleted"},400:{description:"Invalid regiment ID format",summary:"Validation Error",content:{"application/json":{schema:S.object({errors:S.record(S.string(),S.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:S.object({message:S.string()})}}},404:{description:"Regiment not found with the provided ID",summary:"Regiment Not Found",content:{"application/json":{schema:S.object({message:S.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:S.object({message:S.string()})}}}}};import{$Enums as es}from"@prisma/client";import f from"zod";import{extendZodWithOpenApi as Xu}from"@asteasolutions/zod-to-openapi";import{Degree as $u,Seniority as Ju}from"@prisma/client";import Q from"zod";Xu(Q);var Vn=Q.object({registrationNumber:Q.string(),mainEtps:Q.string().optional(),formations:Q.string().optional(),degrees:Q.array(Q.enum($u)),occupations:Q.string(),seniority:Q.enum(Ju),institutions:Q.string(),biography:Q.string().optional(),userId:Q.string()}),go=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{registrationNumber:t,mainEtps:i,formations:n,degrees:s,occupations:m,seniority:p,institutions:l,biography:P,userId:U}=Vn.parse(e.body);if(await this.researcherRepository.findByRegistrationNumber(t))throw new z("J\xE1 existe um pesquisador cadastrado com este n\xFAmero de registro.");if(await this.researcherRepository.findByUserId(U))throw new z("Usu\xE1rio j\xE1 possui um perfil de pesquisador.");return await this.researcherRepository.create({registrationNumber:t,mainEtps:i,formations:n,degrees:s,occupations:m,seniority:p,institutions:l,biography:P,userId:U}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as Qu}from"@asteasolutions/zod-to-openapi";import Kn from"zod";Qu(Kn);var Yn=Kn.object({id:Kn.uuid()}),fo=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t}=Yn.parse({id:e.params.id});if(!await this.researcherRepository.findById(t))throw new d("O pesquisador n\xE3o existe.");return await this.researcherRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as eg}from"@asteasolutions/zod-to-openapi";import Xn from"zod";eg(Xn);var ho=Xn.object({id:Xn.uuid()}),yo=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t}=ho.parse({id:e.params.id}),i=await this.researcherRepository.findById(t);if(!i)throw new d("O pesquisador n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as tg}from"@asteasolutions/zod-to-openapi";import $n from"zod";tg($n);var Jn=$n.object({userId:$n.uuid()}),Ro=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{userId:t}=Jn.parse({userId:e.params.userId}),i=await this.researcherRepository.findByUserId(t);if(!i)throw new d("O pesquisador n\xE3o existe para este usu\xE1rio.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as rg}from"@asteasolutions/zod-to-openapi";import{Degree as og,Seniority as ig}from"@prisma/client";import ee from"zod";rg(ee);var Qn=ee.object({id:ee.uuid(),registrationNumber:ee.string().optional(),mainEtps:ee.string().optional(),formations:ee.string().optional(),degrees:ee.array(ee.enum(og)).optional(),occupations:ee.string().optional(),seniority:ee.enum(ig).optional(),institutions:ee.string().optional(),biography:ee.string().optional()}),Io=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{id:t,registrationNumber:i,mainEtps:n,formations:s,degrees:m,occupations:p,seniority:l,institutions:P,biography:U}=Qn.parse({id:e.params.id,...e.body}),k=await this.researcherRepository.findById(t);if(!k)throw new d("O pesquisador n\xE3o existe.");if(i&&i!==k.registrationNumber){let Z=await this.researcherRepository.findByRegistrationNumber(i);if(Z&&Z.id!==t)throw new z("J\xE1 existe um pesquisador com este n\xFAmero de registro.")}return await this.researcherRepository.update({id:t,registrationNumber:i,mainEtps:n,formations:s,degrees:m,occupations:p,seniority:l,institutions:P,biography:U}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ng=1,sg=9,ts=f.object({id:f.uuid(),registrationNumber:f.string(),mainEtps:f.string().nullable(),formations:f.string().nullable(),degrees:f.array(f.enum(es.Degree)),occupations:f.string(),seniority:f.enum(es.Seniority),institutions:f.string(),biography:f.string().nullable(),createdAt:f.date(),updatedAt:f.date(),userId:f.uuid(),user:f.object({id:f.uuid(),name:f.string(),emailAddress:f.string(),avatarUrl:f.string().nullable(),orcid:f.string().nullable(),phone:f.string().nullable(),lattesUrl:f.string().nullable(),role:f.enum(es.UserRole)})}),Am={method:"post",path:"/researcher",tags:["Researchers"],summary:"Create a new researcher profile",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:Vn}}}},responses:{201:{description:"Researcher profile created successfully",summary:"Researcher Created",content:{"application/json":{schema:f.object({message:f.string()})}}},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:f.object({message:f.string()})}}},409:{description:"Researcher with this registration number already exists or user already has a researcher profile",summary:"Conflict",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},Dm={method:"get",path:"/researcher",tags:["Researchers"],summary:"List all researchers with pagination and filters",request:{query:f.object({page:f.coerce.number().min(1).default(ng).optional(),limit:f.coerce.number().min(1).default(sg).optional(),userId:f.string().optional(),registrationNumber:f.string().optional(),name:f.string().optional(),emailAddress:f.string().optional(),mainEtps:f.string().optional(),formations:f.string().optional(),occupations:f.string().optional(),institutions:f.string().optional(),biography:f.string().optional(),orderBy:f.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of researchers retrieved successfully with pagination",summary:"Researchers Retrieved",content:{"application/json":{schema:f.object({page:f.number(),totalPages:f.number(),offset:f.number(),limit:f.number(),researchers:f.array(ts)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},Um={method:"get",path:"/researcher/{id}",tags:["Researchers"],summary:"Find researcher by ID",request:{params:ho},responses:{200:{description:"Researcher details retrieved successfully",summary:"Researcher Retrieved",content:{"application/json":{schema:ts}}},400:{description:"Invalid researcher ID format",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},Fm={method:"get",path:"/researcher/user/{userId}",tags:["Researchers"],summary:"Find researcher by user ID",request:{params:Jn},responses:{200:{description:"Researcher details retrieved successfully",summary:"Researcher Retrieved",content:{"application/json":{schema:ts}}},400:{description:"Invalid user ID format",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},404:{description:"Researcher not found for this user",summary:"Researcher Not Found",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},qm={method:"put",path:"/researcher/{id}",tags:["Researchers"],summary:"Update researcher profile",security:[{bearerAuth:[]}],request:{params:ho,body:{content:{"application/json":{schema:Qn.omit({id:!0})}}}},responses:{200:{description:"Researcher profile updated successfully",summary:"Researcher Updated",content:{"application/json":{schema:f.object({message:f.string()})}}},400:{description:"Invalid input data or researcher ID format",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:f.object({message:f.string()})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:f.object({message:f.string()})}}},409:{description:"Researcher with this registration number already exists",summary:"Conflict",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}},Bm={method:"delete",path:"/researcher/{id}",tags:["Researchers"],summary:"Delete researcher profile",security:[{bearerAuth:[]}],request:{params:Yn},responses:{200:{description:"Researcher profile deleted successfully",summary:"Researcher Deleted"},400:{description:"Invalid researcher ID format",summary:"Validation Error",content:{"application/json":{schema:f.object({errors:f.record(f.string(),f.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:f.object({message:f.string()})}}},404:{description:"Researcher not found with the provided ID",summary:"Researcher Not Found",content:{"application/json":{schema:f.object({message:f.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:f.object({message:f.string()})}}}}};import{$Enums as dg}from"@prisma/client";import M from"zod";import{extendZodWithOpenApi as ag}from"@asteasolutions/zod-to-openapi";import at from"zod";ag(at);var rs=at.object({role:at.string().min(1),description:at.string().optional(),userId:at.uuid(),order:at.number().optional()}),bo=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{role:t,description:i,userId:n,order:s}=rs.parse(e.body);return await this.sdhcTeamMemberRepository.create({role:t,description:i,userId:n,order:s??0}),r.sendStatus(201)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as mg}from"@asteasolutions/zod-to-openapi";import os from"zod";mg(os);var is=os.object({id:os.uuid()}),Co=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t}=is.parse({id:e.params.id});if(!await this.sdhcTeamMemberRepository.findById(t))throw new d("O membro da equipe SDHC n\xE3o existe.");return await this.sdhcTeamMemberRepository.deleteById(t),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as cg}from"@asteasolutions/zod-to-openapi";import ns from"zod";cg(ns);var So=ns.object({id:ns.uuid()}),wo=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t}=So.parse({id:e.params.id}),i=await this.sdhcTeamMemberRepository.findById(t);if(!i)throw new d("O membro da equipe SDHC n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as pg}from"@asteasolutions/zod-to-openapi";import _e from"zod";pg(_e);var ss=_e.object({id:_e.uuid(),role:_e.string().min(1).optional(),description:_e.string().optional(),userId:_e.uuid().optional(),order:_e.number().optional()}),vo=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let{id:t,role:i,description:n,userId:s,order:m}=ss.parse({id:e.params.id,...e.body});if(!await this.sdhcTeamMemberRepository.findById(t))throw new d("O membro da equipe SDHC n\xE3o existe.");return await this.sdhcTeamMemberRepository.update({id:t,role:i,description:n,userId:s,order:m}),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var lg=M.object({id:M.uuid(),name:M.string(),emailAddress:M.string(),avatarUrl:M.string().nullable(),orcid:M.string().nullable(),phone:M.string().nullable(),lattesUrl:M.string().nullable(),role:M.enum(dg.UserRole)}),Om=M.object({id:M.uuid(),role:M.string(),description:M.string().nullable(),order:M.number(),createdAt:M.date(),updatedAt:M.date(),userId:M.uuid(),user:lg}),Nm={method:"post",path:"/sdhc-team-member",tags:["SDHC Team Members"],summary:"Create a new SDHC Team Member",security:[{bearerAuth:[]}],request:{body:{content:{"application/json":{schema:rs}}}},responses:{201:{description:"SDHC Team Member created successfully",summary:"SDHC Team Member Created"},400:{description:"Invalid input data or missing required fields",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},km={method:"get",path:"/sdhc-team-member",tags:["SDHC Team Members"],summary:"List all SDHC Team Members with filters",request:{query:M.object({role:M.string().optional(),orderBy:M.enum(["asc","desc"]).optional()})},responses:{200:{description:"List of SDHC Team Members retrieved successfully",summary:"SDHC Team Members Retrieved",content:{"application/json":{schema:M.object({members:M.array(Om)})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},Lm={method:"get",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Find SDHC Team Member by ID",request:{params:So},responses:{200:{description:"SDHC Team Member details retrieved successfully",summary:"SDHC Team Member Retrieved",content:{"application/json":{schema:Om}}},400:{description:"Invalid SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},_m={method:"put",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Update SDHC Team Member",security:[{bearerAuth:[]}],request:{params:So,body:{content:{"application/json":{schema:ss.omit({id:!0})}}}},responses:{200:{description:"SDHC Team Member updated successfully",summary:"SDHC Team Member Updated"},400:{description:"Invalid input data or SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:M.object({message:M.string()})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}},Hm={method:"delete",path:"/sdhc-team-member/{id}",tags:["SDHC Team Members"],summary:"Delete SDHC Team Member",security:[{bearerAuth:[]}],request:{params:is},responses:{200:{description:"SDHC Team Member deleted successfully",summary:"SDHC Team Member Deleted"},400:{description:"Invalid SDHC Team Member ID format",summary:"Validation Error",content:{"application/json":{schema:M.object({errors:M.record(M.string(),M.string())})}}},401:{description:"User not authenticated",summary:"Authentication Required",content:{"application/json":{schema:M.object({message:M.string()})}}},404:{description:"SDHC Team Member not found with the provided ID",summary:"SDHC Team Member Not Found",content:{"application/json":{schema:M.object({message:M.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:M.object({message:M.string()})}}}}};import{$Enums as Wm}from"@prisma/client";import T from"zod";import{extendZodWithOpenApi as ug}from"@asteasolutions/zod-to-openapi";import as from"zod";ug(as);var ms=as.object({id:as.string()}),Eo=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{id:t}=ms.parse({id:e.params.id}),i=await this.userRepository.findById(t);if(!i)throw new d("O usu\xE1rio n\xE3o existe.");let n=e.user.id;if(i.id!==n)throw new $("Voc\xEA n\xE3o tem permiss\xE3o para deletar o usu\xE1rio");return await this.userRepository.deleteById(i.id),r.sendStatus(204)}catch(t){if(console.log(t),t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as gg}from"@asteasolutions/zod-to-openapi";import{z as cs}from"zod";gg(cs);var ps=cs.object({id:cs.string().min(1,"id do usu\xE1rio n\xE3o fornecido.")}),jo=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{id:t}=ps.parse(e.params),i=await this.userRepository.findById(t);if(!i)throw new d("Usu\xE1rio n\xE3o encontrado");r.status(200).json(i)}catch(t){if(console.log(t),t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as fg}from"@asteasolutions/zod-to-openapi";import He from"zod";var Gm=2,zm=1024,yg=zm*zm,hg=Gm*yg,Rg=/^\d{4}-\d{4}-\d{4}-\d{4}$/,Ig=/^\(?\d{2}\)?[\s-]?\d{4,5}-?\d{4}$/;fg(He);var ds=He.object({name:He.string().optional(),lattesUrl:He.string().optional(),orcid:He.string().optional().transform(o=>o===void 0?void 0:o.trim()).refine(o=>o===void 0||o===""||Rg.test(o),{message:"ORCID inv\xE1lido. Deve estar no formato 0000-0000-0000-0000"}),phone:He.string().optional().refine(o=>o===void 0||o===""||Ig.test(o),{message:"Telefone inv\xE1lido. Deve estar no formato (99) 99999-9999"}),avatarImage:He.any().refine(o=>o==null?!0:typeof o!="object"||typeof o.size!="number"?!1:o.size<=hg,`A imagem deve ter no m\xE1ximo ${Gm}MB.`).optional()}),Mo=class{constructor(e,r){this.userRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{avatarImage:t,...i}=ds.parse({...e.body,avatarImage:e.file}),n=e.user.id,s=await this.userRepository.findById(n);if(!s)throw new V("O usu\xE1rio n\xE3o existe");let m=s.avatarUrl;return t&&(s.avatarUrl?m=await this.firebaseStorageService.updateFile({file:t,id:n,folder:F.USER,fileUrl:s.avatarUrl}):m=await this.firebaseStorageService.uploadFile({file:t,id:n,folder:F.USER})),await this.userRepository.update({...i,id:n,avatarUrl:m||void 0}),r.sendStatus(204)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Zm={method:"get",path:"/users/{id}",tags:["Users"],summary:"Find user by ID",request:{params:ps},responses:{200:{description:"User details retrieved successfully",summary:"User Retrieved",content:{"application/json":{schema:T.object({id:T.string(),name:T.string(),createdAt:T.date(),updatedAt:T.date(),role:T.enum(Wm.UserRole),lattesUrl:T.string().nullable(),orcid:T.string().nullable(),phone:T.string().nullable(),avatarUrl:T.url().nullable(),emailAddress:T.email()})}}},400:{description:"Invalid user ID format",summary:"Validation Error",content:{"application/json":{schema:T.object({errors:T.record(T.string(),T.string())})}}},404:{description:"User not found with the provided ID",summary:"User Not Found",content:{"application/json":{schema:T.object({message:T.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:T.object({message:T.string()})}}}}},Vm={method:"put",path:"/users",tags:["Users"],summary:"Update authenticated user",security:[{bearerAuth:[]}],request:{body:{content:{"multipart/form-data":{schema:ds}}}},responses:{200:{description:"User profile updated successfully",summary:"User Updated",content:{"application/json":{schema:T.object({message:T.string()})}}},400:{description:"Invalid input data or file format",summary:"Validation Error",content:{"application/json":{schema:T.object({errors:T.record(T.string(),T.string())})}}},401:{description:"User not authenticated or unauthorized",summary:"Authentication Required",content:{"application/json":{schema:T.object({message:T.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:T.object({message:T.string()})}}}}},Km={method:"delete",path:"/users",tags:["Users"],summary:"Delete authenticated user",security:[{bearerAuth:[]}],request:{params:ms},responses:{200:{description:"User account deleted successfully",summary:"User Deleted",content:{"application/json":{schema:T.object({message:T.string()})}}},400:{description:"Invalid request parameters",summary:"Validation Error",content:{"application/json":{schema:T.object({errors:T.record(T.string(),T.string())})}}},401:{description:"User not authenticated or unauthorized",summary:"Authentication Required",content:{"application/json":{schema:T.object({message:T.string()})}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:T.object({message:T.string()})}}}}},Ym={method:"get",path:"/users",tags:["Users"],summary:"List users",responses:{200:{description:"Complete list of users retrieved successfully",summary:"Users Retrieved",content:{"application/json":{schema:T.array(T.object({id:T.string(),name:T.string(),createdAt:T.date(),updatedAt:T.date(),role:T.enum(Wm.UserRole),lattesUrl:T.url().nullable(),orcid:T.string().nullable(),phone:T.string().nullable(),avatarUrl:T.string().nullable(),emailAddress:T.email()}))}}},500:{description:"Internal server error occurred",summary:"Server Error",content:{"application/json":{schema:T.object({message:T.string()})}}}}};var h=new bg;h.registerComponent("securitySchemes","bearerAuth",{type:"http",scheme:"bearer",bearerFormat:"JWT"});h.registerPath(Ds);h.registerPath(Us);h.registerPath(Fs);h.registerPath(qs);h.registerPath(Os);h.registerPath(Ns);h.registerPath(Bs);h.registerPath(Zm);h.registerPath(Vm);h.registerPath(Km);h.registerPath(Ym);h.registerPath(em);h.registerPath(tm);h.registerPath(rm);h.registerPath(om);h.registerPath(ks);h.registerPath(Ls);h.registerPath(_s);h.registerPath(Hs);h.registerPath(zs);h.registerPath(fm);h.registerPath(ym);h.registerPath(hm);h.registerPath(Rm);h.registerPath(Im);h.registerPath(ea);h.registerPath(ta);h.registerPath(ra);h.registerPath(oa);h.registerPath(ia);h.registerPath(Am);h.registerPath(Dm);h.registerPath(Um);h.registerPath(Fm);h.registerPath(qm);h.registerPath(Bm);h.registerPath(Ws);h.registerPath(Zs);h.registerPath(Vs);h.registerPath(Ks);h.registerPath(Ys);h.registerPath(cm);h.registerPath(pm);h.registerPath(dm);h.registerPath(lm);h.registerPath(um);h.registerPath(Fa);h.registerPath(qa);h.registerPath(Ba);h.registerPath(Oa);h.registerPath(Na);h.registerPath(Nm);h.registerPath(km);h.registerPath(Lm);h.registerPath(_m);h.registerPath(Hm);h.registerPath(xa);h.registerPath(Ta);h.registerPath(Pa);h.registerPath(Aa);h.registerPath(Da);h.registerPath(Em);h.registerPath(jm);h.registerPath(Mm);h.registerPath(xm);h.registerPath(Tm);h.registerPath(Pm);h.registerPath(Va);h.registerPath(Ka);h.registerPath(Ya);h.registerPath(Xa);h.registerPath($a);h.registerPath(Ja);h.registerPath(za);h.registerPath(Ga);h.registerPath(Wa);h.registerPath(Za);h.registerPath(Ca);h.registerPath(wa);h.registerPath(Sa);h.registerPath(va);h.registerPath(Ea);h.registerPath(ja);h.registerPath(ha);h.registerPath(Ra);h.registerPath(Ia);h.registerPath(ba);h.registerPath(ca);h.registerPath(pa);h.registerPath(da);h.registerPath(la);var wg=new Cg(h.definitions),Xm=wg.generateDocument({openapi:"3.0.0",info:{title:"API da Rede CT",version:"1.0.0",description:"API com valida\xE7\xE3o Zod"}});import{Router as Tg}from"express";import{extendZodWithOpenApi as Sg}from"@asteasolutions/zod-to-openapi";import ls from"zod";Sg(ls);var vg=ls.object({authenticatedUserId:ls.uuid()}),xo=class{constructor(e){this.userRepository=e}async handle(e,r){try{let{authenticatedUserId:t}=vg.parse({authenticatedUserId:e.user.id}),i=await this.userRepository.findById(t);if(!i)throw new d("Usu\xE1rio n\xE3o encontrado.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{PrismaClient as Eg}from"@prisma/client";var B=new Eg({log:["warn","error"]});var To=class{constructor(e){this.prisma=e}async register({userId:e,title:r,description:t,certificationUrl:i}){await this.prisma.certification.create({data:{title:r,description:t,certificationUrl:i,user:{connect:{id:e}}}})}async find({pagination:{offset:e,limit:r},filter:{description:t,orderBy:i,title:n,userId:s}}){let m={},p=[];return s&&(m.userId=s),n&&p.push({title:{contains:n,mode:"insensitive"}}),t&&p.push({description:{contains:t,mode:"insensitive"}}),p.length>0&&(m.OR=p),await this.prisma.certification.findMany({where:m,include:{user:{omit:{passwordHash:!0}}},orderBy:{updatedAt:i},skip:e,take:r})}async findById(e){return await this.prisma.certification.findFirst({where:{id:e}})}async findByUserId({pagination:{limit:e,offset:r},filter:{description:t,orderBy:i,title:n},userId:s}){let m={userId:s},p=[];return n&&p.push({title:{contains:n,mode:"insensitive"}}),t&&p.push({description:{contains:t,mode:"insensitive"}}),p.length>0&&(m.OR=p),await this.prisma.certification.findMany({where:m,include:{user:{omit:{passwordHash:!0}}},skip:r,take:e,orderBy:i?{updatedAt:i}:{updatedAt:"desc"}})}async update({id:e,...r}){await this.prisma.certification.update({where:{id:e},data:r})}async deleteById(e){await this.prisma.certification.delete({where:{id:e}})}async count({filter:{description:e,title:r,userId:t}}){let i={},n=[];return t&&(i.userId=t),r&&n.push({title:{contains:r,mode:"insensitive"}}),e&&n.push({description:{contains:e,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.certification.count({where:i})}};function Te(){return new To(B)}var Po=class{constructor(e){this.prisma=e}async create(e){await this.prisma.news.create({data:e})}async find({pagination:{offset:e,limit:r},filter:{authorId:t,content:i,title:n,orderBy:s}}){let m={};t&&(m.authorId={contains:t,mode:"insensitive"});let p=[];return n&&p.push({title:{contains:n,mode:"insensitive"}}),i&&p.push({content:{contains:i,mode:"insensitive"}}),p.length>0&&(m.OR=p),await this.prisma.news.findMany({where:m,omit:{authorId:!0},include:{author:!0},orderBy:{updatedAt:s},skip:e,take:r})}async findById(e){return await this.prisma.news.findUnique({where:{id:e},omit:{authorId:!0},include:{author:!0}})}async findByAuthorId({authorId:e,pagination:{offset:r,limit:t},filter:{orderBy:i="desc",content:n,title:s}}){let m={authorId:e},p=[];return s&&p.push({title:{contains:s,mode:"insensitive"}}),n&&p.push({content:{contains:n,mode:"insensitive"}}),p.length>0&&(m.OR=p),await this.prisma.news.findMany({omit:{authorId:!0},where:m,orderBy:{updatedAt:i},skip:r,take:t})}async update(e){await this.prisma.news.update({where:{id:e.id},data:{title:e.title,content:e.content,imageUrl:e.imageUrl}})}async delete(e){await this.prisma.news.delete({where:{id:e}})}async count({filter:{authorId:e,content:r,title:t}}){let i={};e&&(i.authorId={contains:e,mode:"insensitive"});let n=[];return t&&n.push({title:{contains:t,mode:"insensitive"}}),r&&n.push({content:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.news.count({where:i})}};function ge(){return new Po(B)}var Ao=class{constructor(e){this.prisma=e}async create(e){await this.prisma.pendency.create({data:e})}async find({filter:{description:e,orderBy:r,title:t,status:i,userId:n},pagination:{limit:s,offset:m}}){let p={userId:n,AND:{status:{equals:i}}};e&&(p.description={contains:e,mode:"insensitive"});let l=[];return t&&l.push({title:{contains:t,mode:"insensitive"}}),l.length>0&&(p.OR=l),await this.prisma.pendency.findMany({where:p,orderBy:{updatedAt:r},include:{user:{omit:{passwordHash:!0}}},skip:m,take:s})}async findById(e){return await this.prisma.pendency.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async findByUserId({filter:{description:e,orderBy:r,title:t,status:i},pagination:{limit:n,offset:s},userId:m}){let p={userId:m,AND:{status:{equals:i}}},l=[];return e&&l.push({description:{contains:e,mode:"insensitive"}}),t&&l.push({title:{contains:t,mode:"insensitive"}}),l.length>0&&(p.OR=l),await this.prisma.pendency.findMany({where:p,orderBy:{updatedAt:r},include:{user:{omit:{passwordHash:!0}}},skip:s,take:n})}async update({id:e,...r}){await this.prisma.pendency.update({where:{id:e},data:r})}async deleteById(e){await this.prisma.pendency.delete({where:{id:e}})}async count({filter:{description:e,title:r,status:t,userId:i}}){let n={userId:i},s=[];return e&&s.push({description:{contains:e,mode:"insensitive"}}),r&&s.push({title:{contains:r,mode:"insensitive"}}),t&&s.push({status:{equals:t}}),s.length>0&&(n.OR=s),await this.prisma.pendency.count({where:n})}};function Pe(){return new Ao(B)}var Do=class{constructor(e){this.prisma=e}async create(e){await this.prisma.user.create({data:e})}async update(e){await this.prisma.user.update({where:{id:e.id},data:{lattesUrl:e.lattesUrl??null,orcid:e.orcid??null,phone:e.phone??null,avatarUrl:e.avatarUrl??null}})}async deleteById(e){await this.prisma.user.delete({where:{id:e}})}async find(){return await this.prisma.user.findMany({omit:{passwordHash:!0}})}async findByEmail(e){return await this.prisma.user.findFirst({where:{emailAddress:e}})}async findById(e){return await this.prisma.user.findFirst({where:{id:e},omit:{passwordHash:!0}})}};function Y(){return new Do(B)}import{compare as jg,hash as Mg}from"bcryptjs";var Uo=class{constructor(e,r){this.hashFn=e;this.compareFn=r}async hash(e){return await this.hashFn(e,6)}async compare({password:e,hashedPassword:r}){return await this.compareFn(e,r)}};function us(){return new Uo(Mg,jg)}import $m from"jsonwebtoken";import X from"zod";var xg=X.object({JWT_SECRET:X.string(),FIREBASE_BUCKET:X.string(),FIREBASE_CLIENT_EMAIL:X.string(),FIREBASE_PRIVATE_KEY:X.string(),FIREBASE_PROJECT_ID:X.string(),FIREBASE_TYPE:X.string(),FIREBASE_PRIVATE_KEY_ID:X.string(),FIREBASE_CLIENT_ID:X.string(),FIREBASE_AUTH_URI:X.string(),FIREBASE_TOKEN_URI:X.string(),FIREBASE_AUTH_PROVIDER_X509_CERT_URL:X.string(),FIREBASE_CLIENT_X509_CERT_URL:X.string()}),W=xg.parse(process.env);var Fo=class{constructor(e,r){this.signFn=e;this.verifyFn=r}sign(e){try{return this.signFn(e,W.JWT_SECRET,{expiresIn:"3d",subject:e.id})}catch{return null}}verify(e){try{return this.verifyFn(e,W.JWT_SECRET)}catch{return null}}};function qo(){return new Fo($m.sign,$m.verify)}function Jm(){return{signUpController:new Ot(Y(),us())}}function Qm(){return{signInController:new qt(Y(),us(),qo())}}function ec(){return{findAuthenticatedUserController:new xo(Y())}}function tc(){return{findAuthenticatedUserController:new Dt(ge())}}function rc(){return{findAuthenticatedUserCertificationsController:new At(Te())}}function oc(){return{findAuthenticatedUserPendenciesController:new Ut(Pe())}}var Bo=class{constructor(e){this.jwtService=e}authenticated(e,r,t){let i=e.headers.authorization;if(!i?.startsWith("Bearer "))return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});let n=i.split(" ")[1];if(!n)return r.status(401).json({message:"Token n\xE3o fornecido."});try{let s=this.jwtService.verify(n);if(!s)return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});e.user=s,t()}catch(s){if(console.log(s),s instanceof Error)return r.status(401).json({message:s.message})}}isAdmin(e,r,t){let i=e.headers.authorization;if(!i?.startsWith("Bearer "))return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});let n=i.split(" ")[1];if(!n)return r.status(401).json({message:"Token n\xE3o fornecido."});try{let s=this.jwtService.verify(n);if(!s)return r.status(401).json({message:"Token inv\xE1lido.",invalid:!0});if(s.role!=="ADMIN")return r.status(401).json({message:"\xC9 necess\xE1rio ter permiss\xF5es de administrador."});t()}catch(s){if(console.log(s),s instanceof Error)return r.status(401).json({message:s.message})}}};function O(){return{authMiddleware:new Bo(qo())}}var fe=Tg(),{authMiddleware:vt}=O();fe.post("/sign-up",async(o,e)=>{let{signUpController:r}=Jm();await r.handle(o,e)});fe.post("/sign-in",async(o,e)=>{let{signInController:r}=Qm();await r.handle(o,e)});fe.get("/user",(o,e,r)=>{vt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserController:r}=ec();await r.handle(o,e)});fe.get("/user/news",(o,e,r)=>{vt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserController:r}=tc();await r.handle(o,e)});fe.get("/admin",(o,e,r)=>{vt.isAdmin(o,e,r)},(o,e)=>{try{e.status(200).json({success:!0})}catch(r){r instanceof Error&&e.status(500).json({message:r.message})}});fe.get("/certifications",(o,e,r)=>{vt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserCertificationsController:r}=rc();await r.handle(o,e)});fe.get("/pendencies",(o,e,r)=>{vt.authenticated(o,e,r)},async(o,e)=>{let{findAuthenticatedUserPendenciesController:r}=oc();await r.handle(o,e)});import{Router as qg}from"express";import{getStorage as Ag}from"firebase-admin/storage";import{config as Pg}from"dotenv";import ic from"firebase-admin";Pg();var gs=ic.initializeApp({credential:ic.credential.cert({clientEmail:W.FIREBASE_CLIENT_EMAIL,privateKey:W.FIREBASE_PRIVATE_KEY,projectId:W.FIREBASE_PROJECT_ID,type:W.FIREBASE_TYPE,privateKeyId:W.FIREBASE_PRIVATE_KEY_ID,clientId:W.FIREBASE_CLIENT_ID,authUri:W.FIREBASE_AUTH_URI,tokenUri:W.FIREBASE_TOKEN_URI,authProviderX509CertUrl:W.FIREBASE_AUTH_PROVIDER_X509_CERT_URL,clientX509CertUrl:W.FIREBASE_CLIENT_X509_CERT_URL}),storageBucket:W.FIREBASE_BUCKET});gs.name?console.log("\u{1F525} Firebase conectado com sucesso!"):console.error("\u274C Erro ao se conectar ao Firebase.");var Dg=Ag(gs),nc=Dg.bucket(W.FIREBASE_BUCKET);import{randomUUID as Ug}from"node:crypto";var Fg=/https:\/\/storage\.googleapis\.com\/[^/]+\/(.+)$/,Oo=class{constructor(e){this.bucket=e}async uploadFile({file:e,folder:r,id:t}){let i=`${Ug()}-${e?.originalname}`,n=this.bucket.file(`${r}/${t}/${i}`);return await new Promise((s,m)=>{let p=n.createWriteStream({metadata:{contentType:e?.mimetype}});p.on("error",l=>{m(l)}),p.on("finish",async()=>{try{await n.makePublic();let l=`https://storage.googleapis.com/${this.bucket.name}/${n.name}`;s(l)}catch(l){m(l)}}),p.end(e.buffer)})}async updateFile({file:e,id:r,fileUrl:t,folder:i}){try{let n=this.getPath(t);if(!n)throw new Error("Arquivo n\xE3o encontrado.");let[s,m]=await Promise.all([this.bucket.file(n).delete(),this.uploadFile({file:e,id:r,folder:i})]);return m}catch{throw new Error("Erro ao atualizar o arquivo.")}}async deleteFile({fileUrl:e}){let r=this.getPath(e);if(!r)throw new Error("Arquivo n\xE3o encontrado.");try{await this.bucket.file(r).delete()}catch{throw new Error("Erro ao deletar o arquivo.")}}getPath(e){let r=e.match(Fg);return r?r[1]:null}};function q(){return new Oo(nc)}function sc(){return{registerCertificationController:new _t(Y(),Te(),q())}}function ac(){return{findCertificationsController:new Lt(Te())}}function mc(){return{findCertificationByIdController:new kt(Te())}}function cc(){return{updateCertificationController:new zt(Te(),q())}}function pc(){return{deleteCertificationController:new Nt(Te(),q())}}import dc from"multer";var N=dc({storage:dc.memoryStorage()});var ze=qg(),{authMiddleware:Et}=O();ze.post("/:user_id",(o,e,r)=>{Et.isAdmin(o,e,r)},N.single("certification"),async(o,e)=>{let{registerCertificationController:r}=sc();await r.handle(o,e)});ze.get("/",(o,e,r)=>{Et.isAdmin(o,e,r)},async(o,e)=>{let{findCertificationsController:r}=ac();await r.handle(o,e)});ze.get("/:certification_id",(o,e,r)=>{Et.isAdmin(o,e,r)},async(o,e)=>{let{findCertificationByIdController:r}=mc();await r.handle(o,e)});ze.put("/:certification_id",(o,e,r)=>{Et.isAdmin(o,e,r)},N.single("certification"),async(o,e)=>{let{updateCertificationController:r}=cc();await r.handle(o,e)});ze.delete("/:certification_id",(o,e,r)=>{Et.isAdmin(o,e,r)},async(o,e)=>{let{deleteCertificationController:r}=pc();await r.handle(o,e)});import{Router as Lg}from"express";import{extendZodWithOpenApi as Bg}from"@asteasolutions/zod-to-openapi";import ye from"zod";var Og=1,Ng=9;Bg(ye);var kg=ye.object({page:ye.coerce.number().min(1).default(Og),limit:ye.coerce.number().min(1).default(Ng),code:ye.string().optional(),title:ye.string().optional(),description:ye.string().optional(),notes:ye.string().optional(),orderBy:ye.enum(["asc","desc"]).default("desc")}),No=class{constructor(e){this.etpRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=kg.parse(e.query),s=i*t-i,[m,p]=await Promise.all([this.etpRepository.find({pagination:{offset:s,limit:i},filter:n}),this.etpRepository.count({filter:n})]),l=Math.max(Math.ceil(p/i),1);r.status(200).json({page:t,totalPages:l,offset:s,limit:i,etps:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ko=class{constructor(e){this.prisma=e}async create(e){let{leaderId:r,deputyLeaderId:t,secretaryId:i,memberIds:n,...s}=e;await this.prisma.$transaction(async m=>{let p=await m.eTP.create({data:s});await m.eTPLeader.create({data:{etpId:p.id,researcherId:r}}),await m.eTPDeputy.create({data:{etpId:p.id,researcherId:t}}),await m.eTPSecretary.create({data:{etpId:p.id,researcherId:i}}),await m.eTP.update({where:{id:p.id},data:{members:{connect:n.map(l=>({id:l}))}}})})}async update(e){let{leaderId:r,deputyLeaderId:t,secretaryId:i,memberIds:n,...s}=e;await this.prisma.$transaction(async m=>{await m.eTP.update({where:{id:e.id},data:s}),await this.updateLeader(m,e.id,r),await this.updateDeputyLeader(m,e.id,t),await this.updateSecretary(m,e.id,i),await this.updateMembers(m,e.id,n)})}async updateLeader(e,r,t){t!==void 0&&(await e.eTPLeader.deleteMany({where:{etpId:r}}),t&&await e.eTPLeader.create({data:{etpId:r,researcherId:t}}))}async updateDeputyLeader(e,r,t){t!==void 0&&(await e.eTPDeputy.deleteMany({where:{etpId:r}}),t&&await e.eTPDeputy.create({data:{etpId:r,researcherId:t}}))}async updateSecretary(e,r,t){t!==void 0&&(await e.eTPSecretary.deleteMany({where:{etpId:r}}),t&&await e.eTPSecretary.create({data:{etpId:r,researcherId:t}}))}async updateMembers(e,r,t){t!==void 0&&await e.eTP.update({where:{id:r},data:{members:{set:t.map(i=>({id:i}))}}})}async deleteById(e){await this.prisma.eTP.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{code:t,title:i,description:n,notes:s,orderBy:m}}){let p={},l=[];return t&&l.push({code:{contains:t,mode:"insensitive"}}),i&&l.push({title:{contains:i,mode:"insensitive"}}),n&&l.push({description:{contains:n,mode:"insensitive"}}),s&&l.push({notes:{contains:s,mode:"insensitive"}}),l.length>0&&(p.OR=l),await this.prisma.eTP.findMany({where:p,include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}},orderBy:{updatedAt:m},skip:e,take:r})}async findById(e){return await this.prisma.eTP.findFirst({where:{id:e},include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}}})}async findByCode(e){return await this.prisma.eTP.findFirst({where:{code:e},include:{leader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},deputyLeader:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},secretary:{include:{researcher:{include:{user:{omit:{passwordHash:!0}}}}}},members:{include:{user:{omit:{passwordHash:!0}}}}}})}async count({filter:{code:e,title:r,description:t,notes:i}}){let n={},s=[];return e&&s.push({code:{contains:e,mode:"insensitive"}}),r&&s.push({title:{contains:r,mode:"insensitive"}}),t&&s.push({description:{contains:t,mode:"insensitive"}}),i&&s.push({notes:{contains:i,mode:"insensitive"}}),s.length>0&&(n.OR=s),await this.prisma.eTP.count({where:n})}};function mt(){return new ko(B)}function lc(){return{createETPController:new Wt(mt())}}function uc(){return{findETPsController:new No(mt())}}function gc(){return{findETPByIdController:new Vt(mt())}}function fc(){return{updateETPController:new Yt(mt())}}function yc(){return{deleteETPController:new Zt(mt())}}var Ge=Lg(),{authMiddleware:fs}=O();Ge.post("/",(o,e,r)=>{fs.authenticated(o,e,r)},async(o,e)=>{let{createETPController:r}=lc();await r.handle(o,e)});Ge.get("/",async(o,e)=>{let{findETPsController:r}=uc();await r.handle(o,e)});Ge.get("/:id",async(o,e)=>{let{findETPByIdController:r}=gc();await r.handle(o,e)});Ge.put("/:id",(o,e,r)=>{fs.authenticated(o,e,r)},async(o,e)=>{let{updateETPController:r}=fc();await r.handle(o,e)});Ge.delete("/:id",(o,e,r)=>{fs.authenticated(o,e,r)},async(o,e)=>{let{deleteETPController:r}=yc();await r.handle(o,e)});import{Router as _g}from"express";var Lo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.inMemoriam.create({data:e})}async update(e){await this.prisma.inMemoriam.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.inMemoriam.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{name:t,biography:i,role:n,orderBy:s}}){let m={},p=[];return n&&(m.role=n),t&&p.push({name:{contains:t,mode:"insensitive"}}),i&&p.push({biography:{contains:i,mode:"insensitive"}}),p.length>0&&(m.OR=p),await this.prisma.inMemoriam.findMany({where:m,orderBy:{updatedAt:s},skip:e,take:r})}async findById(e){return await this.prisma.inMemoriam.findFirst({where:{id:e}})}async findByRole(e){return await this.prisma.inMemoriam.findMany({where:{role:e}})}async count({filter:{name:e,biography:r,role:t}}){let i={},n=[];return t&&(i.role=t),e&&n.push({name:{contains:e,mode:"insensitive"}}),r&&n.push({biography:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.inMemoriam.count({where:i})}};function We(){return new Lo(B)}function hc(){return{createInMemoriamController:new $t(We(),q())}}function Rc(){return{findInMemoriamsController:new rr(We())}}function Ic(){return{findInMemoriamByIdController:new Qt(We())}}function bc(){return{findInMemoriamByRoleController:new tr(We())}}function Cc(){return{updateInMemoriamController:new or(We(),q())}}function wc(){return{deleteInMemoriamController:new Jt(We(),q())}}var Ae=_g(),{authMiddleware:ys}=O();Ae.post("/",(o,e,r)=>{ys.authenticated(o,e,r)},N.single("photo"),async(o,e)=>{let{createInMemoriamController:r}=hc();await r.handle(o,e)});Ae.get("/",async(o,e)=>{let{findInMemoriamsController:r}=Rc();await r.handle(o,e)});Ae.get("/:id",async(o,e)=>{let{findInMemoriamByIdController:r}=Ic();await r.handle(o,e)});Ae.get("/role/:role",async(o,e)=>{let{findInMemoriamByRoleController:r}=bc();await r.handle(o,e)});Ae.put("/:id",(o,e,r)=>{ys.authenticated(o,e,r)},N.single("photo"),async(o,e)=>{let{updateInMemoriamController:r}=Cc();await r.handle(o,e)});Ae.delete("/:id",(o,e,r)=>{ys.authenticated(o,e,r)},async(o,e)=>{let{deleteInMemoriamController:r}=wc();await r.handle(o,e)});import{Router as Hg}from"express";var hs=Hg();hs.get("/",(o,e)=>{e.status(200).json({message:"Rede CT"})});import{Router as Vg}from"express";var _o=class{constructor(e){this.prisma=e}async create(e){await this.prisma.internationalScientificCongress.create({data:e})}async update(e){await this.prisma.internationalScientificCongress.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.internationalScientificCongress.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,edition:i,orderBy:n}}){let s={},m=[];return i&&(s.edition=i),t&&m.push({title:{contains:t,mode:"insensitive"}}),m.length>0&&(s.OR=m),await this.prisma.internationalScientificCongress.findMany({where:s,include:{partners:!0,galleries:!0},orderBy:n?{startDate:n}:{startDate:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.internationalScientificCongress.findFirst({where:{id:e},include:{partners:!0,galleries:!0}})}async findByEdition(e){return await this.prisma.internationalScientificCongress.findMany({where:{edition:e},include:{partners:!0,galleries:!0}})}async count({filter:{title:e,edition:r}}){let t={},i=[];return r&&(t.edition=r),e&&i.push({title:{contains:e,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.internationalScientificCongress.count({where:t})}};function ne(){return new _o(B)}function Sc(){return{createInternationalScientificCongressController:new gr(ne())}}function vc(){return{findInternationalScientificCongressesController:new Ir(ne())}}function Ec(){return{findInternationalScientificCongressByIdController:new hr(ne())}}function jc(){return{findInternationalScientificCongressByEditionController:new yr(ne())}}function Mc(){return{updateInternationalScientificCongressController:new br(ne())}}function xc(){return{deleteInternationalScientificCongressController:new fr(ne())}}import{extendZodWithOpenApi as zg}from"@asteasolutions/zod-to-openapi";import Rs from"zod";zg(Rs);var Gg=Rs.object({id:Rs.uuid()}),Ho=class{constructor(e){this.internationalScientificCongressGalleryRepository=e}async handle(e,r){try{let{id:t}=Gg.parse({id:e.params.id}),i=await this.internationalScientificCongressGalleryRepository.findById(t);if(!i)throw new d("A imagem da galeria n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var zo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.congressGalleryItem.create({data:e})}async update(e){await this.prisma.congressGalleryItem.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.congressGalleryItem.delete({where:{id:e}})}async findByCongressId(e){let{pagination:r,filter:t}=e;return await this.prisma.congressGalleryItem.findMany({where:{congressId:t.congressId,...t.caption&&{caption:{contains:t.caption,mode:"insensitive"}}},skip:r.offset,take:r.limit})}async findById(e){return await this.prisma.congressGalleryItem.findFirst({where:{id:e}})}async count(e){let{filter:r}=e;return await this.prisma.congressGalleryItem.count({where:{congressId:r.congressId,...r.caption&&{caption:{contains:r.caption,mode:"insensitive"}}}})}};function ct(){return new zo(B)}function Tc(){return{createInternationalScientificCongressGalleryController:new ir(ct(),ne(),q())}}function Pc(){return{findInternationalScientificCongressGalleriesByCongressIdController:new ar(ct())}}function Ac(){return{findInternationalScientificCongressGalleryByIdController:new Ho(ct())}}function Dc(){return{updateInternationalScientificCongressGalleryController:new mr(ct(),q())}}function Uc(){return{deleteInternationalScientificCongressGalleryController:new nr(ct())}}import{extendZodWithOpenApi as Wg}from"@asteasolutions/zod-to-openapi";import Is from"zod";Wg(Is);var Zg=Is.object({id:Is.uuid()}),Go=class{constructor(e){this.internationalScientificCongressPartnerRepository=e}async handle(e,r){try{let{id:t}=Zg.parse({id:e.params.id}),i=await this.internationalScientificCongressPartnerRepository.findById(t);if(!i)throw new d("O parceiro n\xE3o existe.");return r.status(200).json(i)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Wo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.congressPartner.create({data:e})}async update(e){await this.prisma.congressPartner.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.congressPartner.delete({where:{id:e}})}async findByCongressId(e){return await this.prisma.congressPartner.findMany({where:{congressId:e.filter.congressId,name:e.filter.name?{contains:e.filter.name,mode:"insensitive"}:void 0},skip:e.pagination?.offset,take:e.pagination?.limit})}async findById(e){return await this.prisma.congressPartner.findFirst({where:{id:e}})}async count(e){return await this.prisma.congressPartner.count({where:{congressId:e.filter.congressId,name:e.filter.name?{contains:e.filter.name,mode:"insensitive"}:void 0}})}};function pt(){return new Wo(B)}function Fc(){return{createInternationalScientificCongressPartnerController:new cr(pt(),ne(),q())}}function qc(){return{findInternationalScientificCongressPartnersByCongressIdController:new lr(pt())}}function Bc(){return{findInternationalScientificCongressPartnerByIdController:new Go(pt())}}function Oc(){return{updateInternationalScientificCongressPartnerController:new ur(pt(),q())}}function Nc(){return{deleteInternationalScientificCongressPartnerController:new pr(pt())}}var G=Vg(),{authMiddleware:he}=O();G.post("/",(o,e,r)=>{he.authenticated(o,e,r)},async(o,e)=>{let{createInternationalScientificCongressController:r}=Sc();await r.handle(o,e)});G.get("/",async(o,e)=>{let{findInternationalScientificCongressesController:r}=vc();await r.handle(o,e)});G.get("/:id",async(o,e)=>{let{findInternationalScientificCongressByIdController:r}=Ec();await r.handle(o,e)});G.get("/edition/:edition",async(o,e)=>{let{findInternationalScientificCongressByEditionController:r}=jc();await r.handle(o,e)});G.put("/:id",(o,e,r)=>{he.authenticated(o,e,r)},async(o,e)=>{let{updateInternationalScientificCongressController:r}=Mc();await r.handle(o,e)});G.delete("/:id",(o,e,r)=>{he.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressController:r}=xc();await r.handle(o,e)});G.post("/:congressId/gallery",(o,e,r)=>{he.authenticated(o,e,r)},N.single("image"),async(o,e)=>{let{createInternationalScientificCongressGalleryController:r}=Tc();await r.handle(o,e)});G.get("/:congressId/gallery",async(o,e)=>{let{findInternationalScientificCongressGalleriesByCongressIdController:r}=Pc();await r.handle(o,e)});G.get("/gallery/:id",async(o,e)=>{let{findInternationalScientificCongressGalleryByIdController:r}=Ac();await r.handle(o,e)});G.put("/gallery/:id",(o,e,r)=>{he.authenticated(o,e,r)},N.single("image"),async(o,e)=>{let{updateInternationalScientificCongressGalleryController:r}=Dc();await r.handle(o,e)});G.delete("/gallery/:id",(o,e,r)=>{he.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressGalleryController:r}=Uc();await r.handle(o,e)});G.post("/:congressId/partner",(o,e,r)=>{he.authenticated(o,e,r)},N.single("logo"),async(o,e)=>{let{createInternationalScientificCongressPartnerController:r}=Fc();await r.handle(o,e)});G.get("/:congressId/partner",async(o,e)=>{let{findInternationalScientificCongressPartnersByCongressIdController:r}=qc();await r.handle(o,e)});G.get("/partner/:id",async(o,e)=>{let{findInternationalScientificCongressPartnerByIdController:r}=Bc();await r.handle(o,e)});G.put("/partner/:id",(o,e,r)=>{he.authenticated(o,e,r)},N.single("logo"),async(o,e)=>{let{updateInternationalScientificCongressPartnerController:r}=Oc();await r.handle(o,e)});G.delete("/partner/:id",(o,e,r)=>{he.authenticated(o,e,r)},async(o,e)=>{let{deleteInternationalScientificCongressPartnerController:r}=Nc();await r.handle(o,e)});import{Router as Xg}from"express";import{extendZodWithOpenApi as Kg}from"@asteasolutions/zod-to-openapi";import Zo from"zod";Kg(Zo);var Yg=Zo.object({role:Zo.string().optional(),orderBy:Zo.enum(["asc","desc"]).optional()}),Vo=class{constructor(e){this.legitimatorCommitteeMemberRepository=e}async handle(e,r){try{let t=Yg.parse(e.query),i=await this.legitimatorCommitteeMemberRepository.find({filter:t});r.status(200).json({members:i})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Ko=class{constructor(e){this.prisma=e}async create(e){await this.prisma.legitimatorCommitteeMember.create({data:{...e,order:e.order??0}})}async update(e){let{id:r,...t}=e;await this.prisma.legitimatorCommitteeMember.update({where:{id:r},data:t})}async deleteById(e){await this.prisma.legitimatorCommitteeMember.delete({where:{id:e}})}async find({filter:{role:e,orderBy:r}}){let t={};return e&&(t.role={contains:e,mode:"insensitive"}),await this.prisma.legitimatorCommitteeMember.findMany({where:t,include:{user:{omit:{passwordHash:!0}}},orderBy:r?[{order:"asc"},{updatedAt:r}]:[{order:"asc"},{updatedAt:"desc"}]})}async findById(e){return await this.prisma.legitimatorCommitteeMember.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{role:e}}){let r={};return e&&(r.role={contains:e,mode:"insensitive"}),await this.prisma.legitimatorCommitteeMember.count({where:r})}};function dt(){return new Ko(B)}function kc(){return{createLegitimatorCommitteeMemberController:new Cr(dt())}}function Lc(){return{findLegitimatorCommitteeMembersController:new Vo(dt())}}function _c(){return{findLegitimatorCommitteeMemberByIdController:new Sr(dt())}}function Hc(){return{updateLegitimatorCommitteeMemberController:new Er(dt())}}function zc(){return{deleteLegitimatorCommitteeMemberController:new wr(dt())}}var Ze=Xg(),{authMiddleware:bs}=O();Ze.post("/",(o,e,r)=>{bs.authenticated(o,e,r)},async(o,e)=>{let{createLegitimatorCommitteeMemberController:r}=kc();await r.handle(o,e)});Ze.get("/",async(o,e)=>{let{findLegitimatorCommitteeMembersController:r}=Lc();await r.handle(o,e)});Ze.get("/:id",async(o,e)=>{let{findLegitimatorCommitteeMemberByIdController:r}=_c();await r.handle(o,e)});Ze.put("/:id",(o,e,r)=>{bs.authenticated(o,e,r)},async(o,e)=>{let{updateLegitimatorCommitteeMemberController:r}=Hc();await r.handle(o,e)});Ze.delete("/:id",(o,e,r)=>{bs.authenticated(o,e,r)},async(o,e)=>{let{deleteLegitimatorCommitteeMemberController:r}=zc();await r.handle(o,e)});import{Router as Qg}from"express";import{extendZodWithOpenApi as $g}from"@asteasolutions/zod-to-openapi";import jt from"zod";$g(jt);var Jg=jt.object({name:jt.string().optional(),description:jt.string().optional(),orderBy:jt.enum(["asc","desc"]).default("desc")}),Yo=class{constructor(e){this.managementTeamRepository=e}async handle(e,r){try{let t=Jg.parse(e.query),i=await this.managementTeamRepository.find({filter:t});r.status(200).json({teams:i})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Xo=class{constructor(e){this.prisma=e}async create(e){let{members:r,...t}=e;await this.prisma.$transaction(async i=>{let n=await i.managementTeam.create({data:t});return await i.managementTeamMember.createMany({data:r.map(({userId:s,role:m,order:p})=>({teamId:n.id,userId:s,role:m,order:p??0}))}),n})}async update(e){let{members:r,...t}=e;await this.prisma.$transaction(async i=>{let n=await i.managementTeam.update({where:{id:e.id},data:t});return r!==void 0&&(await i.managementTeamMember.deleteMany({where:{teamId:e.id}}),r.length>0&&await i.managementTeamMember.createMany({data:r.map(({userId:s,role:m,order:p})=>({teamId:e.id,userId:s,role:m,order:p??0}))})),n})}async deleteById(e){await this.prisma.managementTeam.delete({where:{id:e}})}async find({filter:{name:e,description:r,orderBy:t}}){let i={},n=[];return e&&n.push({name:{contains:e,mode:"insensitive"}}),r&&n.push({description:{contains:r,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.managementTeam.findMany({where:i,include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}},orderBy:{updatedAt:t}})}async findById(e){return await this.prisma.managementTeam.findFirst({where:{id:e},include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}}})}async findByName(e){return await this.prisma.managementTeam.findFirst({where:{name:e},include:{members:{include:{user:{omit:{passwordHash:!0}}},orderBy:{order:"asc"}}}})}async count({filter:{name:e,description:r}}){let t={},i=[];return e&&i.push({name:{contains:e,mode:"insensitive"}}),r&&i.push({description:{contains:r,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.managementTeam.count({where:t})}};function lt(){return new Xo(B)}function Gc(){return{createManagementTeamController:new jr(lt())}}function Wc(){return{findManagementTeamsController:new Yo(lt())}}function Zc(){return{findManagementTeamByIdController:new xr(lt())}}function Vc(){return{updateManagementTeamController:new Pr(lt())}}function Kc(){return{deleteManagementTeamController:new Mr(lt())}}var Ve=Qg(),{authMiddleware:Cs}=O();Ve.post("/",(o,e,r)=>{Cs.authenticated(o,e,r)},async(o,e)=>{let{createManagementTeamController:r}=Gc();await r.handle(o,e)});Ve.get("/",async(o,e)=>{let{findManagementTeamsController:r}=Wc();await r.handle(o,e)});Ve.get("/:id",async(o,e)=>{let{findManagementTeamByIdController:r}=Zc();await r.handle(o,e)});Ve.put("/:id",(o,e,r)=>{Cs.authenticated(o,e,r)},async(o,e)=>{let{updateManagementTeamController:r}=Vc();await r.handle(o,e)});Ve.delete("/:id",(o,e,r)=>{Cs.authenticated(o,e,r)},async(o,e)=>{let{deleteManagementTeamController:r}=Kc();await r.handle(o,e)});import{Router as rf}from"express";var $o=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.meeting.create({data:e})}async update(e){await this.prisma.meeting.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.meeting.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,format:i,status:n,orderBy:s}}){let m={},p=[];return i&&(m.format=i),n&&(m.status=n),t&&p.push({title:{contains:t,mode:"insensitive"}}),p.length>0&&(m.OR=p),await this.prisma.meeting.findMany({where:m,include:{minutes:!0},orderBy:s?{scheduledAt:s}:{scheduledAt:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.meeting.findFirst({where:{id:e},include:{minutes:!0}})}async findByStatus(e){return await this.prisma.meeting.findMany({where:{status:e},include:{minutes:!0}})}async count({filter:{title:e,format:r,status:t}}){let i={},n=[];return r&&(i.format=r),t&&(i.status=t),e&&n.push({title:{contains:e,mode:"insensitive"}}),n.length>0&&(i.OR=n),await this.prisma.meeting.count({where:i})}};function Re(){return new $o(B)}function Yc(){return{createMeetingController:new qr(Re())}}function Xc(){return{findMeetingsController:new Lr(Re())}}function $c(){return{findMeetingByIdController:new Or(Re())}}function Jc(){return{findMeetingByStatusController:new kr(Re())}}function Qc(){return{updateMeetingController:new _r(Re())}}function ep(){return{deleteMeetingController:new Br(Re())}}import{extendZodWithOpenApi as ef}from"@asteasolutions/zod-to-openapi";import ws from"zod";ef(ws);var tf=ws.object({meetingId:ws.uuid()}),Jo=class{constructor(e,r){this.meetingMinuteRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{meetingId:t}=tf.parse({meetingId:e.params.meetingId}),i=await this.meetingMinuteRepository.findByMeetingId(t);if(!i)throw new d("A ata n\xE3o existe para esta reuni\xE3o.");return i.documentUrl&&await this.firebaseStorageService.deleteFile({fileUrl:i.documentUrl}),await this.meetingMinuteRepository.deleteByMeetingId(i.id),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};var Qo=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.meetingMinute.create({data:e,include:{meeting:!0}})}async update(e){await this.prisma.meetingMinute.update({where:{id:e.id},data:e})}async deleteByMeetingId(e){await this.prisma.meetingMinute.delete({where:{id:e}})}async findByMeetingId(e){return await this.prisma.meetingMinute.findFirst({where:{meetingId:e},include:{meeting:!0}})}};function Mt(){return new Qo(B)}function tp(){return{createMeetingMinuteController:new Ar(Mt(),Re(),q())}}function rp(){return{findMeetingMinuteByMeetingIdController:new Dr(Mt())}}function op(){return{updateMeetingMinuteByMeetingIdController:new Ur(Mt(),q())}}function ip(){return{deleteMeetingMinuteByMeetingIdController:new Jo(Mt(),q())}}var te=rf(),{authMiddleware:ut}=O();te.post("/",(o,e,r)=>{ut.authenticated(o,e,r)},async(o,e)=>{let{createMeetingController:r}=Yc();await r.handle(o,e)});te.get("/",async(o,e)=>{let{findMeetingsController:r}=Xc();await r.handle(o,e)});te.get("/:id",async(o,e)=>{let{findMeetingByIdController:r}=$c();await r.handle(o,e)});te.get("/status/:status",async(o,e)=>{let{findMeetingByStatusController:r}=Jc();await r.handle(o,e)});te.put("/:id",(o,e,r)=>{ut.authenticated(o,e,r)},async(o,e)=>{let{updateMeetingController:r}=Qc();await r.handle(o,e)});te.delete("/:id",(o,e,r)=>{ut.authenticated(o,e,r)},async(o,e)=>{let{deleteMeetingController:r}=ep();await r.handle(o,e)});te.post("/:meetingId/minute",(o,e,r)=>{ut.authenticated(o,e,r)},N.single("document"),async(o,e)=>{let{createMeetingMinuteController:r}=tp();await r.handle(o,e)});te.get("/:meetingId/minute",async(o,e)=>{let{findMeetingMinuteByMeetingIdController:r}=rp();await r.handle(o,e)});te.put("/:meetingId/minute",(o,e,r)=>{ut.authenticated(o,e,r)},N.single("document"),async(o,e)=>{let{updateMeetingMinuteByMeetingIdController:r}=op();await r.handle(o,e)});te.delete("/:meetingId/minute",(o,e,r)=>{ut.authenticated(o,e,r)},async(o,e)=>{let{deleteMeetingMinuteByMeetingIdController:r}=ip();await r.handle(o,e)});import{Router as df}from"express";import{extendZodWithOpenApi as of}from"@asteasolutions/zod-to-openapi";import Ss from"zod";of(Ss);var nf=Ss.object({id:Ss.string()}),ei=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t}=nf.parse(e.params),i=e.user.id,n=await this.newsRepository.findById(t);if(!n)throw new d("Not\xEDcia n\xE3o encontrada.");if(n.author.id!==i)throw new $("Sem permiss\xE3o.");await Promise.all([this.newsRepository.delete(t),this.firebaseStorageService.deleteFile({fileUrl:n.imageUrl})]),r.sendStatus(200)}catch(t){if(t instanceof Error)throw new a(t.message)}}};import{extendZodWithOpenApi as sf}from"@asteasolutions/zod-to-openapi";import gt from"zod";var af=5,np=1024,mf=np*np,cf=af*mf;sf(gt);var pf=gt.object({id:gt.string(),title:gt.string().min(1),content:gt.string().min(1),image:gt.any().optional().refine(o=>!o||typeof o=="object"&&typeof o.mimetype=="string"&&o.mimetype.startsWith("image/")&&typeof o.size=="number"&&o.size<=cf,"A imagem deve ser uma imagem v\xE1lida de no m\xE1ximo 5MB.")}),ti=class{constructor(e,r){this.newsRepository=e;this.firebaseStorageService=r}async handle(e,r){try{let{id:t,title:i,content:n,image:s}=pf.parse({id:e.params.id,image:e.file,...e.body}),m=await this.newsRepository.findById(t);if(!m)throw new d("Not\xEDcia n\xE3o encontrada.");let p=e.user.id;if(m.author.id!==p)throw new $("Sem permiss\xE3o.");let l=m.imageUrl||"";s&&m.imageUrl&&(l=await this.firebaseStorageService.updateFile({file:s,folder:F.NEWS,id:t,fileUrl:m.imageUrl}));let P=await this.newsRepository.update({id:t,title:i,content:n,imageUrl:l});r.status(200).json(P)}catch(t){if(t instanceof Error)throw new a(t.message)}}};function sp(){return{createNewsController:new Hr(ge(),q())}}function ap(){return{findAllNewsController:new Zr(ge())}}function mp(){return{findNewsByIdController:new Wr(ge())}}function cp(){return{findNewsByAuthorIdController:new zr(ge())}}function pp(){return{updateNewsController:new ti(ge(),q())}}function dp(){return{deleteNewsController:new ei(ge(),q())}}var De=df(),{authMiddleware:vs}=O();De.post("/",(o,e,r)=>{vs.authenticated(o,e,r)},N.single("image"),async(o,e)=>{let{createNewsController:r}=sp();await r.handle(o,e)});De.get("/",async(o,e)=>{let{findAllNewsController:r}=ap();await r.handle(o,e)});De.get("/:id",async(o,e)=>{let{findNewsByIdController:r}=mp();await r.handle(o,e)});De.get("/author/:authorId",async(o,e)=>{let{findNewsByAuthorIdController:r}=cp();await r.handle(o,e)});De.put("/:id",(o,e,r)=>{vs.authenticated(o,e,r)},N.single("image"),async(o,e)=>{let{updateNewsController:r}=pp();await r.handle(o,e)});De.delete("/:id",(o,e,r)=>{vs.authenticated(o,e,r)},async(o,e)=>{let{deleteNewsController:r}=dp();await r.handle(o,e)});import{Router as lf}from"express";var ri=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.partner.create({data:e})}async update(e){await this.prisma.partner.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.partner.delete({where:{id:e}})}async find({pagination:e,filter:{name:r,description:t,category:i,isActive:n,orderBy:s}}){let m={},p=[];return n!==void 0&&(m.isActive=n),r&&p.push({name:{contains:r,mode:"insensitive"}}),t&&p.push({description:{contains:t,mode:"insensitive"}}),i&&p.push({category:{contains:i,mode:"insensitive"}}),p.length>0&&(m.OR=p),await this.prisma.partner.findMany({where:m,orderBy:s?{updatedAt:s}:{updatedAt:"desc"},...e&&{skip:e.offset,take:e.limit}})}async findById(e){return await this.prisma.partner.findFirst({where:{id:e}})}async count({filter:{name:e,description:r,category:t,isActive:i}}){let n={},s=[];return i!==void 0&&(n.isActive=i),e&&s.push({name:{contains:e,mode:"insensitive"}}),r&&s.push({description:{contains:r,mode:"insensitive"}}),t&&s.push({category:{contains:t,mode:"insensitive"}}),s.length>0&&(n.OR=s),await this.prisma.partner.count({where:n})}};function ft(){return new ri(B)}function lp(){return{createPartnerController:new Vr(ft(),q())}}function up(){return{findPartnersController:new $r(ft())}}function gp(){return{findPartnerByIdController:new Yr(ft())}}function fp(){return{updatePartnerController:new Jr(ft(),q())}}function yp(){return{deletePartnerController:new Kr(ft(),q())}}var Ke=lf(),{authMiddleware:Es}=O();Ke.post("/",(o,e,r)=>{Es.authenticated(o,e,r)},N.single("logo"),async(o,e)=>{let{createPartnerController:r}=lp();await r.handle(o,e)});Ke.get("/",async(o,e)=>{let{findPartnersController:r}=up();await r.handle(o,e)});Ke.get("/:id",async(o,e)=>{let{findPartnerByIdController:r}=gp();await r.handle(o,e)});Ke.put("/:id",(o,e,r)=>{Es.authenticated(o,e,r)},N.single("logo"),async(o,e)=>{let{updatePartnerController:r}=fp();await r.handle(o,e)});Ke.delete("/:id",(o,e,r)=>{Es.authenticated(o,e,r)},async(o,e)=>{let{deletePartnerController:r}=yp();await r.handle(o,e)});import{Router as uf}from"express";function hp(){return{createPendencyController:new Qr(Y(),Pe(),q())}}function Rp(){return{findPendenciesController:new ro(Pe())}}function Ip(){return{findPendencyByIdController:new oo(Pe())}}function bp(){return{updatePendencyController:new io(Pe(),q())}}function Cp(){return{deletePendencyController:new to(Pe(),q())}}var Ye=uf(),{authMiddleware:xt}=O();Ye.post("/:user_id",(o,e,r)=>{xt.isAdmin(o,e,r)},N.single("document"),async(o,e)=>{let{createPendencyController:r}=hp();await r.handle(o,e)});Ye.get("/",(o,e,r)=>{xt.isAdmin(o,e,r)},async(o,e)=>{let{findPendenciesController:r}=Rp();await r.handle(o,e)});Ye.get("/:pendency_id",(o,e,r)=>{xt.isAdmin(o,e,r)},async(o,e)=>{let{findPendencyByIdController:r}=Ip();await r.handle(o,e)});Ye.put("/:pendency_id",(o,e,r)=>{xt.isAdmin(o,e,r)},N.single("document"),async(o,e)=>{let{updatePendencyController:r}=bp();await r.handle(o,e)});Ye.delete("/:pendency_id",(o,e,r)=>{xt.isAdmin(o,e,r)},async(o,e)=>{let{deletePendencyController:r}=Cp();await r.handle(o,e)});import{Router as gf}from"express";var oi=class{constructor(e){this.prisma=e}async create(e){return await this.prisma.regiment.create({data:e})}async update(e){await this.prisma.regiment.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.regiment.delete({where:{id:e}})}async find({pagination:{offset:e,limit:r},filter:{title:t,status:i,orderBy:n}}){let s={},m=[];return i&&(s.status=i),t&&m.push({title:{contains:t,mode:"insensitive"}}),m.length>0&&(s.OR=m),await this.prisma.regiment.findMany({where:s,orderBy:n?{updatedAt:n}:{updatedAt:"desc"},skip:e,take:r})}async findById(e){return await this.prisma.regiment.findFirst({where:{id:e}})}async findByStatus(e){return await this.prisma.regiment.findMany({where:{status:e}})}async count({filter:{title:e,status:r}}){let t={},i=[];return r&&(t.status=r),e&&i.push({title:{contains:e,mode:"insensitive"}}),i.length>0&&(t.OR=i),await this.prisma.regiment.count({where:t})}};function Xe(){return new oi(B)}function wp(){return{createRegimentController:new so(Xe(),q())}}function Sp(){return{findRegimentsController:new lo(Xe())}}function vp(){return{findRegimentByIdController:new mo(Xe())}}function Ep(){return{findRegimentByStatusController:new po(Xe())}}function jp(){return{updateRegimentController:new uo(Xe(),q())}}function Mp(){return{deleteRegimentController:new ao(Xe(),q())}}var Ue=gf(),{authMiddleware:js}=O();Ue.post("/",(o,e,r)=>{js.authenticated(o,e,r)},N.single("document"),async(o,e)=>{let{createRegimentController:r}=wp();await r.handle(o,e)});Ue.get("/",async(o,e)=>{let{findRegimentsController:r}=Sp();await r.handle(o,e)});Ue.get("/:id",async(o,e)=>{let{findRegimentByIdController:r}=vp();await r.handle(o,e)});Ue.get("/status/:status",async(o,e)=>{let{findRegimentByStatusController:r}=Ep();await r.handle(o,e)});Ue.put("/:id",(o,e,r)=>{js.authenticated(o,e,r)},N.single("document"),async(o,e)=>{let{updateRegimentController:r}=jp();await r.handle(o,e)});Ue.delete("/:id",(o,e,r)=>{js.authenticated(o,e,r)},async(o,e)=>{let{deleteRegimentController:r}=Mp();await r.handle(o,e)});import{Router as If}from"express";import{extendZodWithOpenApi as ff}from"@asteasolutions/zod-to-openapi";import K from"zod";var yf=1,hf=9;ff(K);var Rf=K.object({page:K.coerce.number().min(1).default(yf),limit:K.coerce.number().min(1).default(hf),userId:K.string().optional(),registrationNumber:K.string().optional(),name:K.string().optional(),emailAddress:K.string().optional(),mainEtps:K.string().optional(),formations:K.string().optional(),occupations:K.string().optional(),institutions:K.string().optional(),biography:K.string().optional(),orderBy:K.enum(["asc","desc"]).default("desc")}),ii=class{constructor(e){this.researcherRepository=e}async handle(e,r){try{let{page:t,limit:i,...n}=Rf.parse(e.query),s=i*t-i,[m,p]=await Promise.all([this.researcherRepository.find({pagination:{offset:s,limit:i},filter:{userName:n.name,...n}}),this.researcherRepository.count({filter:{userName:n.name,...n}})]),l=Math.max(Math.ceil(p/i),1);r.status(200).json({page:t,totalPages:l,offset:s,limit:i,researchers:m})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var ni=class{constructor(e){this.prisma=e}async create(e){await this.prisma.researcher.create({data:e})}async update(e){await this.prisma.researcher.update({where:{id:e.id},data:e})}async deleteById(e){await this.prisma.researcher.delete({where:{id:e}})}async find({pagination:e,filter:{biography:r,degrees:t,formations:i,institutions:n,mainEtps:s,occupations:m,orderBy:p,registrationNumber:l,seniority:P,userId:U,userName:k}}){let Z={},ce=[];return k&&ce.push({user:{name:{contains:k,mode:"insensitive"}}}),l&&ce.push({registrationNumber:{contains:l,mode:"insensitive"}}),s&&ce.push({mainEtps:{contains:s,mode:"insensitive"}}),i&&ce.push({formations:{contains:i,mode:"insensitive"}}),m&&ce.push({occupations:{contains:m,mode:"insensitive"}}),n&&ce.push({institutions:{contains:n,mode:"insensitive"}}),r&&ce.push({biography:{contains:r,mode:"insensitive"}}),ce.length>0&&(Z.OR=ce),t&&t.length>0&&(Z.degrees={hasSome:t}),P&&(Z.seniority=P),U&&(Z.userId={equals:U}),await this.prisma.researcher.findMany({where:Z,omit:{userId:!0},include:{user:{omit:{passwordHash:!0}}},orderBy:{updatedAt:p},...e&&{skip:e.offset,take:e.limit}})}async findById(e){return await this.prisma.researcher.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async findByUserId(e){return await this.prisma.researcher.findFirst({where:{userId:e},include:{user:{omit:{passwordHash:!0}}}})}async findByRegistrationNumber(e){return await this.prisma.researcher.findFirst({where:{registrationNumber:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{biography:e,degrees:r,formations:t,institutions:i,mainEtps:n,occupations:s,registrationNumber:m,seniority:p,userId:l,userName:P}}){let U={},k=[];return P&&k.push({user:{name:{contains:P,mode:"insensitive"}}}),m&&k.push({registrationNumber:{contains:m,mode:"insensitive"}}),k.length>0&&(U.OR=k),n&&(U.mainEtps={contains:n,mode:"insensitive"}),t&&(U.formations={contains:t,mode:"insensitive"}),r&&r.length>0&&(U.degrees={hasSome:r}),s&&(U.occupations={contains:s,mode:"insensitive"}),p&&(U.seniority=p),i&&(U.institutions={contains:i,mode:"insensitive"}),e&&(U.biography={contains:e,mode:"insensitive"}),l&&(U.userId={equals:l}),await this.prisma.researcher.count({where:U})}};function $e(){return new ni(B)}function xp(){return{createResearcherController:new go($e())}}function Tp(){return{findResearchersController:new ii($e())}}function Pp(){return{findResearcherByIdController:new yo($e())}}function Ap(){return{findResearcherByUserIdController:new Ro($e())}}function Dp(){return{updateResearcherController:new Io($e())}}function Up(){return{deleteResearcherController:new fo($e())}}var Fe=If(),{authMiddleware:Ms}=O();Fe.post("/",(o,e,r)=>{Ms.authenticated(o,e,r)},async(o,e)=>{let{createResearcherController:r}=xp();await r.handle(o,e)});Fe.get("/",async(o,e)=>{let{findResearchersController:r}=Tp();await r.handle(o,e)});Fe.get("/:id",async(o,e)=>{let{findResearcherByIdController:r}=Pp();await r.handle(o,e)});Fe.get("/user/:userId",async(o,e)=>{let{findResearcherByUserIdController:r}=Ap();await r.handle(o,e)});Fe.put("/:id",(o,e,r)=>{Ms.authenticated(o,e,r)},async(o,e)=>{let{updateResearcherController:r}=Dp();await r.handle(o,e)});Fe.delete("/:id",(o,e,r)=>{Ms.authenticated(o,e,r)},async(o,e)=>{let{deleteResearcherController:r}=Up();await r.handle(o,e)});import{Router as wf}from"express";import{extendZodWithOpenApi as bf}from"@asteasolutions/zod-to-openapi";import si from"zod";bf(si);var Cf=si.object({role:si.string().optional(),orderBy:si.enum(["asc","desc"]).optional()}),ai=class{constructor(e){this.sdhcTeamMemberRepository=e}async handle(e,r){try{let t=Cf.parse(e.query),i=await this.sdhcTeamMemberRepository.find({filter:t});r.status(200).json({members:i})}catch(t){if(t instanceof Error)throw new a(t.message)}}};var mi=class{constructor(e){this.prisma=e}async create(e){await this.prisma.sDHCTeamMember.create({data:{...e,order:e.order??0}})}async update(e){let{id:r,...t}=e;await this.prisma.sDHCTeamMember.update({where:{id:r},data:t})}async deleteById(e){await this.prisma.sDHCTeamMember.delete({where:{id:e}})}async find({filter:{role:e,orderBy:r}}){let t={};return e&&(t.role={contains:e,mode:"insensitive"}),await this.prisma.sDHCTeamMember.findMany({where:t,include:{user:{omit:{passwordHash:!0}}},orderBy:r?[{order:"asc"},{updatedAt:r}]:[{order:"asc"},{updatedAt:"desc"}]})}async findById(e){return await this.prisma.sDHCTeamMember.findFirst({where:{id:e},include:{user:{omit:{passwordHash:!0}}}})}async count({filter:{role:e}}){let r={};return e&&(r.role={contains:e,mode:"insensitive"}),await this.prisma.sDHCTeamMember.count({where:r})}};function yt(){return new mi(B)}function Fp(){return{createSDHCTeamMemberController:new bo(yt())}}function qp(){return{findSDHCTeamMembersController:new ai(yt())}}function Bp(){return{findSDHCTeamMemberByIdController:new wo(yt())}}function Op(){return{updateSDHCTeamMemberController:new vo(yt())}}function Np(){return{deleteSDHCTeamMemberController:new Co(yt())}}var Je=wf(),{authMiddleware:xs}=O();Je.post("/",(o,e,r)=>{xs.authenticated(o,e,r)},async(o,e)=>{let{createSDHCTeamMemberController:r}=Fp();await r.handle(o,e)});Je.get("/",async(o,e)=>{let{findSDHCTeamMembersController:r}=qp();await r.handle(o,e)});Je.get("/:id",async(o,e)=>{let{findSDHCTeamMemberByIdController:r}=Bp();await r.handle(o,e)});Je.put("/:id",(o,e,r)=>{xs.authenticated(o,e,r)},async(o,e)=>{let{updateSDHCTeamMemberController:r}=Op();await r.handle(o,e)});Je.delete("/:id",(o,e,r)=>{xs.authenticated(o,e,r)},async(o,e)=>{let{deleteSDHCTeamMemberController:r}=Np();await r.handle(o,e)});import{Router as Sf}from"express";var ci=class{constructor(e){this.userRepository=e}async handle(e,r){try{let t=await this.userRepository.find();r.status(200).json(t)}catch(t){if(t instanceof Error)throw new a(t.message)}}};function kp(){return{updateUserController:new Mo(Y(),q())}}function Lp(){return{deleteUserController:new Eo(Y())}}function _p(){return{findUsersController:new ci(Y())}}function Hp(){return{findUserController:new jo(Y())}}var ht=Sf(),{authMiddleware:zp}=O();ht.get("/:id",async(o,e)=>{let{findUserController:r}=Hp();await r.handle(o,e)});ht.put("/",(o,e,r)=>{zp.authenticated(o,e,r)},N.single("avatarImage"),async(o,e)=>{let{updateUserController:r}=kp();await r.handle(o,e)});ht.delete("/:id",(o,e,r)=>{zp.authenticated(o,e,r)},async(o,e)=>{let{deleteUserController:r}=Lp();await r.handle(o,e)});ht.get("/",async(o,e)=>{let{findUsersController:r}=_p();await r.handle(o,e)});var L=Ts(),jf={methods:["GET","POST","PUT","DELETE"],origin:["http://localhost:3000","https://rede-ct.vercel.app"],credentials:!0};L.use(Ef(jf));L.use(Ts.json());L.use(Ts.urlencoded({extended:!1}));L.use("/docs",vf({content:Xm,theme:"kepler"}));L.use("/",hs);L.use("/auth",fe);L.use("/user",ht);L.use("/news",De);L.use("/certification",ze);L.use("/pendency",Ye);L.use("/researcher",Fe);L.use("/in-memoriam",Ae);L.use("/etp",Ge);L.use("/partner",Ke);L.use("/management-team",Ve);L.use("/sdhc-team-member",Je);L.use("/legitimator-committee-member",Ze);L.use("/regiment",Ue);L.use("/meeting",te);L.use("/international-scientific-congress",G);L.use((o,e,r,t)=>{let{errorHandler:i}=Ps();i.handle(o,e,r,t)});var xf=Mf.createServer(L),Gp=4e3;xf.listen(Gp,()=>{console.log(`\u{1F680} Aplica\xE7\xE3o rodando na porta ${Gp}.`)});
